<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 42 章 貝葉斯定理的應用：單一參數模型 Single-parameter models | 醫學統計學</title>
  <meta name="description" content="第 42 章 貝葉斯定理的應用：單一參數模型 Single-parameter models | 醫學統計學" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="第 42 章 貝葉斯定理的應用：單一參數模型 Single-parameter models | 醫學統計學" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.jpg" />
  
  <meta name="github-repo" content="winterwang/LSHTMlearningnote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 42 章 貝葉斯定理的應用：單一參數模型 Single-parameter models | 醫學統計學" />
  
  
  <meta name="twitter:image" content="img/cover.jpg" />

<meta name="author" content="王 超辰 Chaochen Wang" />


<meta name="date" content="2020-10-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-Bayes.html"/>
<link rel="next" href="normal-distr.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block/empty-anchor.js"></script>
<script src="libs/kePrint/kePrint.js"></script>
<link href="libs/lightable/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">在LSHTM的統計學筆記</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>我是誰</a></li>
<li class="part"><span><b>I 概率論 Probability</b></span></li>
<li class="chapter" data-level="1" data-path="prob-intro.html"><a href="prob-intro.html"><i class="fa fa-check"></i><b>1</b> 概率論入門：定義與公理</a>
<ul>
<li class="chapter" data-level="1.1" data-path="prob-intro.html"><a href="prob-intro.html#三個概率公理"><i class="fa fa-check"></i><b>1.1</b> 三個概率公理：</a></li>
<li class="chapter" data-level="1.2" data-path="prob-intro.html"><a href="prob-intro.html#conditonalProb"><i class="fa fa-check"></i><b>1.2</b> 條件概率 Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="prob-intro.html"><a href="prob-intro.html#獨立-independence-的定義"><i class="fa fa-check"></i><b>1.3</b> 獨立 (independence) 的定義</a></li>
<li class="chapter" data-level="1.4" data-path="prob-intro.html"><a href="prob-intro.html#賭博問題"><i class="fa fa-check"></i><b>1.4</b> 賭博問題</a></li>
<li class="chapter" data-level="1.5" data-path="prob-intro.html"><a href="prob-intro.html#賭博問題的答案"><i class="fa fa-check"></i><b>1.5</b> 賭博問題的答案</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Bayes-Definition.html"><a href="Bayes-Definition.html"><i class="fa fa-check"></i><b>2</b> Bayes 貝葉斯理論的概念</a></li>
<li class="chapter" data-level="3" data-path="expectation.html"><a href="expectation.html"><i class="fa fa-check"></i><b>3</b> 期望 Expectation (或均值 or mean) 和 方差 Variance</a>
<ul>
<li class="chapter" data-level="3.1" data-path="expectation.html"><a href="expectation.html#方差的性質"><i class="fa fa-check"></i><b>3.1</b> 方差的性質：</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bernoulli.html"><a href="bernoulli.html"><i class="fa fa-check"></i><b>4</b> 伯努利分佈 Bernoulli distribution</a></li>
<li class="chapter" data-level="5" data-path="binomial.html"><a href="binomial.html"><i class="fa fa-check"></i><b>5</b> 二項分佈的概念 Binomial distribution</a>
<ul>
<li class="chapter" data-level="5.1" data-path="binomial.html"><a href="binomial.html#二項分佈的期望和方差"><i class="fa fa-check"></i><b>5.1</b> 二項分佈的期望和方差</a></li>
<li class="chapter" data-level="5.2" data-path="binomial.html"><a href="binomial.html#hyperdist"><i class="fa fa-check"></i><b>5.2</b> 超幾何分佈 hypergeometric distribution</a></li>
<li class="chapter" data-level="5.3" data-path="binomial.html"><a href="binomial.html#樂透中獎概率問題"><i class="fa fa-check"></i><b>5.3</b> 樂透中獎概率問題：</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="binomial.html"><a href="binomial.html#如果我只想中其中的-3-個號碼概率有多大"><i class="fa fa-check"></i><b>5.3.1</b> 如果我只想中其中的 <span class="math inline">\(3\)</span> 個號碼，概率有多大？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>6</b> 泊松分佈 Poisson Distribution</a></li>
<li class="chapter" data-level="7" data-path="normaldistr.html"><a href="normaldistr.html"><i class="fa fa-check"></i><b>7</b> 正（常）態分佈 Normal Distribution</a>
<ul>
<li class="chapter" data-level="7.1" data-path="normaldistr.html"><a href="normaldistr.html#概率密度曲線-probability-density-function-pdf"><i class="fa fa-check"></i><b>7.1</b> 概率密度曲線 probability density function， PDF</a></li>
<li class="chapter" data-level="7.2" data-path="normaldistr.html"><a href="normaldistr.html#正常態分佈"><i class="fa fa-check"></i><b>7.2</b> 正（常）態分佈</a></li>
<li class="chapter" data-level="7.3" data-path="normaldistr.html"><a href="normaldistr.html#standardNormal"><i class="fa fa-check"></i><b>7.3</b> 標準正（常）態分佈</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="CLT.html"><a href="CLT.html"><i class="fa fa-check"></i><b>8</b> 中心極限定理 the Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="8.1" data-path="CLT.html"><a href="CLT.html#covariance"><i class="fa fa-check"></i><b>8.1</b> 協方差 Covariance</a></li>
<li class="chapter" data-level="8.2" data-path="CLT.html"><a href="CLT.html#correlation"><i class="fa fa-check"></i><b>8.2</b> 相關 Correlation</a></li>
<li class="chapter" data-level="8.3" data-path="CLT.html"><a href="CLT.html#中心極限定理-the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> 中心極限定理 the Central Limit Theorem</a></li>
<li class="chapter" data-level="8.4" data-path="CLT.html"><a href="CLT.html#binomial-normal-approx"><i class="fa fa-check"></i><b>8.4</b> 二項分佈的正（常）態分佈近似</a></li>
<li class="chapter" data-level="8.5" data-path="CLT.html"><a href="CLT.html#泊松分佈的正常態分佈近似"><i class="fa fa-check"></i><b>8.5</b> 泊松分佈的正（常）態分佈近似</a></li>
<li class="chapter" data-level="8.6" data-path="CLT.html"><a href="CLT.html#continuity-correction"><i class="fa fa-check"></i><b>8.6</b> 正（常）態分佈模擬的校正：continuity corrections</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="CLT.html"><a href="CLT.html#例題"><i class="fa fa-check"></i><b>8.6.1</b> 例題</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="CLT.html"><a href="CLT.html#兩個連續隨機變量"><i class="fa fa-check"></i><b>8.7</b> 兩個連續隨機變量</a></li>
<li class="chapter" data-level="8.8" data-path="CLT.html"><a href="CLT.html#兩個連續隨機變量-例子"><i class="fa fa-check"></i><b>8.8</b> 兩個連續隨機變量 例子：</a></li>
<li class="chapter" data-level="8.9" data-path="CLT.html"><a href="CLT.html#條件分佈和邊緣分佈的概念"><i class="fa fa-check"></i><b>8.9</b> 條件分佈和邊緣分佈的概念</a></li>
<li class="chapter" data-level="8.10" data-path="CLT.html"><a href="CLT.html#條件分佈和邊緣分佈的例子"><i class="fa fa-check"></i><b>8.10</b> 條件分佈和邊緣分佈的例子</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="CLT.html"><a href="CLT.html#例題-1"><i class="fa fa-check"></i><b>8.10.1</b> 例題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 統計推斷 Inference</b></span></li>
<li class="chapter" data-level="9" data-path="inference-basic.html"><a href="inference-basic.html"><i class="fa fa-check"></i><b>9</b> 統計推斷的概念</a>
<ul>
<li class="chapter" data-level="9.1" data-path="inference-basic.html"><a href="inference-basic.html#人羣與樣本-population-and-sample"><i class="fa fa-check"></i><b>9.1</b> 人羣與樣本 (population and sample)</a></li>
<li class="chapter" data-level="9.2" data-path="inference-basic.html"><a href="inference-basic.html#樣本和統計量-sample-and-statistic"><i class="fa fa-check"></i><b>9.2</b> 樣本和統計量 (sample and statistic)</a></li>
<li class="chapter" data-level="9.3" data-path="inference-basic.html"><a href="inference-basic.html#估計-estimation"><i class="fa fa-check"></i><b>9.3</b> 估計 Estimation</a></li>
<li class="chapter" data-level="9.4" data-path="inference-basic.html"><a href="inference-basic.html#信賴區間-confidence-intervals"><i class="fa fa-check"></i><b>9.4</b> 信賴區間 confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html"><i class="fa fa-check"></i><b>10</b> 估計和精確度 Estimation and Precision</a>
<ul>
<li class="chapter" data-level="10.1" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#CI-for-sample-mean"><i class="fa fa-check"></i><b>10.1</b> 估計量和他們的樣本分佈</a></li>
<li class="chapter" data-level="10.2" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#估計量的特質"><i class="fa fa-check"></i><b>10.2</b> 估計量的特質</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#bias"><i class="fa fa-check"></i><b>10.2.1</b> 偏倚</a></li>
<li class="chapter" data-level="10.2.2" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#估計量的效能-efficiency"><i class="fa fa-check"></i><b>10.2.2</b> 估計量的效能 Efficiency</a></li>
<li class="chapter" data-level="10.2.3" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#均值和中位數的相對效能"><i class="fa fa-check"></i><b>10.2.3</b> 均值和中位數的相對效能</a></li>
<li class="chapter" data-level="10.2.4" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#均方差-mean-square-error-mse"><i class="fa fa-check"></i><b>10.2.4</b> 均方差 mean square error (MSE)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#samplevarbias"><i class="fa fa-check"></i><b>10.3</b> 總體方差的估計，自由度</a></li>
<li class="chapter" data-level="10.4" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#samplevar"><i class="fa fa-check"></i><b>10.4</b> 樣本方差的樣本分佈</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html"><i class="fa fa-check"></i><b>11</b> 卡方分佈 Chi-square distribution</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#卡方分佈的期望和方差的證明"><i class="fa fa-check"></i><b>11.1</b> 卡方分佈的期望和方差的證明</a></li>
<li class="chapter" data-level="11.2" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#卡方分佈的期望"><i class="fa fa-check"></i><b>11.2</b> 卡方分佈的期望</a></li>
<li class="chapter" data-level="11.3" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#卡方分佈的方差"><i class="fa fa-check"></i><b>11.3</b> 卡方分佈的方差</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#下面來求-ex_14"><i class="fa fa-check"></i><b>11.3.1</b> 下面來求 <span class="math inline">\(E(X_1^4)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#把上面的推導擴展"><i class="fa fa-check"></i><b>11.4</b> 把上面的推導擴展</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="likelihood-definition.html"><a href="likelihood-definition.html"><i class="fa fa-check"></i><b>12</b> 似然 Likelihood</a>
<ul>
<li class="chapter" data-level="12.1" data-path="likelihood-definition.html"><a href="likelihood-definition.html#概率-vs.-推斷-ability-vs.-inference"><i class="fa fa-check"></i><b>12.1</b> 概率 vs. 推斷 ability vs. Inference</a></li>
<li class="chapter" data-level="12.2" data-path="likelihood-definition.html"><a href="likelihood-definition.html#似然和極大似然估計-likelihood-and-maximum-likelihood-estimators"><i class="fa fa-check"></i><b>12.2</b> 似然和極大似然估計 Likelihood and maximum likelihood estimators</a></li>
<li class="chapter" data-level="12.3" data-path="likelihood-definition.html"><a href="likelihood-definition.html#似然方程的一般化定義"><i class="fa fa-check"></i><b>12.3</b> 似然方程的一般化定義</a></li>
<li class="chapter" data-level="12.4" data-path="likelihood-definition.html"><a href="likelihood-definition.html#對數似然方程-log-likelihood"><i class="fa fa-check"></i><b>12.4</b> 對數似然方程 log-likelihood</a></li>
<li class="chapter" data-level="12.5" data-path="likelihood-definition.html"><a href="likelihood-definition.html#極大似然估計-maximum-likelihood-estimator-mle-的性質"><i class="fa fa-check"></i><b>12.5</b> 極大似然估計 (maximum likelihood estimator, MLE) 的性質：</a></li>
<li class="chapter" data-level="12.6" data-path="likelihood-definition.html"><a href="likelihood-definition.html#likelihood-poi"><i class="fa fa-check"></i><b>12.6</b> 率的似然估計 Likelihood for a rate</a></li>
<li class="chapter" data-level="12.7" data-path="likelihood-definition.html"><a href="likelihood-definition.html#有-n-個獨立觀察時的似然方程和對數似然方程"><i class="fa fa-check"></i><b>12.7</b> 有 <span class="math inline">\(n\)</span> 個獨立觀察時的似然方程和對數似然方程</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="llr.html"><a href="llr.html"><i class="fa fa-check"></i><b>13</b> 對數似然比 Log-likelihood ratio</a>
<ul>
<li class="chapter" data-level="13.1" data-path="llr.html"><a href="llr.html#正態分佈數據的極大似然和對數似然比"><i class="fa fa-check"></i><b>13.1</b> 正態分佈數據的極大似然和對數似然比</a></li>
<li class="chapter" data-level="13.2" data-path="llr.html"><a href="llr.html#llr-chi1"><i class="fa fa-check"></i><b>13.2</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比</a></li>
<li class="chapter" data-level="13.3" data-path="llr.html"><a href="llr.html#llr-chi"><i class="fa fa-check"></i><b>13.3</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比的分佈</a></li>
<li class="chapter" data-level="13.4" data-path="llr.html"><a href="llr.html#似然比信賴區間"><i class="fa fa-check"></i><b>13.4</b> 似然比信賴區間</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="llr.html"><a href="llr.html#binomial-ex"><i class="fa fa-check"></i><b>13.4.1</b> 以二項分佈數據爲例</a></li>
<li class="chapter" data-level="13.4.2" data-path="llr.html"><a href="llr.html#normal-ex"><i class="fa fa-check"></i><b>13.4.2</b> 以正態分佈數據爲例</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="llr.html"><a href="llr.html#inference-practical-05"><i class="fa fa-check"></i><b>13.5</b> Inference Practical 05</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="llr.html"><a href="llr.html#q1"><i class="fa fa-check"></i><b>13.5.1</b> Q1</a></li>
<li class="chapter" data-level="13.5.2" data-path="llr.html"><a href="llr.html#q2"><i class="fa fa-check"></i><b>13.5.2</b> Q2</a></li>
<li class="chapter" data-level="13.5.3" data-path="llr.html"><a href="llr.html#q3"><i class="fa fa-check"></i><b>13.5.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="quadratic-llr.html"><a href="quadratic-llr.html"><i class="fa fa-check"></i><b>14</b> 二次方程近似法求對數似然比 approximate log-likelihood ratios</a>
<ul>
<li class="chapter" data-level="14.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#quadratic-llr2"><i class="fa fa-check"></i><b>14.1</b> 正態近似法求對數似然 Normal approximation to the log-likelihood</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#近似法估算對數似然比的信賴區間"><i class="fa fa-check"></i><b>14.1.1</b> 近似法估算對數似然比的信賴區間</a></li>
<li class="chapter" data-level="14.1.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#以泊松分佈爲例"><i class="fa fa-check"></i><b>14.1.2</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.1.3" data-path="quadratic-llr.html"><a href="quadratic-llr.html#quadratic-binomial-approx"><i class="fa fa-check"></i><b>14.1.3</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#para-trans"><i class="fa fa-check"></i><b>14.2</b> 參數转换 parameter transformations</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#Possion-log-transform"><i class="fa fa-check"></i><b>14.2.1</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.2.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#以二項分佈爲例"><i class="fa fa-check"></i><b>14.2.2</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="quadratic-llr.html"><a href="quadratic-llr.html#inference-practical-06"><i class="fa fa-check"></i><b>14.3</b> Inference Practical 06</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#q1-1"><i class="fa fa-check"></i><b>14.3.1</b> Q1</a></li>
<li class="chapter" data-level="14.3.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#q2-1"><i class="fa fa-check"></i><b>14.3.2</b> Q2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="hypothesis-test.html"><a href="hypothesis-test.html"><i class="fa fa-check"></i><b>15</b> 假設檢驗的構建 Construction of a hypothesis test</a>
<ul>
<li class="chapter" data-level="15.1" data-path="hypothesis-test.html"><a href="hypothesis-test.html#null-and-alter"><i class="fa fa-check"></i><b>15.1</b> 什麼是假設檢驗 Hypothesis testing</a></li>
<li class="chapter" data-level="15.2" data-path="hypothesis-test.html"><a href="hypothesis-test.html#錯誤概率和效能方程-error-probabilities-and-the-power-function"><i class="fa fa-check"></i><b>15.2</b> 錯誤概率和效能方程 error probabilities and the power function</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="hypothesis-test.html"><a href="hypothesis-test.html#以二項分佈爲例-1"><i class="fa fa-check"></i><b>15.2.1</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="hypothesis-test.html"><a href="hypothesis-test.html#Neyman-Pearson"><i class="fa fa-check"></i><b>15.3</b> 如何選擇要檢驗的統計量</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="hypothesis-test.html"><a href="hypothesis-test.html#以已知方差的正態分佈爲例"><i class="fa fa-check"></i><b>15.3.1</b> 以已知方差的正態分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="hypothesis-test.html"><a href="hypothesis-test.html#複合假設-composite-hypotheses"><i class="fa fa-check"></i><b>15.4</b> 複合假設 composite hypotheses</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="hypothesis-test.html"><a href="hypothesis-test.html#單側替代假設"><i class="fa fa-check"></i><b>15.4.1</b> 單側替代假設</a></li>
<li class="chapter" data-level="15.4.2" data-path="hypothesis-test.html"><a href="hypothesis-test.html#雙側替代假設"><i class="fa fa-check"></i><b>15.4.2</b> 雙側替代假設</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="hypothesis-test.html"><a href="hypothesis-test.html#爲反對零假設-h_0-的證據定量"><i class="fa fa-check"></i><b>15.5</b> 爲反對零假設 <span class="math inline">\(H_0\)</span> 的證據定量</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="hypothesis-test.html"><a href="hypothesis-test.html#normal-mean-compare"><i class="fa fa-check"></i><b>15.5.1</b> 回到正態分佈的均值比較問題上來(單側替代假設)</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="hypothesis-test.html"><a href="hypothesis-test.html#雙側替代假設情況下雙側-p-值的定量方法"><i class="fa fa-check"></i><b>15.6</b> 雙側替代假設情況下，雙側 <span class="math inline">\(p\)</span> 值的定量方法</a></li>
<li class="chapter" data-level="15.7" data-path="hypothesis-test.html"><a href="hypothesis-test.html#test-summary"><i class="fa fa-check"></i><b>15.7</b> 假設檢驗構建之總結</a></li>
<li class="chapter" data-level="15.8" data-path="hypothesis-test.html"><a href="hypothesis-test.html#inference-practical-07"><i class="fa fa-check"></i><b>15.8</b> Inference Practical 07</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="hypothesis-test.html"><a href="hypothesis-test.html#q1-2"><i class="fa fa-check"></i><b>15.8.1</b> Q1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html"><i class="fa fa-check"></i><b>16</b> 假設檢驗的近似方法</a>
<ul>
<li class="chapter" data-level="16.1" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#近似和精確檢驗-approximate-and-exact-tests"><i class="fa fa-check"></i><b>16.1</b> 近似和精確檢驗 approximate and exact tests</a></li>
<li class="chapter" data-level="16.2" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#LRT"><i class="fa fa-check"></i><b>16.2</b> 精確檢驗法之 – 似然比檢驗法 Likelihood ratio test</a></li>
<li class="chapter" data-level="16.3" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#練習題"><i class="fa fa-check"></i><b>16.3</b> 練習題</a></li>
<li class="chapter" data-level="16.4" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#Wald"><i class="fa fa-check"></i><b>16.4</b> 近似檢驗法之 – Wald 檢驗</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#再以二項分佈爲例"><i class="fa fa-check"></i><b>16.4.1</b> 再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#Score"><i class="fa fa-check"></i><b>16.5</b> 近似檢驗法之 – Score 检验</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#再再以二項分佈爲例"><i class="fa fa-check"></i><b>16.5.1</b> 再再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#LRTwaldScore-Compare"><i class="fa fa-check"></i><b>16.6</b> LRT, Wald, Score 檢驗三者的比較</a></li>
<li class="chapter" data-level="16.7" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#inference-practical-08"><i class="fa fa-check"></i><b>16.7</b> Inference Practical 08</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#q1-3"><i class="fa fa-check"></i><b>16.7.1</b> Q1</a></li>
<li class="chapter" data-level="16.7.2" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#q2-2"><i class="fa fa-check"></i><b>16.7.2</b> Q2</a></li>
<li class="chapter" data-level="16.7.3" data-path="approximation-hypo-test.html"><a href="approximation-hypo-test.html#q3-1"><i class="fa fa-check"></i><b>16.7.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="normal-error-models.html"><a href="normal-error-models.html"><i class="fa fa-check"></i><b>17</b> 正態誤差模型 Normal error models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="normal-error-models.html"><a href="normal-error-models.html#服從正態分佈的隨機變量"><i class="fa fa-check"></i><b>17.1</b> 服從正態分佈的隨機變量</a></li>
<li class="chapter" data-level="17.2" data-path="normal-error-models.html"><a href="normal-error-models.html#Fandtdistr"><i class="fa fa-check"></i><b>17.2</b> <span class="math inline">\(F\)</span> 分佈和 <span class="math inline">\(t\)</span> 分佈的概念</a></li>
<li class="chapter" data-level="17.3" data-path="normal-error-models.html"><a href="normal-error-models.html#兩個參數的模型"><i class="fa fa-check"></i><b>17.3</b> 兩個參數的模型</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="normal-error-models.html"><a href="normal-error-models.html#一組數據兩個參數"><i class="fa fa-check"></i><b>17.3.1</b> 一組數據兩個參數</a></li>
<li class="chapter" data-level="17.3.2" data-path="normal-error-models.html"><a href="normal-error-models.html#兩組數據各一個參數"><i class="fa fa-check"></i><b>17.3.2</b> 兩組數據各一個參數</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="normal-error-models.html"><a href="normal-error-models.html#正態分佈概率密度方程中總體均值和方差都未知-單樣本-t-檢驗-one-sample-t-test-的統計學推導"><i class="fa fa-check"></i><b>17.4</b> 正態分佈概率密度方程中總體均值和方差都未知 (單樣本 <span class="math inline">\(t\)</span> 檢驗 one sample <span class="math inline">\(t\)</span> test 的統計學推導)</a></li>
<li class="chapter" data-level="17.5" data-path="normal-error-models.html"><a href="normal-error-models.html#比較兩組獨立數據的均值-two-sample-t-test-with-equal-unknown-sigma2"><i class="fa fa-check"></i><b>17.5</b> 比較兩組獨立數據的均值 two sample <span class="math inline">\(t\)</span> test with equal unknown <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="17.6" data-path="normal-error-models.html"><a href="normal-error-models.html#各個統計分佈之間的關係"><i class="fa fa-check"></i><b>17.6</b> 各個統計分佈之間的關係</a></li>
<li class="chapter" data-level="17.7" data-path="normal-error-models.html"><a href="normal-error-models.html#inference-practical-09"><i class="fa fa-check"></i><b>17.7</b> Inference Practical 09</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html"><i class="fa fa-check"></i><b>18</b> 多個參數時的統計推斷 Inference with multiple parameters I</a>
<ul>
<li class="chapter" data-level="18.1" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#多參數-multiple-parameters---lrt"><i class="fa fa-check"></i><b>18.1</b> 多參數 multiple parameters - LRT</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#似然-likelihood"><i class="fa fa-check"></i><b>18.1.1</b> 似然 likelihood</a></li>
<li class="chapter" data-level="18.1.2" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#對數似然比檢驗"><i class="fa fa-check"></i><b>18.1.2</b> 對數似然比檢驗</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#多參數-wald-檢驗---wald-test"><i class="fa fa-check"></i><b>18.2</b> 多參數 Wald 檢驗 - Wald test</a></li>
<li class="chapter" data-level="18.3" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#多參數-score-檢驗---score-test"><i class="fa fa-check"></i><b>18.3</b> 多參數 Score 檢驗 - Score test</a></li>
<li class="chapter" data-level="18.4" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#condilikeli"><i class="fa fa-check"></i><b>18.4</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="18.5" data-path="inference-with-multiple-para.html"><a href="inference-with-multiple-para.html#inference-practical-10"><i class="fa fa-check"></i><b>18.5</b> Inference Practical 10</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html"><i class="fa fa-check"></i><b>19</b> 多個參數時的統計推斷 – 子集似然函數 profile log-likelihoods</a>
<ul>
<li class="chapter" data-level="19.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#子集似然法推導的過程總結"><i class="fa fa-check"></i><b>19.1</b> 子集似然法推導的過程總結</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#子集對數似然方程的分佈"><i class="fa fa-check"></i><b>19.1.1</b> 子集對數似然方程的分佈</a></li>
<li class="chapter" data-level="19.1.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#假設檢驗過程舉例"><i class="fa fa-check"></i><b>19.1.2</b> 假設檢驗過程舉例</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#子集對數似然比的近似"><i class="fa fa-check"></i><b>19.2</b> 子集對數似然比的近似</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#子集對數似然比近似的一般化"><i class="fa fa-check"></i><b>19.2.1</b> 子集對數似然比近似的一般化</a></li>
<li class="chapter" data-level="19.2.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#事件發生率之比的-wald-檢驗統計量"><i class="fa fa-check"></i><b>19.2.2</b> 事件發生率之比的 Wald 檢驗統計量</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#practical0"><i class="fa fa-check"></i><b>19.3</b> Inference Practical 11</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>20</b> 統計推斷總結</a>
<ul>
<li class="chapter" data-level="20.0.1" data-path="summary.html"><a href="summary.html#快速複習"><i class="fa fa-check"></i><b>20.0.1</b> 快速複習</a></li>
<li class="chapter" data-level="20.0.2" data-path="summary.html"><a href="summary.html#試爲下面的醫學研究問題提出合適的統計學模型"><i class="fa fa-check"></i><b>20.0.2</b> 試爲下面的醫學研究問題提出合適的統計學模型</a></li>
<li class="chapter" data-level="20.0.3" data-path="summary.html"><a href="summary.html#醫生來找統計學家問問題"><i class="fa fa-check"></i><b>20.0.3</b> 醫生來找統計學家問問題</a></li>
</ul></li>
<li class="part"><span><b>III 統計分析方法 Analytical Techniques</b></span></li>
<li class="chapter" data-level="21" data-path="descriptive-stat.html"><a href="descriptive-stat.html"><i class="fa fa-check"></i><b>21</b> 探索數據和簡單描述</a>
<ul>
<li class="chapter" data-level="21.1" data-path="descriptive-stat.html"><a href="descriptive-stat.html#數據分析的流程"><i class="fa fa-check"></i><b>21.1</b> 數據分析的流程</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="descriptive-stat.html"><a href="descriptive-stat.html#研究設計和實施"><i class="fa fa-check"></i><b>21.1.1</b> 研究設計和實施</a></li>
<li class="chapter" data-level="21.1.2" data-path="descriptive-stat.html"><a href="descriptive-stat.html#數據分析"><i class="fa fa-check"></i><b>21.1.2</b> 數據分析</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="descriptive-stat.html"><a href="descriptive-stat.html#數據類型"><i class="fa fa-check"></i><b>21.2</b> 數據類型</a></li>
<li class="chapter" data-level="21.3" data-path="descriptive-stat.html"><a href="descriptive-stat.html#如何總結並展示數據"><i class="fa fa-check"></i><b>21.3</b> 如何總結並展示數據</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="descriptive-stat.html"><a href="descriptive-stat.html#離散型分類型數據的描述---頻數分佈表-frequency-table"><i class="fa fa-check"></i><b>21.3.1</b> 離散型分類型數據的描述 - 頻數分佈表 frequency table</a></li>
<li class="chapter" data-level="21.3.2" data-path="descriptive-stat.html"><a href="descriptive-stat.html#連續型變量"><i class="fa fa-check"></i><b>21.3.2</b> 連續型變量</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="descriptive-stat.html"><a href="descriptive-stat.html#數據總結方案位置分散偏度和峰度"><i class="fa fa-check"></i><b>21.4</b> 數據總結方案：位置，分散，偏度，和峰度</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="descriptive-stat.html"><a href="descriptive-stat.html#位置"><i class="fa fa-check"></i><b>21.4.1</b> 位置</a></li>
<li class="chapter" data-level="21.4.2" data-path="descriptive-stat.html"><a href="descriptive-stat.html#分散"><i class="fa fa-check"></i><b>21.4.2</b> 分散</a></li>
<li class="chapter" data-level="21.4.3" data-path="descriptive-stat.html"><a href="descriptive-stat.html#偏度-skewness"><i class="fa fa-check"></i><b>21.4.3</b> 偏度 skewness</a></li>
<li class="chapter" data-level="21.4.4" data-path="descriptive-stat.html"><a href="descriptive-stat.html#峯度-kurtosis"><i class="fa fa-check"></i><b>21.4.4</b> 峯度 kurtosis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>22</b> 信賴區間 confidence intervals</a>
<ul>
<li class="chapter" data-level="22.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#定義"><i class="fa fa-check"></i><b>22.1</b> 定義</a></li>
<li class="chapter" data-level="22.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#利用總體參數的樣本分佈求信賴區間"><i class="fa fa-check"></i><b>22.2</b> 利用總體參數的樣本分佈求信賴區間</a></li>
<li class="chapter" data-level="22.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#情況1已知方差的正態分佈數據均值的信賴區間"><i class="fa fa-check"></i><b>22.3</b> 情況1：已知方差的正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="22.4" data-path="confidence-intervals.html"><a href="confidence-intervals.html#CImean"><i class="fa fa-check"></i><b>22.4</b> 信賴區間的意義</a></li>
<li class="chapter" data-level="22.5" data-path="confidence-intervals.html"><a href="confidence-intervals.html#AT2-5"><i class="fa fa-check"></i><b>22.5</b> 情況2：未知方差，但是已知服從正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="22.6" data-path="confidence-intervals.html"><a href="confidence-intervals.html#varCI"><i class="fa fa-check"></i><b>22.6</b> 情況3：服從正態分佈的隨機變量方差的信賴區間</a></li>
<li class="chapter" data-level="22.7" data-path="confidence-intervals.html"><a href="confidence-intervals.html#當樣本量足夠大時"><i class="fa fa-check"></i><b>22.7</b> 當樣本量足夠大時</a></li>
<li class="chapter" data-level="22.8" data-path="confidence-intervals.html"><a href="confidence-intervals.html#情況4求人羣百分比的信賴區間"><i class="fa fa-check"></i><b>22.8</b> 情況4：求人羣百分比的信賴區間</a>
<ul>
<li class="chapter" data-level="22.8.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#一般原則"><i class="fa fa-check"></i><b>22.8.1</b> 一般原則</a></li>
<li class="chapter" data-level="22.8.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#exactprop"><i class="fa fa-check"></i><b>22.8.2</b> 二項分佈的“精確法”計算信賴區間</a></li>
<li class="chapter" data-level="22.8.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#二項分佈的近似法計算信賴區間"><i class="fa fa-check"></i><b>22.8.3</b> 二項分佈的近似法計算信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="confidence-intervals.html"><a href="confidence-intervals.html#CIrate"><i class="fa fa-check"></i><b>22.9</b> 率的信賴區間</a>
<ul>
<li class="chapter" data-level="22.9.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#利用泊松分佈精確計算"><i class="fa fa-check"></i><b>22.9.1</b> 利用泊松分佈精確計算</a></li>
<li class="chapter" data-level="22.9.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#利用正態近似法計算"><i class="fa fa-check"></i><b>22.9.2</b> 利用正態近似法計算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="hypo-tests.html"><a href="hypo-tests.html"><i class="fa fa-check"></i><b>23</b> 假設檢驗</a>
<ul>
<li class="chapter" data-level="23.1" data-path="hypo-tests.html"><a href="hypo-tests.html#拋硬幣的例子"><i class="fa fa-check"></i><b>23.1</b> 拋硬幣的例子</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="hypo-tests.html"><a href="hypo-tests.html#單側和雙側檢驗"><i class="fa fa-check"></i><b>23.1.1</b> 單側和雙側檢驗</a></li>
<li class="chapter" data-level="23.1.2" data-path="hypo-tests.html"><a href="hypo-tests.html#p-值的意義"><i class="fa fa-check"></i><b>23.1.2</b> <span class="math inline">\(p\)</span> 值的意義</a></li>
<li class="chapter" data-level="23.1.3" data-path="hypo-tests.html"><a href="hypo-tests.html#p-值和信賴區間的關係"><i class="fa fa-check"></i><b>23.1.3</b> <span class="math inline">\(p\)</span> 值和信賴區間的關係</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="hypo-tests.html"><a href="hypo-tests.html#二項分佈的精確假設檢驗"><i class="fa fa-check"></i><b>23.2</b> 二項分佈的精確假設檢驗</a></li>
<li class="chapter" data-level="23.3" data-path="hypo-tests.html"><a href="hypo-tests.html#當樣本量較大"><i class="fa fa-check"></i><b>23.3</b> 當樣本量較大</a></li>
<li class="chapter" data-level="23.4" data-path="hypo-tests.html"><a href="hypo-tests.html#二項分佈的正態近似法假設檢驗"><i class="fa fa-check"></i><b>23.4</b> 二項分佈的正態近似法假設檢驗</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="hypo-tests.html"><a href="hypo-tests.html#連續性校正-continuity-correction"><i class="fa fa-check"></i><b>23.4.1</b> 連續性校正 continuity correction</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="hypo-tests.html"><a href="hypo-tests.html#AT3-5"><i class="fa fa-check"></i><b>23.5</b> 情況1：對均值進行假設檢驗 (方差已知)</a></li>
<li class="chapter" data-level="23.6" data-path="hypo-tests.html"><a href="hypo-tests.html#OneSampleT"><i class="fa fa-check"></i><b>23.6</b> 情況2：對均值進行假設檢驗 (方差未知) the one-sample t-test</a></li>
<li class="chapter" data-level="23.7" data-path="hypo-tests.html"><a href="hypo-tests.html#情況3對配對實驗數據的均值差進行假設檢驗-the-paired-t-test"><i class="fa fa-check"></i><b>23.7</b> 情況3：對配對實驗數據的均值差進行假設檢驗 the paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>24</b> 相關 association</a>
<ul>
<li class="chapter" data-level="24.1" data-path="association.html"><a href="association.html#背景介紹"><i class="fa fa-check"></i><b>24.1</b> 背景介紹</a></li>
<li class="chapter" data-level="24.2" data-path="association.html"><a href="association.html#兩個連續型變量的相關分析"><i class="fa fa-check"></i><b>24.2</b> 兩個連續型變量的相關分析</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="association.html"><a href="association.html#相關係數的定義"><i class="fa fa-check"></i><b>24.2.1</b> 相關係數的定義</a></li>
<li class="chapter" data-level="24.2.2" data-path="association.html"><a href="association.html#相關係數的性質"><i class="fa fa-check"></i><b>24.2.2</b> 相關係數的性質</a></li>
<li class="chapter" data-level="24.2.3" data-path="association.html"><a href="association.html#對相關係數是否爲零進行假設檢驗"><i class="fa fa-check"></i><b>24.2.3</b> 對相關係數是否爲零進行假設檢驗</a></li>
<li class="chapter" data-level="24.2.4" data-path="association.html"><a href="association.html#相關係數的-95-信賴區間"><i class="fa fa-check"></i><b>24.2.4</b> 相關係數的 <span class="math inline">\(95\%\)</span> 信賴區間</a></li>
<li class="chapter" data-level="24.2.5" data-path="association.html"><a href="association.html#比較兩個相關係數是否相等"><i class="fa fa-check"></i><b>24.2.5</b> 比較兩個相關係數是否相等</a></li>
<li class="chapter" data-level="24.2.6" data-path="association.html"><a href="association.html#相關係數那些事兒"><i class="fa fa-check"></i><b>24.2.6</b> 相關係數那些事兒</a></li>
<li class="chapter" data-level="24.2.7" data-path="association.html"><a href="association.html#在-r-裏面計算相關係數"><i class="fa fa-check"></i><b>24.2.7</b> 在 R 裏面計算相關係數</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="association.html"><a href="association.html#二元變量之間的相關性-association-between-pairs-of-binary-variables"><i class="fa fa-check"></i><b>24.3</b> 二元變量之間的相關性 association between pairs of binary variables</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="association.html"><a href="association.html#or-的信賴區間"><i class="fa fa-check"></i><b>24.3.1</b> OR 的信賴區間</a></li>
<li class="chapter" data-level="24.3.2" data-path="association.html"><a href="association.html#比值比的假設檢驗"><i class="fa fa-check"></i><b>24.3.2</b> 比值比的假設檢驗</a></li>
<li class="chapter" data-level="24.3.3" data-path="association.html"><a href="association.html#chisquaretest"><i class="fa fa-check"></i><b>24.3.3</b> 兩個百分比的卡方檢驗</a></li>
<li class="chapter" data-level="24.3.4" data-path="association.html"><a href="association.html#確切檢驗法-fishers-exact-test"><i class="fa fa-check"></i><b>24.3.4</b> 確切檢驗法 Fisher’s “exact” test</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="association.html"><a href="association.html#多分類-無排序-的情況-mtimes-n-表格"><i class="fa fa-check"></i><b>24.4</b> 多分類 (無排序) 的情況 <span class="math inline">\(M\times N\)</span> 表格</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="comparisons.html"><a href="comparisons.html"><i class="fa fa-check"></i><b>25</b> 比較 Comparisons</a>
<ul>
<li class="chapter" data-level="25.1" data-path="comparisons.html"><a href="comparisons.html#比較兩個均值-comparing-two-population-means"><i class="fa fa-check"></i><b>25.1</b> 比較兩個均值 comparing two population means</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="comparisons.html"><a href="comparisons.html#當方差已知且數據服從正態分佈-z-test"><i class="fa fa-check"></i><b>25.1.1</b> 當方差已知，且數據服從正態分佈 Z-test</a></li>
<li class="chapter" data-level="25.1.2" data-path="comparisons.html"><a href="comparisons.html#當方差未知但是方差可以被認爲相等且數據服從正態分佈-two-sample-t-test"><i class="fa fa-check"></i><b>25.1.2</b> 當方差未知，但是方差可以被認爲相等，且數據服從正態分佈 two sample <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="25.1.3" data-path="comparisons.html"><a href="comparisons.html#練習"><i class="fa fa-check"></i><b>25.1.3</b> 練習</a></li>
<li class="chapter" data-level="25.1.4" data-path="comparisons.html"><a href="comparisons.html#當方差未知但是方差不可以被認爲相等且數據服從正態分佈"><i class="fa fa-check"></i><b>25.1.4</b> 當方差未知，但是方差<strong>不可以</strong>被認爲相等，且數據服從正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="comparisons.html"><a href="comparisons.html#兩個人羣的方差比較"><i class="fa fa-check"></i><b>25.2</b> 兩個人羣的方差比較</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="comparisons.html"><a href="comparisons.html#Ftest"><i class="fa fa-check"></i><b>25.2.1</b> 方差比值檢驗 variance ratio test</a></li>
<li class="chapter" data-level="25.2.2" data-path="comparisons.html"><a href="comparisons.html#信賴區間"><i class="fa fa-check"></i><b>25.2.2</b> 信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="comparisons.html"><a href="comparisons.html#比較兩個百分比"><i class="fa fa-check"></i><b>25.3</b> 比較兩個百分比</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="comparisons.html"><a href="comparisons.html#proportiontest"><i class="fa fa-check"></i><b>25.3.1</b> 兩個百分比差是否爲零的推斷 Risk difference</a></li>
<li class="chapter" data-level="25.3.2" data-path="comparisons.html"><a href="comparisons.html#兩個百分比商是否爲-1-的推斷-relative-riskrisk-ratio"><i class="fa fa-check"></i><b>25.3.2</b> 兩個百分比商是否爲 1 的推斷 relative risk/risk ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>26</b> 前提和數據轉換 Assumptions and transformations</a>
<ul>
<li class="chapter" data-level="26.1" data-path="assumptions.html"><a href="assumptions.html#穩健性"><i class="fa fa-check"></i><b>26.1</b> 穩健性</a></li>
<li class="chapter" data-level="26.2" data-path="assumptions.html"><a href="assumptions.html#正態性"><i class="fa fa-check"></i><b>26.2</b> 正態性</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="assumptions.html"><a href="assumptions.html#normalplot"><i class="fa fa-check"></i><b>26.2.1</b> 正態分佈圖 normal plot</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="assumptions.html"><a href="assumptions.html#總結連續型變量不服從正態分佈時的處理方案"><i class="fa fa-check"></i><b>26.3</b> 總結連續型變量不服從正態分佈時的處理方案</a></li>
<li class="chapter" data-level="26.4" data-path="assumptions.html"><a href="assumptions.html#數學冪轉換-power-transformations"><i class="fa fa-check"></i><b>26.4</b> 數學冪轉換 power transformations</a>
<ul>
<li class="chapter" data-level="26.4.1" data-path="assumptions.html"><a href="assumptions.html#對數轉換-logarithmic-transformation"><i class="fa fa-check"></i><b>26.4.1</b> 對數轉換 logarithmic Transformation</a></li>
<li class="chapter" data-level="26.4.2" data-path="assumptions.html"><a href="assumptions.html#逆轉換信賴區間-back-transformation-of-cis"><i class="fa fa-check"></i><b>26.4.2</b> 逆轉換信賴區間 back-transformation of CIs</a></li>
<li class="chapter" data-level="26.4.3" data-path="assumptions.html"><a href="assumptions.html#對數正態分佈-log-normal-distribution"><i class="fa fa-check"></i><b>26.4.3</b> 對數正態分佈 log-normal distribution</a></li>
<li class="chapter" data-level="26.4.4" data-path="assumptions.html"><a href="assumptions.html#百分比的轉換"><i class="fa fa-check"></i><b>26.4.4</b> 百分比的轉換</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 線性迴歸 Linear Regression</b></span></li>
<li class="chapter" data-level="27" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>27</b> 簡單線性迴歸 Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="27.1" data-path="lm.html"><a href="lm.html#一些背景和術語"><i class="fa fa-check"></i><b>27.1</b> 一些背景和術語</a></li>
<li class="chapter" data-level="27.2" data-path="lm.html"><a href="lm.html#簡單線性迴歸模型-simple-linear-regression-model"><i class="fa fa-check"></i><b>27.2</b> 簡單線性迴歸模型 simple linear regression model</a>
<ul>
<li class="chapter" data-level="27.2.1" data-path="lm.html"><a href="lm.html#數據-a"><i class="fa fa-check"></i><b>27.2.1</b> 數據 A</a></li>
<li class="chapter" data-level="27.2.2" data-path="lm.html"><a href="lm.html#數據-b"><i class="fa fa-check"></i><b>27.2.2</b> 數據 B</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="lm.html"><a href="lm.html#區分因變量和預測變量"><i class="fa fa-check"></i><b>27.3</b> 區分因變量和預測變量</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="lm.html"><a href="lm.html#meanfunction"><i class="fa fa-check"></i><b>27.3.1</b> 均值 (期待值) 公式</a></li>
<li class="chapter" data-level="27.3.2" data-path="lm.html"><a href="lm.html#條件分佈和方差-the-conditional-distribution-and-the-variance-function"><i class="fa fa-check"></i><b>27.3.2</b> 條件分佈和方差 the conditional distribution and the variance function</a></li>
<li class="chapter" data-level="27.3.3" data-path="lm.html"><a href="lm.html#defLM"><i class="fa fa-check"></i><b>27.3.3</b> 定義簡單線性迴歸模型</a></li>
<li class="chapter" data-level="27.3.4" data-path="lm.html"><a href="lm.html#殘差-residuals"><i class="fa fa-check"></i><b>27.3.4</b> 殘差 residuals</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="lm.html"><a href="lm.html#參數的估計-estimation-of-parameters"><i class="fa fa-check"></i><b>27.4</b> 參數的估計 estimation of parameters</a>
<ul>
<li class="chapter" data-level="27.4.1" data-path="lm.html"><a href="lm.html#MLEalphabeta"><i class="fa fa-check"></i><b>27.4.1</b> 普通最小二乘法估計 <span class="math inline">\(\alpha, \beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="lm.html"><a href="lm.html#ResidualVar"><i class="fa fa-check"></i><b>27.5</b> 殘差方差的估計 Estimation of the residual variance <span class="math inline">\((\sigma^2)\)</span></a></li>
<li class="chapter" data-level="27.6" data-path="lm.html"><a href="lm.html#growgam"><i class="fa fa-check"></i><b>27.6</b> R 演示 例 1： 圖 @ref(fig:age-wt) 數據</a></li>
<li class="chapter" data-level="27.7" data-path="lm.html"><a href="lm.html#binarylms"><i class="fa fa-check"></i><b>27.7</b> R 演示 例 2： 表@ref(tab:walk) 數據</a></li>
<li class="chapter" data-level="27.8" data-path="lm.html"><a href="lm.html#exeChol"><i class="fa fa-check"></i><b>27.8</b> LM practical 01</a>
<ul>
<li class="chapter" data-level="27.8.1" data-path="lm.html"><a href="lm.html#兩次測量的膽固醇水平分別用-c_1-c_2-來標記的話考慮這樣的簡單線性迴歸模型c_2alphabeta-c_2-varepsilon我們進行這樣迴歸的前提假設有哪些"><i class="fa fa-check"></i><b>27.8.1</b> 兩次測量的膽固醇水平分別用 <span class="math inline">\(C_1, C_2\)</span> 來標記的話，考慮這樣的簡單線性迴歸模型：<span class="math inline">\(C_2=\alpha+\beta C_2 + \varepsilon\)</span>。我們進行這樣迴歸的前提假設有哪些？</a></li>
<li class="chapter" data-level="27.8.2" data-path="lm.html"><a href="lm.html#計算普通最小二乘法-ols-下截距和斜率的估計值-hatalpha-hatbeta"><i class="fa fa-check"></i><b>27.8.2</b> 計算普通最小二乘法 (OLS) 下，截距和斜率的估計值 <span class="math inline">\(\hat\alpha, \hat\beta\)</span></a></li>
<li class="chapter" data-level="27.8.3" data-path="lm.html"><a href="lm.html#和迴歸模型計算的結果作比較解釋這些估計值的含義"><i class="fa fa-check"></i><b>27.8.3</b> 和迴歸模型計算的結果作比較，解釋這些估計值的含義</a></li>
<li class="chapter" data-level="27.8.4" data-path="lm.html"><a href="lm.html#加上計算的估計值直線-即迴歸直線"><i class="fa fa-check"></i><b>27.8.4</b> 加上計算的估計值直線 (即迴歸直線)</a></li>
<li class="chapter" data-level="27.8.5" data-path="lm.html"><a href="lm.html#diagnosis"><i class="fa fa-check"></i><b>27.8.5</b> 下面的代碼用於模型的假設診斷</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="28" data-path="OLS.html"><a href="OLS.html"><i class="fa fa-check"></i><b>28</b> 最小二乘估計的性質和推斷 Ordinary Least Squares Estimators and Inference</a>
<ul>
<li class="chapter" data-level="28.1" data-path="OLS.html"><a href="OLS.html#ols-估計量的性質"><i class="fa fa-check"></i><b>28.1</b> OLS 估計量的性質</a></li>
<li class="chapter" data-level="28.2" data-path="OLS.html"><a href="OLS.html#beta"><i class="fa fa-check"></i><b>28.2</b> <span class="math inline">\(\hat\beta\)</span> 的性質</a>
<ul>
<li class="chapter" data-level="28.2.1" data-path="OLS.html"><a href="OLS.html#randbeta"><i class="fa fa-check"></i><b>28.2.1</b> <span class="math inline">\(Y\)</span> 對 <span class="math inline">\(X\)</span> 迴歸， 和 <span class="math inline">\(X\)</span> 對 <span class="math inline">\(Y\)</span> 迴歸</a></li>
<li class="chapter" data-level="28.2.2" data-path="OLS.html"><a href="OLS.html#例-1-還是圖-reffigage-wt-數據"><i class="fa fa-check"></i><b>28.2.2</b> 例 1： 還是圖 @ref(fig:age-wt) 數據</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="OLS.html"><a href="OLS.html#截距和迴歸係數的方差協方差"><i class="fa fa-check"></i><b>28.3</b> 截距和迴歸係數的方差，協方差</a>
<ul>
<li class="chapter" data-level="28.3.1" data-path="OLS.html"><a href="OLS.html#centring"><i class="fa fa-check"></i><b>28.3.1</b> 中心化 centring</a></li>
</ul></li>
<li class="chapter" data-level="28.4" data-path="OLS.html"><a href="OLS.html#alpha-beta-的推斷"><i class="fa fa-check"></i><b>28.4</b> <span class="math inline">\(\alpha, \beta\)</span> 的推斷</a>
<ul>
<li class="chapter" data-level="28.4.1" data-path="OLS.html"><a href="OLS.html#對迴歸係數進行假設檢驗"><i class="fa fa-check"></i><b>28.4.1</b> 對迴歸係數進行假設檢驗</a></li>
<li class="chapter" data-level="28.4.2" data-path="OLS.html"><a href="OLS.html#迴歸係數截距的信賴區間"><i class="fa fa-check"></i><b>28.4.2</b> 迴歸係數，截距的信賴區間</a></li>
<li class="chapter" data-level="28.4.3" data-path="OLS.html"><a href="OLS.html#預測值的信賴區間-置信帶---測量迴歸曲線本身的不確定性"><i class="fa fa-check"></i><b>28.4.3</b> 預測值的信賴區間 (置信帶) - 測量迴歸曲線本身的不確定性</a></li>
<li class="chapter" data-level="28.4.4" data-path="OLS.html"><a href="OLS.html#預測帶-reference-range---包含了-95-觀察值的區間"><i class="fa fa-check"></i><b>28.4.4</b> 預測帶 Reference range - 包含了 95% 觀察值的區間</a></li>
</ul></li>
<li class="chapter" data-level="28.5" data-path="OLS.html"><a href="OLS.html#rsquare"><i class="fa fa-check"></i><b>28.5</b> 線性迴歸模型和 Pearson 相關係數</a>
<ul>
<li class="chapter" data-level="28.5.1" data-path="OLS.html"><a href="OLS.html#r2-可以理解爲因變量平方和被模型解釋的比例"><i class="fa fa-check"></i><b>28.5.1</b> <span class="math inline">\(r^2\)</span> 可以理解爲因變量平方和被模型解釋的比例</a></li>
</ul></li>
<li class="chapter" data-level="28.6" data-path="OLS.html"><a href="OLS.html#t-r2-F"><i class="fa fa-check"></i><b>28.6</b> Pearson 相關係數和模型迴歸係數的檢驗統計量 <span class="math inline">\(t\)</span> 之間的關係</a></li>
<li class="chapter" data-level="28.7" data-path="OLS.html"><a href="OLS.html#lm-practical-02"><i class="fa fa-check"></i><b>28.7</b> LM practical 02</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>29</b> 方差分析 Introduction to Analysis of Variance</a>
<ul>
<li class="chapter" data-level="29.1" data-path="ANOVA.html"><a href="ANOVA.html#背景"><i class="fa fa-check"></i><b>29.1</b> 背景</a></li>
<li class="chapter" data-level="29.2" data-path="ANOVA.html"><a href="ANOVA.html#簡單線性迴歸模型的方差分析"><i class="fa fa-check"></i><b>29.2</b> 簡單線性迴歸模型的方差分析</a>
<ul>
<li class="chapter" data-level="29.2.1" data-path="ANOVA.html"><a href="ANOVA.html#兩個模型的參數估計"><i class="fa fa-check"></i><b>29.2.1</b> 兩個模型的參數估計</a></li>
<li class="chapter" data-level="29.2.2" data-path="ANOVA.html"><a href="ANOVA.html#分割零假設模型的殘差平方和"><i class="fa fa-check"></i><b>29.2.2</b> 分割零假設模型的殘差平方和</a></li>
<li class="chapter" data-level="29.2.3" data-path="ANOVA.html"><a href="ANOVA.html#Rsquare"><i class="fa fa-check"></i><b>29.2.3</b> <span class="math inline">\(R^2\)</span> – 我的名字叫<strong>決定係數</strong> coefficient of determination</a></li>
<li class="chapter" data-level="29.2.4" data-path="ANOVA.html"><a href="ANOVA.html#方差分析表格-the-anova-table"><i class="fa fa-check"></i><b>29.2.4</b> 方差分析表格 the ANOVA table</a></li>
<li class="chapter" data-level="29.2.5" data-path="ANOVA.html"><a href="ANOVA.html#用-anova-進行假設檢驗"><i class="fa fa-check"></i><b>29.2.5</b> 用 ANOVA 進行假設檢驗</a></li>
<li class="chapter" data-level="29.2.6" data-path="ANOVA.html"><a href="ANOVA.html#lm-Ftest"><i class="fa fa-check"></i><b>29.2.6</b> 簡單線性迴歸時的 <span class="math inline">\(F\)</span> 檢驗</a></li>
<li class="chapter" data-level="29.2.7" data-path="ANOVA.html"><a href="ANOVA.html#F-t-same"><i class="fa fa-check"></i><b>29.2.7</b> 簡單線性迴歸時 <span class="math inline">\(F\)</span> 檢驗和 <span class="math inline">\(t\)</span> 檢驗的一致性</a></li>
</ul></li>
<li class="chapter" data-level="29.3" data-path="ANOVA.html"><a href="ANOVA.html#分類變量用作預測變量時的-anova"><i class="fa fa-check"></i><b>29.3</b> 分類變量用作預測變量時的 ANOVA</a>
<ul>
<li class="chapter" data-level="29.3.1" data-path="ANOVA.html"><a href="ANOVA.html#一個二分類預測變量"><i class="fa fa-check"></i><b>29.3.1</b> 一個二分類預測變量</a></li>
<li class="chapter" data-level="29.3.2" data-path="ANOVA.html"><a href="ANOVA.html#一個模型兩種表述"><i class="fa fa-check"></i><b>29.3.2</b> 一個模型，兩種表述</a></li>
<li class="chapter" data-level="29.3.3" data-path="ANOVA.html"><a href="ANOVA.html#分組變量的平方和"><i class="fa fa-check"></i><b>29.3.3</b> 分組變量的平方和</a></li>
<li class="chapter" data-level="29.3.4" data-path="ANOVA.html"><a href="ANOVA.html#簡單模型的分組變量大於兩組的情況"><i class="fa fa-check"></i><b>29.3.4</b> 簡單模型的分組變量大於兩組的情況</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="ANOVA.html"><a href="ANOVA.html#lm-practical-03"><i class="fa fa-check"></i><b>29.4</b> LM practical 03</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="multivariable-models.html"><a href="multivariable-models.html"><i class="fa fa-check"></i><b>30</b> 多元模型分析 Multivariable Models</a>
<ul>
<li class="chapter" data-level="30.1" data-path="multivariable-models.html"><a href="multivariable-models.html#兩個預測變量的線性迴歸模型"><i class="fa fa-check"></i><b>30.1</b> 兩個預測變量的線性迴歸模型</a>
<ul>
<li class="chapter" data-level="30.1.1" data-path="multivariable-models.html"><a href="multivariable-models.html#數學標記法和解釋"><i class="fa fa-check"></i><b>30.1.1</b> 數學標記法和解釋</a></li>
<li class="chapter" data-level="30.1.2" data-path="multivariable-models.html"><a href="multivariable-models.html#最小平方和估計-least-squares-estimation"><i class="fa fa-check"></i><b>30.1.2</b> 最小平方和估計 Least Squares Estimation</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="multivariable-models.html"><a href="multivariable-models.html#線性回歸模型中使用分組變量"><i class="fa fa-check"></i><b>30.2</b> 線性回歸模型中使用分組變量</a></li>
<li class="chapter" data-level="30.3" data-path="multivariable-models.html"><a href="multivariable-models.html#協方差分析模型-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>30.3</b> 協方差分析模型 the Analysis of Covariance (ANCOVA) Model</a></li>
<li class="chapter" data-level="30.4" data-path="multivariable-models.html"><a href="multivariable-models.html#偏回歸係數的變化"><i class="fa fa-check"></i><b>30.4</b> 偏回歸係數的變化</a>
<ul>
<li class="chapter" data-level="30.4.1" data-path="multivariable-models.html"><a href="multivariable-models.html#情況1-beta_1-beta_1"><i class="fa fa-check"></i><b>30.4.1</b> 情況1： <span class="math inline">\(\beta_1 &gt; \beta_1^*\)</span></a></li>
<li class="chapter" data-level="30.4.2" data-path="multivariable-models.html"><a href="multivariable-models.html#情況2beta_1beta_1"><i class="fa fa-check"></i><b>30.4.2</b> 情況2：<span class="math inline">\(\beta_1&lt;\beta_1^*\)</span></a></li>
<li class="chapter" data-level="30.4.3" data-path="multivariable-models.html"><a href="multivariable-models.html#情況3-beta_1-beta_1"><i class="fa fa-check"></i><b>30.4.3</b> 情況3： <span class="math inline">\(\beta_1 = \beta_1^*\)</span></a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="multivariable-models.html"><a href="multivariable-models.html#confounding"><i class="fa fa-check"></i><b>30.5</b> 混雜 confounding</a>
<ul>
<li class="chapter" data-level="30.5.1" data-path="multivariable-models.html"><a href="multivariable-models.html#作為媒介-mediation-effect"><i class="fa fa-check"></i><b>30.5.1</b> 作為媒介 mediation effect</a></li>
<li class="chapter" data-level="30.5.2" data-path="multivariable-models.html"><a href="multivariable-models.html#兩個預測變量之間的關係"><i class="fa fa-check"></i><b>30.5.2</b> 兩個預測變量之間的關係</a></li>
<li class="chapter" data-level="30.5.3" data-path="multivariable-models.html"><a href="multivariable-models.html#rct臨床實驗是個特例"><i class="fa fa-check"></i><b>30.5.3</b> RCT臨床實驗是個特例</a></li>
</ul></li>
<li class="chapter" data-level="30.6" data-path="multivariable-models.html"><a href="multivariable-models.html#lm-practical-04"><i class="fa fa-check"></i><b>30.6</b> LM practical 04</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html"><i class="fa fa-check"></i><b>31</b> 多元模型分析：矩陣標記與其意義</a>
<ul>
<li class="chapter" data-level="31.1" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#線性回歸模型的矩陣非矩陣標記法"><i class="fa fa-check"></i><b>31.1</b> 線性回歸模型的矩陣/非矩陣標記法</a>
<ul>
<li class="chapter" data-level="31.1.1" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#模型標記"><i class="fa fa-check"></i><b>31.1.1</b> 模型標記：</a></li>
</ul></li>
<li class="chapter" data-level="31.2" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#解讀參數"><i class="fa fa-check"></i><b>31.2</b> 解讀參數</a>
<ul>
<li class="chapter" data-level="31.2.1" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#最小二乘估計"><i class="fa fa-check"></i><b>31.2.1</b> 最小二乘估計</a></li>
<li class="chapter" data-level="31.2.2" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#因變量的期待值-mathbfhat-y"><i class="fa fa-check"></i><b>31.2.2</b> 因變量的期待值 <span class="math inline">\(\mathbf{\hat Y}\)</span></a></li>
<li class="chapter" data-level="31.2.3" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#殘差"><i class="fa fa-check"></i><b>31.2.3</b> 殘差</a></li>
</ul></li>
<li class="chapter" data-level="31.3" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#方差分析一般化和-f-檢驗"><i class="fa fa-check"></i><b>31.3</b> 方差分析一般化和 <span class="math inline">\(F\)</span> 檢驗</a>
<ul>
<li class="chapter" data-level="31.3.1" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#多元線性迴歸時的決定係數和殘差方差"><i class="fa fa-check"></i><b>31.3.1</b> 多元線性迴歸時的決定係數和殘差方差</a></li>
<li class="chapter" data-level="31.3.2" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#方差分析表格"><i class="fa fa-check"></i><b>31.3.2</b> 方差分析表格</a></li>
<li class="chapter" data-level="31.3.3" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#globalsig"><i class="fa fa-check"></i><b>31.3.3</b> 迴歸方程的顯著性檢驗</a></li>
<li class="chapter" data-level="31.3.4" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#partialF"><i class="fa fa-check"></i><b>31.3.4</b> <span class="math inline">\(\text{partial }F\)</span> 檢驗</a></li>
</ul></li>
<li class="chapter" data-level="31.4" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#添加新變量對迴歸模型的影響"><i class="fa fa-check"></i><b>31.4</b> 添加新變量對迴歸模型的影響</a>
<ul>
<li class="chapter" data-level="31.4.1" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#偏迴歸係數方差的改變"><i class="fa fa-check"></i><b>31.4.1</b> 偏迴歸係數方差的改變</a></li>
<li class="chapter" data-level="31.4.2" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#偏迴歸係數檢驗結果的改變"><i class="fa fa-check"></i><b>31.4.2</b> 偏迴歸係數檢驗結果的改變</a></li>
<li class="chapter" data-level="31.4.3" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#擬合值的改變"><i class="fa fa-check"></i><b>31.4.3</b> 擬合值的改變</a></li>
<li class="chapter" data-level="31.4.4" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#決定係數的改變"><i class="fa fa-check"></i><b>31.4.4</b> 決定係數的改變</a></li>
<li class="chapter" data-level="31.4.5" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#共線性-collinearity"><i class="fa fa-check"></i><b>31.4.5</b> 共線性 collinearity</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#實戰演習"><i class="fa fa-check"></i><b>31.5</b> 實戰演習</a>
<ul>
<li class="chapter" data-level="31.5.1" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#血清維生素-c-濃度的預測變量"><i class="fa fa-check"></i><b>31.5.1</b> 血清維生素 C 濃度的預測變量</a></li>
<li class="chapter" data-level="31.5.2" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#紅細胞容積與血紅蛋白"><i class="fa fa-check"></i><b>31.5.2</b> 紅細胞容積與血紅蛋白</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="matrix-multivariable.html"><a href="matrix-multivariable.html#lm-practical-05"><i class="fa fa-check"></i><b>31.6</b> LM practical 05</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="lm-diag.html"><a href="lm-diag.html"><i class="fa fa-check"></i><b>32</b> 線性迴歸的模型診斷</a>
<ul>
<li class="chapter" data-level="32.1" data-path="lm-diag.html"><a href="lm-diag.html#線性迴歸模型的前提條件"><i class="fa fa-check"></i><b>32.1</b> 線性迴歸模型的前提條件</a></li>
<li class="chapter" data-level="32.2" data-path="lm-diag.html"><a href="lm-diag.html#用圖形來視覺診斷"><i class="fa fa-check"></i><b>32.2</b> 用圖形來視覺診斷</a></li>
<li class="chapter" data-level="32.3" data-path="lm-diag.html"><a href="lm-diag.html#殘差圖"><i class="fa fa-check"></i><b>32.3</b> 殘差圖</a></li>
<li class="chapter" data-level="32.4" data-path="lm-diag.html"><a href="lm-diag.html#殘差正態圖-normal-plot-of-residuals"><i class="fa fa-check"></i><b>32.4</b> 殘差正態圖 normal plot of residuals</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="lm-diag.html"><a href="lm-diag.html#模型診斷實例"><i class="fa fa-check"></i><b>32.4.1</b> 模型診斷實例</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="lm-diag.html"><a href="lm-diag.html#前提條件的統計學檢驗"><i class="fa fa-check"></i><b>32.5</b> 前提條件的統計學檢驗</a>
<ul>
<li class="chapter" data-level="32.5.1" data-path="lm-diag.html"><a href="lm-diag.html#二次方程迴歸法檢驗非線性"><i class="fa fa-check"></i><b>32.5.1</b> 二次方程迴歸法檢驗非線性</a></li>
<li class="chapter" data-level="32.5.2" data-path="lm-diag.html"><a href="lm-diag.html#非線性關係模型"><i class="fa fa-check"></i><b>32.5.2</b> 非線性關係模型</a></li>
</ul></li>
<li class="chapter" data-level="32.6" data-path="lm-diag.html"><a href="lm-diag.html#異常值槓桿值和庫克距離"><i class="fa fa-check"></i><b>32.6</b> 異常值，槓桿值，和庫克距離</a>
<ul>
<li class="chapter" data-level="32.6.1" data-path="lm-diag.html"><a href="lm-diag.html#standardres"><i class="fa fa-check"></i><b>32.6.1</b> 異常值和標準化殘差</a></li>
<li class="chapter" data-level="32.6.2" data-path="lm-diag.html"><a href="lm-diag.html#槓桿值-leverage"><i class="fa fa-check"></i><b>32.6.2</b> 槓桿值 Leverage</a></li>
<li class="chapter" data-level="32.6.3" data-path="lm-diag.html"><a href="lm-diag.html#庫克距離-cooks-distance"><i class="fa fa-check"></i><b>32.6.3</b> 庫克距離 Cook’s Distance</a></li>
</ul></li>
<li class="chapter" data-level="32.7" data-path="lm-diag.html"><a href="lm-diag.html#在統計忍者包裏面對模型診斷作圖"><i class="fa fa-check"></i><b>32.7</b> 在統計忍者包裏面對模型診斷作圖</a></li>
<li class="chapter" data-level="32.8" data-path="lm-diag.html"><a href="lm-diag.html#lm-practical-06"><i class="fa fa-check"></i><b>32.8</b> LM practical 06</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>33</b> 交互作用 Interactions</a>
<ul>
<li class="chapter" data-level="33.1" data-path="interaction.html"><a href="interaction.html#兩個預測變量之間的線性模型交互作用"><i class="fa fa-check"></i><b>33.1</b> 兩個預測變量之間的線性模型交互作用</a>
<ul>
<li class="chapter" data-level="33.1.1" data-path="interaction.html"><a href="interaction.html#交互作用線性模型的一般表達式"><i class="fa fa-check"></i><b>33.1.1</b> 交互作用線性模型的一般表達式</a></li>
<li class="chapter" data-level="33.1.2" data-path="interaction.html"><a href="interaction.html#interaction-cont-bin"><i class="fa fa-check"></i><b>33.1.2</b> 連續型變量和二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="33.1.3" data-path="interaction.html"><a href="interaction.html#兩個二分類變量之間的交互作用"><i class="fa fa-check"></i><b>33.1.3</b> 兩個二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="33.1.4" data-path="interaction.html"><a href="interaction.html#兩個連續變量之間的交互作用"><i class="fa fa-check"></i><b>33.1.4</b> 兩個連續變量之間的交互作用</a></li>
</ul></li>
<li class="chapter" data-level="33.2" data-path="interaction.html"><a href="interaction.html#lm-practical-07"><i class="fa fa-check"></i><b>33.2</b> LM practical 07</a></li>
</ul></li>
<li class="part"><span><b>V 臨床實驗 Clinical Trials</b></span></li>
<li class="chapter" data-level="34" data-path="sample-size.html"><a href="sample-size.html"><i class="fa fa-check"></i><b>34</b> 樣本量計算問題</a>
<ul>
<li class="chapter" data-level="34.1" data-path="sample-size.html"><a href="sample-size.html#背景-1"><i class="fa fa-check"></i><b>34.1</b> 背景</a></li>
<li class="chapter" data-level="34.2" data-path="sample-size.html"><a href="sample-size.html#決定所需樣本量大小的統計學因素"><i class="fa fa-check"></i><b>34.2</b> 決定所需樣本量大小的統計學因素</a></li>
<li class="chapter" data-level="34.3" data-path="sample-size.html"><a href="sample-size.html#第一類和第二類錯誤-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>34.3</b> 第一類和第二類錯誤 Type I and type II errors</a></li>
<li class="chapter" data-level="34.4" data-path="sample-size.html"><a href="sample-size.html#比較兩組之間的百分比-percentages-or-proportions"><i class="fa fa-check"></i><b>34.4</b> 比較兩組之間的百分比 (percentages or proportions)</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="sample-size.html"><a href="sample-size.html#樣本量計算公式-使用顯著水平-5-和檢驗效能-90"><i class="fa fa-check"></i><b>34.4.1</b> 樣本量計算公式 (使用顯著水平 5%, 和檢驗效能 90%)</a></li>
<li class="chapter" data-level="34.4.2" data-path="sample-size.html"><a href="sample-size.html#樣本量計算公式的一般化-不同的顯著水平和檢驗效能條件下"><i class="fa fa-check"></i><b>34.4.2</b> 樣本量計算公式的一般化 (不同的顯著水平和檢驗效能條件下)</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="sample-size.html"><a href="sample-size.html#比較兩組之間的均值"><i class="fa fa-check"></i><b>34.5</b> 比較兩組之間的均值</a>
<ul>
<li class="chapter" data-level="34.5.1" data-path="sample-size.html"><a href="sample-size.html#樣本量計算公式"><i class="fa fa-check"></i><b>34.5.1</b> 樣本量計算公式</a></li>
</ul></li>
<li class="chapter" data-level="34.6" data-path="sample-size.html"><a href="sample-size.html#樣本量計算的調整"><i class="fa fa-check"></i><b>34.6</b> 樣本量計算的調整</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="baseline-adjustment-using-ancova.html"><a href="baseline-adjustment-using-ancova.html"><i class="fa fa-check"></i><b>35</b> Baseline Adjustment using ANCOVA</a></li>
<li class="part"><span><b>VI 穩健統計方法 Robust Statistic Methods</b></span></li>
<li class="chapter" data-level="36" data-path="robust-intro.html"><a href="robust-intro.html"><i class="fa fa-check"></i><b>36</b> 穩健統計方法入門</a></li>
<li class="chapter" data-level="37" data-path="rank-tests.html"><a href="rank-tests.html"><i class="fa fa-check"></i><b>37</b> 基於秩次的非參數檢驗</a>
<ul>
<li class="chapter" data-level="37.1" data-path="rank-tests.html"><a href="rank-tests.html#sign-test"><i class="fa fa-check"></i><b>37.1</b> 符號檢驗 the Sign test</a>
<ul>
<li class="chapter" data-level="37.1.1" data-path="rank-tests.html"><a href="rank-tests.html#符號檢驗的特點"><i class="fa fa-check"></i><b>37.1.1</b> 符號檢驗的特點</a></li>
</ul></li>
<li class="chapter" data-level="37.2" data-path="rank-tests.html"><a href="rank-tests.html#Wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>37.2</b> Wilcoxon 符號秩和檢驗，the Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="37.3" data-path="rank-tests.html"><a href="rank-tests.html#wilcoxon-mann-whitney-wmw-檢驗"><i class="fa fa-check"></i><b>37.3</b> Wilcoxon-Mann-Whitney (WMW) 檢驗</a></li>
<li class="chapter" data-level="37.4" data-path="rank-tests.html"><a href="rank-tests.html#秩相關spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>37.4</b> 秩相關，Spearman’s Rank Correlation Coefficient</a></li>
<li class="chapter" data-level="37.5" data-path="rank-tests.html"><a href="rank-tests.html#基於秩次的非參數檢驗的優缺點"><i class="fa fa-check"></i><b>37.5</b> 基於秩次的非參數檢驗的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="permutation.html"><a href="permutation.html"><i class="fa fa-check"></i><b>38</b> 排列置換法 Permutation procedures</a>
<ul>
<li class="chapter" data-level="38.1" data-path="permutation.html"><a href="permutation.html#背景介紹-1"><i class="fa fa-check"></i><b>38.1</b> 背景介紹</a></li>
<li class="chapter" data-level="38.2" data-path="permutation.html"><a href="permutation.html#直接上實例"><i class="fa fa-check"></i><b>38.2</b> 直接上實例</a></li>
<li class="chapter" data-level="38.3" data-path="permutation.html"><a href="permutation.html#排列置換法三板斧"><i class="fa fa-check"></i><b>38.3</b> 排列置換法三板斧</a>
<ul>
<li class="chapter" data-level="38.3.1" data-path="permutation.html"><a href="permutation.html#該如何選用合適的檢驗統計量-t"><i class="fa fa-check"></i><b>38.3.1</b> 該如何選用合適的檢驗統計量 <span class="math inline">\(T\)</span>？</a></li>
<li class="chapter" data-level="38.3.2" data-path="permutation.html"><a href="permutation.html#可以在排列置換法中對其他變量進行統計學調整-adjustment-嗎"><i class="fa fa-check"></i><b>38.3.2</b> 可以在排列置換法中對其他變量進行統計學調整 (adjustment) 嗎？</a></li>
<li class="chapter" data-level="38.3.3" data-path="permutation.html"><a href="permutation.html#排列置換法基於秩次的非參數檢驗之間的關係"><i class="fa fa-check"></i><b>38.3.3</b> 排列置換法，基於秩次的非參數檢驗之間的關係</a></li>
<li class="chapter" data-level="38.3.4" data-path="permutation.html"><a href="permutation.html#排列置換檢驗法是一種精確檢驗"><i class="fa fa-check"></i><b>38.3.4</b> 排列置換檢驗法，是一種精確檢驗</a></li>
</ul></li>
<li class="chapter" data-level="38.4" data-path="permutation.html"><a href="permutation.html#基於排序置換檢驗法計算信賴區間"><i class="fa fa-check"></i><b>38.4</b> 基於排序置換檢驗法計算信賴區間</a></li>
<li class="chapter" data-level="38.5" data-path="permutation.html"><a href="permutation.html#排序置換法的優缺點"><i class="fa fa-check"></i><b>38.5</b> 排序置換法的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>39</b> 自助重抽法 The bootstrap</a>
<ul>
<li class="chapter" data-level="39.1" data-path="bootstrap.html"><a href="bootstrap.html#定義-1"><i class="fa fa-check"></i><b>39.1</b> 定義</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="the-sandwich-estimator.html"><a href="the-sandwich-estimator.html"><i class="fa fa-check"></i><b>40</b> The sandwich estimator</a></li>
<li class="part"><span><b>VII 貝葉斯統計 Introduction to Bayesian Statistics</b></span></li>
<li class="chapter" data-level="41" data-path="intro-Bayes.html"><a href="intro-Bayes.html"><i class="fa fa-check"></i><b>41</b> 貝葉斯統計入門</a>
<ul>
<li class="chapter" data-level="41.1" data-path="intro-Bayes.html"><a href="intro-Bayes.html#概率論推斷的複習"><i class="fa fa-check"></i><b>41.1</b> 概率論推斷的複習</a></li>
<li class="chapter" data-level="41.2" data-path="intro-Bayes.html"><a href="intro-Bayes.html#貝葉斯概率推理逆概率-bayesian-reasoninginverse-probability"><i class="fa fa-check"></i><b>41.2</b> 貝葉斯概率推理/逆概率 Bayesian reasoning/inverse probability</a>
<ul>
<li class="chapter" data-level="41.2.1" data-path="intro-Bayes.html"><a href="intro-Bayes.html#演繹推理-deductive-reasoning-和-三段論-weak-syllogisms"><i class="fa fa-check"></i><b>41.2.1</b> 演繹推理 deductive reasoning 和 三段論 weak syllogisms</a></li>
<li class="chapter" data-level="41.2.2" data-path="intro-Bayes.html"><a href="intro-Bayes.html#如何給可能性定量-quantifying-plausibility"><i class="fa fa-check"></i><b>41.2.2</b> 如何給可能性定量 Quantifying plausibility</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="intro-Bayes.html"><a href="intro-Bayes.html#貝葉斯推理的統計學實現"><i class="fa fa-check"></i><b>41.3</b> 貝葉斯推理的統計學實現</a>
<ul>
<li class="chapter" data-level="41.3.1" data-path="intro-Bayes.html"><a href="intro-Bayes.html#醫學診斷測試-diagnostic-testing"><i class="fa fa-check"></i><b>41.3.1</b> 醫學診斷測試 diagnostic testing</a></li>
<li class="chapter" data-level="41.3.2" data-path="intro-Bayes.html"><a href="intro-Bayes.html#hiv-檢查時的應用"><i class="fa fa-check"></i><b>41.3.2</b> HIV 檢查時的應用</a></li>
<li class="chapter" data-level="41.3.3" data-path="intro-Bayes.html"><a href="intro-Bayes.html#離散概率分佈實例遺傳學分析"><i class="fa fa-check"></i><b>41.3.3</b> 離散概率分佈實例：遺傳學分析</a></li>
<li class="chapter" data-level="41.3.4" data-path="intro-Bayes.html"><a href="intro-Bayes.html#說點小歷史"><i class="fa fa-check"></i><b>41.3.4</b> 說點小歷史</a></li>
</ul></li>
<li class="chapter" data-level="41.4" data-path="intro-Bayes.html"><a href="intro-Bayes.html#practical-intro-to-bayes-01"><i class="fa fa-check"></i><b>41.4</b> Practical Intro-to-Bayes 01</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="single-para-model.html"><a href="single-para-model.html"><i class="fa fa-check"></i><b>42</b> 貝葉斯定理的應用：單一參數模型 Single-parameter models</a>
<ul>
<li class="chapter" data-level="42.1" data-path="single-para-model.html"><a href="single-para-model.html#從二進制數據中估計概率-estimating-a-probability-from-binomial-data"><i class="fa fa-check"></i><b>42.1</b> 從二進制數據中估計概率 Estimating a probability from binomial data</a>
<ul>
<li class="chapter" data-level="42.1.1" data-path="single-para-model.html"><a href="single-para-model.html#事後概率分佈是數據和先驗概率分佈之間的妥協"><i class="fa fa-check"></i><b>42.1.1</b> 事後概率分佈是數據和先驗概率分佈之間的妥協</a></li>
<li class="chapter" data-level="42.1.2" data-path="single-para-model.html"><a href="single-para-model.html#不同先驗概率分佈對事後概率分佈估計的影響"><i class="fa fa-check"></i><b>42.1.2</b> 不同先驗概率分佈對事後概率分佈估計的影響</a></li>
<li class="chapter" data-level="42.1.3" data-path="single-para-model.html"><a href="single-para-model.html#從已知的事後概率分佈中採樣對採集的事後樣本數據轉換"><i class="fa fa-check"></i><b>42.1.3</b> 從已知的事後概率分佈中採樣，對採集的事後樣本數據轉換</a></li>
<li class="chapter" data-level="42.1.4" data-path="single-para-model.html"><a href="single-para-model.html#使用非共軛先驗概率計算事後概率分佈"><i class="fa fa-check"></i><b>42.1.4</b> 使用非共軛先驗概率計算事後概率分佈</a></li>
</ul></li>
<li class="chapter" data-level="42.2" data-path="single-para-model.html"><a href="single-para-model.html#貝葉斯理論下的事後二項分佈概率密度方程-notation-for-probability-density-functions-in-binomial-data"><i class="fa fa-check"></i><b>42.2</b> 貝葉斯理論下的事後二項分佈概率密度方程 notation for probability density functions in binomial data</a></li>
<li class="chapter" data-level="42.3" data-path="single-para-model.html"><a href="single-para-model.html#theta-的先驗概率"><i class="fa fa-check"></i><b>42.3</b> <span class="math inline">\(\theta\)</span> 的先驗概率</a>
<ul>
<li class="chapter" data-level="42.3.1" data-path="single-para-model.html"><a href="single-para-model.html#beta-distribution-intro"><i class="fa fa-check"></i><b>42.3.1</b> beta 分佈 the beta distribution</a></li>
<li class="chapter" data-level="42.3.2" data-path="single-para-model.html"><a href="single-para-model.html#conjugate"><i class="fa fa-check"></i><b>42.3.2</b> 二項分佈數據事後概率分佈的一般化：共軛性</a></li>
</ul></li>
<li class="chapter" data-level="42.4" data-path="single-para-model.html"><a href="single-para-model.html#附贈加量不加價"><i class="fa fa-check"></i><b>42.4</b> 附贈–加量不加價</a></li>
<li class="chapter" data-level="42.5" data-path="single-para-model.html"><a href="single-para-model.html#practical-intro-to-bayes-02"><i class="fa fa-check"></i><b>42.5</b> Practical Intro-to-Bayes 02</a>
<ul>
<li class="chapter" data-level="42.5.1" data-path="single-para-model.html"><a href="single-para-model.html#q1-4"><i class="fa fa-check"></i><b>42.5.1</b> Q1</a></li>
<li class="chapter" data-level="42.5.2" data-path="single-para-model.html"><a href="single-para-model.html#q2-3"><i class="fa fa-check"></i><b>42.5.2</b> Q2</a></li>
<li class="chapter" data-level="42.5.3" data-path="single-para-model.html"><a href="single-para-model.html#q3-2"><i class="fa fa-check"></i><b>42.5.3</b> Q3</a></li>
<li class="chapter" data-level="42.5.4" data-path="single-para-model.html"><a href="single-para-model.html#q4"><i class="fa fa-check"></i><b>42.5.4</b> Q4</a></li>
<li class="chapter" data-level="42.5.5" data-path="single-para-model.html"><a href="single-para-model.html#q5"><i class="fa fa-check"></i><b>42.5.5</b> Q5</a></li>
<li class="chapter" data-level="42.5.6" data-path="single-para-model.html"><a href="single-para-model.html#q6"><i class="fa fa-check"></i><b>42.5.6</b> Q6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="43" data-path="normal-distr.html"><a href="normal-distr.html"><i class="fa fa-check"></i><b>43</b> 貝葉斯理論在正態分布數據中的應用 Normal distribution applying Bayes’ Theorem</a>
<ul>
<li class="chapter" data-level="43.1" data-path="normal-distr.html"><a href="normal-distr.html#事後概率的總結方法"><i class="fa fa-check"></i><b>43.1</b> 事後概率的總結方法</a></li>
<li class="chapter" data-level="43.2" data-path="normal-distr.html"><a href="normal-distr.html#貝葉斯統計推斷中的正態分布"><i class="fa fa-check"></i><b>43.2</b> 貝葉斯統計推斷中的正態分布</a>
<ul>
<li class="chapter" data-level="43.2.1" data-path="normal-distr.html"><a href="normal-distr.html#n-independent-identically-distributed-observations"><i class="fa fa-check"></i><b>43.2.1</b> <span class="math inline">\(n\)</span> independent identically distributed observations</a></li>
</ul></li>
<li class="chapter" data-level="43.3" data-path="normal-distr.html"><a href="normal-distr.html#事後預測分佈-posterior-predictive-distribution"><i class="fa fa-check"></i><b>43.3</b> 事後預測分佈 Posterior predictive distribution</a></li>
</ul></li>
<li class="chapter" data-level="44" data-path="-other-standard-single-parameter-models.html"><a href="-other-standard-single-parameter-models.html"><i class="fa fa-check"></i><b>44</b> 其他典型的單一參數模型 Other standard single-parameter models</a>
<ul>
<li class="chapter" data-level="44.1" data-path="-other-standard-single-parameter-models.html"><a href="-other-standard-single-parameter-models.html#unknownvarBayes"><i class="fa fa-check"></i><b>44.1</b> 正（常）態分佈僅均值已知（方差未知） Normal distribution with known mean but unknown variance</a></li>
<li class="chapter" data-level="44.2" data-path="-other-standard-single-parameter-models.html"><a href="-other-standard-single-parameter-models.html#泊松分佈模型的貝葉斯思路-poisson-distribution-model-under-bayesian-framework"><i class="fa fa-check"></i><b>44.2</b> 泊松分佈模型的貝葉斯思路 Poisson distribution model under Bayesian framework</a></li>
<li class="chapter" data-level="44.3" data-path="-other-standard-single-parameter-models.html"><a href="-other-standard-single-parameter-models.html#泊松模型的其他表達形式-poisson-model-parameterized-in-terms-of-rate-and-exposure"><i class="fa fa-check"></i><b>44.3</b> 泊松模型的其他表達形式 poisson model parameterized in terms of rate and exposure</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html"><i class="fa fa-check"></i><b>45</b> 多參數模型 Introduction to multiparameter models</a>
<ul>
<li class="chapter" data-level="45.1" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#把不需要的噪音參數平均出去-averaging-over-nuisance-parameters"><i class="fa fa-check"></i><b>45.1</b> 把不需要的噪音參數平均出去 Averaging over ‘nuisance parameters’</a></li>
<li class="chapter" data-level="45.2" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#未知均值也未知方差的正常態分佈數據-normal-data-with-unknown-mean-and-variance"><i class="fa fa-check"></i><b>45.2</b> 未知均值也未知方差的正（常）態分佈數據 normal data with unknown mean and variance</a>
<ul>
<li class="chapter" data-level="45.2.1" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#無信息先驗概率分佈-noninformative-prior-distribution"><i class="fa fa-check"></i><b>45.2.1</b> 無信息先驗概率分佈 noninformative prior distribution</a></li>
<li class="chapter" data-level="45.2.2" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#均值的事後邊際概率分佈-marginal-posterior-distribution-of-mu"><i class="fa fa-check"></i><b>45.2.2</b> 均值的事後邊際概率分佈 marginal posterior distribution of <span class="math inline">\(\mu\)</span></a></li>
</ul></li>
<li class="chapter" data-level="45.3" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#r-演示-正常態數據但均值方差均未知"><i class="fa fa-check"></i><b>45.3</b> R 演示 正常態數據但均值方差均未知</a>
<ul>
<li class="chapter" data-level="45.3.1" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#繪製聯合事後密度分佈及均值和方差各自的邊際分佈-visualise-the-joint-and-marginal-densities"><i class="fa fa-check"></i><b>45.3.1</b> 繪製聯合事後密度分佈及均值和方差各自的邊際分佈 visualise the joint and marginal densities</a></li>
<li class="chapter" data-level="45.3.2" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#單獨繪製邊際分佈的每一個部分"><i class="fa fa-check"></i><b>45.3.2</b> 單獨繪製邊際分佈的每一個部分</a></li>
<li class="chapter" data-level="45.3.3" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#繪製事後均值的概率密度分佈"><i class="fa fa-check"></i><b>45.3.3</b> 繪製事後均值的概率密度分佈</a></li>
</ul></li>
<li class="chapter" data-level="45.4" data-path="-introduction-to-multiparameter-models.html"><a href="-introduction-to-multiparameter-models.html#r-演示-分析二進制數據-bda3-p.74"><i class="fa fa-check"></i><b>45.4</b> R 演示 分析二進制數據 (BDA3 P.74)</a></li>
</ul></li>
<li class="chapter" data-level="46" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><i class="fa fa-check"></i><b>46</b> 簡單線型回歸模型 - 地心說模型 Linear regression is the geocentric model of applied statistics</a>
<ul>
<li class="chapter" data-level="46.1" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html#為什麼正常態分佈是正常的-why-normal-distribution-is-normal"><i class="fa fa-check"></i><b>46.1</b> 為什麼正（常）態分佈是正常的 why normal distribution is normal?</a></li>
<li class="chapter" data-level="46.2" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html#身高的高斯模型-gaussian-model-of-height"><i class="fa fa-check"></i><b>46.2</b> 身高的高斯模型 Gaussian model of height</a>
<ul>
<li class="chapter" data-level="46.2.1" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html#小方格估計法近似事後概率分佈"><i class="fa fa-check"></i><b>46.2.1</b> 小方格估計法近似事後概率分佈</a></li>
<li class="chapter" data-level="46.2.2" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html#從計算獲得的事後概率分佈中採樣"><i class="fa fa-check"></i><b>46.2.2</b> 從計算獲得的事後概率分佈中採樣</a></li>
<li class="chapter" data-level="46.2.3" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html#使用二次方程近似法"><i class="fa fa-check"></i><b>46.2.3</b> 使用二次方程近似法</a></li>
<li class="chapter" data-level="46.2.4" data-path="-linear-regression-is-the-geocentric-model-of-applied-statistics.html"><a href="-linear-regression-is-the-geocentric-model-of-applied-statistics.html#關於-beta-的先驗概率-priors"><i class="fa fa-check"></i><b>46.2.4</b> 關於 <span class="math inline">\(\beta\)</span> 的先驗概率 Priors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="47" data-path="-curves-and-lines.html"><a href="-curves-and-lines.html"><i class="fa fa-check"></i><b>47</b> 直線和曲線 curves and lines</a>
<ul>
<li class="chapter" data-level="47.1" data-path="-curves-and-lines.html"><a href="-curves-and-lines.html#多項式回歸模型"><i class="fa fa-check"></i><b>47.1</b> 多項式回歸模型</a></li>
<li class="chapter" data-level="47.2" data-path="-curves-and-lines.html"><a href="-curves-and-lines.html#平滑曲線-splines"><i class="fa fa-check"></i><b>47.2</b> 平滑曲線 Splines</a></li>
</ul></li>
<li class="chapter" data-level="48" data-path="-many-more-variables.html"><a href="-many-more-variables.html"><i class="fa fa-check"></i><b>48</b> 多重線性回歸模型 many more variables</a>
<ul>
<li class="chapter" data-level="48.1" data-path="-many-more-variables.html"><a href="-many-more-variables.html#虛假的相關性"><i class="fa fa-check"></i><b>48.1</b> 虛假的相關性</a></li>
<li class="chapter" data-level="48.2" data-path="-many-more-variables.html"><a href="-many-more-variables.html#繪製輔助我們理解的有向無環圖"><i class="fa fa-check"></i><b>48.2</b> 繪製輔助我們理解的有向無環圖</a></li>
<li class="chapter" data-level="48.3" data-path="-many-more-variables.html"><a href="-many-more-variables.html#多重線性回歸模型的表達"><i class="fa fa-check"></i><b>48.3</b> 多重線性回歸模型的表達</a>
<ul>
<li class="chapter" data-level="48.3.1" data-path="-many-more-variables.html"><a href="-many-more-variables.html#預測變量殘差圖-predictor-residual-plots"><i class="fa fa-check"></i><b>48.3.1</b> 預測變量殘差圖 predictor residual plots</a></li>
<li class="chapter" data-level="48.3.2" data-path="-many-more-variables.html"><a href="-many-more-variables.html#事後分佈預測圖-posterior-prediction-plots"><i class="fa fa-check"></i><b>48.3.2</b> 事後分佈預測圖 posterior prediction plots</a></li>
<li class="chapter" data-level="48.3.3" data-path="-many-more-variables.html"><a href="-many-more-variables.html#反現實圖-counterfactual-plots"><i class="fa fa-check"></i><b>48.3.3</b> 反現實圖 counterfactual plots</a></li>
</ul></li>
<li class="chapter" data-level="48.4" data-path="-many-more-variables.html"><a href="-many-more-variables.html#被掩蓋起來的關係"><i class="fa fa-check"></i><b>48.4</b> 被掩蓋起來的關係</a></li>
<li class="chapter" data-level="48.5" data-path="-many-more-variables.html"><a href="-many-more-variables.html#分類型變量-categorical-variables"><i class="fa fa-check"></i><b>48.5</b> 分類型變量 categorical variables</a>
<ul>
<li class="chapter" data-level="48.5.1" data-path="-many-more-variables.html"><a href="-many-more-variables.html#二進制型變量"><i class="fa fa-check"></i><b>48.5.1</b> 二進制型變量</a></li>
<li class="chapter" data-level="48.5.2" data-path="-many-more-variables.html"><a href="-many-more-variables.html#多於兩個分類的分類變量"><i class="fa fa-check"></i><b>48.5.2</b> 多於兩個分類的分類變量</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="49" data-path="-dag-causal-terror.html"><a href="-dag-causal-terror.html"><i class="fa fa-check"></i><b>49</b> 有向無環圖 DAG &amp; 可怕的因果 Causal Terror</a>
<ul>
<li class="chapter" data-level="49.1" data-path="-dag-causal-terror.html"><a href="-dag-causal-terror.html#多重共線性問題-multicollinearity"><i class="fa fa-check"></i><b>49.1</b> 多重共線性問題 multicollinearity</a>
<ul>
<li class="chapter" data-level="49.1.1" data-path="-dag-causal-terror.html"><a href="-dag-causal-terror.html#哺乳動物奶質量數據中的共線性"><i class="fa fa-check"></i><b>49.1.1</b> 哺乳動物奶質量數據中的共線性</a></li>
</ul></li>
<li class="chapter" data-level="49.2" data-path="-dag-causal-terror.html"><a href="-dag-causal-terror.html#治療後偏倚-post-treatment-bias"><i class="fa fa-check"></i><b>49.2</b> 治療後偏倚 post-treatment bias</a>
<ul>
<li class="chapter" data-level="49.2.1" data-path="-dag-causal-terror.html"><a href="-dag-causal-terror.html#設定模型"><i class="fa fa-check"></i><b>49.2.1</b> 設定模型</a></li>
</ul></li>
<li class="chapter" data-level="49.3" data-path="-dag-causal-terror.html"><a href="-dag-causal-terror.html#對撞因子偏倚-collider-bias"><i class="fa fa-check"></i><b>49.3</b> 對撞因子偏倚 collider bias</a></li>
</ul></li>
<li class="part"><span><b>VIII 廣義線性迴歸模型 Generalised Linear Regression</b></span></li>
<li class="chapter" data-level="50" data-path="revision.html"><a href="revision.html"><i class="fa fa-check"></i><b>50</b> 重要概念複習</a>
<ul>
<li class="chapter" data-level="50.1" data-path="revision.html"><a href="revision.html#概率論學派統計推斷要點複習"><i class="fa fa-check"></i><b>50.1</b> 概率論學派統計推斷要點複習</a></li>
<li class="chapter" data-level="50.2" data-path="revision.html"><a href="revision.html#似然"><i class="fa fa-check"></i><b>50.2</b> 似然</a></li>
<li class="chapter" data-level="50.3" data-path="revision.html"><a href="revision.html#極大似然估計"><i class="fa fa-check"></i><b>50.3</b> 極大似然估計</a></li>
<li class="chapter" data-level="50.4" data-path="revision.html"><a href="revision.html#關於假設檢驗的複習"><i class="fa fa-check"></i><b>50.4</b> 關於假設檢驗的複習</a>
<ul>
<li class="chapter" data-level="50.4.1" data-path="revision.html"><a href="revision.html#子集似然函數"><i class="fa fa-check"></i><b>50.4.1</b> 子集似然函數</a></li>
</ul></li>
<li class="chapter" data-level="50.5" data-path="revision.html"><a href="revision.html#線性迴歸複習"><i class="fa fa-check"></i><b>50.5</b> 線性迴歸複習</a>
<ul>
<li class="chapter" data-level="50.5.1" data-path="revision.html"><a href="revision.html#簡單線性迴歸"><i class="fa fa-check"></i><b>50.5.1</b> 簡單線性迴歸</a></li>
<li class="chapter" data-level="50.5.2" data-path="revision.html"><a href="revision.html#多元線性迴歸"><i class="fa fa-check"></i><b>50.5.2</b> 多元線性迴歸</a></li>
<li class="chapter" data-level="50.5.3" data-path="revision.html"><a href="revision.html#score-equations"><i class="fa fa-check"></i><b>50.5.3</b> 簡單線性迴歸的統計推斷</a></li>
</ul></li>
<li class="chapter" data-level="50.6" data-path="revision.html"><a href="revision.html#glm-practical-01"><i class="fa fa-check"></i><b>50.6</b> GLM-Practical 01</a>
<ul>
<li class="chapter" data-level="50.6.1" data-path="revision.html"><a href="revision.html#建立似然方程"><i class="fa fa-check"></i><b>50.6.1</b> 建立似然方程</a></li>
<li class="chapter" data-level="50.6.2" data-path="revision.html"><a href="revision.html#建立對數似然方程"><i class="fa fa-check"></i><b>50.6.2</b> 建立對數似然方程</a></li>
<li class="chapter" data-level="50.6.3" data-path="revision.html"><a href="revision.html#線性回歸模型"><i class="fa fa-check"></i><b>50.6.3</b> 線性回歸模型</a></li>
<li class="chapter" data-level="50.6.4" data-path="revision.html"><a href="revision.html#似然比檢驗wald-檢驗score-檢驗"><i class="fa fa-check"></i><b>50.6.4</b> 似然比檢驗，Wald 檢驗，Score 檢驗</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="51" data-path="intro-GLM.html"><a href="intro-GLM.html"><i class="fa fa-check"></i><b>51</b> 廣義線性迴歸入門</a>
<ul>
<li class="chapter" data-level="51.1" data-path="intro-GLM.html"><a href="intro-GLM.html#指數分佈家族"><i class="fa fa-check"></i><b>51.1</b> 指數分佈家族</a>
<ul>
<li class="chapter" data-level="51.1.1" data-path="intro-GLM.html"><a href="intro-GLM.html#泊松分佈和二項分佈的指數分佈家族屬性"><i class="fa fa-check"></i><b>51.1.1</b> 泊松分佈和二項分佈的指數分佈家族屬性</a></li>
<li class="chapter" data-level="51.1.2" data-path="intro-GLM.html"><a href="intro-GLM.html#exercise.-exponential-distribution"><i class="fa fa-check"></i><b>51.1.2</b> Exercise. Exponential distribution</a></li>
</ul></li>
<li class="chapter" data-level="51.2" data-path="intro-GLM.html"><a href="intro-GLM.html#defineaGLM"><i class="fa fa-check"></i><b>51.2</b> 廣義線性迴歸模型之定義</a></li>
<li class="chapter" data-level="51.3" data-path="intro-GLM.html"><a href="intro-GLM.html#注意"><i class="fa fa-check"></i><b>51.3</b> 注意</a></li>
<li class="chapter" data-level="51.4" data-path="intro-GLM.html"><a href="intro-GLM.html#如何在-r-裏擬合-glm"><i class="fa fa-check"></i><b>51.4</b> 如何在 R 裏擬合 “GLM”</a>
<ul>
<li class="chapter" data-level="51.4.1" data-path="intro-GLM.html"><a href="intro-GLM.html#margins-命令"><i class="fa fa-check"></i><b>51.4.1</b> <code>margins</code> 命令</a></li>
<li class="chapter" data-level="51.4.2" data-path="intro-GLM.html"><a href="intro-GLM.html#ggplot2geom_smoothmethod-loess-命令"><i class="fa fa-check"></i><b>51.4.2</b> <code>ggplot2::geom_smooth(method = "loess")</code> 命令</a></li>
</ul></li>
<li class="chapter" data-level="51.5" data-path="intro-GLM.html"><a href="intro-GLM.html#glm-practical-02"><i class="fa fa-check"></i><b>51.5</b> GLM-Practical 02</a>
<ul>
<li class="chapter" data-level="51.5.1" data-path="intro-GLM.html"><a href="intro-GLM.html#思考本章中指數分布家族的參數設置假如有一個觀測值-y-來自指數家族試求證"><i class="fa fa-check"></i><b>51.5.1</b> 思考本章中指數分布家族的參數設置。假如，有一個觀測值 <span class="math inline">\(y\)</span> 來自指數家族。試求證:</a></li>
<li class="chapter" data-level="51.5.2" data-path="intro-GLM.html"><a href="intro-GLM.html#r-練習"><i class="fa fa-check"></i><b>51.5.2</b> R 練習</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="52" data-path="logistic.html"><a href="logistic.html"><i class="fa fa-check"></i><b>52</b> 二項分佈數據的廣義線性迴歸模型 logistic regression model</a>
<ul>
<li class="chapter" data-level="52.1" data-path="logistic.html"><a href="logistic.html#彙總後個人-grouped-individual-的二項分佈數據"><i class="fa fa-check"></i><b>52.1</b> 彙總後/個人 (grouped / individual) 的二項分佈數據</a></li>
<li class="chapter" data-level="52.2" data-path="logistic.html"><a href="logistic.html#二項分佈數據的廣義線性迴歸模型"><i class="fa fa-check"></i><b>52.2</b> 二項分佈數據的廣義線性迴歸模型</a></li>
<li class="chapter" data-level="52.3" data-path="logistic.html"><a href="logistic.html#logit-or-log"><i class="fa fa-check"></i><b>52.3</b> 注</a>
<ul>
<li class="chapter" data-level="52.3.1" data-path="logistic.html"><a href="logistic.html#exercise.-link-functions."><i class="fa fa-check"></i><b>52.3.1</b> Exercise. Link functions.</a></li>
</ul></li>
<li class="chapter" data-level="52.4" data-path="logistic.html"><a href="logistic.html#邏輯迴歸模型迴歸係數的實際意義"><i class="fa fa-check"></i><b>52.4</b> 邏輯迴歸模型迴歸係數的實際意義</a></li>
<li class="chapter" data-level="52.5" data-path="logistic.html"><a href="logistic.html#BSEinfection"><i class="fa fa-check"></i><b>52.5</b> 邏輯迴歸實際案例</a>
<ul>
<li class="chapter" data-level="52.5.1" data-path="logistic.html"><a href="logistic.html#分析目的"><i class="fa fa-check"></i><b>52.5.1</b> 分析目的</a></li>
<li class="chapter" data-level="52.5.2" data-path="logistic.html"><a href="logistic.html#模型-1-飼料-羣"><i class="fa fa-check"></i><b>52.5.2</b> 模型 1 飼料 + 羣</a></li>
<li class="chapter" data-level="52.5.3" data-path="logistic.html"><a href="logistic.html#模型-2-增加交互作用項-飼料-times-羣"><i class="fa fa-check"></i><b>52.5.3</b> 模型 2 增加交互作用項 飼料 <span class="math inline">\(\times\)</span> 羣</a></li>
</ul></li>
<li class="chapter" data-level="52.6" data-path="logistic.html"><a href="logistic.html#glm-practical-03"><i class="fa fa-check"></i><b>52.6</b> GLM-Practical 03</a>
<ul>
<li class="chapter" data-level="52.6.1" data-path="logistic.html"><a href="logistic.html#昆蟲的死亡率"><i class="fa fa-check"></i><b>52.6.1</b> 昆蟲的死亡率</a></li>
<li class="chapter" data-level="52.6.2" data-path="logistic.html"><a href="logistic.html#哮喘門診數據"><i class="fa fa-check"></i><b>52.6.2</b> 哮喘門診數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="53" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>53</b> 模型比較和擬合優度</a>
<ul>
<li class="chapter" data-level="53.1" data-path="model-comparison.html"><a href="model-comparison.html#嵌套式模型的比較-nested-models"><i class="fa fa-check"></i><b>53.1</b> 嵌套式模型的比較 nested models</a></li>
<li class="chapter" data-level="53.2" data-path="model-comparison.html"><a href="model-comparison.html#嵌套式模型比較實例"><i class="fa fa-check"></i><b>53.2</b> 嵌套式模型比較實例</a></li>
<li class="chapter" data-level="53.3" data-path="model-comparison.html"><a href="model-comparison.html#飽和模型模型的偏差擬合優度"><i class="fa fa-check"></i><b>53.3</b> 飽和模型，模型的偏差，擬合優度</a>
<ul>
<li class="chapter" data-level="53.3.1" data-path="model-comparison.html"><a href="model-comparison.html#飽和模型-saturated-model"><i class="fa fa-check"></i><b>53.3.1</b> 飽和模型 saturated model</a></li>
<li class="chapter" data-level="53.3.2" data-path="model-comparison.html"><a href="model-comparison.html#deviance"><i class="fa fa-check"></i><b>53.3.2</b> 模型偏差 deviance</a></li>
<li class="chapter" data-level="53.3.3" data-path="model-comparison.html"><a href="model-comparison.html#彙總型二項分佈數據-aggregatedgrouped-binary-data"><i class="fa fa-check"></i><b>53.3.3</b> 彙總型二項分佈數據 aggregated/grouped binary data</a></li>
</ul></li>
<li class="chapter" data-level="53.4" data-path="model-comparison.html"><a href="model-comparison.html#gof"><i class="fa fa-check"></i><b>53.4</b> 個人數據擬合模型的優度檢驗</a></li>
<li class="chapter" data-level="53.5" data-path="model-comparison.html"><a href="model-comparison.html#glm-practical-04"><i class="fa fa-check"></i><b>53.5</b> GLM Practical 04</a>
<ul>
<li class="chapter" data-level="53.5.1" data-path="model-comparison.html"><a href="model-comparison.html#回到之前的昆蟲數據嘗試評價該模型的擬合優度"><i class="fa fa-check"></i><b>53.5.1</b> 回到之前的昆蟲數據，嘗試評價該模型的擬合優度。</a></li>
<li class="chapter" data-level="53.5.2" data-path="model-comparison.html"><a href="model-comparison.html#低出生體重數據"><i class="fa fa-check"></i><b>53.5.2</b> 低出生體重數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="54" data-path="count-outcomes.html"><a href="count-outcomes.html"><i class="fa fa-check"></i><b>54</b> 計數型因變量 Count outcomes</a>
<ul>
<li class="chapter" data-level="54.1" data-path="count-outcomes.html"><a href="count-outcomes.html#泊松-glm"><i class="fa fa-check"></i><b>54.1</b> 泊松 GLM</a></li>
<li class="chapter" data-level="54.2" data-path="count-outcomes.html"><a href="count-outcomes.html#泊松迴歸實例"><i class="fa fa-check"></i><b>54.2</b> 泊松迴歸實例</a></li>
<li class="chapter" data-level="54.3" data-path="count-outcomes.html"><a href="count-outcomes.html#過度離散-overdispersion"><i class="fa fa-check"></i><b>54.3</b> 過度離散 overdispersion</a>
<ul>
<li class="chapter" data-level="54.3.1" data-path="count-outcomes.html"><a href="count-outcomes.html#過度離散怎麼查"><i class="fa fa-check"></i><b>54.3.1</b> 過度離散怎麼查？</a></li>
<li class="chapter" data-level="54.3.2" data-path="count-outcomes.html"><a href="count-outcomes.html#負二項式分佈模型-negative-binomial-model"><i class="fa fa-check"></i><b>54.3.2</b> 負二項式分佈模型 negative binomial model</a></li>
</ul></li>
<li class="chapter" data-level="54.4" data-path="count-outcomes.html"><a href="count-outcomes.html#glm-practical-05"><i class="fa fa-check"></i><b>54.4</b> GLM Practical 05</a></li>
</ul></li>
<li class="chapter" data-level="55" data-path="GLM-rates.html"><a href="GLM-rates.html"><i class="fa fa-check"></i><b>55</b> 率的廣義線性迴歸 Poisson GLM for rates</a>
<ul>
<li class="chapter" data-level="55.1" data-path="GLM-rates.html"><a href="GLM-rates.html#醫學中的率"><i class="fa fa-check"></i><b>55.1</b> 醫學中的率</a></li>
<li class="chapter" data-level="55.2" data-path="GLM-rates.html"><a href="GLM-rates.html#泊松過程"><i class="fa fa-check"></i><b>55.2</b> 泊松過程</a></li>
<li class="chapter" data-level="55.3" data-path="GLM-rates.html"><a href="GLM-rates.html#率的模型"><i class="fa fa-check"></i><b>55.3</b> 率的模型</a></li>
<li class="chapter" data-level="55.4" data-path="GLM-rates.html"><a href="GLM-rates.html#率的-glm"><i class="fa fa-check"></i><b>55.4</b> 率的 GLM</a></li>
<li class="chapter" data-level="55.5" data-path="GLM-rates.html"><a href="GLM-rates.html#分析實例-example-british-doctors-study"><i class="fa fa-check"></i><b>55.5</b> 分析實例 Example: British doctors study</a>
<ul>
<li class="chapter" data-level="55.5.1" data-path="GLM-rates.html"><a href="GLM-rates.html#模型-1-吸菸"><i class="fa fa-check"></i><b>55.5.1</b> 模型 1: 吸菸</a></li>
<li class="chapter" data-level="55.5.2" data-path="GLM-rates.html"><a href="GLM-rates.html#模型-2-吸菸-年齡"><i class="fa fa-check"></i><b>55.5.2</b> 模型 2: 吸菸 + 年齡</a></li>
<li class="chapter" data-level="55.5.3" data-path="GLM-rates.html"><a href="GLM-rates.html#模型-3-吸菸-年齡-吸菸與年齡的交互作用項"><i class="fa fa-check"></i><b>55.5.3</b> 模型 3: 吸菸 + 年齡 + 吸菸與年齡的交互作用項</a></li>
</ul></li>
<li class="chapter" data-level="55.6" data-path="GLM-rates.html"><a href="GLM-rates.html#glm-practical-06"><i class="fa fa-check"></i><b>55.6</b> GLM Practical 06</a>
<ul>
<li class="chapter" data-level="55.6.1" data-path="GLM-rates.html"><a href="GLM-rates.html#將數據導入-r-環境中初步計算每個工廠不同年齡組工人的死亡人數和追蹤人年數據"><i class="fa fa-check"></i><b>55.6.1</b> 將數據導入 R 環境中，初步計算每個工廠不同年齡組工人的死亡人數，和追蹤人年數據。</a></li>
<li class="chapter" data-level="55.6.2" data-path="GLM-rates.html"><a href="GLM-rates.html#計算死亡率的對數值繪製其與年齡組的點圖"><i class="fa fa-check"></i><b>55.6.2</b> 計算死亡率的對數值，繪製其與年齡組的點圖。</a></li>
<li class="chapter" data-level="55.6.3" data-path="GLM-rates.html"><a href="GLM-rates.html#請用數學語言描述死亡率和年齡組之間關係的模型"><i class="fa fa-check"></i><b>55.6.3</b> 請用數學語言描述死亡率和年齡組之間關係的模型。</a></li>
<li class="chapter" data-level="55.6.4" data-path="GLM-rates.html"><a href="GLM-rates.html#接下來的模型中在前面的基礎上加入工廠編號你認爲是否有證據證明工廠之間的工人的死亡率在調整了年齡之後依然有差異計算年齡調整過後的兩工廠之間死亡率之比和95ci"><i class="fa fa-check"></i><b>55.6.4</b> 接下來的模型中在前面的基礎上加入工廠編號，你認爲是否有證據證明工廠之間的工人的死亡率在調整了年齡之後依然有差異？計算年齡調整過後的兩工廠之間死亡率之比和95%CI。</a></li>
<li class="chapter" data-level="55.6.5" data-path="GLM-rates.html"><a href="GLM-rates.html#現在在前一步加了工廠變量的基礎上重新擬合模型加入工廠和年齡之間的交互作用項"><i class="fa fa-check"></i><b>55.6.5</b> 現在在前一步加了工廠變量的基礎上，重新擬合模型，加入工廠和年齡之間的交互作用項</a></li>
<li class="chapter" data-level="55.6.6" data-path="GLM-rates.html"><a href="GLM-rates.html#現在把年齡當作連續型變量來考慮擬合下列模型"><i class="fa fa-check"></i><b>55.6.6</b> 現在把年齡當作連續型變量來考慮。擬合下列模型</a></li>
<li class="chapter" data-level="55.6.7" data-path="GLM-rates.html"><a href="GLM-rates.html#計算只有年齡連續型和工廠兩個變量模型時的模型偏差-deviance該模型和第一部分中飽和模型之間相比相差幾個參數parameters你有怎樣的推論"><i class="fa fa-check"></i><b>55.6.7</b> 計算只有年齡(連續型)和工廠兩個變量模型時的模型偏差 (deviance)，該模型和第一部分中飽和模型之間相比相差幾個參數(parameters)？你有怎樣的推論？</a></li>
<li class="chapter" data-level="55.6.8" data-path="GLM-rates.html"><a href="GLM-rates.html#對這個數據進行了這一系列的分析之後你從流行病學的角度來說有怎樣的結論"><i class="fa fa-check"></i><b>55.6.8</b> 對這個數據進行了這一系列的分析之後，你從流行病學的角度來說，有怎樣的結論？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="56" data-path="confounding-interaction.html"><a href="confounding-interaction.html"><i class="fa fa-check"></i><b>56</b> 混雜的調整，交互作用，和模型的可壓縮性</a>
<ul>
<li class="chapter" data-level="56.1" data-path="confounding-interaction.html"><a href="confounding-interaction.html#混雜因素的調整"><i class="fa fa-check"></i><b>56.1</b> 混雜因素的調整</a>
<ul>
<li class="chapter" data-level="56.1.1" data-path="confounding-interaction.html"><a href="confounding-interaction.html#woolf-法估算合併比值比"><i class="fa fa-check"></i><b>56.1.1</b> Woolf 法估算合併比值比</a></li>
</ul></li>
<li class="chapter" data-level="56.2" data-path="confounding-interaction.html"><a href="confounding-interaction.html#交互作用"><i class="fa fa-check"></i><b>56.2</b> 交互作用</a></li>
<li class="chapter" data-level="56.3" data-path="confounding-interaction.html"><a href="confounding-interaction.html#可壓縮性-collapsibility"><i class="fa fa-check"></i><b>56.3</b> 可壓縮性 collapsibility</a>
<ul>
<li class="chapter" data-level="56.3.1" data-path="confounding-interaction.html"><a href="confounding-interaction.html#線性迴歸的可壓縮性"><i class="fa fa-check"></i><b>56.3.1</b> 線性迴歸的可壓縮性</a></li>
<li class="chapter" data-level="56.3.2" data-path="confounding-interaction.html"><a href="confounding-interaction.html#collapsibility"><i class="fa fa-check"></i><b>56.3.2</b> 邏輯鏈接方程時的不可壓縮性</a></li>
</ul></li>
<li class="chapter" data-level="56.4" data-path="confounding-interaction.html"><a href="confounding-interaction.html#interaction-depend-scale"><i class="fa fa-check"></i><b>56.4</b> 交互作用對尺度的依賴性</a></li>
<li class="chapter" data-level="56.5" data-path="confounding-interaction.html"><a href="confounding-interaction.html#glm-practical-07"><i class="fa fa-check"></i><b>56.5</b> GLM Practical 07</a>
<ul>
<li class="chapter" data-level="56.5.1" data-path="confounding-interaction.html"><a href="confounding-interaction.html#使用你熟悉的統計學軟件擬合一個由-fupcontrol-作爲結果變量treat-作爲唯一預測變量的廣義線性回歸模型-根據報告的結果寫一段適用於醫學流行病學文獻雜誌的報告"><i class="fa fa-check"></i><b>56.5.1</b> 使用你熟悉的統計學軟件擬合一個由 <code>fupcontrol</code> 作爲結果變量，<code>treat</code> 作爲唯一預測變量的廣義線性回歸模型。 根據報告的結果，寫一段適用於醫學/流行病學文獻雜誌的報告。</a></li>
<li class="chapter" data-level="56.5.2" data-path="confounding-interaction.html"><a href="confounding-interaction.html#分析-treat-和-basecontrol-之間的關係結果是否如你的預期那樣"><i class="fa fa-check"></i><b>56.5.2</b> 分析 <code>treat</code> 和 <code>basecontrol</code> 之間的關係，結果是否如你的預期那樣？</a></li>
<li class="chapter" data-level="56.5.3" data-path="confounding-interaction.html"><a href="confounding-interaction.html#已知模型中如果增加調整基線變量可能對-fupcontrol-有一定的預測效果-在你的模型中增加基線血壓控制情況的變量與-m0-的結果-治療效果-treatment-effect參數標準誤-standard-error和-p-值重新修改之前用於發表在醫學雜誌上關於這個分析結果的報告描述"><i class="fa fa-check"></i><b>56.5.3</b> 已知模型中如果增加調整基線變量可能對 <code>fupcontrol</code> 有一定的預測效果。 在你的模型中增加基線血壓控制情況的變量。與 <code>m0</code> 的結果 (治療效果 treatment effect；參數標準誤 standard error；和 p 值)。重新修改之前用於發表在醫學雜誌上關於這個分析結果的報告描述。</a></li>
<li class="chapter" data-level="56.5.4" data-path="confounding-interaction.html"><a href="confounding-interaction.html#你更推薦使用哪個模型作爲最終主要結果的彙報"><i class="fa fa-check"></i><b>56.5.4</b> 你更推薦使用哪個模型作爲最終主要結果的彙報？</a></li>
<li class="chapter" data-level="56.5.5" data-path="confounding-interaction.html"><a href="confounding-interaction.html#實驗研究者更想知道新的治療方案是否由於基線時患者的血壓控制情況而有不同爲了回答這個問題請擬合對應的廣義線性回歸模型根據結果回答這個問題"><i class="fa fa-check"></i><b>56.5.5</b> 實驗研究者更想知道新的治療方案是否由於基線時患者的血壓控制情況而有不同。爲了回答這個問題，請擬合對應的廣義線性回歸模型。根據結果回答這個問題。</a></li>
<li class="chapter" data-level="56.5.6" data-path="confounding-interaction.html"><a href="confounding-interaction.html#換一個模型先不考慮-basecontrol使用危險度比-risk-ratio-來評價不同治療方案之間的療效"><i class="fa fa-check"></i><b>56.5.6</b> 換一個模型，先不考慮 <code>basecontrol</code>，使用危險度比 (risk ratio) 來評價不同治療方案之間的療效。</a></li>
<li class="chapter" data-level="56.5.7" data-path="confounding-interaction.html"><a href="confounding-interaction.html#在前一模型m4中加入-basecontrol與未加入該變量時模型的輸出結果相比有什麼不同"><i class="fa fa-check"></i><b>56.5.7</b> 在前一模型<code>m4</code>中加入 <code>basecontrol</code>，與未加入該變量時模型的輸出結果相比，有什麼不同？</a></li>
<li class="chapter" data-level="56.5.8" data-path="confounding-interaction.html"><a href="confounding-interaction.html#給上述模型增加交互作用項對於危險度比作爲指標時的交互作用分析結果和使用比值比時相比你有怎樣的思考和結論"><i class="fa fa-check"></i><b>56.5.8</b> 給上述模型增加交互作用項。對於危險度比作爲指標時的交互作用分析結果，和使用比值比時相比，你有怎樣的思考和結論？</a></li>
<li class="chapter" data-level="56.5.9" data-path="confounding-interaction.html"><a href="confounding-interaction.html#如果說不考慮一個rct的統計分析不能在收集完數據之後修改這一事實你認爲危險度比模型和比值比模型更應該使用哪一個來總結本數據的結果呢"><i class="fa fa-check"></i><b>56.5.9</b> 如果說不考慮一個RCT的統計分析不能在收集完數據之後修改這一事實，你認爲危險度比模型和比值比模型更應該使用哪一個來總結本數據的結果呢？</a></li>
<li class="chapter" data-level="56.5.10" data-path="confounding-interaction.html"><a href="confounding-interaction.html#證明危險度比模型是可以壓縮的prove-that-the-log-link-models-are-collapsible."><i class="fa fa-check"></i><b>56.5.10</b> 證明危險度比模型是可以壓縮的。Prove that the log-link models are collapsible.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="57" data-path="epi-logistic.html"><a href="epi-logistic.html"><i class="fa fa-check"></i><b>57</b> 流行病學中的邏輯迴歸</a>
<ul>
<li class="chapter" data-level="57.1" data-path="epi-logistic.html"><a href="epi-logistic.html#流行病學研究最常用的實驗設計"><i class="fa fa-check"></i><b>57.1</b> 流行病學研究最常用的實驗設計</a></li>
<li class="chapter" data-level="57.2" data-path="epi-logistic.html"><a href="epi-logistic.html#GLM8-3"><i class="fa fa-check"></i><b>57.2</b> 以簡單二進制暴露變量爲例</a>
<ul>
<li class="chapter" data-level="57.2.1" data-path="epi-logistic.html"><a href="epi-logistic.html#先決條件"><i class="fa fa-check"></i><b>57.2.1</b> 先決條件</a></li>
<li class="chapter" data-level="57.2.2" data-path="epi-logistic.html"><a href="epi-logistic.html#比值比-odds-ratios"><i class="fa fa-check"></i><b>57.2.2</b> 比值比 Odds ratios</a></li>
<li class="chapter" data-level="57.2.3" data-path="epi-logistic.html"><a href="epi-logistic.html#GLM8-3-4"><i class="fa fa-check"></i><b>57.2.3</b> 邏輯迴歸應用於病例對照研究的合理性</a></li>
</ul></li>
<li class="chapter" data-level="57.3" data-path="epi-logistic.html"><a href="epi-logistic.html#拓展到多個暴露變量的邏輯迴歸模型"><i class="fa fa-check"></i><b>57.3</b> 拓展到多個暴露變量的邏輯迴歸模型</a>
<ul>
<li class="chapter" data-level="57.3.1" data-path="epi-logistic.html"><a href="epi-logistic.html#mantel-haenszel-法"><i class="fa fa-check"></i><b>57.3.1</b> Mantel Haenszel 法</a></li>
<li class="chapter" data-level="57.3.2" data-path="epi-logistic.html"><a href="epi-logistic.html#隊列研究和病例對照研究的似然"><i class="fa fa-check"></i><b>57.3.2</b> 隊列研究和病例對照研究的似然</a></li>
<li class="chapter" data-level="57.3.3" data-path="epi-logistic.html"><a href="epi-logistic.html#病例對照研究中的邏輯迴歸"><i class="fa fa-check"></i><b>57.3.3</b> 病例對照研究中的邏輯迴歸</a></li>
</ul></li>
<li class="chapter" data-level="57.4" data-path="epi-logistic.html"><a href="epi-logistic.html#流行病學研究中變量的調整策略"><i class="fa fa-check"></i><b>57.4</b> 流行病學研究中變量的調整策略</a></li>
<li class="chapter" data-level="57.5" data-path="epi-logistic.html"><a href="epi-logistic.html#glm-practical-08"><i class="fa fa-check"></i><b>57.5</b> GLM Practical 08</a>
<ul>
<li class="chapter" data-level="57.5.1" data-path="epi-logistic.html"><a href="epi-logistic.html#part-1"><i class="fa fa-check"></i><b>57.5.1</b> Part 1</a></li>
<li class="chapter" data-level="57.5.2" data-path="epi-logistic.html"><a href="epi-logistic.html#part-2"><i class="fa fa-check"></i><b>57.5.2</b> Part 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="58" data-path="GLM-strategy.html"><a href="GLM-strategy.html"><i class="fa fa-check"></i><b>58</b> 分析策略</a>
<ul>
<li class="chapter" data-level="58.1" data-path="GLM-strategy.html"><a href="GLM-strategy.html#明確分析目的"><i class="fa fa-check"></i><b>58.1</b> 明確分析目的</a></li>
<li class="chapter" data-level="58.2" data-path="GLM-strategy.html"><a href="GLM-strategy.html#分析目的-1.1-估計-rct-中治療效果-treatment-effect"><i class="fa fa-check"></i><b>58.2</b> 分析目的 1.1 – 估計 RCT 中治療效果 (treatment effect)</a>
<ul>
<li class="chapter" data-level="58.2.1" data-path="GLM-strategy.html"><a href="GLM-strategy.html#rct-數據分析的一些不成熟的小建議"><i class="fa fa-check"></i><b>58.2.1</b> RCT 數據分析的一些不成熟的小建議</a></li>
</ul></li>
<li class="chapter" data-level="58.3" data-path="GLM-strategy.html"><a href="GLM-strategy.html#分析目的-1.2-估計流行病學研究中暴露變量和結果變量的關係-exposure-effect"><i class="fa fa-check"></i><b>58.3</b> 分析目的 1.2 – 估計流行病學研究中暴露變量和結果變量的關係 (exposure effect)</a>
<ul>
<li class="chapter" data-level="58.3.1" data-path="GLM-strategy.html"><a href="GLM-strategy.html#不成熟的小策略"><i class="fa fa-check"></i><b>58.3.1</b> 不成熟的小策略</a></li>
<li class="chapter" data-level="58.3.2" data-path="GLM-strategy.html"><a href="GLM-strategy.html#補充"><i class="fa fa-check"></i><b>58.3.2</b> 補充</a></li>
</ul></li>
<li class="chapter" data-level="58.4" data-path="GLM-strategy.html"><a href="GLM-strategy.html#分析目的-2-和-3-建立預測模型-predictive-models"><i class="fa fa-check"></i><b>58.4</b> 分析目的 2 和 3 – 建立預測模型 (predictive models)</a></li>
<li class="chapter" data-level="58.5" data-path="GLM-strategy.html"><a href="GLM-strategy.html#glm-practical-09"><i class="fa fa-check"></i><b>58.5</b> GLM practical 09</a>
<ul>
<li class="chapter" data-level="58.5.1" data-path="GLM-strategy.html"><a href="GLM-strategy.html#part-1-1"><i class="fa fa-check"></i><b>58.5.1</b> Part 1</a></li>
<li class="chapter" data-level="58.5.2" data-path="GLM-strategy.html"><a href="GLM-strategy.html#part-2-1"><i class="fa fa-check"></i><b>58.5.2</b> Part 2</a></li>
<li class="chapter" data-level="58.5.3" data-path="GLM-strategy.html"><a href="GLM-strategy.html#part-3"><i class="fa fa-check"></i><b>58.5.3</b> Part 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="59" data-path="checkingGLM.html"><a href="checkingGLM.html"><i class="fa fa-check"></i><b>59</b> 檢查你的模型 Model Checking - GLM</a>
<ul>
<li class="chapter" data-level="59.1" data-path="checkingGLM.html"><a href="checkingGLM.html#線性預測方程的定義"><i class="fa fa-check"></i><b>59.1</b> 線性預測方程的定義</a>
<ul>
<li class="chapter" data-level="59.1.1" data-path="checkingGLM.html"><a href="checkingGLM.html#殘差-1"><i class="fa fa-check"></i><b>59.1.1</b> 殘差</a></li>
<li class="chapter" data-level="59.1.2" data-path="checkingGLM.html"><a href="checkingGLM.html#glm-在-r-裏獲取殘差"><i class="fa fa-check"></i><b>59.1.2</b> GLM 在 R 裏獲取殘差</a></li>
<li class="chapter" data-level="59.1.3" data-path="checkingGLM.html"><a href="checkingGLM.html#如何利用獲得的殘差"><i class="fa fa-check"></i><b>59.1.3</b> 如何利用獲得的殘差</a></li>
</ul></li>
<li class="chapter" data-level="59.2" data-path="checkingGLM.html"><a href="checkingGLM.html#共變量模式殘差-covariate-pattern-residuals"><i class="fa fa-check"></i><b>59.2</b> 共變量模式殘差 covariate pattern residuals</a></li>
<li class="chapter" data-level="59.3" data-path="checkingGLM.html"><a href="checkingGLM.html#鏈接方程"><i class="fa fa-check"></i><b>59.3</b> 鏈接方程</a></li>
<li class="chapter" data-level="59.4" data-path="checkingGLM.html"><a href="checkingGLM.html#NHANESdrinker"><i class="fa fa-check"></i><b>59.4</b> NHANES 飲酒量數據實例</a></li>
<li class="chapter" data-level="59.5" data-path="checkingGLM.html"><a href="checkingGLM.html#practical-10"><i class="fa fa-check"></i><b>59.5</b> Practical 10</a></li>
</ul></li>
<li class="chapter" data-level="60" data-path="assess-perf.html"><a href="assess-perf.html"><i class="fa fa-check"></i><b>60</b> 評價模型的表現 Assessing model performance</a>
<ul>
<li class="chapter" data-level="60.1" data-path="assess-perf.html"><a href="assess-perf.html#calibration"><i class="fa fa-check"></i><b>60.1</b> 精準度 calibration</a></li>
<li class="chapter" data-level="60.2" data-path="assess-perf.html"><a href="assess-perf.html#可解釋因變量的變異度及-r2-決定係數"><i class="fa fa-check"></i><b>60.2</b> 可解釋因變量的變異度及 <span class="math inline">\(R^2\)</span> 決定係數</a></li>
<li class="chapter" data-level="60.3" data-path="assess-perf.html"><a href="assess-perf.html#分辨能力-descrimination"><i class="fa fa-check"></i><b>60.3</b> 分辨能力 descrimination</a>
<ul>
<li class="chapter" data-level="60.3.1" data-path="assess-perf.html"><a href="assess-perf.html#敏感度和特異度"><i class="fa fa-check"></i><b>60.3.1</b> 敏感度和特異度</a></li>
</ul></li>
<li class="chapter" data-level="60.4" data-path="assess-perf.html"><a href="assess-perf.html#practical-11"><i class="fa fa-check"></i><b>60.4</b> Practical 11</a></li>
</ul></li>
<li class="chapter" data-level="61" data-path="paired-ana.html"><a href="paired-ana.html"><i class="fa fa-check"></i><b>61</b> 配對實驗數據的分析法</a>
<ul>
<li class="chapter" data-level="61.1" data-path="paired-ana.html"><a href="paired-ana.html#配對的原理"><i class="fa fa-check"></i><b>61.1</b> 配對的原理</a>
<ul>
<li class="chapter" data-level="61.1.1" data-path="paired-ana.html"><a href="paired-ana.html#爲了提升估計的精確度"><i class="fa fa-check"></i><b>61.1.1</b> 爲了提升估計的精確度</a></li>
<li class="chapter" data-level="61.1.2" data-path="paired-ana.html"><a href="paired-ana.html#控制混雜因素"><i class="fa fa-check"></i><b>61.1.2</b> 控制混雜因素</a></li>
</ul></li>
<li class="chapter" data-level="61.2" data-path="paired-ana.html"><a href="paired-ana.html#結果變量爲連續型變量的配對實驗"><i class="fa fa-check"></i><b>61.2</b> 結果變量爲連續型變量的配對實驗</a>
<ul>
<li class="chapter" data-level="61.2.1" data-path="paired-ana.html"><a href="paired-ana.html#一般檢驗方法"><i class="fa fa-check"></i><b>61.2.1</b> 一般檢驗方法</a></li>
<li class="chapter" data-level="61.2.2" data-path="paired-ana.html"><a href="paired-ana.html#用迴歸法分析"><i class="fa fa-check"></i><b>61.2.2</b> 用迴歸法分析</a></li>
</ul></li>
<li class="chapter" data-level="61.3" data-path="paired-ana.html"><a href="paired-ana.html#結果變量是二進制變量的配對實驗"><i class="fa fa-check"></i><b>61.3</b> 結果變量是二進制變量的配對實驗</a>
<ul>
<li class="chapter" data-level="61.3.1" data-path="paired-ana.html"><a href="paired-ana.html#第一步-對數據作表格"><i class="fa fa-check"></i><b>61.3.1</b> 第一步 對數據作表格</a></li>
<li class="chapter" data-level="61.3.2" data-path="paired-ana.html"><a href="paired-ana.html#mcnemars-test"><i class="fa fa-check"></i><b>61.3.2</b> McNemar’s test</a></li>
<li class="chapter" data-level="61.3.3" data-path="paired-ana.html"><a href="paired-ana.html#二進制型結果變量配對實驗的比值比"><i class="fa fa-check"></i><b>61.3.3</b> 二進制型結果變量配對實驗的比值比</a></li>
<li class="chapter" data-level="61.3.4" data-path="paired-ana.html"><a href="paired-ana.html#配對實驗比值比的信賴區間"><i class="fa fa-check"></i><b>61.3.4</b> 配對實驗比值比的信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="61.4" data-path="paired-ana.html"><a href="paired-ana.html#條件-conditional-比值比和邊際-marginal-比值比"><i class="fa fa-check"></i><b>61.4</b> 條件 (conditional) 比值比和邊際 (marginal) 比值比</a></li>
</ul></li>
<li class="chapter" data-level="62" data-path="conditional-logistic.html"><a href="conditional-logistic.html"><i class="fa fa-check"></i><b>62</b> 條件邏輯迴歸 Conditional logistic regression</a>
<ul>
<li class="chapter" data-level="62.1" data-path="conditional-logistic.html"><a href="conditional-logistic.html#配對實驗的邏輯迴歸模型"><i class="fa fa-check"></i><b>62.1</b> 配對實驗的邏輯迴歸模型</a>
<ul>
<li class="chapter" data-level="62.1.1" data-path="conditional-logistic.html"><a href="conditional-logistic.html#配對病例對照研究"><i class="fa fa-check"></i><b>62.1.1</b> 配對病例對照研究</a></li>
<li class="chapter" data-level="62.1.2" data-path="conditional-logistic.html"><a href="conditional-logistic.html#配對隊列研究"><i class="fa fa-check"></i><b>62.1.2</b> 配對隊列研究</a></li>
</ul></li>
<li class="chapter" data-level="62.2" data-path="conditional-logistic.html"><a href="conditional-logistic.html#條件邏輯回歸-二進制暴露變量"><i class="fa fa-check"></i><b>62.2</b> 條件邏輯回歸 – 二進制暴露變量</a>
<ul>
<li class="chapter" data-level="62.2.1" data-path="conditional-logistic.html"><a href="conditional-logistic.html#充分統計量-sufficient-statistics"><i class="fa fa-check"></i><b>62.2.1</b> 充分統計量 sufficient statistics</a></li>
<li class="chapter" data-level="62.2.2" data-path="conditional-logistic.html"><a href="conditional-logistic.html#條件邏輯回歸的推導"><i class="fa fa-check"></i><b>62.2.2</b> 條件邏輯回歸的推導</a></li>
<li class="chapter" data-level="62.2.3" data-path="conditional-logistic.html"><a href="conditional-logistic.html#條件似然-conditional-likelihood"><i class="fa fa-check"></i><b>62.2.3</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="62.2.4" data-path="conditional-logistic.html"><a href="conditional-logistic.html#進一步擴展"><i class="fa fa-check"></i><b>62.2.4</b> 進一步擴展</a></li>
</ul></li>
<li class="chapter" data-level="62.3" data-path="conditional-logistic.html"><a href="conditional-logistic.html#條件邏輯回歸模型的一般化"><i class="fa fa-check"></i><b>62.3</b> 條件邏輯回歸模型的一般化</a></li>
</ul></li>
<li class="chapter" data-level="63" data-path="multinomial-logistic.html"><a href="multinomial-logistic.html"><i class="fa fa-check"></i><b>63</b> 多項邏輯回歸 Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="64" data-path="ordinal-logistic.html"><a href="ordinal-logistic.html"><i class="fa fa-check"></i><b>64</b> 順序邏輯回歸 Ordinal Logistic Regression</a></li>
<li class="part"><span><b>IX 等級線性迴歸模型 analysis of hierarchical and other dependent data</b></span></li>
<li class="chapter" data-level="65" data-path="Hierarchical.html"><a href="Hierarchical.html"><i class="fa fa-check"></i><b>65</b> 相互依賴數據及簡單的應對方案</a>
<ul>
<li class="chapter" data-level="65.1" data-path="Hierarchical.html"><a href="Hierarchical.html#相互依賴的數據"><i class="fa fa-check"></i><b>65.1</b> 相互依賴的數據</a></li>
<li class="chapter" data-level="65.2" data-path="Hierarchical.html"><a href="Hierarchical.html#依賴性的來源在哪裏"><i class="fa fa-check"></i><b>65.2</b> 依賴性的來源在哪裏</a></li>
<li class="chapter" data-level="65.3" data-path="Hierarchical.html"><a href="Hierarchical.html#數據有依賴性導致的結果"><i class="fa fa-check"></i><b>65.3</b> 數據有依賴性導致的結果</a></li>
<li class="chapter" data-level="65.4" data-path="Hierarchical.html"><a href="Hierarchical.html#邊際模型和條件模型-marginal-and-conditional-models"><i class="fa fa-check"></i><b>65.4</b> 邊際模型和條件模型 marginal and conditional models</a>
<ul>
<li class="chapter" data-level="65.4.1" data-path="Hierarchical.html"><a href="Hierarchical.html#標記法-notation"><i class="fa fa-check"></i><b>65.4.1</b> 標記法 notation</a></li>
<li class="chapter" data-level="65.4.2" data-path="Hierarchical.html"><a href="Hierarchical.html#合並每個階層"><i class="fa fa-check"></i><b>65.4.2</b> 合並每個階層</a></li>
<li class="chapter" data-level="65.4.3" data-path="Hierarchical.html"><a href="Hierarchical.html#生物學悖論-ecological-fallacy"><i class="fa fa-check"></i><b>65.4.3</b> 生物學悖論 ecological fallacy</a></li>
<li class="chapter" data-level="65.4.4" data-path="Hierarchical.html"><a href="Hierarchical.html#分解層級數據"><i class="fa fa-check"></i><b>65.4.4</b> 分解層級數據</a></li>
<li class="chapter" data-level="65.4.5" data-path="Hierarchical.html"><a href="Hierarchical.html#固定效應模型-fixed-effect-model"><i class="fa fa-check"></i><b>65.4.5</b> 固定效應模型 fixed effect model</a></li>
</ul></li>
<li class="chapter" data-level="65.5" data-path="Hierarchical.html"><a href="Hierarchical.html#簡單線性迴歸複習"><i class="fa fa-check"></i><b>65.5</b> 簡單線性迴歸複習</a></li>
<li class="chapter" data-level="65.6" data-path="Hierarchical.html"><a href="Hierarchical.html#practical-hierarchical-01"><i class="fa fa-check"></i><b>65.6</b> Practical Hierarchical 01</a>
<ul>
<li class="chapter" data-level="65.6.1" data-path="Hierarchical.html"><a href="Hierarchical.html#數據"><i class="fa fa-check"></i><b>65.6.1</b> 數據</a></li>
<li class="chapter" data-level="65.6.2" data-path="Hierarchical.html"><a href="Hierarchical.html#問題"><i class="fa fa-check"></i><b>65.6.2</b> 問題</a></li>
<li class="chapter" data-level="65.6.3" data-path="Hierarchical.html"><a href="Hierarchical.html#將-high-school-and-beyond-數據導入-r-中熟悉數據結構及內容特別要注意觀察每個學校的學生特徵"><i class="fa fa-check"></i><b>65.6.3</b> 將 High-School-and-Beyond 數據導入 R 中，熟悉數據結構及內容，特別要注意觀察每個學校的學生特徵。</a></li>
<li class="chapter" data-level="65.6.4" data-path="Hierarchical.html"><a href="Hierarchical.html#爲了簡便起見接下來的分析只節選數據中前五所學校-188-名學生的數學成績和-ses分別計算每所學校的數學成績及-ses-的平均值"><i class="fa fa-check"></i><b>65.6.4</b> 爲了簡便起見，接下來的分析只節選數據中前五所學校 188 名學生的數學成績，和 SES。分別計算每所學校的數學成績,及 SES 的平均值。</a></li>
<li class="chapter" data-level="65.6.5" data-path="Hierarchical.html"><a href="Hierarchical.html#先無視掉學校這一分層變量把所有學生看作是相互獨立的擬合總體的-ses-和數學成績的線性迴歸-total-regression-model把該總體模型的預測值提取並存儲在數據庫中"><i class="fa fa-check"></i><b>65.6.5</b> 先無視掉學校這一分層變量，把所有學生看作是相互獨立的，擬合總體的 SES 和數學成績的線性迴歸 <strong>(Total regression model)</strong>。把該總體模型的預測值提取並存儲在數據庫中。</a></li>
<li class="chapter" data-level="65.6.6" data-path="Hierarchical.html"><a href="Hierarchical.html#用各個學校-ses-和數學成績的均值擬合一個學校間的線性迴歸模型-between-regression-model"><i class="fa fa-check"></i><b>65.6.6</b> 用各個學校 SES 和數學成績的均值擬合一個學校間的線性迴歸模型 <strong>(between regression model)</strong>。</a></li>
<li class="chapter" data-level="65.6.7" data-path="Hierarchical.html"><a href="Hierarchical.html#分別對每個學校內的學生進行-ses-和數學成績擬合線性迴歸模型"><i class="fa fa-check"></i><b>65.6.7</b> 分別對每個學校內的學生進行 SES 和數學成績擬合線性迴歸模型。</a></li>
<li class="chapter" data-level="65.6.8" data-path="Hierarchical.html"><a href="Hierarchical.html#比較三種模型計算的數學成績的擬合值他們一致還是有所不同爲什麼會有不同"><i class="fa fa-check"></i><b>65.6.8</b> 比較三種模型計算的數學成績的擬合值，他們一致？還是有所不同？爲什麼會有不同？</a></li>
<li class="chapter" data-level="65.6.9" data-path="Hierarchical.html"><a href="Hierarchical.html#把三種模型的數學成績擬合值散點圖繪製在同一張圖內"><i class="fa fa-check"></i><b>65.6.9</b> 把三種模型的數學成績擬合值散點圖繪製在同一張圖內。</a></li>
<li class="chapter" data-level="65.6.10" data-path="Hierarchical.html"><a href="Hierarchical.html#用這-5-個學校的數據擬合一個固定效應線性迴歸模型"><i class="fa fa-check"></i><b>65.6.10</b> 用這 5 個學校的數據擬合一個固定效應線性迴歸模型</a></li>
<li class="chapter" data-level="65.6.11" data-path="Hierarchical.html"><a href="Hierarchical.html#讀入-pefr-數據"><i class="fa fa-check"></i><b>65.6.11</b> 讀入 PEFR 數據。</a></li>
<li class="chapter" data-level="65.6.12" data-path="Hierarchical.html"><a href="Hierarchical.html#求每個患者的-wp-兩次測量平均值"><i class="fa fa-check"></i><b>65.6.12</b> 求每個患者的 <code>wp</code> 兩次測量平均值</a></li>
<li class="chapter" data-level="65.6.13" data-path="Hierarchical.html"><a href="Hierarchical.html#在-r-裏先用-anova-分析個人的-wp-變異再用-lme4lmer-擬合用-id-作隨機效應的混合效應模型確認後者報告的-std.dev-for-id-effect-其實可以用-anova-結果的-sqrtfractextmms-msen-n-是每個個體重複測量值的個數"><i class="fa fa-check"></i><b>65.6.13</b> 在 R 裏先用 ANOVA 分析個人的 <code>wp</code> 變異。再用 <code>lme4::lmer</code> 擬合用 <code>id</code> 作隨機效應的混合效應模型。確認後者報告的 <code>Std.Dev for id effect</code> 其實可以用 ANOVA 結果的 <span class="math inline">\(\sqrt{\frac{\text{MMS-MSE}}{n}}\)</span> (n 是每個個體重複測量值的個數)。</a></li>
<li class="chapter" data-level="65.6.14" data-path="Hierarchical.html"><a href="Hierarchical.html#擬合結果變量爲-wp解釋變量爲-id-的簡單線性迴歸模型用數學表達式描述這個模型"><i class="fa fa-check"></i><b>65.6.14</b> 擬合結果變量爲 <code>wp</code>，解釋變量爲 <code>id</code> 的簡單線性迴歸模型。用數學表達式描述這個模型。</a></li>
<li class="chapter" data-level="65.6.15" data-path="Hierarchical.html"><a href="Hierarchical.html#將-wp-中心化之後重新擬合相同的模型把截距去除掉寫下這個模型的數學表達式"><i class="fa fa-check"></i><b>65.6.15</b> 將 <code>wp</code> 中心化之後，重新擬合相同的模型，把截距去除掉。寫下這個模型的數學表達式。</a></li>
<li class="chapter" data-level="65.6.16" data-path="Hierarchical.html"><a href="Hierarchical.html#計算這些迴歸係數-其實是不同羣之間的隨機截距-的均值和標準差"><i class="fa fa-check"></i><b>65.6.16</b> 計算這些迴歸係數 (其實是不同羣之間的隨機截距) 的均值和標準差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="66" data-path="random-intercept.html"><a href="random-intercept.html"><i class="fa fa-check"></i><b>66</b> 隨機截距模型 random intercept model</a>
<ul>
<li class="chapter" data-level="66.1" data-path="random-intercept.html"><a href="random-intercept.html#隨機截距模型的定義"><i class="fa fa-check"></i><b>66.1</b> 隨機截距模型的定義</a></li>
<li class="chapter" data-level="66.2" data-path="random-intercept.html"><a href="random-intercept.html#隨機截距模型的參數估計"><i class="fa fa-check"></i><b>66.2</b> 隨機截距模型的參數估計</a></li>
<li class="chapter" data-level="66.3" data-path="random-intercept.html"><a href="random-intercept.html#如何在-r-中進行隨機截距模型的擬合"><i class="fa fa-check"></i><b>66.3</b> 如何在 R 中進行隨機截距模型的擬合</a></li>
<li class="chapter" data-level="66.4" data-path="random-intercept.html"><a href="random-intercept.html#隨機截距模型中的統計推斷"><i class="fa fa-check"></i><b>66.4</b> 隨機截距模型中的統計推斷</a>
<ul>
<li class="chapter" data-level="66.4.1" data-path="random-intercept.html"><a href="random-intercept.html#fixed-inference"><i class="fa fa-check"></i><b>66.4.1</b> 固定效應部分的推斷</a></li>
<li class="chapter" data-level="66.4.2" data-path="random-intercept.html"><a href="random-intercept.html#隨機效應部分的推斷"><i class="fa fa-check"></i><b>66.4.2</b> 隨機效應部分的推斷</a></li>
</ul></li>
<li class="chapter" data-level="66.5" data-path="random-intercept.html"><a href="random-intercept.html#practical-hierarchical-02"><i class="fa fa-check"></i><b>66.5</b> Practical Hierarchical 02</a>
<ul>
<li class="chapter" data-level="66.5.1" data-path="random-intercept.html"><a href="random-intercept.html#數據-1"><i class="fa fa-check"></i><b>66.5.1</b> 數據</a></li>
<li class="chapter" data-level="66.5.2" data-path="random-intercept.html"><a href="random-intercept.html#讀入-ghq-數據探索其內容該數據是否是平衡數據-balanced計算每名學生的兩次問卷成績平均分"><i class="fa fa-check"></i><b>66.5.2</b> 讀入 GHQ 數據，探索其內容，該數據是否是平衡數據 (balanced)？計算每名學生的兩次問卷成績平均分。</a></li>
<li class="chapter" data-level="66.5.3" data-path="random-intercept.html"><a href="random-intercept.html#把數據從寬-wide-改變成長-long-的形式"><i class="fa fa-check"></i><b>66.5.3</b> 把數據從寬 (wide) 改變成長 (long) 的形式</a></li>
<li class="chapter" data-level="66.5.4" data-path="random-intercept.html"><a href="random-intercept.html#對數據按照-id-分層進行-anova"><i class="fa fa-check"></i><b>66.5.4</b> 對數據按照 <code>id</code> 分層進行 ANOVA</a></li>
<li class="chapter" data-level="66.5.5" data-path="random-intercept.html"><a href="random-intercept.html#用-r-裏的-nlme-包使用限制性極大似然法-restricted-maximum-likelihood-reml-擬合截距混合效應模型比較其結果和前文中隨機效應-anova-的結果"><i class="fa fa-check"></i><b>66.5.5</b> 用 R 裏的 <code>nlme</code> 包，使用限制性極大似然法 (restricted maximum likelihood, REML) 擬合截距混合效應模型，比較其結果和前文中隨機效應 ANOVA 的結果</a></li>
<li class="chapter" data-level="66.5.6" data-path="random-intercept.html"><a href="random-intercept.html#用極大似然法-maximum-likelihood-ml-method-ml-重新擬合前面的混合效應模型比較結果有什麼不同"><i class="fa fa-check"></i><b>66.5.6</b> 用極大似然法 (maximum likelihood, ML) <code>method = "ML"</code> 重新擬合前面的混合效應模型，比較結果有什麼不同。</a></li>
<li class="chapter" data-level="66.5.7" data-path="random-intercept.html"><a href="random-intercept.html#用簡單線性迴歸擬合一個固定效應模型"><i class="fa fa-check"></i><b>66.5.7</b> 用簡單線性迴歸擬合一個固定效應模型</a></li>
<li class="chapter" data-level="66.5.8" data-path="random-intercept.html"><a href="random-intercept.html#計算這些隨機截距的均值和標準差"><i class="fa fa-check"></i><b>66.5.8</b> 計算這些隨機截距的均值和標準差</a></li>
<li class="chapter" data-level="66.5.9" data-path="random-intercept.html"><a href="random-intercept.html#忽略掉所有的分層和解釋變量擬合-ghq-的簡單線性迴歸"><i class="fa fa-check"></i><b>66.5.9</b> 忽略掉所有的分層和解釋變量擬合 <code>GHQ</code> 的簡單線性迴歸</a></li>
<li class="chapter" data-level="66.5.10" data-path="random-intercept.html"><a href="random-intercept.html#用分層的穩健法-三明治標準誤法-計算簡單線性迴歸時截距的標準誤差和簡單線性迴歸時的結果作比較"><i class="fa fa-check"></i><b>66.5.10</b> 用分層的穩健法 (三明治標準誤法) 計算簡單線性迴歸時，截距的標準誤差，和簡單線性迴歸時的結果作比較</a></li>
<li class="chapter" data-level="66.5.11" data-path="random-intercept.html"><a href="random-intercept.html#讀入-siblings-數據先總結嬰兒的出生體重思考這個數據中嬰兒出生體重之間是否可能存在關聯性它的來源是哪裏用這個數據擬合兩個混合效應模型-ml-reml不加入任何解釋變量"><i class="fa fa-check"></i><b>66.5.11</b> 讀入 <code>siblings</code> 數據。先總結嬰兒的出生體重，思考這個數據中嬰兒出生體重之間是否可能存在關聯性？它的來源是哪裏。用這個數據擬合兩個混合效應模型 (ML, REML)，不加入任何解釋變量。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="67" data-path="random-inter-cov.html"><a href="random-inter-cov.html"><i class="fa fa-check"></i><b>67</b> 隨機截距模型中加入共變量 random intercept model with covariates</a>
<ul>
<li class="chapter" data-level="67.1" data-path="random-inter-cov.html"><a href="random-inter-cov.html#多元線性回歸模型的延伸"><i class="fa fa-check"></i><b>67.1</b> 多元線性回歸模型的延伸</a></li>
<li class="chapter" data-level="67.2" data-path="random-inter-cov.html"><a href="random-inter-cov.html#siblings-數據中新生兒體重的實例"><i class="fa fa-check"></i><b>67.2</b> <code>siblings</code> 數據中新生兒體重的實例</a></li>
<li class="chapter" data-level="67.3" data-path="random-inter-cov.html"><a href="random-inter-cov.html#賦值予隨機效應成分"><i class="fa fa-check"></i><b>67.3</b> 賦值予隨機效應成分</a>
<ul>
<li class="chapter" data-level="67.3.1" data-path="random-inter-cov.html"><a href="random-inter-cov.html#簡單預測-simple-prediction"><i class="fa fa-check"></i><b>67.3.1</b> 簡單預測 simple prediction</a></li>
<li class="chapter" data-level="67.3.2" data-path="random-inter-cov.html"><a href="random-inter-cov.html#eb-預測值"><i class="fa fa-check"></i><b>67.3.2</b> EB 預測值</a></li>
</ul></li>
<li class="chapter" data-level="67.4" data-path="random-inter-cov.html"><a href="random-inter-cov.html#混合效應模型的診斷"><i class="fa fa-check"></i><b>67.4</b> 混合效應模型的診斷</a></li>
<li class="chapter" data-level="67.5" data-path="random-inter-cov.html"><a href="random-inter-cov.html#第二層級-cluster-levellevel-2-的協方差"><i class="fa fa-check"></i><b>67.5</b> 第二層級 (cluster level/level 2) 的協方差</a></li>
<li class="chapter" data-level="67.6" data-path="random-inter-cov.html"><a href="random-inter-cov.html#層內層間效應估計"><i class="fa fa-check"></i><b>67.6</b> 層內層間效應估計</a></li>
<li class="chapter" data-level="67.7" data-path="random-inter-cov.html"><a href="random-inter-cov.html#到底選擇固定還是混合模型"><i class="fa fa-check"></i><b>67.7</b> 到底選擇固定還是混合模型？</a></li>
<li class="chapter" data-level="67.8" data-path="random-inter-cov.html"><a href="random-inter-cov.html#practical-hierarchical-03"><i class="fa fa-check"></i><b>67.8</b> Practical Hierarchical 03</a>
<ul>
<li class="chapter" data-level="67.8.1" data-path="random-inter-cov.html"><a href="random-inter-cov.html#把-high-school-and-beyond-數據讀入-r-中"><i class="fa fa-check"></i><b>67.8.1</b> 把 High-school-and-Beyond 數據讀入 R 中。</a></li>
<li class="chapter" data-level="67.8.2" data-path="random-inter-cov.html"><a href="random-inter-cov.html#擬合兩個隨機截距模型-ml-reml結果變量用-mathach解釋變量用-ses觀察結果是否不同"><i class="fa fa-check"></i><b>67.8.2</b> 擬合兩個隨機截距模型 (ML, REML)，結果變量用 <code>mathach</code>，解釋變量用 <code>ses</code>。觀察結果是否不同。</a></li>
<li class="chapter" data-level="67.8.3" data-path="random-inter-cov.html"><a href="random-inter-cov.html#觀察學校類型是否爲天主教學校-sector-的分佈把它加入剛擬合的兩個隨機截距模型它們估計的隨機效應標準差-hatsigma_u和隨機誤差標準差-hatsigma_e和之前有什麼不同-mlreml-的選用對結果有影響嗎"><i class="fa fa-check"></i><b>67.8.3</b> 觀察學校類型是否爲天主教學校 <code>sector</code> 的分佈，把它加入剛擬合的兩個隨機截距模型，它們估計的隨機效應標準差 <span class="math inline">\(\hat\sigma_u\)</span>，和隨機誤差標準差 <span class="math inline">\(\hat\sigma_e\)</span>，和之前有什麼不同？ “ML，REML” 的選用對結果有影響嗎？</a></li>
<li class="chapter" data-level="67.8.4" data-path="random-inter-cov.html"><a href="random-inter-cov.html#現在把學校規模-size-這一變量加入混合效應模型的固定效應部分記得先把該變量中心化並除以-100會有助於對結果的解釋-比平均值每增加100名學生仔細觀察模型結果中隨機效應標準差和隨機誤差標準殘差的變化"><i class="fa fa-check"></i><b>67.8.4</b> 現在把學校規模 <code>size</code> 這一變量加入混合效應模型的固定效應部分，記得先把該變量中心化，並除以 100，會有助於對結果的解釋 (比平均值每增加100名學生)。仔細觀察模型結果中隨機效應標準差和隨機誤差標準殘差的變化。</a></li>
<li class="chapter" data-level="67.8.5" data-path="random-inter-cov.html"><a href="random-inter-cov.html#在模型的固定效應部分增加-sizesector-的交互作用項觀察輸出結果中該交互作用項是否有意義用什麼檢驗方法判斷這個交互作用項能否幫助模型更加擬合數據"><i class="fa fa-check"></i><b>67.8.5</b> 在模型的固定效應部分增加 <code>size*sector</code> 的交互作用項。觀察輸出結果中該交互作用項是否有意義。用什麼檢驗方法判斷這個交互作用項能否幫助模型更加擬合數據？</a></li>
<li class="chapter" data-level="67.8.6" data-path="random-inter-cov.html"><a href="random-inter-cov.html#把上面八個模型估計的隨機效應標準差和隨機誤差標準差總結成表格它們之間有什麼規律嗎"><i class="fa fa-check"></i><b>67.8.6</b> 把上面八個模型估計的隨機效應標準差，和隨機誤差標準差總結成表格，它們之間有什麼規律嗎？</a></li>
<li class="chapter" data-level="67.8.7" data-path="random-inter-cov.html"><a href="random-inter-cov.html#在混合效應模型的固定效應部分增加學生性別-female和學生是否是少數族裔-minority-兩個變量再觀察-hatsigma_u-hatsigma_e-是否發生變化"><i class="fa fa-check"></i><b>67.8.7</b> 在混合效應模型的固定效應部分增加學生性別 <code>female</code>，和學生是否是少數族裔 <code>minority</code> 兩個變量。再觀察 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span> 是否發生變化？</a></li>
<li class="chapter" data-level="67.8.8" data-path="random-inter-cov.html"><a href="random-inter-cov.html#檢查學生性別和族裔是否和學校是否是天主教會學校有關係先作分類型數據的分佈表格然後把它們各自與-sector-的交互作用項加入混合效應模型中的固定效應部分記錄下此時的-hatsigma_u-hatsigma_e"><i class="fa fa-check"></i><b>67.8.8</b> 檢查學生性別和族裔是否和學校是否是天主教會學校有關係，先作分類型數據的分佈表格，然後把它們各自與 <code>sector</code> 的交互作用項加入混合效應模型中的固定效應部分，記錄下此時的 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span></a></li>
<li class="chapter" data-level="67.8.9" data-path="random-inter-cov.html"><a href="random-inter-cov.html#對上面最後一個模型進行殘差分析和模型的診斷"><i class="fa fa-check"></i><b>67.8.9</b> 對上面最後一個模型進行殘差分析和模型的診斷。</a></li>
<li class="chapter" data-level="67.8.10" data-path="random-inter-cov.html"><a href="random-inter-cov.html#通過剛剛所求的隨機效應方差的殘差確認哪個學校存在相對極端的值"><i class="fa fa-check"></i><b>67.8.10</b> 通過剛剛所求的隨機效應方差的殘差，確認哪個學校存在相對極端的值。</a></li>
<li class="chapter" data-level="67.8.11" data-path="random-inter-cov.html"><a href="random-inter-cov.html#計算學校水平的-ses-平均值以及每個學生自己和所在學校均值之間的差值大小分別擬合兩個不同的混合效應模型一個只用-ses另一個換做使用新計算的組均值和組內均差"><i class="fa fa-check"></i><b>67.8.11</b> 計算學校水平的 SES 平均值，以及每個學生自己和所在學校均值之間的差值大小。分別擬合兩個不同的混合效應模型，一個只用 <code>SES</code>，另一個換做使用新計算的組均值和組內均差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="68" data-path="random-coefficient.html"><a href="random-coefficient.html"><i class="fa fa-check"></i><b>68</b> 隨機回歸系數模型 random coefficient model</a>
<ul>
<li class="chapter" data-level="68.1" data-path="random-coefficient.html"><a href="random-coefficient.html#gcse-scores-實例"><i class="fa fa-check"></i><b>68.1</b> GCSE scores 實例</a></li>
<li class="chapter" data-level="68.2" data-path="random-coefficient.html"><a href="random-coefficient.html#隨機回歸系數的實質"><i class="fa fa-check"></i><b>68.2</b> 隨機回歸系數的實質</a></li>
<li class="chapter" data-level="68.3" data-path="random-coefficient.html"><a href="random-coefficient.html#繼續-gcse-scores-實例"><i class="fa fa-check"></i><b>68.3</b> 繼續 GCSE scores 實例</a></li>
<li class="chapter" data-level="68.4" data-path="random-coefficient.html"><a href="random-coefficient.html#使用模型結果推斷"><i class="fa fa-check"></i><b>68.4</b> 使用模型結果推斷</a></li>
<li class="chapter" data-level="68.5" data-path="random-coefficient.html"><a href="random-coefficient.html#random-var"><i class="fa fa-check"></i><b>68.5</b> 隨機效應的方差</a></li>
<li class="chapter" data-level="68.6" data-path="random-coefficient.html"><a href="random-coefficient.html#模型效果評估"><i class="fa fa-check"></i><b>68.6</b> 模型效果評估</a></li>
<li class="chapter" data-level="68.7" data-path="random-coefficient.html"><a href="random-coefficient.html#practical-hierarchical-04"><i class="fa fa-check"></i><b>68.7</b> Practical Hierarchical 04</a>
<ul>
<li class="chapter" data-level="68.7.1" data-path="random-coefficient.html"><a href="random-coefficient.html#先忽略學校編號爲-48-的學校擬合一個只有固定效應-簡單線性回歸模型結果變量是-gcse解釋變量是-lrt-和學校"><i class="fa fa-check"></i><b>68.7.1</b> 先忽略學校編號爲 48 的學校，擬合一個只有固定效應 (簡單線性回歸模型)，結果變量是 GCSE，解釋變量是 LRT 和學校。</a></li>
<li class="chapter" data-level="68.7.2" data-path="random-coefficient.html"><a href="random-coefficient.html#僅有固定效應模型的學校變量變更爲學校類型-男校女校或混合校從這個新模型的結果來看你是否認爲學校類型和學校編號本身相比能夠解釋相同的學校層面的方差-lrt-的估計回歸參數發生了怎樣的變化"><i class="fa fa-check"></i><b>68.7.2</b> 僅有固定效應模型的學校變量變更爲學校類型 (男校女校或混合校)，從這個新模型的結果來看，你是否認爲學校類型，和學校編號本身相比能夠解釋相同的學校層面的方差？ <code>lrt</code> 的估計回歸參數發生了怎樣的變化？</a></li>
<li class="chapter" data-level="68.7.3" data-path="random-coefficient.html"><a href="random-coefficient.html#使用限制性極大似然法擬合一個隨機截距模型記錄此時的限制性對數似然的大小-log-likelihood用-lmertestrand-命令對隨機效應部分的方差是否爲零做檢驗指明該檢驗的零假設是什麼並解釋其結果的含義"><i class="fa fa-check"></i><b>68.7.3</b> 使用限制性極大似然法擬合一個隨機截距模型。記錄此時的限制性對數似然的大小 (log-likelihood)。用 <code>lmerTest::rand</code> 命令對隨機效應部分的方差是否爲零做檢驗，指明該檢驗的零假設是什麼，並解釋其結果的含義。</a></li>
<li class="chapter" data-level="68.7.4" data-path="random-coefficient.html"><a href="random-coefficient.html#在前一題的隨機截距模型中加入-schgend-變量作爲解釋隨機截距的一個自變量觀察輸出結果解釋其是否有意義記錄這個模型的限制性似然"><i class="fa fa-check"></i><b>68.7.4</b> 在前一題的隨機截距模型中加入 <code>schgend</code> 變量，作爲解釋隨機截距的一個自變量，觀察輸出結果，解釋其是否有意義。記錄這個模型的限制性似然。</a></li>
<li class="chapter" data-level="68.7.5" data-path="random-coefficient.html"><a href="random-coefficient.html#擬合隨機截距隨機斜率模型固定效應部分的-lrt-也加入進隨機效應部分"><i class="fa fa-check"></i><b>68.7.5</b> 擬合隨機截距隨機斜率模型，固定效應部分的 <code>lrt</code> 也加入進隨機效應部分。</a></li>
<li class="chapter" data-level="68.7.6" data-path="random-coefficient.html"><a href="random-coefficient.html#通過上面幾個模型計算獲得的似然嘗試檢驗隨機斜率標準差以及該標準差和隨機截距標準差的協相關是否有意義"><i class="fa fa-check"></i><b>68.7.6</b> 通過上面幾個模型計算獲得的似然，嘗試檢驗隨機斜率標準差，以及該標準差和隨機截距標準差的協相關是否有意義。</a></li>
<li class="chapter" data-level="68.7.7" data-path="random-coefficient.html"><a href="random-coefficient.html#模型中的-schgend-改成-mean_girl-會給出怎樣的結果呢"><i class="fa fa-check"></i><b>68.7.7</b> 模型中的 <code>schgend</code> 改成 <code>mean_girl</code> 會給出怎樣的結果呢？</a></li>
<li class="chapter" data-level="68.7.8" data-path="random-coefficient.html"><a href="random-coefficient.html#現在我們把注意力改爲關心學校編號爲-48-的學校的情況用且禁用它一所學校的數據擬合一個簡單線性回歸結果變量是-gcse解釋變量是-lrt"><i class="fa fa-check"></i><b>68.7.8</b> 現在我們把注意力改爲關心學校編號爲 48 的學校的情況。用且禁用它一所學校的數據，擬合一個簡單線性回歸，結果變量是 <code>gcse</code>，解釋變量是 <code>lrt</code>。</a></li>
<li class="chapter" data-level="68.7.9" data-path="random-coefficient.html"><a href="random-coefficient.html#這次不排除-48-號學校擬合所有學校的數據進入-fixed_reml2-模型中去結果有發生顯著的變化嗎"><i class="fa fa-check"></i><b>68.7.9</b> 這次不排除 48 號學校，擬合所有學校的數據進入 <code>Fixed_reml2</code> 模型中去，結果有發生顯著的變化嗎？</a></li>
<li class="chapter" data-level="68.7.10" data-path="random-coefficient.html"><a href="random-coefficient.html#計算這個模型的第二階級level-2-school-level的殘差"><i class="fa fa-check"></i><b>68.7.10</b> 計算這個模型的第二階級(level 2, <code>school</code> level)的殘差。</a></li>
<li class="chapter" data-level="68.7.11" data-path="random-coefficient.html"><a href="random-coefficient.html#計算這個模型的第一階級level-1-student殘差分析其分布查看第48所學校的殘差表現如何"><i class="fa fa-check"></i><b>68.7.11</b> 計算這個模型的第一階級(level 1, student)殘差，分析其分布，查看第48所學校的殘差表現如何。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="69" data-path="longitudinal1.html"><a href="longitudinal1.html"><i class="fa fa-check"></i><b>69</b> 縱向研究數據 longitudinal data 1</a>
<ul>
<li class="chapter" data-level="69.1" data-path="longitudinal1.html"><a href="longitudinal1.html#固定測量時刻-fixed-occasions"><i class="fa fa-check"></i><b>69.1</b> 固定測量時刻 fixed occasions</a>
<ul>
<li class="chapter" data-level="69.1.1" data-path="longitudinal1.html"><a href="longitudinal1.html#缺失值-missing-data"><i class="fa fa-check"></i><b>69.1.1</b> 缺失值 Missing data</a></li>
</ul></li>
<li class="chapter" data-level="69.2" data-path="longitudinal1.html"><a href="longitudinal1.html#不固定測量時刻-variable-occasions"><i class="fa fa-check"></i><b>69.2</b> 不固定測量時刻 variable occasions</a></li>
<li class="chapter" data-level="69.3" data-path="longitudinal1.html"><a href="longitudinal1.html#預測軌跡-predicting-trajectories"><i class="fa fa-check"></i><b>69.3</b> 預測軌跡 predicting trajectories</a></li>
<li class="chapter" data-level="69.4" data-path="longitudinal1.html"><a href="longitudinal1.html#practical-05-hier"><i class="fa fa-check"></i><b>69.4</b> Practical 05-Hier</a></li>
</ul></li>
<li class="chapter" data-level="70" data-path="longitudinal2.html"><a href="longitudinal2.html"><i class="fa fa-check"></i><b>70</b> 縱向研究數據 longitudinal data 2</a>
<ul>
<li class="chapter" data-level="70.1" data-path="longitudinal2.html"><a href="longitudinal2.html#邊際結構-marginal-structures"><i class="fa fa-check"></i><b>70.1</b> 邊際結構 marginal structures</a>
<ul>
<li class="chapter" data-level="70.1.1" data-path="longitudinal2.html"><a href="longitudinal2.html#隨機截距模型"><i class="fa fa-check"></i><b>70.1.1</b> 隨機截距模型</a></li>
<li class="chapter" data-level="70.1.2" data-path="longitudinal2.html"><a href="longitudinal2.html#隨機系數模型"><i class="fa fa-check"></i><b>70.1.2</b> 隨機系數模型</a></li>
</ul></li>
<li class="chapter" data-level="70.2" data-path="longitudinal2.html"><a href="longitudinal2.html#矩陣記法"><i class="fa fa-check"></i><b>70.2</b> 矩陣記法</a></li>
<li class="chapter" data-level="70.3" data-path="longitudinal2.html"><a href="longitudinal2.html#混合效應模型的一般化公式"><i class="fa fa-check"></i><b>70.3</b> 混合效應模型的一般化公式</a></li>
<li class="chapter" data-level="70.4" data-path="longitudinal2.html"><a href="longitudinal2.html#其他可選擇的方差協方差矩陣特徵"><i class="fa fa-check"></i><b>70.4</b> 其他可選擇的方差協方差矩陣特徵</a></li>
<li class="chapter" data-level="70.5" data-path="longitudinal2.html"><a href="longitudinal2.html#其他要點評論"><i class="fa fa-check"></i><b>70.5</b> 其他要點評論</a></li>
<li class="chapter" data-level="70.6" data-path="longitudinal2.html"><a href="longitudinal2.html#不平衡數據"><i class="fa fa-check"></i><b>70.6</b> 不平衡數據</a></li>
<li class="chapter" data-level="70.7" data-path="longitudinal2.html"><a href="longitudinal2.html#practical-06-hier"><i class="fa fa-check"></i><b>70.7</b> Practical 06-Hier</a></li>
</ul></li>
<li class="chapter" data-level="71" data-path="longitudinal3.html"><a href="longitudinal3.html"><i class="fa fa-check"></i><b>71</b> 縱向研究數據 longitudinal data 3</a>
<ul>
<li class="chapter" data-level="71.1" data-path="longitudinal3.html"><a href="longitudinal3.html#第一層級的異質性-level-1-heterogeneity"><i class="fa fa-check"></i><b>71.1</b> 第一層級的異質性 level 1 heterogeneity</a></li>
<li class="chapter" data-level="71.2" data-path="longitudinal3.html"><a href="longitudinal3.html#第二層級異質性-level-2-heterogeneity"><i class="fa fa-check"></i><b>71.2</b> 第二層級異質性 level 2 heterogeneity</a></li>
<li class="chapter" data-level="71.3" data-path="longitudinal3.html"><a href="longitudinal3.html#分析策略"><i class="fa fa-check"></i><b>71.3</b> 分析策略</a>
<ul>
<li class="chapter" data-level="71.3.1" data-path="longitudinal3.html"><a href="longitudinal3.html#模型選擇和建模步驟"><i class="fa fa-check"></i><b>71.3.1</b> 模型選擇和建模步驟</a></li>
</ul></li>
<li class="chapter" data-level="71.4" data-path="longitudinal3.html"><a href="longitudinal3.html#practical-07-hier"><i class="fa fa-check"></i><b>71.4</b> Practical 07-Hier</a></li>
</ul></li>
<li class="chapter" data-level="72" data-path="-generalized-estimating-equation.html"><a href="-generalized-estimating-equation.html"><i class="fa fa-check"></i><b>72</b> 廣義估計方程式 Generalized Estimating Equation</a>
<ul>
<li class="chapter" data-level="72.1" data-path="-generalized-estimating-equation.html"><a href="-generalized-estimating-equation.html#practical-08-hier"><i class="fa fa-check"></i><b>72.1</b> Practical 08-Hier</a></li>
</ul></li>
<li class="chapter" data-level="73" data-path="cluster-ana.html"><a href="cluster-ana.html"><i class="fa fa-check"></i><b>73</b> 聚類分析 Cluster analysis/unsupervised learning</a>
<ul>
<li class="chapter" data-level="73.1" data-path="cluster-ana.html"><a href="cluster-ana.html#聚類分析過程"><i class="fa fa-check"></i><b>73.1</b> 聚類分析過程</a>
<ul>
<li class="chapter" data-level="73.1.1" data-path="cluster-ana.html"><a href="cluster-ana.html#連續型變量-continuous-variables-in-cluster-analysis"><i class="fa fa-check"></i><b>73.1.1</b> 連續型變量 continuous variables in cluster analysis</a></li>
<li class="chapter" data-level="73.1.2" data-path="cluster-ana.html"><a href="cluster-ana.html#二分類或者分類型變量之間的距離-distances-for-binarycategorical-variables"><i class="fa fa-check"></i><b>73.1.2</b> 二分類或者分類型變量之間的距離 distances for binary/categorical variables</a></li>
<li class="chapter" data-level="73.1.3" data-path="cluster-ana.html"><a href="cluster-ana.html#定義分類方法"><i class="fa fa-check"></i><b>73.1.3</b> 定義分類方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="74" data-path="PCA.html"><a href="PCA.html"><i class="fa fa-check"></i><b>74</b> 主成分分析 Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="74.1" data-path="PCA.html"><a href="PCA.html#數據有相關性時產生的問題"><i class="fa fa-check"></i><b>74.1</b> 數據有相關性時產生的問題</a></li>
<li class="chapter" data-level="74.2" data-path="PCA.html"><a href="PCA.html#最大化方差等價於最大化數據點到新座標軸投影projection的長度"><i class="fa fa-check"></i><b>74.2</b> 最大化方差等價於最大化數據點到新座標軸<strong>“投影(projection)”</strong>的長度</a></li>
<li class="chapter" data-level="74.3" data-path="PCA.html"><a href="PCA.html#數學推導"><i class="fa fa-check"></i><b>74.3</b> 數學推導</a>
<ul>
<li class="chapter" data-level="74.3.1" data-path="PCA.html"><a href="PCA.html#超越對稱矩陣奇異值分解-singular-value-decomposition-svd"><i class="fa fa-check"></i><b>74.3.1</b> 超越對稱矩陣：奇異值分解 (singular value decomposition, SVD)</a></li>
</ul></li>
<li class="chapter" data-level="74.4" data-path="PCA.html"><a href="PCA.html#主成分分析數據實例"><i class="fa fa-check"></i><b>74.4</b> 主成分分析數據實例</a></li>
<li class="chapter" data-level="74.5" data-path="PCA.html"><a href="PCA.html#在pca圖形中加入補充變量和補充個體-supplementary-elements"><i class="fa fa-check"></i><b>74.5</b> 在PCA圖形中加入補充變量和補充個體 (supplementary elements)</a>
<ul>
<li class="chapter" data-level="74.5.1" data-path="PCA.html"><a href="PCA.html#展示分類輔助性變量和個體的關係"><i class="fa fa-check"></i><b>74.5.1</b> 展示分類輔助性變量和個體的關係</a></li>
</ul></li>
<li class="chapter" data-level="74.6" data-path="PCA.html"><a href="PCA.html#cluster-analysispca-practical"><i class="fa fa-check"></i><b>74.6</b> Cluster analysis/PCA practical</a>
<ul>
<li class="chapter" data-level="74.6.1" data-path="PCA.html"><a href="PCA.html#使用的數據和簡單背景知識"><i class="fa fa-check"></i><b>74.6.1</b> 使用的數據和簡單背景知識</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="75" data-path="-missing-data-1.html"><a href="-missing-data-1.html"><i class="fa fa-check"></i><b>75</b> 缺失數據 Missing data 1</a>
<ul>
<li class="chapter" data-level="75.1" data-path="-missing-data-1.html"><a href="-missing-data-1.html#處理原則建議recommended-principles"><i class="fa fa-check"></i><b>75.1</b> 處理原則（建議）recommended principles</a></li>
<li class="chapter" data-level="75.2" data-path="-missing-data-1.html"><a href="-missing-data-1.html#缺失數據機制-missingness-mechanisms"><i class="fa fa-check"></i><b>75.2</b> 缺失數據機制 missingness mechanisms</a></li>
<li class="chapter" data-level="75.3" data-path="-missing-data-1.html"><a href="-missing-data-1.html#臨時解決方案-ad-hoc-approaches"><i class="fa fa-check"></i><b>75.3</b> 臨時解決方案 ad-hoc approaches</a></li>
<li class="chapter" data-level="75.4" data-path="-missing-data-1.html"><a href="-missing-data-1.html#單一變量的參數多重插補法-parametric-multiple-imputation-of-one-variable"><i class="fa fa-check"></i><b>75.4</b> 單一變量的參數多重插補法 parametric multiple imputation of one variable</a></li>
<li class="chapter" data-level="75.5" data-path="-missing-data-1.html"><a href="-missing-data-1.html#變量選擇插補次數模型檢查"><i class="fa fa-check"></i><b>75.5</b> 變量選擇，插補次數，模型檢查</a></li>
<li class="chapter" data-level="75.6" data-path="-missing-data-1.html"><a href="-missing-data-1.html#總結"><i class="fa fa-check"></i><b>75.6</b> 總結</a></li>
<li class="chapter" data-level="75.7" data-path="-missing-data-1.html"><a href="-missing-data-1.html#practical-10-hier"><i class="fa fa-check"></i><b>75.7</b> Practical 10-Hier</a>
<ul>
<li class="chapter" data-level="75.7.1" data-path="-missing-data-1.html"><a href="-missing-data-1.html#數據缺失產生的影響缺失機制和多重插補法"><i class="fa fa-check"></i><b>75.7.1</b> 數據缺失產生的影響，缺失機制，和多重插補法</a></li>
<li class="chapter" data-level="75.7.2" data-path="-missing-data-1.html"><a href="-missing-data-1.html#二進制變量的缺失-class-size-study"><i class="fa fa-check"></i><b>75.7.2</b> 二進制變量的缺失 “class size study”</a></li>
<li class="chapter" data-level="75.7.3" data-path="-missing-data-1.html"><a href="-missing-data-1.html#完整數據分析結果"><i class="fa fa-check"></i><b>75.7.3</b> 完整數據分析結果</a></li>
<li class="chapter" data-level="75.7.4" data-path="-missing-data-1.html"><a href="-missing-data-1.html#去除了缺失值的分析結果-complete-case-analysis"><i class="fa fa-check"></i><b>75.7.4</b> 去除了缺失值的分析結果 complete case analysis</a></li>
<li class="chapter" data-level="75.7.5" data-path="-missing-data-1.html"><a href="-missing-data-1.html#分析-sen_m-的缺失值機制"><i class="fa fa-check"></i><b>75.7.5</b> 分析 <code>sen_m</code> 的缺失值機制</a></li>
<li class="chapter" data-level="75.7.6" data-path="-missing-data-1.html"><a href="-missing-data-1.html#多重插補-multiple-imputation"><i class="fa fa-check"></i><b>75.7.6</b> 多重插補 multiple imputation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="76" data-path="-missing-data-2.html"><a href="-missing-data-2.html"><i class="fa fa-check"></i><b>76</b> 缺失數據 Missing data 2</a></li>
<li class="chapter" data-level="77" data-path="further-issues.html"><a href="further-issues.html"><i class="fa fa-check"></i><b>77</b> Further issues</a></li>
<li class="part"><span><b>X 生存分析 Survival Analysis</b></span></li>
<li class="chapter" data-level="78" data-path="surv-intro.html"><a href="surv-intro.html"><i class="fa fa-check"></i><b>78</b> 生存分析入門</a>
<ul>
<li class="chapter" data-level="78.1" data-path="surv-intro.html"><a href="surv-intro.html#本章概要"><i class="fa fa-check"></i><b>78.1</b> 本章概要</a></li>
<li class="chapter" data-level="78.2" data-path="surv-intro.html"><a href="surv-intro.html#什麼是生存分析-what-is-survival-analysis"><i class="fa fa-check"></i><b>78.2</b> 什麼是生存分析 What is survival analysis?</a></li>
<li class="chapter" data-level="78.3" data-path="surv-intro.html"><a href="surv-intro.html#生存數據在哪裏"><i class="fa fa-check"></i><b>78.3</b> 生存數據在哪裏</a></li>
<li class="chapter" data-level="78.4" data-path="surv-intro.html"><a href="surv-intro.html#生存數據分析之前要理清楚的問題"><i class="fa fa-check"></i><b>78.4</b> 生存數據分析之前要理清楚的問題</a></li>
<li class="chapter" data-level="78.5" data-path="surv-intro.html"><a href="surv-intro.html#生存數據的左右截尾"><i class="fa fa-check"></i><b>78.5</b> 生存數據的左右截尾</a>
<ul>
<li class="chapter" data-level="78.5.1" data-path="surv-intro.html"><a href="surv-intro.html#左側截尾數據-left-truncation"><i class="fa fa-check"></i><b>78.5.1</b> 左側截尾數據 left-truncation</a></li>
</ul></li>
<li class="chapter" data-level="78.6" data-path="surv-intro.html"><a href="surv-intro.html#初步分析生存數據"><i class="fa fa-check"></i><b>78.6</b> 初步分析生存數據</a></li>
<li class="chapter" data-level="78.7" data-path="surv-intro.html"><a href="surv-intro.html#初步描述生存數據"><i class="fa fa-check"></i><b>78.7</b> 初步描述生存數據</a>
<ul>
<li class="chapter" data-level="78.7.1" data-path="surv-intro.html"><a href="surv-intro.html#生存方程"><i class="fa fa-check"></i><b>78.7.1</b> 生存方程</a></li>
<li class="chapter" data-level="78.7.2" data-path="surv-intro.html"><a href="surv-intro.html#風險度方程"><i class="fa fa-check"></i><b>78.7.2</b> 風險度方程</a></li>
<li class="chapter" data-level="78.7.3" data-path="surv-intro.html"><a href="surv-intro.html#概率密度方程"><i class="fa fa-check"></i><b>78.7.3</b> 概率密度方程</a></li>
<li class="chapter" data-level="78.7.4" data-path="surv-intro.html"><a href="surv-intro.html#各方程之間的關系"><i class="fa fa-check"></i><b>78.7.4</b> 各方程之間的關系</a></li>
</ul></li>
<li class="chapter" data-level="78.8" data-path="surv-intro.html"><a href="surv-intro.html#生存時間的參數分布"><i class="fa fa-check"></i><b>78.8</b> 生存時間的參數分布</a>
<ul>
<li class="chapter" data-level="78.8.1" data-path="surv-intro.html"><a href="surv-intro.html#exponentialdist"><i class="fa fa-check"></i><b>78.8.1</b> 指數分布</a></li>
<li class="chapter" data-level="78.8.2" data-path="surv-intro.html"><a href="surv-intro.html#weibulldist"><i class="fa fa-check"></i><b>78.8.2</b> Weibull 分布</a></li>
</ul></li>
<li class="chapter" data-level="78.9" data-path="surv-intro.html"><a href="surv-intro.html#極大似然法估計"><i class="fa fa-check"></i><b>78.9</b> 極大似然法估計</a></li>
<li class="chapter" data-level="78.10" data-path="surv-intro.html"><a href="surv-intro.html#practical-survival-01"><i class="fa fa-check"></i><b>78.10</b> Practical Survival 01</a>
<ul>
<li class="chapter" data-level="78.10.1" data-path="surv-intro.html"><a href="surv-intro.html#生存分析的時間尺度"><i class="fa fa-check"></i><b>78.10.1</b> 生存分析的時間尺度</a></li>
<li class="chapter" data-level="78.10.2" data-path="surv-intro.html"><a href="surv-intro.html#擬合最簡單的指數分布生存數據"><i class="fa fa-check"></i><b>78.10.2</b> 擬合最簡單的指數分布生存數據</a></li>
<li class="chapter" data-level="78.10.3" data-path="surv-intro.html"><a href="surv-intro.html#探索服從-weibull-分布時風險度方程的曲線"><i class="fa fa-check"></i><b>78.10.3</b> 探索服從 Weibull 分布時風險度方程的曲線</a></li>
<li class="chapter" data-level="78.10.4" data-path="surv-intro.html"><a href="surv-intro.html#探索-對數邏輯-log-logistic-分布時風險度方程曲線會有哪些特性"><i class="fa fa-check"></i><b>78.10.4</b> 探索 對數邏輯 (log-logistic) 分布時，風險度方程曲線會有哪些特性？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="79" data-path="nonparametric.html"><a href="nonparametric.html"><i class="fa fa-check"></i><b>79</b> 非參數法分析生存數據</a>
<ul>
<li class="chapter" data-level="79.1" data-path="nonparametric.html"><a href="nonparametric.html#本章概要-1"><i class="fa fa-check"></i><b>79.1</b> 本章概要</a></li>
<li class="chapter" data-level="79.2" data-path="nonparametric.html"><a href="nonparametric.html#生存分析中的非參數分析法"><i class="fa fa-check"></i><b>79.2</b> 生存分析中的非參數分析法</a></li>
<li class="chapter" data-level="79.3" data-path="nonparametric.html"><a href="nonparametric.html#kaplan-meier-法分析生存方程"><i class="fa fa-check"></i><b>79.3</b> Kaplan-Meier 法分析生存方程</a>
<ul>
<li class="chapter" data-level="79.3.1" data-path="nonparametric.html"><a href="nonparametric.html#當數據中沒有刪失值"><i class="fa fa-check"></i><b>79.3.1</b> 當數據中沒有刪失值</a></li>
<li class="chapter" data-level="79.3.2" data-path="nonparametric.html"><a href="nonparametric.html#當數據中有刪失值"><i class="fa fa-check"></i><b>79.3.2</b> 當數據中有刪失值</a></li>
</ul></li>
<li class="chapter" data-level="79.4" data-path="nonparametric.html"><a href="nonparametric.html#kaplan-meier-數據的信賴區間的估計"><i class="fa fa-check"></i><b>79.4</b> Kaplan-Meier 數據的信賴區間的估計</a></li>
<li class="chapter" data-level="79.5" data-path="nonparametric.html"><a href="nonparametric.html#另一種非參數法分析-生命表格估計"><i class="fa fa-check"></i><b>79.5</b> 另一種非參數法分析 – 生命表格估計</a></li>
<li class="chapter" data-level="79.6" data-path="nonparametric.html"><a href="nonparametric.html#兩組之間生存概率的比較"><i class="fa fa-check"></i><b>79.6</b> 兩組之間生存概率的比較</a>
<ul>
<li class="chapter" data-level="79.6.1" data-path="nonparametric.html"><a href="nonparametric.html#the-log-rank-test"><i class="fa fa-check"></i><b>79.6.1</b> The log rank test</a></li>
</ul></li>
<li class="chapter" data-level="79.7" data-path="nonparametric.html"><a href="nonparametric.html#計算累積風險度-cumulative-hazard"><i class="fa fa-check"></i><b>79.7</b> 計算累積風險度 cumulative hazard</a></li>
<li class="chapter" data-level="79.8" data-path="nonparametric.html"><a href="nonparametric.html#關於非參數分析法的一些延伸"><i class="fa fa-check"></i><b>79.8</b> 關於非參數分析法的一些延伸</a></li>
<li class="chapter" data-level="79.9" data-path="nonparametric.html"><a href="nonparametric.html#practical-survival-02"><i class="fa fa-check"></i><b>79.9</b> Practical Survival 02</a>
<ul>
<li class="chapter" data-level="79.9.1" data-path="nonparametric.html"><a href="nonparametric.html#part-1-pbc-數據"><i class="fa fa-check"></i><b>79.9.1</b> Part 1: PBC 數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="80" data-path="surv-reg.html"><a href="surv-reg.html"><i class="fa fa-check"></i><b>80</b> 生存數據中的回歸模型</a>
<ul>
<li class="chapter" data-level="80.1" data-path="surv-reg.html"><a href="surv-reg.html#本章概要-2"><i class="fa fa-check"></i><b>80.1</b> 本章概要</a></li>
<li class="chapter" data-level="80.2" data-path="surv-reg.html"><a href="surv-reg.html#使用參數模型分析生存數據的目的"><i class="fa fa-check"></i><b>80.2</b> 使用參數模型分析生存數據的目的</a></li>
<li class="chapter" data-level="80.3" data-path="surv-reg.html"><a href="surv-reg.html#生存數據的似然方程"><i class="fa fa-check"></i><b>80.3</b> 生存數據的似然方程</a></li>
<li class="chapter" data-level="80.4" data-path="surv-reg.html"><a href="surv-reg.html#如何加入解釋變量"><i class="fa fa-check"></i><b>80.4</b> 如何加入解釋變量</a></li>
<li class="chapter" data-level="80.5" data-path="surv-reg.html"><a href="surv-reg.html#指數模型-exponential-model"><i class="fa fa-check"></i><b>80.5</b> 指數模型 exponential model</a></li>
<li class="chapter" data-level="80.6" data-path="surv-reg.html"><a href="surv-reg.html#weibull-分布"><i class="fa fa-check"></i><b>80.6</b> Weibull 分布</a></li>
<li class="chapter" data-level="80.7" data-path="surv-reg.html"><a href="surv-reg.html#weibull-和-指數模型的比較"><i class="fa fa-check"></i><b>80.7</b> Weibull 和 指數模型的比較</a>
<ul>
<li class="chapter" data-level="80.7.1" data-path="surv-reg.html"><a href="surv-reg.html#繪圖法"><i class="fa fa-check"></i><b>80.7.1</b> 繪圖法</a></li>
<li class="chapter" data-level="80.7.2" data-path="surv-reg.html"><a href="surv-reg.html#統計檢驗法"><i class="fa fa-check"></i><b>80.7.2</b> 統計檢驗法</a></li>
</ul></li>
<li class="chapter" data-level="80.8" data-path="surv-reg.html"><a href="surv-reg.html#拓展解釋變量類型與個數的參數模型"><i class="fa fa-check"></i><b>80.8</b> 拓展解釋變量（類型與個數）的參數模型</a>
<ul>
<li class="chapter" data-level="80.8.1" data-path="surv-reg.html"><a href="surv-reg.html#當變量是連續型時"><i class="fa fa-check"></i><b>80.8.1</b> 當變量是連續型時</a></li>
<li class="chapter" data-level="80.8.2" data-path="surv-reg.html"><a href="surv-reg.html#多於兩種類型的分類型變量"><i class="fa fa-check"></i><b>80.8.2</b> （多於兩種類型的）分類型變量</a></li>
<li class="chapter" data-level="80.8.3" data-path="surv-reg.html"><a href="surv-reg.html#當你加入了多個解釋變量時"><i class="fa fa-check"></i><b>80.8.3</b> 當你加入了多個解釋變量時</a></li>
</ul></li>
<li class="chapter" data-level="80.9" data-path="surv-reg.html"><a href="surv-reg.html#practical-survival-03"><i class="fa fa-check"></i><b>80.9</b> Practical Survival 03</a></li>
</ul></li>
<li class="chapter" data-level="81" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i><b>81</b> Cox 比例風險模型</a>
<ul>
<li class="chapter" data-level="81.1" data-path="cox.html"><a href="cox.html#本章概要-3"><i class="fa fa-check"></i><b>81.1</b> 本章概要</a></li>
<li class="chapter" data-level="81.2" data-path="cox.html"><a href="cox.html#初步介紹-cox-比例風險模型"><i class="fa fa-check"></i><b>81.2</b> 初步介紹 Cox 比例風險模型</a></li>
<li class="chapter" data-level="81.3" data-path="cox.html"><a href="cox.html#偏似然法-partial-likelihood"><i class="fa fa-check"></i><b>81.3</b> 偏似然法 (partial likelihood)</a>
<ul>
<li class="chapter" data-level="81.3.1" data-path="cox.html"><a href="cox.html#爲什麼使用-cox-回歸模型"><i class="fa fa-check"></i><b>81.3.1</b> 爲什麼使用 Cox 回歸模型？</a></li>
</ul></li>
<li class="chapter" data-level="81.4" data-path="cox.html"><a href="cox.html#處理相等的生存時間-handling-tied-survival-times"><i class="fa fa-check"></i><b>81.4</b> 處理相等的生存時間 handling tied survival times</a></li>
<li class="chapter" data-level="81.5" data-path="cox.html"><a href="cox.html#估計生存曲線"><i class="fa fa-check"></i><b>81.5</b> 估計生存曲線</a></li>
<li class="chapter" data-level="81.6" data-path="cox.html"><a href="cox.html#cox回歸模型中包涵的假設"><i class="fa fa-check"></i><b>81.6</b> Cox回歸模型中包涵的假設：</a></li>
<li class="chapter" data-level="81.7" data-path="cox.html"><a href="cox.html#評估比例風險假設-assessing-the-proportional-hazard-assumption"><i class="fa fa-check"></i><b>81.7</b> 評估比例風險假設 assessing the proportional hazard assumption</a></li>
<li class="chapter" data-level="81.8" data-path="cox.html"><a href="cox.html#該用半參數模型還是用全參數模型"><i class="fa fa-check"></i><b>81.8</b> 該用半參數模型還是用全參數模型</a></li>
<li class="chapter" data-level="81.9" data-path="cox.html"><a href="cox.html#practical-survival-04"><i class="fa fa-check"></i><b>81.9</b> Practical Survival 04</a></li>
</ul></li>
<li class="chapter" data-level="82" data-path="surv-check.html"><a href="surv-check.html"><i class="fa fa-check"></i><b>82</b> 分析策略和模型檢查 Model checking-survival analysis</a>
<ul>
<li class="chapter" data-level="82.1" data-path="surv-check.html"><a href="surv-check.html#本章概要-4"><i class="fa fa-check"></i><b>82.1</b> 本章概要</a></li>
<li class="chapter" data-level="82.2" data-path="surv-check.html"><a href="surv-check.html#生存分析策略"><i class="fa fa-check"></i><b>82.2</b> 生存分析策略</a>
<ul>
<li class="chapter" data-level="82.2.1" data-path="surv-check.html"><a href="surv-check.html#關於似然比檢驗-a-note-on-likelihood-ratio-tests"><i class="fa fa-check"></i><b>82.2.1</b> 關於似然比檢驗 A note on likelihood ratio tests</a></li>
</ul></li>
<li class="chapter" data-level="82.3" data-path="surv-check.html"><a href="surv-check.html#針對不同的研究設計不同的分析策略"><i class="fa fa-check"></i><b>82.3</b> 針對不同的研究設計不同的分析策略</a>
<ul>
<li class="chapter" data-level="82.3.1" data-path="surv-check.html"><a href="surv-check.html#針對隨機對照臨牀試驗-rct"><i class="fa fa-check"></i><b>82.3.1</b> 針對隨機對照臨牀試驗 RCT</a></li>
<li class="chapter" data-level="82.3.2" data-path="surv-check.html"><a href="surv-check.html#針對觀察型研究-observational-studies"><i class="fa fa-check"></i><b>82.3.2</b> 針對觀察型研究 observational studies</a></li>
</ul></li>
<li class="chapter" data-level="82.4" data-path="surv-check.html"><a href="surv-check.html#模型檢查的要點"><i class="fa fa-check"></i><b>82.4</b> 模型檢查的要點</a></li>
<li class="chapter" data-level="82.5" data-path="surv-check.html"><a href="surv-check.html#比例風險假設的檢查-check-the-proportional-hazard-assumtion"><i class="fa fa-check"></i><b>82.5</b> 比例風險假設的檢查 check the proportional hazard assumtion</a>
<ul>
<li class="chapter" data-level="82.5.1" data-path="surv-check.html"><a href="surv-check.html#比例風險檢查的統計檢驗法"><i class="fa fa-check"></i><b>82.5.1</b> 比例風險檢查的統計檢驗法</a></li>
<li class="chapter" data-level="82.5.2" data-path="surv-check.html"><a href="surv-check.html#用-schoenfeld-殘差繪圖"><i class="fa fa-check"></i><b>82.5.2</b> 用 Schoenfeld 殘差繪圖</a></li>
</ul></li>
<li class="chapter" data-level="82.6" data-path="surv-check.html"><a href="surv-check.html#評價模型擬合的其他有趣方法"><i class="fa fa-check"></i><b>82.6</b> 評價模型擬合的其他有趣方法</a>
<ul>
<li class="chapter" data-level="82.6.1" data-path="surv-check.html"><a href="surv-check.html#martingale-殘差-assessing-the-functional-form-of-continuous-variables"><i class="fa fa-check"></i><b>82.6.1</b> Martingale 殘差-assessing the functional form of continuous variables</a></li>
<li class="chapter" data-level="82.6.2" data-path="surv-check.html"><a href="surv-check.html#deviance-偏差殘差-identifying-individuals-for-whom-the-model-does-not-provide-a-good-fit"><i class="fa fa-check"></i><b>82.6.2</b> Deviance 偏差殘差 – identifying individuals for whom the model does not provide a good fit</a></li>
</ul></li>
<li class="chapter" data-level="82.7" data-path="surv-check.html"><a href="surv-check.html#practical-survival-05"><i class="fa fa-check"></i><b>82.7</b> Practical Survival 05</a>
<ul>
<li class="chapter" data-level="82.7.1" data-path="surv-check.html"><a href="surv-check.html#把數據讀入你最喜歡的-r-的環境中先考慮一個二進制變量-cir0-對生存的影響在建立的模型中加入該-cir0-變量和時間的交互作用項在-r-裏需要用到-tt-命令"><i class="fa fa-check"></i><b>82.7.1</b> 把數據讀入你最喜歡的 R 的環境中，先考慮一個二進制變量 <code>cir0</code> 對生存的影響。在建立的模型中加入該 <code>cir0</code> 變量和時間的交互作用項。在 R 裏需要用到 <code>tt()</code> 命令。</a></li>
<li class="chapter" data-level="82.7.2" data-path="surv-check.html"><a href="surv-check.html#繪製模型中只有-cir0-一個變量的情況下調整後的-scaled-schoenfeld-殘差圖"><i class="fa fa-check"></i><b>82.7.2</b> 繪製模型中只有 <code>cir0</code> 一個變量的情況下，調整後的 scaled Schoenfeld 殘差圖。</a></li>
<li class="chapter" data-level="82.7.3" data-path="surv-check.html"><a href="surv-check.html#另外一種探索變量-cir0-的風險度比是否隨時間保持不變的方法是可以把生存數據分割成幾個時間段分別估計每個時間段內該暴露變量的風險度比"><i class="fa fa-check"></i><b>82.7.3</b> 另外一種探索變量 <code>cir0</code> 的風險度比是否隨時間保持不變的方法是可以把生存數據分割成幾個時間段，分別估計每個時間段內該暴露變量的風險度比。</a></li>
<li class="chapter" data-level="82.7.4" data-path="surv-check.html"><a href="surv-check.html#接下來我們來看該數據集中的一個連續型變量-bil0-我們練習使用-martingale-殘差輔助我們判斷該連續型變量應該放入模型中的數學函數形式"><i class="fa fa-check"></i><b>82.7.4</b> 接下來我們來看該數據集中的一個連續型變量， <code>bil0</code> 。我們練習使用 Martingale 殘差輔助我們判斷該連續型變量應該放入模型中的數學函數形式。</a></li>
<li class="chapter" data-level="82.7.5" data-path="surv-check.html"><a href="surv-check.html#選擇你認爲應該對-bil0-進行的數學函數形式使用-scaled-schoenfeld-殘差檢查它是否違反比例風險假設"><i class="fa fa-check"></i><b>82.7.5</b> 選擇你認爲應該對 <code>bil0</code> 進行的數學函數形式，使用 Scaled Schoenfeld 殘差檢查它是否違反比例風險假設。</a></li>
<li class="chapter" data-level="82.7.6" data-path="surv-check.html"><a href="surv-check.html#建立一個含有如下解釋變量的-cox-比例風險回歸模型轉換過後的bil0-cir0cenc0-age"><i class="fa fa-check"></i><b>82.7.6</b> 建立一個含有如下解釋變量的 Cox 比例風險回歸模型：轉換過後的<code>bil0</code>, <code>cir0</code>，<code>cenc0</code>, <code>Age</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="83" data-path="competing-risk.html"><a href="competing-risk.html"><i class="fa fa-check"></i><b>83</b> 競爭風險模型 competing risk</a>
<ul>
<li class="chapter" data-level="83.1" data-path="competing-risk.html"><a href="competing-risk.html#cause-specific-hazard"><i class="fa fa-check"></i><b>83.1</b> Cause-specific hazard</a>
<ul>
<li class="chapter" data-level="83.1.1" data-path="competing-risk.html"><a href="competing-risk.html#cause-specific-hazards-models"><i class="fa fa-check"></i><b>83.1.1</b> Cause-specific hazards models</a></li>
</ul></li>
<li class="chapter" data-level="83.2" data-path="competing-risk.html"><a href="competing-risk.html#cumulative-incidence-function"><i class="fa fa-check"></i><b>83.2</b> Cumulative incidence function</a></li>
<li class="chapter" data-level="83.3" data-path="competing-risk.html"><a href="competing-risk.html#subdistribution-hazard---fine-and-gray-model"><i class="fa fa-check"></i><b>83.3</b> Subdistribution hazard - Fine and Gray model</a>
<ul>
<li class="chapter" data-level="83.3.1" data-path="competing-risk.html"><a href="competing-risk.html#subdistribution-hazard-model"><i class="fa fa-check"></i><b>83.3.1</b> Subdistribution hazard model</a></li>
</ul></li>
<li class="chapter" data-level="83.4" data-path="competing-risk.html"><a href="competing-risk.html#multi-state-models"><i class="fa fa-check"></i><b>83.4</b> Multi-state models</a>
<ul>
<li class="chapter" data-level="83.4.1" data-path="competing-risk.html"><a href="competing-risk.html#the-markov-model"><i class="fa fa-check"></i><b>83.4.1</b> The Markov model</a></li>
<li class="chapter" data-level="83.4.2" data-path="competing-risk.html"><a href="competing-risk.html#cox-proportional-hazards-model-for-transition-intensities"><i class="fa fa-check"></i><b>83.4.2</b> Cox proportional hazards model for transition intensities</a></li>
</ul></li>
<li class="chapter" data-level="83.5" data-path="competing-risk.html"><a href="competing-risk.html#practical-survival-06"><i class="fa fa-check"></i><b>83.5</b> Practical Survival 06</a></li>
</ul></li>
<li class="chapter" data-level="84" data-path="other-surv.html"><a href="other-surv.html"><i class="fa fa-check"></i><b>84</b> 生存分析的其他手段</a>
<ul>
<li class="chapter" data-level="84.1" data-path="other-surv.html"><a href="other-surv.html#分層cox生存分析-stratified-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>84.1</b> 分層Cox生存分析 stratified Cox proportional hazards model</a></li>
<li class="chapter" data-level="84.2" data-path="other-surv.html"><a href="other-surv.html#加速失效死亡模型-accelerated-failure-time-aft-model"><i class="fa fa-check"></i><b>84.2</b> 加速失效(死亡)模型 Accelerated failure time (AFT) model</a>
<ul>
<li class="chapter" data-level="84.2.1" data-path="other-surv.html"><a href="other-surv.html#詳細推導"><i class="fa fa-check"></i><b>84.2.1</b> 詳細推導</a></li>
<li class="chapter" data-level="84.2.2" data-path="other-surv.html"><a href="other-surv.html#再詳細推導"><i class="fa fa-check"></i><b>84.2.2</b> 再詳細推導</a></li>
<li class="chapter" data-level="84.2.3" data-path="other-surv.html"><a href="other-surv.html#風險比例模型ph和加速失效死亡模型aft的比較"><i class="fa fa-check"></i><b>84.2.3</b> 風險比例模型(PH)和加速失效（死亡）模型(AFT)的比較</a></li>
<li class="chapter" data-level="84.2.4" data-path="other-surv.html"><a href="other-surv.html#weibull-模型也是一種-aft-模型"><i class="fa fa-check"></i><b>84.2.4</b> Weibull 模型也是一種 AFT 模型</a></li>
</ul></li>
<li class="chapter" data-level="84.3" data-path="other-surv.html"><a href="other-surv.html#practical-survival-07"><i class="fa fa-check"></i><b>84.3</b> Practical Survival 07</a></li>
</ul></li>
<li class="chapter" data-level="85" data-path="time-dep.html"><a href="time-dep.html"><i class="fa fa-check"></i><b>85</b> 時間依存變量 Time-dependent variables 和脆弱模型 frailty model</a>
<ul>
<li class="chapter" data-level="85.1" data-path="time-dep.html"><a href="time-dep.html#時間依存變量指的是什麼"><i class="fa fa-check"></i><b>85.1</b> 時間依存變量指的是什麼</a></li>
<li class="chapter" data-level="85.2" data-path="time-dep.html"><a href="time-dep.html#extended-cox-model-把cox模型擴展開去"><i class="fa fa-check"></i><b>85.2</b> Extended Cox model 把Cox模型擴展開去</a></li>
<li class="chapter" data-level="85.3" data-path="time-dep.html"><a href="time-dep.html#時間依存變量數據的結構"><i class="fa fa-check"></i><b>85.3</b> 時間依存變量數據的結構</a>
<ul>
<li class="chapter" data-level="85.3.1" data-path="time-dep.html"><a href="time-dep.html#值得注意的點"><i class="fa fa-check"></i><b>85.3.1</b> 值得注意的點</a></li>
</ul></li>
<li class="chapter" data-level="85.4" data-path="time-dep.html"><a href="time-dep.html#frailty-models-脆弱模型"><i class="fa fa-check"></i><b>85.4</b> Frailty Models (脆弱模型?)</a>
<ul>
<li class="chapter" data-level="85.4.1" data-path="time-dep.html"><a href="time-dep.html#individual-frailty-model"><i class="fa fa-check"></i><b>85.4.1</b> Individual frailty model</a></li>
<li class="chapter" data-level="85.4.2" data-path="time-dep.html"><a href="time-dep.html#application-to-a-weibull-model"><i class="fa fa-check"></i><b>85.4.2</b> Application to a Weibull model</a></li>
<li class="chapter" data-level="85.4.3" data-path="time-dep.html"><a href="time-dep.html#shared-frailty-model"><i class="fa fa-check"></i><b>85.4.3</b> Shared frailty model</a></li>
</ul></li>
<li class="chapter" data-level="85.5" data-path="time-dep.html"><a href="time-dep.html#practical-survival-08"><i class="fa fa-check"></i><b>85.5</b> Practical Survival 08</a>
<ul>
<li class="chapter" data-level="85.5.1" data-path="time-dep.html"><a href="time-dep.html#練習題-exercise-8.1"><i class="fa fa-check"></i><b>85.5.1</b> 練習題 exercise 8.1</a></li>
<li class="chapter" data-level="85.5.2" data-path="time-dep.html"><a href="time-dep.html#解答"><i class="fa fa-check"></i><b>85.5.2</b> 解答</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="86" data-path="surv-advance.html"><a href="surv-advance.html"><i class="fa fa-check"></i><b>86</b> 時間事件數據的高級分析法</a></li>
<li class="chapter" data-level="87" data-path="bayes-surv.html"><a href="bayes-surv.html"><i class="fa fa-check"></i><b>87</b> 貝葉斯生存分析 Bayesian Survival Analysis</a></li>
<li class="part"><span><b>XI 貝葉斯統計學 Bayesian Statistics</b></span></li>
<li class="chapter" data-level="88" data-path="why-bayes.html"><a href="why-bayes.html"><i class="fa fa-check"></i><b>88</b> 爲什麼我們要用貝葉斯統計學方法？</a>
<ul>
<li class="chapter" data-level="88.1" data-path="why-bayes.html"><a href="why-bayes.html#氨甲喋呤-methotrexate-在系統性硬皮病-systematic-sclerosis-ssc-中的療效"><i class="fa fa-check"></i><b>88.1</b> 氨甲喋呤 (methotrexate) 在系統性硬皮病 (systematic sclerosis, SSc) 中的療效</a>
<ul>
<li class="chapter" data-level="88.1.1" data-path="why-bayes.html"><a href="why-bayes.html#背景資料-ssc-trial"><i class="fa fa-check"></i><b>88.1.1</b> 背景資料-SSc trial</a></li>
<li class="chapter" data-level="88.1.2" data-path="why-bayes.html"><a href="why-bayes.html#概率論者分析結果"><i class="fa fa-check"></i><b>88.1.2</b> 概率論者分析結果</a></li>
<li class="chapter" data-level="88.1.3" data-path="why-bayes.html"><a href="why-bayes.html#貝葉斯統計分析結果"><i class="fa fa-check"></i><b>88.1.3</b> 貝葉斯統計分析結果</a></li>
</ul></li>
<li class="chapter" data-level="88.2" data-path="why-bayes.html"><a href="why-bayes.html#example-the-great-trial"><i class="fa fa-check"></i><b>88.2</b> Example: The GREAT trial</a>
<ul>
<li class="chapter" data-level="88.2.1" data-path="why-bayes.html"><a href="why-bayes.html#background-great-trial"><i class="fa fa-check"></i><b>88.2.1</b> Background (GREAT trial)</a></li>
<li class="chapter" data-level="88.2.2" data-path="why-bayes.html"><a href="why-bayes.html#試驗結果"><i class="fa fa-check"></i><b>88.2.2</b> 試驗結果</a></li>
<li class="chapter" data-level="88.2.3" data-path="why-bayes.html"><a href="why-bayes.html#經典統計學分析方法"><i class="fa fa-check"></i><b>88.2.3</b> 經典統計學分析方法</a></li>
<li class="chapter" data-level="88.2.4" data-path="why-bayes.html"><a href="why-bayes.html#貝葉斯統計學分析方法"><i class="fa fa-check"></i><b>88.2.4</b> 貝葉斯統計學分析方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="89" data-path="MC-estimation.html"><a href="MC-estimation.html"><i class="fa fa-check"></i><b>89</b> 蒙特卡羅估計和預測 Mente Carlo estimation and prediction</a>
<ul>
<li class="chapter" data-level="89.1" data-path="MC-estimation.html"><a href="MC-estimation.html#起源"><i class="fa fa-check"></i><b>89.1</b> 起源</a></li>
<li class="chapter" data-level="89.2" data-path="MC-estimation.html"><a href="MC-estimation.html#百分比的統計學推斷-inference-on-proportions"><i class="fa fa-check"></i><b>89.2</b> 百分比的統計學推斷 inference on proportions</a>
<ul>
<li class="chapter" data-level="89.2.1" data-path="MC-estimation.html"><a href="MC-estimation.html#example-new-drug"><i class="fa fa-check"></i><b>89.2.1</b> Example: New Drug</a></li>
<li class="chapter" data-level="89.2.2" data-path="MC-estimation.html"><a href="MC-estimation.html#beta-distr"><i class="fa fa-check"></i><b>89.2.2</b> Beta 分布</a></li>
<li class="chapter" data-level="89.2.3" data-path="MC-estimation.html"><a href="MC-estimation.html#作出預測"><i class="fa fa-check"></i><b>89.2.3</b> 作出預測</a></li>
<li class="chapter" data-level="89.2.4" data-path="MC-estimation.html"><a href="MC-estimation.html#example-新藥表現預測"><i class="fa fa-check"></i><b>89.2.4</b> Example: 新藥表現預測</a></li>
</ul></li>
<li class="chapter" data-level="89.3" data-path="MC-estimation.html"><a href="MC-estimation.html#蒙特卡羅估計"><i class="fa fa-check"></i><b>89.3</b> 蒙特卡羅估計</a>
<ul>
<li class="chapter" data-level="89.3.1" data-path="MC-estimation.html"><a href="MC-estimation.html#用蒙特卡羅法估計概率分佈尾側累積概率面積"><i class="fa fa-check"></i><b>89.3.1</b> 用蒙特卡羅法估計概率分佈尾側累積概率(面積)</a></li>
<li class="chapter" data-level="89.3.2" data-path="MC-estimation.html"><a href="MC-estimation.html#用蒙特卡羅法計算預測概率分佈"><i class="fa fa-check"></i><b>89.3.2</b> 用蒙特卡羅法計算預測概率分佈</a></li>
</ul></li>
<li class="chapter" data-level="89.4" data-path="MC-estimation.html"><a href="MC-estimation.html#蒙特卡羅法分析軟件-openbugs-jags"><i class="fa fa-check"></i><b>89.4</b> 蒙特卡羅法分析軟件 OpenBUGS / JAGS</a>
<ul>
<li class="chapter" data-level="89.4.1" data-path="MC-estimation.html"><a href="MC-estimation.html#用-jagsbugs-分析投擲硬幣數據"><i class="fa fa-check"></i><b>89.4.1</b> 用 JAGS/BUGS 分析投擲硬幣數據</a></li>
<li class="chapter" data-level="89.4.2" data-path="MC-estimation.html"><a href="MC-estimation.html#用-jags-對藥物臨牀試驗的結果做預測"><i class="fa fa-check"></i><b>89.4.2</b> 用 JAGS 對藥物臨牀試驗的結果做預測</a></li>
<li class="chapter" data-level="89.4.3" data-path="MC-estimation.html"><a href="MC-estimation.html#用蒙特卡羅法計算一個臨牀試驗的統計效能-allow-uncertainty-in-power-calculation"><i class="fa fa-check"></i><b>89.4.3</b> 用蒙特卡羅法計算一個臨牀試驗的統計效能 allow uncertainty in power calculation</a></li>
</ul></li>
<li class="chapter" data-level="89.5" data-path="MC-estimation.html"><a href="MC-estimation.html#practical-bayesian-statistics-02"><i class="fa fa-check"></i><b>89.5</b> Practical Bayesian Statistics 02</a></li>
</ul></li>
<li class="chapter" data-level="90" data-path="conjugate-priors.html"><a href="conjugate-priors.html"><i class="fa fa-check"></i><b>90</b> 共軛先驗概率 Conjugate priors</a>
<ul>
<li class="chapter" data-level="90.1" data-path="conjugate-priors.html"><a href="conjugate-priors.html#貝葉斯推斷的基礎"><i class="fa fa-check"></i><b>90.1</b> 貝葉斯推斷的基礎</a></li>
<li class="chapter" data-level="90.2" data-path="conjugate-priors.html"><a href="conjugate-priors.html#二項分布似然數據的共軛先驗概率"><i class="fa fa-check"></i><b>90.2</b> 二項分布(似然)數據的共軛先驗概率</a>
<ul>
<li class="chapter" data-level="90.2.1" data-path="conjugate-priors.html"><a href="conjugate-priors.html#事後概率分布預測"><i class="fa fa-check"></i><b>90.2.1</b> 事後概率分布預測</a></li>
</ul></li>
<li class="chapter" data-level="90.3" data-path="conjugate-priors.html"><a href="conjugate-priors.html#正態分布似然數據的共軛先驗概率"><i class="fa fa-check"></i><b>90.3</b> 正態分布(似然)數據的共軛先驗概率</a></li>
<li class="chapter" data-level="90.4" data-path="conjugate-priors.html"><a href="conjugate-priors.html#泊淞分布似然數據的共軛先驗概率"><i class="fa fa-check"></i><b>90.4</b> 泊淞分布(似然)數據的共軛先驗概率</a></li>
<li class="chapter" data-level="90.5" data-path="conjugate-priors.html"><a href="conjugate-priors.html#共軛先驗概率分布的總結"><i class="fa fa-check"></i><b>90.5</b> 共軛先驗概率分布的總結</a></li>
<li class="chapter" data-level="90.6" data-path="conjugate-priors.html"><a href="conjugate-priors.html#BayesPrac03"><i class="fa fa-check"></i><b>90.6</b> Practical Bayesian Statistics 03</a></li>
</ul></li>
<li class="chapter" data-level="91" data-path="MCMC-methods.html"><a href="MCMC-methods.html"><i class="fa fa-check"></i><b>91</b> 馬爾可夫鏈蒙特卡羅MCMC，圖形模型，BUGS語言</a>
<ul>
<li class="chapter" data-level="91.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#markov-chain-monte-carlo-馬爾可夫鏈蒙特卡羅算法"><i class="fa fa-check"></i><b>91.1</b> Markov Chain Monte Carlo 馬爾可夫鏈蒙特卡羅算法</a>
<ul>
<li class="chapter" data-level="91.1.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#爲什麼我們需要用計算機模擬算法simulation-methods來進行貝葉斯統計推斷"><i class="fa fa-check"></i><b>91.1.1</b> 爲什麼我們需要用計算機模擬算法(simulation methods)來進行貝葉斯統計推斷？</a></li>
<li class="chapter" data-level="91.1.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#Gibbs-sampling"><i class="fa fa-check"></i><b>91.1.2</b> 吉布斯採樣</a></li>
<li class="chapter" data-level="91.1.3" data-path="MCMC-methods.html"><a href="MCMC-methods.html#初始值-initial-values"><i class="fa fa-check"></i><b>91.1.3</b> 初始值 initial values</a></li>
</ul></li>
<li class="chapter" data-level="91.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#使用-mcmc-時需要考慮的一些問題"><i class="fa fa-check"></i><b>91.2</b> 使用 MCMC 時需要考慮的一些問題</a>
<ul>
<li class="chapter" data-level="91.2.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#收斂時間"><i class="fa fa-check"></i><b>91.2.1</b> 收斂時間</a></li>
<li class="chapter" data-level="91.2.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#模型效率-efficiency-of-mcmc"><i class="fa fa-check"></i><b>91.2.2</b> 模型效率 efficiency of MCMC</a></li>
</ul></li>
<li class="chapter" data-level="91.3" data-path="MCMC-methods.html"><a href="MCMC-methods.html#bugs-軟件"><i class="fa fa-check"></i><b>91.3</b> BUGS 軟件</a></li>
<li class="chapter" data-level="91.4" data-path="MCMC-methods.html"><a href="MCMC-methods.html#圖形模型-statistical-graphical-models---directed-acyclic-graphs-dags"><i class="fa fa-check"></i><b>91.4</b> 圖形模型 statistical graphical models - Directed Acyclic Graphs (DAGs)</a>
<ul>
<li class="chapter" data-level="91.4.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#條件獨立的概念-conditional-independence-concept"><i class="fa fa-check"></i><b>91.4.1</b> 條件獨立的概念 conditional independence concept</a></li>
</ul></li>
<li class="chapter" data-level="91.5" data-path="MCMC-methods.html"><a href="MCMC-methods.html#bugs-language"><i class="fa fa-check"></i><b>91.5</b> BUGS language</a>
<ul>
<li class="chapter" data-level="91.5.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#節點的種類-types-of-nodes"><i class="fa fa-check"></i><b>91.5.1</b> 節點的種類 types of nodes</a></li>
<li class="chapter" data-level="91.5.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#分布的標記法"><i class="fa fa-check"></i><b>91.5.2</b> 分布的標記法</a></li>
<li class="chapter" data-level="91.5.3" data-path="MCMC-methods.html"><a href="MCMC-methods.html#arrays-and-loops"><i class="fa fa-check"></i><b>91.5.3</b> Arrays and loops</a></li>
<li class="chapter" data-level="91.5.4" data-path="MCMC-methods.html"><a href="MCMC-methods.html#常用的方程"><i class="fa fa-check"></i><b>91.5.4</b> 常用的方程</a></li>
</ul></li>
<li class="chapter" data-level="91.6" data-path="MCMC-methods.html"><a href="MCMC-methods.html#爲bugs-model模型準備格式正確的數據"><i class="fa fa-check"></i><b>91.6</b> 爲BUGS model模型準備格式正確的數據</a></li>
<li class="chapter" data-level="91.7" data-path="MCMC-methods.html"><a href="MCMC-methods.html#practical-bayesian-statistics-04"><i class="fa fa-check"></i><b>91.7</b> Practical Bayesian Statistics 04</a></li>
</ul></li>
<li class="chapter" data-level="92" data-path="Bayes-check.html"><a href="Bayes-check.html"><i class="fa fa-check"></i><b>92</b> 建模和模型的檢查</a>
<ul>
<li class="chapter" data-level="92.1" data-path="Bayes-check.html"><a href="Bayes-check.html#BayesianLM"><i class="fa fa-check"></i><b>92.1</b> 簡單線性回歸模型</a></li>
<li class="chapter" data-level="92.2" data-path="Bayes-check.html"><a href="Bayes-check.html#children-in-the-gambia"><i class="fa fa-check"></i><b>92.2</b> Children in the Gambia</a>
<ul>
<li class="chapter" data-level="92.2.1" data-path="Bayes-check.html"><a href="Bayes-check.html#岡比亞兒童數據模型"><i class="fa fa-check"></i><b>92.2.1</b> 岡比亞兒童數據模型</a></li>
<li class="chapter" data-level="92.2.2" data-path="Bayes-check.html"><a href="Bayes-check.html#bugs-model-for-gambia-example"><i class="fa fa-check"></i><b>92.2.2</b> BUGS model for Gambia example</a></li>
<li class="chapter" data-level="92.2.3" data-path="Bayes-check.html"><a href="Bayes-check.html#data-file-for-the-gambia-example"><i class="fa fa-check"></i><b>92.2.3</b> Data file for the Gambia example</a></li>
<li class="chapter" data-level="92.2.4" data-path="Bayes-check.html"><a href="Bayes-check.html#初始值文件-initial-value-files"><i class="fa fa-check"></i><b>92.2.4</b> 初始值文件 initial value files</a></li>
<li class="chapter" data-level="92.2.5" data-path="Bayes-check.html"><a href="Bayes-check.html#給岡比亞兒童體重數據的貝葉斯模型檢查收斂-mcmc-check-1"><i class="fa fa-check"></i><b>92.2.5</b> 給岡比亞兒童體重數據的貝葉斯模型檢查收斂 (MCMC check 1)</a></li>
<li class="chapter" data-level="92.2.6" data-path="Bayes-check.html"><a href="Bayes-check.html#岡比亞兒童體重數據的貝葉斯統計學推斷結果"><i class="fa fa-check"></i><b>92.2.6</b> 岡比亞兒童體重數據的貝葉斯統計學推斷結果</a></li>
<li class="chapter" data-level="92.2.7" data-path="Bayes-check.html"><a href="Bayes-check.html#檢查岡比亞兒童體重數據貝葉斯模型的有效樣本量-effective-sample-size-mcmc-check-2"><i class="fa fa-check"></i><b>92.2.7</b> 檢查岡比亞兒童體重數據貝葉斯模型的有效樣本量 effective sample size (MCMC check 2)</a></li>
<li class="chapter" data-level="92.2.8" data-path="Bayes-check.html"><a href="Bayes-check.html#檢查模型擬合程度-checking-model-fit-for-the-gambia-example"><i class="fa fa-check"></i><b>92.2.8</b> 檢查模型擬合程度 checking model fit for the Gambia example</a></li>
<li class="chapter" data-level="92.2.9" data-path="Bayes-check.html"><a href="Bayes-check.html#tdreplacegaussian"><i class="fa fa-check"></i><b>92.2.9</b> 其他的替代模型 alternative model with t-errors</a></li>
</ul></li>
<li class="chapter" data-level="92.3" data-path="Bayes-check.html"><a href="Bayes-check.html#貝葉斯統計模型的比較-bayesian-model-comparison"><i class="fa fa-check"></i><b>92.3</b> 貝葉斯統計模型的比較 Bayesian model comparison</a>
<ul>
<li class="chapter" data-level="92.3.1" data-path="Bayes-check.html"><a href="Bayes-check.html#deviance-information-criterion-dic"><i class="fa fa-check"></i><b>92.3.1</b> Deviance Information Criterion (DIC)</a></li>
<li class="chapter" data-level="92.3.2" data-path="Bayes-check.html"><a href="Bayes-check.html#岡比亞兒童體重數據模型比較"><i class="fa fa-check"></i><b>92.3.2</b> 岡比亞兒童體重數據模型比較</a></li>
</ul></li>
<li class="chapter" data-level="92.4" data-path="Bayes-check.html"><a href="Bayes-check.html#practical-bayesian-statistics-05"><i class="fa fa-check"></i><b>92.4</b> Practical Bayesian Statistics 05</a>
<ul>
<li class="chapter" data-level="92.4.1" data-path="Bayes-check.html"><a href="Bayes-check.html#增加年齡二次方項-adding-age-squared"><i class="fa fa-check"></i><b>92.4.1</b> 增加年齡二次方項 adding age squared</a></li>
<li class="chapter" data-level="92.4.2" data-path="Bayes-check.html"><a href="Bayes-check.html#增加年齡和性別的交互作用項-adding-an-interaction-term"><i class="fa fa-check"></i><b>92.4.2</b> 增加年齡和性別的交互作用項 adding an interaction term</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="93" data-path="Bayes-design.html"><a href="Bayes-design.html"><i class="fa fa-check"></i><b>93</b> 不同實驗/研究設計時適用的貝葉斯模型</a>
<ul>
<li class="chapter" data-level="93.1" data-path="Bayes-design.html"><a href="Bayes-design.html#隊列研究設計時的貝葉斯模型"><i class="fa fa-check"></i><b>93.1</b> 隊列研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="93.2" data-path="Bayes-design.html"><a href="Bayes-design.html#病例對照研究設計時的貝葉斯模型"><i class="fa fa-check"></i><b>93.2</b> 病例對照研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="93.3" data-path="Bayes-design.html"><a href="Bayes-design.html#bayes-crosssectional"><i class="fa fa-check"></i><b>93.3</b> 橫斷面研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="93.4" data-path="Bayes-design.html"><a href="Bayes-design.html#把不同實驗設計的數據用貝葉斯模型連接起來"><i class="fa fa-check"></i><b>93.4</b> 把不同實驗設計的數據用貝葉斯模型連接起來</a>
<ul>
<li class="chapter" data-level="93.4.1" data-path="Bayes-design.html"><a href="Bayes-design.html#linking-sub-models-throug-common-parameters"><i class="fa fa-check"></i><b>93.4.1</b> Linking sub-models throug common parameters</a></li>
</ul></li>
<li class="chapter" data-level="93.5" data-path="Bayes-design.html"><a href="Bayes-design.html#practical-bayesian-statistics-06"><i class="fa fa-check"></i><b>93.5</b> Practical Bayesian Statistics 06</a>
<ul>
<li class="chapter" data-level="93.5.1" data-path="Bayes-design.html"><a href="Bayes-design.html#the-great-trial"><i class="fa fa-check"></i><b>93.5.1</b> The GREAT Trial</a></li>
<li class="chapter" data-level="93.5.2" data-path="Bayes-design.html"><a href="Bayes-design.html#吸煙與癌症"><i class="fa fa-check"></i><b>93.5.2</b> 吸煙與癌症</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="94" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html"><i class="fa fa-check"></i><b>94</b> 貝葉斯廣義線性回歸</a>
<ul>
<li class="chapter" data-level="94.1" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#如何在bugs語言中描述分類型變量"><i class="fa fa-check"></i><b>94.1</b> 如何在BUGS語言中描述分類型變量</a>
<ul>
<li class="chapter" data-level="94.1.1" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#啞變量的數據矩陣"><i class="fa fa-check"></i><b>94.1.1</b> 啞變量的數據矩陣</a></li>
<li class="chapter" data-level="94.1.2" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#雙重索引bugs語言標記法"><i class="fa fa-check"></i><b>94.1.2</b> 雙重索引BUGS語言標記法</a></li>
</ul></li>
<li class="chapter" data-level="94.2" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#邏輯回歸-bayesian-logistic-regression"><i class="fa fa-check"></i><b>94.2</b> 邏輯回歸 Bayesian Logistic Regression</a>
<ul>
<li class="chapter" data-level="94.2.1" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#低出生體重數據-1"><i class="fa fa-check"></i><b>94.2.1</b> 低出生體重數據</a></li>
</ul></li>
<li class="chapter" data-level="94.3" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#貝葉斯泊鬆回歸-bayesian-poisson-regression"><i class="fa fa-check"></i><b>94.3</b> 貝葉斯泊鬆回歸 Bayesian Poisson Regression</a></li>
<li class="chapter" data-level="94.4" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#glm-in-a-bayesian-way"><i class="fa fa-check"></i><b>94.4</b> GLM in a Bayesian way</a></li>
<li class="chapter" data-level="94.5" data-path="Bayes-GLM.html"><a href="Bayes-GLM.html#Bayesian-practical07"><i class="fa fa-check"></i><b>94.5</b> Practical Bayesian Statistics 07</a></li>
</ul></li>
<li class="chapter" data-level="95" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html"><i class="fa fa-check"></i><b>95</b> 貝葉斯等級回歸模型</a>
<ul>
<li class="chapter" data-level="95.1" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#關於等級迴歸模型"><i class="fa fa-check"></i><b>95.1</b> 關於等級迴歸模型</a></li>
<li class="chapter" data-level="95.2" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#多層數據在模型中可能要用到的前提條件"><i class="fa fa-check"></i><b>95.2</b> 多層數據在模型中可能要用到的前提條件</a>
<ul>
<li class="chapter" data-level="95.2.1" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#參數是相同的-identical-parameters"><i class="fa fa-check"></i><b>95.2.1</b> 參數是相同的 (identical parameters)</a></li>
<li class="chapter" data-level="95.2.2" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#參數是獨立的-independent-parameters"><i class="fa fa-check"></i><b>95.2.2</b> 參數是獨立的 (independent parameters)</a></li>
<li class="chapter" data-level="95.2.3" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#參數是可交換的-exchangeable-parameters"><i class="fa fa-check"></i><b>95.2.3</b> 參數是可交換的 (exchangeable parameters)</a></li>
</ul></li>
<li class="chapter" data-level="95.3" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#抗抑鬱臨牀試驗實例"><i class="fa fa-check"></i><b>95.3</b> 抗抑鬱臨牀試驗實例</a>
<ul>
<li class="chapter" data-level="95.3.1" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#縱向數據"><i class="fa fa-check"></i><b>95.3.1</b> 縱向數據</a></li>
<li class="chapter" data-level="95.3.2" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#hamd-example"><i class="fa fa-check"></i><b>95.3.2</b> HAMD example</a></li>
<li class="chapter" data-level="95.3.3" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#貝葉斯簡單線性迴歸模型"><i class="fa fa-check"></i><b>95.3.3</b> 貝葉斯簡單線性迴歸模型</a></li>
<li class="chapter" data-level="95.3.4" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#貝葉斯等級線性回歸隨機截距模型"><i class="fa fa-check"></i><b>95.3.4</b> 貝葉斯等級線性回歸–隨機截距模型</a></li>
<li class="chapter" data-level="95.3.5" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#貝葉斯等級線性回歸模型隨機截距和隨機斜率模型"><i class="fa fa-check"></i><b>95.3.5</b> 貝葉斯等級線性回歸模型–隨機截距和隨機斜率模型</a></li>
<li class="chapter" data-level="95.3.6" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#hamd-數據不同模型結果的比較"><i class="fa fa-check"></i><b>95.3.6</b> HAMD 數據不同模型結果的比較</a></li>
<li class="chapter" data-level="95.3.7" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#hamd-數據實例結果的解釋"><i class="fa fa-check"></i><b>95.3.7</b> HAMD 數據實例結果的解釋</a></li>
</ul></li>
<li class="chapter" data-level="95.4" data-path="Bayes-Hier.html"><a href="Bayes-Hier.html#practical-bayesian-statistics-08"><i class="fa fa-check"></i><b>95.4</b> Practical Bayesian Statistics 08</a></li>
</ul></li>
<li class="chapter" data-level="96" data-path="MCMC-revisit.html"><a href="MCMC-revisit.html"><i class="fa fa-check"></i><b>96</b> 再訪 MCMC</a>
<ul>
<li class="chapter" data-level="96.1" data-path="MCMC-revisit.html"><a href="MCMC-revisit.html#metropolis-hastings-algorithm"><i class="fa fa-check"></i><b>96.1</b> Metropolis-Hastings algorithm</a></li>
<li class="chapter" data-level="96.2" data-path="MCMC-revisit.html"><a href="MCMC-revisit.html#適應階段-adaptive-phase"><i class="fa fa-check"></i><b>96.2</b> 適應階段 adaptive phase</a></li>
</ul></li>
<li class="chapter" data-level="97" data-path="compare-Bayes-freq.html"><a href="compare-Bayes-freq.html"><i class="fa fa-check"></i><b>97</b> 貝葉斯和概率論的比較</a>
<ul>
<li class="chapter" data-level="97.1" data-path="compare-Bayes-freq.html"><a href="compare-Bayes-freq.html#兩種方法的不同點總覽"><i class="fa fa-check"></i><b>97.1</b> 兩種方法的不同點總覽</a></li>
<li class="chapter" data-level="97.2" data-path="compare-Bayes-freq.html"><a href="compare-Bayes-freq.html#亞組分析-subgroup-analysis"><i class="fa fa-check"></i><b>97.2</b> 亞組分析 subgroup analysis</a></li>
<li class="chapter" data-level="97.3" data-path="compare-Bayes-freq.html"><a href="compare-Bayes-freq.html#多重比較問題-multiple-comparisons"><i class="fa fa-check"></i><b>97.3</b> 多重比較問題 multiple comparisons</a></li>
</ul></li>
<li class="part"><span><b>XII 非參數貝葉斯統計 Bayesian Nonparametric Data Analysis</b></span></li>
<li class="chapter" data-level="98" data-path="nonparaBayes-intro.html"><a href="nonparaBayes-intro.html"><i class="fa fa-check"></i><b>98</b> 非參貝葉斯入門</a></li>
<li class="chapter" data-level="99" data-path="-density-estimation-dp-models.html"><a href="-density-estimation-dp-models.html"><i class="fa fa-check"></i><b>99</b> 密度估計 Density estimation - 狄雷克雷過程模型 DP models</a>
<ul>
<li class="chapter" data-level="99.1" data-path="-density-estimation-dp-models.html"><a href="-density-estimation-dp-models.html#狄雷克雷過程-dirichlet-process"><i class="fa fa-check"></i><b>99.1</b> 狄雷克雷過程 Dirichlet process</a>
<ul>
<li class="chapter" data-level="99.1.1" data-path="-density-estimation-dp-models.html"><a href="-density-estimation-dp-models.html#定義-definition"><i class="fa fa-check"></i><b>99.1.1</b> 定義 definition</a></li>
<li class="chapter" data-level="99.1.2" data-path="-density-estimation-dp-models.html"><a href="-density-estimation-dp-models.html#推導"><i class="fa fa-check"></i><b>99.1.2</b> 推導</a></li>
<li class="chapter" data-level="99.1.3" data-path="-density-estimation-dp-models.html"><a href="-density-estimation-dp-models.html#事後概率分佈和邊際分佈"><i class="fa fa-check"></i><b>99.1.3</b> 事後概率分佈和邊際分佈</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>XIII 因果推斷 Causal Inference</b></span></li>
<li class="chapter" data-level="100" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html"><i class="fa fa-check"></i><b>100</b> Causal Languages 因果推斷的語法</a>
<ul>
<li class="chapter" data-level="100.1" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#當我們在談論因果推斷的時候我們在談論什麼"><i class="fa fa-check"></i><b>100.1</b> 當我們在談論因果推斷的時候，我們在談論什麼？</a></li>
<li class="chapter" data-level="100.2" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#傳統的統計學方法"><i class="fa fa-check"></i><b>100.2</b> 傳統的統計學方法</a>
<ul>
<li class="chapter" data-level="100.2.1" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#初步分析"><i class="fa fa-check"></i><b>100.2.1</b> 初步分析</a></li>
<li class="chapter" data-level="100.2.2" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#混雜"><i class="fa fa-check"></i><b>100.2.2</b> 混雜</a></li>
<li class="chapter" data-level="100.2.3" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#以共變量爲條件-conditioning-on-covariates"><i class="fa fa-check"></i><b>100.2.3</b> 以共變量爲條件 conditioning on covariates</a></li>
</ul></li>
<li class="chapter" data-level="100.3" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#更加正規的方法"><i class="fa fa-check"></i><b>100.3</b> 更加正規的方法</a>
<ul>
<li class="chapter" data-level="100.3.1" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#因果推斷使用的語言"><i class="fa fa-check"></i><b>100.3.1</b> 因果推斷使用的語言</a></li>
<li class="chapter" data-level="100.3.2" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#因果推斷的被估計量-causal-estimands"><i class="fa fa-check"></i><b>100.3.2</b> 因果推斷的被估計量 causal estimands</a></li>
<li class="chapter" data-level="100.3.3" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#鑑定因果推斷時的前提假設-assumptions-for-identification"><i class="fa fa-check"></i><b>100.3.3</b> 鑑定因果推斷時的前提假設 assumptions for identification</a></li>
<li class="chapter" data-level="100.3.4" data-path="grama-causal-infer.html"><a href="grama-causal-infer.html#鑑定-identification"><i class="fa fa-check"></i><b>100.3.4</b> 鑑定 identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="101" data-path="graphical-models.html"><a href="graphical-models.html"><i class="fa fa-check"></i><b>101</b> Graphical Models 因果推斷的圖形模型</a>
<ul>
<li class="chapter" data-level="101.1" data-path="graphical-models.html"><a href="graphical-models.html#統計學中的有向無環圖"><i class="fa fa-check"></i><b>101.1</b> 統計學中的有向無環圖</a>
<ul>
<li class="chapter" data-level="101.1.1" data-path="graphical-models.html"><a href="graphical-models.html#dag-和條件獨立性-conditional-independence"><i class="fa fa-check"></i><b>101.1.1</b> DAG 和條件獨立性 conditional independence</a></li>
<li class="chapter" data-level="101.1.2" data-path="graphical-models.html"><a href="graphical-models.html#dag-圖的術語"><i class="fa fa-check"></i><b>101.1.2</b> DAG 圖的術語</a></li>
<li class="chapter" data-level="101.1.3" data-path="graphical-models.html"><a href="graphical-models.html#阻斷通路-blocking-paths"><i class="fa fa-check"></i><b>101.1.3</b> 阻斷通路 blocking paths</a></li>
<li class="chapter" data-level="101.1.4" data-path="graphical-models.html"><a href="graphical-models.html#以對撞因子爲條件-conditioning-on-a-collider"><i class="fa fa-check"></i><b>101.1.4</b> 以對撞因子爲條件 conditioning on a collider</a></li>
</ul></li>
<li class="chapter" data-level="101.2" data-path="graphical-models.html"><a href="graphical-models.html#以非對撞爲條件-conditioning-on-a-non-collider"><i class="fa fa-check"></i><b>101.2</b> 以非對撞爲條件 conditioning on a non-collider</a>
<ul>
<li class="chapter" data-level="101.2.1" data-path="graphical-models.html"><a href="graphical-models.html#條件的總結"><i class="fa fa-check"></i><b>101.2.1</b> 條件的總結</a></li>
<li class="chapter" data-level="101.2.2" data-path="graphical-models.html"><a href="graphical-models.html#d-分離-d-separation"><i class="fa fa-check"></i><b>101.2.2</b> D 分離 d-separation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="102" data-path="reg-cont.html"><a href="reg-cont.html"><i class="fa fa-check"></i><b>102</b> Regression Methods with continuous outcomes 結果變量爲連續型變量</a>
<ul>
<li class="chapter" data-level="102.1" data-path="reg-cont.html"><a href="reg-cont.html#用於對連續型結果變量做因果推斷的被估計量"><i class="fa fa-check"></i><b>102.1</b> 用於對連續型結果變量做因果推斷的被估計量</a></li>
<li class="chapter" data-level="102.2" data-path="reg-cont.html"><a href="reg-cont.html#鑑定-identification---revision"><i class="fa fa-check"></i><b>102.2</b> 鑑定 identification - revision</a>
<ul>
<li class="chapter" data-level="102.2.1" data-path="reg-cont.html"><a href="reg-cont.html#條件因果均差-conditional-causal-mean-difference"><i class="fa fa-check"></i><b>102.2.1</b> 條件因果均差 conditional causal mean difference</a></li>
<li class="chapter" data-level="102.2.2" data-path="reg-cont.html"><a href="reg-cont.html#簡單分類型條件變量-c-的-ace"><i class="fa fa-check"></i><b>102.2.2</b> 簡單分類型條件變量 <span class="math inline">\(C\)</span> 的 ACE</a></li>
<li class="chapter" data-level="102.2.3" data-path="reg-cont.html"><a href="reg-cont.html#簡單連續型條件變量-c-的ace"><i class="fa fa-check"></i><b>102.2.3</b> 簡單連續型條件變量 <span class="math inline">\(C\)</span> 的ACE</a></li>
</ul></li>
<li class="chapter" data-level="102.3" data-path="reg-cont.html"><a href="reg-cont.html#通過線性回歸模型來估計-ace"><i class="fa fa-check"></i><b>102.3</b> 通過線性回歸模型來估計 ACE</a>
<ul>
<li class="chapter" data-level="102.3.1" data-path="reg-cont.html"><a href="reg-cont.html#條件因果均值差"><i class="fa fa-check"></i><b>102.3.1</b> 條件因果均值差</a></li>
<li class="chapter" data-level="102.3.2" data-path="reg-cont.html"><a href="reg-cont.html#效應修正-effect-modification-和-交互作用-interaction"><i class="fa fa-check"></i><b>102.3.2</b> 效應修正 effect modification 和 交互作用 interaction</a></li>
<li class="chapter" data-level="102.3.3" data-path="reg-cont.html"><a href="reg-cont.html#分類型條件變量的平均因果效應-ace"><i class="fa fa-check"></i><b>102.3.3</b> 分類型條件變量的平均因果效應 (ACE)</a></li>
<li class="chapter" data-level="102.3.4" data-path="reg-cont.html"><a href="reg-cont.html#positivity-非零性"><i class="fa fa-check"></i><b>102.3.4</b> Positivity 非零性</a></li>
<li class="chapter" data-level="102.3.5" data-path="reg-cont.html"><a href="reg-cont.html#連續型變量的平均因果效應"><i class="fa fa-check"></i><b>102.3.5</b> 連續型變量的平均因果效應</a></li>
</ul></li>
<li class="chapter" data-level="102.4" data-path="reg-cont.html"><a href="reg-cont.html#practical03---causal-inference"><i class="fa fa-check"></i><b>102.4</b> Practical03 - causal inference</a></li>
</ul></li>
<li class="chapter" data-level="103" data-path="regre-binary.html"><a href="regre-binary.html"><i class="fa fa-check"></i><b>103</b> Regression Methods with binary outcomes 結果變量爲二進制變量</a>
<ul>
<li class="chapter" data-level="103.1" data-path="regre-binary.html"><a href="regre-binary.html#二進制結果變量的因果被估計量-causal-estimand"><i class="fa fa-check"></i><b>103.1</b> 二進制結果變量的因果被估計量 (causal estimand):</a>
<ul>
<li class="chapter" data-level="103.1.1" data-path="regre-binary.html"><a href="regre-binary.html#比值比的不可壓縮性-non-collapsibility-of-the-odds-ratio"><i class="fa fa-check"></i><b>103.1.1</b> 比值比的不可壓縮性 non-collapsibility of the odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="103.2" data-path="regre-binary.html"><a href="regre-binary.html#鑑定-identification---conditional-effects"><i class="fa fa-check"></i><b>103.2</b> 鑑定 identification - conditional effects</a></li>
<li class="chapter" data-level="103.3" data-path="regre-binary.html"><a href="regre-binary.html#鑑定-identification---marginal-effects"><i class="fa fa-check"></i><b>103.3</b> 鑑定 identification - marginal effects</a>
<ul>
<li class="chapter" data-level="103.3.1" data-path="regre-binary.html"><a href="regre-binary.html#marginal-causal-risk-difference-ace"><i class="fa fa-check"></i><b>103.3.1</b> Marginal causal risk difference (ACE)</a></li>
<li class="chapter" data-level="103.3.2" data-path="regre-binary.html"><a href="regre-binary.html#marginal-causal-log-risk-ratio"><i class="fa fa-check"></i><b>103.3.2</b> Marginal causal log risk ratio</a></li>
</ul></li>
<li class="chapter" data-level="103.4" data-path="regre-binary.html"><a href="regre-binary.html#通過邏輯回歸估計這些被估計量"><i class="fa fa-check"></i><b>103.4</b> 通過邏輯回歸估計這些被估計量</a></li>
<li class="chapter" data-level="103.5" data-path="regre-binary.html"><a href="regre-binary.html#average-causaltreatment-effect-in-the-exposedtreated-atet"><i class="fa fa-check"></i><b>103.5</b> Average causal/treatment effect in the exposed/treated (ATET)</a></li>
<li class="chapter" data-level="103.6" data-path="regre-binary.html"><a href="regre-binary.html#practical04---causal-inference"><i class="fa fa-check"></i><b>103.6</b> Practical04 - causal inference</a>
<ul>
<li class="chapter" data-level="103.6.1" data-path="regre-binary.html"><a href="regre-binary.html#在stata裡打開數據初步分析和熟悉數據"><i class="fa fa-check"></i><b>103.6.1</b> 在STATA裡打開數據，初步分析和熟悉數據</a></li>
<li class="chapter" data-level="103.6.2" data-path="regre-binary.html"><a href="regre-binary.html#用標準邏輯回歸模型分析-rfa-暴露-和-dodp-結果-之間的關係"><i class="fa fa-check"></i><b>103.6.2</b> 用標準邏輯回歸模型分析 <code>rfa</code> (暴露) 和 <code>dodp</code> (結果) 之間的關係</a></li>
<li class="chapter" data-level="103.6.3" data-path="regre-binary.html"><a href="regre-binary.html#比較上面a和b兩個邏輯回歸模型的結果你認為混雜因素對暴露和結果的關係的影響是怎樣的"><i class="fa fa-check"></i><b>103.6.3</b> 比較上面(a)和(b)兩個邏輯回歸模型的結果，你認為混雜因素對暴露和結果的關係的影響是怎樣的？</a></li>
<li class="chapter" data-level="103.6.4" data-path="regre-binary.html"><a href="regre-binary.html#在怎樣的前提假設條件下上面模型-b-可以被賦予因果關係的解釋"><i class="fa fa-check"></i><b>103.6.4</b> 在怎樣的前提假設條件下，上面模型 (b) 可以被賦予因果關係的解釋？</a></li>
<li class="chapter" data-level="103.6.5" data-path="regre-binary.html"><a href="regre-binary.html#在前面提出的所有前提假設都滿足的情況下請給模型-b-的回歸係數賦予一個因果效應的解釋"><i class="fa fa-check"></i><b>103.6.5</b> 在前面提出的所有前提假設都滿足的情況下，請給模型 (b) 的回歸係數賦予一個因果效應的解釋。</a></li>
<li class="chapter" data-level="103.6.6" data-path="regre-binary.html"><a href="regre-binary.html#用-stata-的-teffects-ra-擬合上面兩個模型"><i class="fa fa-check"></i><b>103.6.6</b> 用 STATA 的 <code>teffects ra</code> 擬合上面兩個模型</a></li>
<li class="chapter" data-level="103.6.7" data-path="regre-binary.html"><a href="regre-binary.html#在怎樣的假設前提條件下前一步擬合的模型-b-結果中的-ate-可以被賦予因果關係的解釋"><i class="fa fa-check"></i><b>103.6.7</b> 在怎樣的假設前提條件下，前一步擬合的模型 (b) 結果中的 ATE 可以被賦予因果關係的解釋？</a></li>
<li class="chapter" data-level="103.6.8" data-path="regre-binary.html"><a href="regre-binary.html#前一問和你擬合完簡單的邏輯回歸之後做的模型假設的回答有什麼不同"><i class="fa fa-check"></i><b>103.6.8</b> 前一問和你擬合完簡單的邏輯回歸之後做的模型假設的回答，有什麼不同？</a></li>
<li class="chapter" data-level="103.6.9" data-path="regre-binary.html"><a href="regre-binary.html#用因果關係語言解釋-teffects-ra-擬合的模型-b-的結果"><i class="fa fa-check"></i><b>103.6.9</b> 用因果關係語言解釋 <code>teffects ra</code> 擬合的模型 (b) 的結果</a></li>
<li class="chapter" data-level="103.6.10" data-path="regre-binary.html"><a href="regre-binary.html#如果模型中加入-age-gender-smoke-nodules-mets-duration-primary-等和預後相關但是和決定療法並不太有關係的變量結果會有什麼不同呢"><i class="fa fa-check"></i><b>103.6.10</b> 如果模型中加入 <code>age, gender, smoke, nodules, mets, duration, primary</code> 等和預後相關但是和決定療法並不太有關係的變量，結果會有什麼不同呢？</a></li>
<li class="chapter" data-level="103.6.11" data-path="regre-binary.html"><a href="regre-binary.html#如果再向模型中加入和暴露變量相關和預後沒什麼關係的變量-coag結果該怎麼解讀"><i class="fa fa-check"></i><b>103.6.11</b> 如果再向模型中加入和暴露變量相關，和預後沒什麼關係的變量 <code>coag</code>，結果該怎麼解讀？</a></li>
<li class="chapter" data-level="103.6.12" data-path="regre-binary.html"><a href="regre-binary.html#使用-atet-的選項重新擬合上面的因果效應模型解釋結果發生的變化並作出相應的結論"><i class="fa fa-check"></i><b>103.6.12</b> 使用 <code>atet</code> 的選項重新擬合上面的因果效應模型，解釋結果發生的變化，並作出相應的結論。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="104" data-path="prop-score.html"><a href="prop-score.html"><i class="fa fa-check"></i><b>104</b> Prospensity Score 傾向性評分</a>
<ul>
<li class="chapter" data-level="104.1" data-path="prop-score.html"><a href="prop-score.html#practical05---causal-inference"><i class="fa fa-check"></i><b>104.1</b> Practical05 - causal inference</a>
<ul>
<li class="chapter" data-level="104.1.1" data-path="prop-score.html"><a href="prop-score.html#初步熟悉數據內容"><i class="fa fa-check"></i><b>104.1.1</b> 初步熟悉數據內容</a></li>
<li class="chapter" data-level="104.1.2" data-path="prop-score.html"><a href="prop-score.html#把連續型變量以分類型數據的形式放入模型中"><i class="fa fa-check"></i><b>104.1.2</b> 把連續型變量以分類型數據的形式放入模型中:</a></li>
<li class="chapter" data-level="104.1.3" data-path="prop-score.html"><a href="prop-score.html#用相同的模型結構估計每個人的傾向性評分"><i class="fa fa-check"></i><b>104.1.3</b> 用相同的模型結構估計每個人的傾向性評分</a></li>
<li class="chapter" data-level="104.1.4" data-path="prop-score.html"><a href="prop-score.html#用-ps-評分來把對象分層-stratification"><i class="fa fa-check"></i><b>104.1.4</b> 用 PS 評分來把對象分層 stratification</a></li>
<li class="chapter" data-level="104.1.5" data-path="prop-score.html"><a href="prop-score.html#用配對法計算-ace"><i class="fa fa-check"></i><b>104.1.5</b> 用配對法計算 ACE</a></li>
<li class="chapter" data-level="104.1.6" data-path="prop-score.html"><a href="prop-score.html#模型校正-ps"><i class="fa fa-check"></i><b>104.1.6</b> 模型校正 PS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="105" data-path="inverse-probability-weighted-estimation-and-doubly-robust-methods.html"><a href="inverse-probability-weighted-estimation-and-doubly-robust-methods.html"><i class="fa fa-check"></i><b>105</b> Inverse probability weighted estimation and doubly robust methods</a></li>
<li class="chapter" data-level="106" data-path="causal-mediation-analysis.html"><a href="causal-mediation-analysis.html"><i class="fa fa-check"></i><b>106</b> Causal mediation analysis</a></li>
<li class="part"><span><b>XIV Statistical Methods in Epidemiology</b></span></li>
<li class="chapter" data-level="107" data-path="-crude-and-stratified-rate-ratios.html"><a href="-crude-and-stratified-rate-ratios.html"><i class="fa fa-check"></i><b>107</b> 粗率比和分層率比 Crude and stratified rate ratios</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本書由 bookdown 強力驅動</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">醫學統計學</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="single-para-model" class="section level1" number="42">
<h1><span class="header-section-number">第 42 章</span> 貝葉斯定理的應用：單一參數模型 Single-parameter models</h1>
<p>從前一章節我們可以深切體會到，貝葉斯統計是如何讓我們的先驗概率，在觀察到數據之後，更新信息，獲得事後概率 (這是一個通過數據自我學習，進化的過程)。(How a prior belief about an event can be updated, given data, to a posterior belief.)</p>
<p>所以說，在貝葉斯模型中，我們期待使用觀察數據來學習，以增加現有的對相關參數的知識和信息。本章我們把重點放在二項分佈，用二項分佈作爲單一參數模型來瞭解怎樣推導事後分佈。</p>
<div id="從二進制數據中估計概率-estimating-a-probability-from-binomial-data" class="section level2" number="42.1">
<h2><span class="header-section-number">42.1</span> 從二進制數據中估計概率 Estimating a probability from binomial data</h2>
<p>在簡單的二項分佈模型中，我們討論的目的是希望從一系列的“柏努利試驗 Bernoulli trials”的結果來估計一個未知的總體百分比 (unknown population proportion)。既 <span class="math inline">\(y_1, y_2, \dots, y_n\)</span> 的結果是 <span class="math inline">\(0,1\)</span>。所以二項分佈的採樣模型可以寫作是：</p>
<p><span class="math display">\[
p(y | \theta) = \text{Bin}(y | n, \theta) = {n \choose y}\theta^y(1- \theta)^{n -y}
\]</span></p>

<div class="example">
<span id="exm:08-intro-to-Bayes-1" class="example"><strong>Example 42.1  </strong></span><strong>估計新生兒中女嬰的比例。</strong>
</div>
<p>作為二項分佈模型最典型的應用之一，估計新生兒中男女性別的比例，也就是男嬰或者女嬰的百分比估計是長期以來茶餘飯後的話題之一。二百年前，歐洲人群中就有好事者估計過，新生兒中女嬰的比例應該是小於50%的。現在大家更加關心的其實是，有哪些因素可能會影響新生兒中女嬰的比例。如今，大多數科學界認可的歐洲人口中新生兒女嬰的比例是 0.485。</p>
<p>在這個例子中，我們定義</p>
<ul>
<li>這個未知的新生兒女嬰比例是 <span class="math inline">\(\theta\)</span>。當然可能有人不同意，或者更樂意使用男女新生兒人數比例 <span class="math inline">\(\phi = \frac{(1 - \theta)}{\theta}\)</span>，來描述這個問題，這個大同小異。</li>
<li><span class="math inline">\(y\)</span> 是新生兒中女嬰的人數。</li>
<li><span class="math inline">\(n\)</span> 是新生兒總人數。</li>
</ul>
<p>當我們決定使用二項分佈模型來模擬上述情境的數據時，我們默認了新生兒性別比例這一條件是決定性別的唯一條件，也就是說，除了這個 <span class="math inline">\(\theta\)</span> 之外，性別是完全隨機且互相獨立的（此處需要先忽略掉一胞多胎，和同一家庭因素等可能對新生兒性別造成的影響）。那麼應用了貝葉斯定理之後，我們可以推導獲得 <span class="math inline">\(\theta\)</span> 的事後概率分佈是</p>
<p><span class="math display" id="eq:betaposterior">\[
\begin{equation}
p(\theta | y) \propto \theta^y (1 - \theta)^{n - y}
\end{equation}
\tag{42.1}
\]</span></p>
<p>由於 <span class="math inline">\(n,y\)</span> 都是常數項，僅由他們構成的最前面的部分就是一個不會根據 <span class="math inline">\(\theta\)</span> 取值發生改變的部分，所以在計算事後概率分佈的事後，我們可以把這部分忽略掉，使用它的非。根據 <a href="https://distribution-explorer.github.io/continuous/beta.html">Beta 分佈的性質</a>，不難發現，公式 <a href="single-para-model.html#eq:betaposterior">(42.1)</a> 其實就是一個參數為 <span class="math inline">\(y + 1, n - y + 1\)</span> 的 Beta 分佈：</p>
<p><span class="math display" id="eq:betaposteriornew">\[
\begin{equation}
\theta | y \sim \text{Beta}(y + 1, n - y + 1)
\end{equation}
\tag{42.2}
\]</span></p>
<div id="事後概率分佈是數據和先驗概率分佈之間的妥協" class="section level3" number="42.1.1">
<h3><span class="header-section-number">42.1.1</span> 事後概率分佈是數據和先驗概率分佈之間的妥協</h3>
<p>貝葉斯推斷的過程是從先驗概率分佈 <span class="math inline">\(p(\theta)\)</span> 過渡到事後概率分佈 <span class="math inline">\(p(\theta | y)\)</span> 的過程。我們應該會很自然地認為，這先驗和事後之間的概率分佈必然存在這某種聯繫。例如，我們可能會很純粹的認為，因為事後概率分佈增加了手上數據的信息，那麼它相應地應該比先驗概率分佈不那麼分散（less variable than the prior）。這個思考過程可以通過下面的數學關係來呈現：</p>
<ul>
<li><span class="math inline">\(\theta\)</span> 的事後概率分佈的期望 <span class="math inline">\(E(\theta | y)\)</span> 和它的先驗概率分佈的期望 <span class="math inline">\(E(\theta)\)</span> 之間的關係：</li>
</ul>
<p><span class="math display" id="eq:posteriorE">\[
\begin{equation}
E(\theta) = E(E(\theta | y))
\end{equation}
\tag{42.3}
\]</span>
事後概率分佈的期望 公式<a href="single-para-model.html#eq:posteriorE">(42.3)</a> 很好理解。先驗概率分佈的 <span class="math inline">\(\theta\)</span> 均值 <span class="math inline">\(E(\theta)\)</span>，等於事後概率分佈的 <span class="math inline">\(\theta\)</span>，在所有觀察點 <span class="math inline">\(y\)</span> 時的值的平均值。</p>
<ul>
<li><span class="math inline">\(\theta\)</span> 的事後概率分佈的方差 <span class="math inline">\(\text{var}(\theta | y)\)</span> 和先驗概率分佈方差之間的關係</li>
</ul>
<p><span class="math display" id="eq:posterorvar">\[
\begin{equation}
\text{var}(\theta)  = E(\text{var}(\theta | y)) + \text{var}(E(\theta | y))
\end{equation}
\tag{42.4}
\]</span></p>
<p>方差關係的方程式 <a href="single-para-model.html#eq:posterorvar">(42.4)</a> 其實說的是先驗概率分佈的方差，在獲取了新的數據 <span class="math inline">\(y\)</span> 之後被分成了兩部分。一個是事後概率分佈本身的方差的均值 <span class="math inline">\(E(\text{var}(\theta | y))\)</span>，還有一部分是事後概率分佈均值的方差 <span class="math inline">\(\text{var}(E(\theta | y))\)</span>。</p>
<p><strong>證明方差關係的公式 <a href="single-para-model.html#eq:posterorvar">(42.4)</a></strong> 參考概率論部分期望與方差的關係 (Chapter <a href="expectation.html#expectation">3</a>)</p>
<p><span class="math display">\[
\begin{aligned}
E(\text{var}(\theta | y)) + \text{var}(E(\theta | y)) &amp; = E(E(\theta^2 | y) - (E(\theta | y))^2) + E([E(\theta | y)]^2) - [E(E(\theta | y))]^2 \\ 
&amp; = E(\theta^2) - E([E(\theta | y)]^2) +  E([E(\theta | y)]^2) - [E(\theta)]^2 \\
&amp; = E(\theta^2) - [E(\theta)]^2 \\ 
&amp; = \text{var}(\theta)
\end{aligned}
\]</span></p>
<p>理解了上述關係之後，可以說，事後概率分佈的方差總是比先驗概率分佈的方差要小一些。如果能想方設法使事後概率分佈均值的方差 <span class="math inline">\(\text{var}(E(\theta | y))\)</span> 這部分佔據更大部分，我們就能提高對 <span class="math inline">\(\theta\)</span> 的事後估計精確度。(the greater the latter variation, the more the potential for reducing our uncertainty with regard to <span class="math inline">\(\theta\)</span>).</p>
<p>這也是貝葉斯統計推斷的基本特徵之一，事後概率分佈的中心，一般是位於先驗概率分佈的中心，和觀察數據的中心之間的某個地方，它是先驗概率分佈和數據之間相互妥協的結果。</p>

<div class="example">
<span id="exm:08-intro-to-Bayes-2" class="example"><strong>Example 42.2  </strong></span><strong>估計有前置胎盤的母親生下的新生兒中女嬰的比例。</strong>
</div>
<p>一個早期來自德國的研究觀察到，980 名孕期有前置胎盤的母親生下的新生兒中，有 437 名是女嬰。那麼，如何來比較這個觀察數據和已知的，在總體人群 (general population) 中的女嬰出生比例 0.485之間的差異？</p>
<p>當先驗概率分佈使用均一分佈 (uniform distribution: <span class="math inline">\(\theta \sim \text{Beta}(a = 1, b = 1)\)</span>) 時，我們獲得的數據是 <span class="math inline">\(n = 980, y = 437\)</span>。那麼根據共軛的性質可以計算出事後概率分佈是服從另一個 Beta 分佈: <span class="math inline">\(p(\theta | y,n) = \text{Beta}(a + y, b + n - y) = \text{Beta}(438, 544)\)</span></p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="single-para-model.html#cb340-1"></a><span class="co"># 95% Credible Intervals  </span></span>
<span id="cb340-2"><a href="single-para-model.html#cb340-2"></a>L &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.025</span>, <span class="dv">438</span>, <span class="dv">544</span>)</span>
<span id="cb340-3"><a href="single-para-model.html#cb340-3"></a>U &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.975</span>, <span class="dv">438</span>, <span class="dv">544</span>)</span>
<span id="cb340-4"><a href="single-para-model.html#cb340-4"></a></span>
<span id="cb340-5"><a href="single-para-model.html#cb340-5"></a>post &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(theta) <span class="kw">dbeta</span>(theta, <span class="dv">438</span>, <span class="dv">544</span>))</span>
<span id="cb340-6"><a href="single-para-model.html#cb340-6"></a></span>
<span id="cb340-7"><a href="single-para-model.html#cb340-7"></a><span class="co"># Illustration</span></span>
<span id="cb340-8"><a href="single-para-model.html#cb340-8"></a>x1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.375</span>, <span class="fl">0.525</span>,<span class="dt">length=</span><span class="dv">10000</span>)</span>
<span id="cb340-9"><a href="single-para-model.html#cb340-9"></a>y1 &lt;-<span class="st"> </span><span class="kw">post</span>(x1)</span>
<span id="cb340-10"><a href="single-para-model.html#cb340-10"></a><span class="kw">plot</span>(x1, y1, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="op">~</span>theta, <span class="dt">ylab=</span><span class="st">&quot;Density&quot;</span>, </span>
<span id="cb340-11"><a href="single-para-model.html#cb340-11"></a>     <span class="dt">main =</span> <span class="st">&quot;Uniform prior -&gt; Posterior is Beta(438, 544)&quot;</span>,</span>
<span id="cb340-12"><a href="single-para-model.html#cb340-12"></a>     <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb340-13"><a href="single-para-model.html#cb340-13"></a><span class="kw">abline</span>(<span class="dt">v =</span> <span class="fl">0.488</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb340-14"><a href="single-para-model.html#cb340-14"></a></span>
<span id="cb340-15"><a href="single-para-model.html#cb340-15"></a><span class="kw">polygon</span>(<span class="kw">c</span>(L, x1[x1<span class="op">&gt;=</span>L <span class="op">&amp;</span><span class="st"> </span>x1<span class="op">&lt;=</span><span class="st"> </span>U], U), <span class="kw">c</span>(<span class="dv">0</span>, y1[x1<span class="op">&gt;=</span>L <span class="op">&amp;</span><span class="st"> </span>x1<span class="op">&lt;=</span>U], <span class="dv">0</span>), <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-intro-to-Bayesfig1"></span>
<img src="bookdown_files/figure-html/08-intro-to-Bayesfig1-1.png" alt="Probability of a girl given placenta previa (BDA3, p.37)." width="90%" />
<p class="caption">
圖 42.1: Probability of a girl given placenta previa (BDA3, p.37).
</p>
</div>
<p>使用 <code>ggplot2</code> 繪圖的方法如下，參考原作者的<a href="https://avehtari.github.io/BDA_R_demos/demos_ch2/demo2_1.html">代碼</a></p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="single-para-model.html#cb341-1"></a><span class="co"># seq creates evenly spaced values</span></span>
<span id="cb341-2"><a href="single-para-model.html#cb341-2"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="fl">0.375</span>, <span class="fl">0.525</span>, <span class="fl">0.001</span>)) </span>
<span id="cb341-3"><a href="single-para-model.html#cb341-3"></a>a &lt;-<span class="st"> </span><span class="dv">438</span></span>
<span id="cb341-4"><a href="single-para-model.html#cb341-4"></a>b &lt;-<span class="st"> </span><span class="dv">544</span></span>
<span id="cb341-5"><a href="single-para-model.html#cb341-5"></a><span class="co"># dbeta computes the posterior density</span></span>
<span id="cb341-6"><a href="single-para-model.html#cb341-6"></a>df1<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">dbeta</span>(df1<span class="op">$</span>theta, a, b)</span>
<span id="cb341-7"><a href="single-para-model.html#cb341-7"></a></span>
<span id="cb341-8"><a href="single-para-model.html#cb341-8"></a><span class="co">## 計算95%可信區間</span></span>
<span id="cb341-9"><a href="single-para-model.html#cb341-9"></a><span class="co"># seq creates evenly spaced values from 2.5% quantile</span></span>
<span id="cb341-10"><a href="single-para-model.html#cb341-10"></a><span class="co"># to 97.5% quantile (i.e., 95% central interval)</span></span>
<span id="cb341-11"><a href="single-para-model.html#cb341-11"></a><span class="co"># qbeta computes the value for a given quantile given parameters a and b</span></span>
<span id="cb341-12"><a href="single-para-model.html#cb341-12"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="kw">qbeta</span>(<span class="fl">0.025</span>, a, b), <span class="kw">qbeta</span>(<span class="fl">0.975</span>, a, b), <span class="dt">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb341-13"><a href="single-para-model.html#cb341-13"></a><span class="co"># compute the posterior density</span></span>
<span id="cb341-14"><a href="single-para-model.html#cb341-14"></a>df2<span class="op">$</span>p &lt;-<span class="st"> </span><span class="kw">dbeta</span>(df2<span class="op">$</span>theta, a, b)</span>
<span id="cb341-15"><a href="single-para-model.html#cb341-15"></a></span>
<span id="cb341-16"><a href="single-para-model.html#cb341-16"></a></span>
<span id="cb341-17"><a href="single-para-model.html#cb341-17"></a><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(theta, p)) <span class="op">+</span></span>
<span id="cb341-18"><a href="single-para-model.html#cb341-18"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df1) <span class="op">+</span></span>
<span id="cb341-19"><a href="single-para-model.html#cb341-19"></a><span class="st">  </span><span class="co"># Add a layer of colorized 95% posterior interval</span></span>
<span id="cb341-20"><a href="single-para-model.html#cb341-20"></a><span class="st">  </span><span class="kw">geom_area</span>(<span class="dt">data =</span> df2, <span class="kw">aes</span>(<span class="dt">fill=</span><span class="st">&#39;1&#39;</span>)) <span class="op">+</span></span>
<span id="cb341-21"><a href="single-para-model.html#cb341-21"></a><span class="st">  </span><span class="co"># Add the proportion of girl babies in general population</span></span>
<span id="cb341-22"><a href="single-para-model.html#cb341-22"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.488</span>, <span class="dt">linetype=</span><span class="st">&#39;dotted&#39;</span>) <span class="op">+</span></span>
<span id="cb341-23"><a href="single-para-model.html#cb341-23"></a><span class="st">  </span><span class="co"># Decorate the plot a little</span></span>
<span id="cb341-24"><a href="single-para-model.html#cb341-24"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&#39;Uniform prior -&gt; Posterior is Beta(438,544)&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span></span>
<span id="cb341-25"><a href="single-para-model.html#cb341-25"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb341-26"><a href="single-para-model.html#cb341-26"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="st">&#39;lightblue&#39;</span>, <span class="dt">labels =</span> <span class="st">&#39;95% posterior interval&#39;</span>) <span class="op">+</span></span>
<span id="cb341-27"><a href="single-para-model.html#cb341-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-intro-to-Bayesfig2"></span>
<img src="bookdown_files/figure-html/08-intro-to-Bayesfig2-1.png" alt="Probability of a girl given placenta previa (BDA3, p.37), same figure in ggplot format." width="90%" />
<p class="caption">
圖 42.2: Probability of a girl given placenta previa (BDA3, p.37), same figure in ggplot format.
</p>
</div>
<p>可以看到這裡我們計算獲得的事後可信區間是 [0.415, 0.477]，它的上限也低於總體人群的女嬰出生概率= 0.485。所以，應該可以認為如果有孕期有前置胎盤，女嬰出生的概率比人群水平更低。</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="single-para-model.html#cb342-1"></a>L;U</span></code></pre></div>
<pre><code>## [1] 0.41506549</code></pre>
<pre><code>## [1] 0.47719977</code></pre>
</div>
<div id="不同先驗概率分佈對事後概率分佈估計的影響" class="section level3" number="42.1.2">
<h3><span class="header-section-number">42.1.2</span> 不同先驗概率分佈對事後概率分佈估計的影響</h3>
<p>參考原作者<a href="https://avehtari.github.io/BDA_R_demos/demos_ch2/demo2_2.html">代碼</a></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="single-para-model.html#cb345-1"></a><span class="co"># Observed data: 437 girls and 543 boys</span></span>
<span id="cb345-2"><a href="single-para-model.html#cb345-2"></a>a &lt;-<span class="st"> </span><span class="dv">437</span></span>
<span id="cb345-3"><a href="single-para-model.html#cb345-3"></a>b &lt;-<span class="st"> </span><span class="dv">543</span></span>
<span id="cb345-4"><a href="single-para-model.html#cb345-4"></a></span>
<span id="cb345-5"><a href="single-para-model.html#cb345-5"></a><span class="co"># Evaluate densities at evenly spaced points between 0.375 and 0.525</span></span>
<span id="cb345-6"><a href="single-para-model.html#cb345-6"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="fl">0.375</span>, <span class="fl">0.525</span>, <span class="fl">0.001</span>))</span>
<span id="cb345-7"><a href="single-para-model.html#cb345-7"></a></span>
<span id="cb345-8"><a href="single-para-model.html#cb345-8"></a><span class="co"># Posterior with Beta(1,1), ie. uniform prior</span></span>
<span id="cb345-9"><a href="single-para-model.html#cb345-9"></a></span>
<span id="cb345-10"><a href="single-para-model.html#cb345-10"></a>df1<span class="op">$</span>pu &lt;-<span class="st"> </span><span class="kw">dbeta</span>(df1<span class="op">$</span>theta, a<span class="op">+</span><span class="dv">1</span>, b<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb345-11"><a href="single-para-model.html#cb345-11"></a></span>
<span id="cb345-12"><a href="single-para-model.html#cb345-12"></a><span class="co"># 3 different choices for priors</span></span>
<span id="cb345-13"><a href="single-para-model.html#cb345-13"></a></span>
<span id="cb345-14"><a href="single-para-model.html#cb345-14"></a><span class="co"># Beta(0.488*2,(1-0.488)*2)</span></span>
<span id="cb345-15"><a href="single-para-model.html#cb345-15"></a><span class="co"># Beta(0.488*20,(1-0.488)*20)</span></span>
<span id="cb345-16"><a href="single-para-model.html#cb345-16"></a><span class="co"># Beta(0.488*200,(1-0.488)*200)</span></span>
<span id="cb345-17"><a href="single-para-model.html#cb345-17"></a></span>
<span id="cb345-18"><a href="single-para-model.html#cb345-18"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">200</span>) <span class="co"># prior counts</span></span>
<span id="cb345-19"><a href="single-para-model.html#cb345-19"></a>apr &lt;-<span class="st"> </span><span class="fl">0.488</span> <span class="co"># prior ratio of success</span></span>
<span id="cb345-20"><a href="single-para-model.html#cb345-20"></a></span>
<span id="cb345-21"><a href="single-para-model.html#cb345-21"></a></span>
<span id="cb345-22"><a href="single-para-model.html#cb345-22"></a><span class="co"># helperf returns for given number of prior observations, prior ratio</span></span>
<span id="cb345-23"><a href="single-para-model.html#cb345-23"></a><span class="co"># of successes, number of observed successes and failures and a data</span></span>
<span id="cb345-24"><a href="single-para-model.html#cb345-24"></a><span class="co"># frame with values of theta, a new data frame with prior and posterior</span></span>
<span id="cb345-25"><a href="single-para-model.html#cb345-25"></a><span class="co"># values evaluated at points theta.</span></span>
<span id="cb345-26"><a href="single-para-model.html#cb345-26"></a>helperf &lt;-<span class="st"> </span><span class="cf">function</span>(n, apr, a, b, df)</span>
<span id="cb345-27"><a href="single-para-model.html#cb345-27"></a>  <span class="kw">cbind</span>(df, </span>
<span id="cb345-28"><a href="single-para-model.html#cb345-28"></a>        <span class="dt">pr =</span> <span class="kw">dbeta</span>(df<span class="op">$</span>theta, n<span class="op">*</span>apr, n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>apr)), </span>
<span id="cb345-29"><a href="single-para-model.html#cb345-29"></a>        <span class="dt">po =</span> <span class="kw">dbeta</span>(df<span class="op">$</span>theta, n<span class="op">*</span>apr <span class="op">+</span><span class="st"> </span>a, n<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>apr) <span class="op">+</span><span class="st"> </span>b), </span>
<span id="cb345-30"><a href="single-para-model.html#cb345-30"></a>        <span class="dt">n =</span> n)</span>
<span id="cb345-31"><a href="single-para-model.html#cb345-31"></a></span>
<span id="cb345-32"><a href="single-para-model.html#cb345-32"></a><span class="co"># lapply function over prior counts n and gather results into key-value pairs.</span></span>
<span id="cb345-33"><a href="single-para-model.html#cb345-33"></a>df2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(n, helperf, apr, a, b, df1) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># calculate posterior points</span></span>
<span id="cb345-34"><a href="single-para-model.html#cb345-34"></a><span class="st">  </span><span class="kw">do.call</span>(rbind, <span class="dt">args =</span> .) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># combine lists </span></span>
<span id="cb345-35"><a href="single-para-model.html#cb345-35"></a><span class="st">  </span><span class="kw">gather</span>(grp, p, <span class="op">-</span><span class="kw">c</span>(theta, n), <span class="dt">factor_key =</span> T)</span>
<span id="cb345-36"><a href="single-para-model.html#cb345-36"></a></span>
<span id="cb345-37"><a href="single-para-model.html#cb345-37"></a><span class="co"># add correct labels for plotting</span></span>
<span id="cb345-38"><a href="single-para-model.html#cb345-38"></a>df2<span class="op">$</span>title &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">paste0</span>(<span class="st">&#39;alpha/(alpha+beta)=0.488, alpha+beta=&#39;</span>,df2<span class="op">$</span>n))</span>
<span id="cb345-39"><a href="single-para-model.html#cb345-39"></a><span class="kw">levels</span>(df2<span class="op">$</span>grp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Posterior with unif prior&#39;</span>, <span class="st">&#39;Prior&#39;</span>, <span class="st">&#39;Posterior&#39;</span>)</span>
<span id="cb345-40"><a href="single-para-model.html#cb345-40"></a></span>
<span id="cb345-41"><a href="single-para-model.html#cb345-41"></a><span class="co"># Plot distributions</span></span>
<span id="cb345-42"><a href="single-para-model.html#cb345-42"></a></span>
<span id="cb345-43"><a href="single-para-model.html#cb345-43"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df2) <span class="op">+</span></span>
<span id="cb345-44"><a href="single-para-model.html#cb345-44"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(theta, p, <span class="dt">color =</span> grp)) <span class="op">+</span></span>
<span id="cb345-45"><a href="single-para-model.html#cb345-45"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.488</span>, <span class="dt">linetype =</span> <span class="st">&#39;dotted&#39;</span>) <span class="op">+</span></span>
<span id="cb345-46"><a href="single-para-model.html#cb345-46"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>title, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb345-47"><a href="single-para-model.html#cb345-47"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span></span>
<span id="cb345-48"><a href="single-para-model.html#cb345-48"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb345-49"><a href="single-para-model.html#cb345-49"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-intro-to-Bayesfig3"></span>
<img src="bookdown_files/figure-html/08-intro-to-Bayesfig3-1.png" alt="Probability of a girl given placenta previa (BDA3, p.37), illustrate the effect of prior and compare posteriro distributions with different parameter values for the beta prior distribution." width="90%" />
<p class="caption">
圖 42.3: Probability of a girl given placenta previa (BDA3, p.37), illustrate the effect of prior and compare posteriro distributions with different parameter values for the beta prior distribution.
</p>
</div>
<p>不難觀察到，隨著先驗概率分佈的信息量增加（越往下的圖中先驗概率分佈的樣本量越多），事後概率分佈會被先驗概率分佈帶著往先驗概率的方向（也就是上圖中的右側）走，這始終顯示了事後概率分佈是先驗概率和數據本身相互妥協的結果。</p>
</div>
<div id="從已知的事後概率分佈中採樣對採集的事後樣本數據轉換" class="section level3" number="42.1.3">
<h3><span class="header-section-number">42.1.3</span> 從已知的事後概率分佈中採樣，對採集的事後樣本數據轉換</h3>
<p>參考<a href="https://avehtari.github.io/BDA_R_demos/demos_ch2/demo2_3.html">原作者代碼</a></p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="single-para-model.html#cb346-1"></a><span class="co"># 我們從事後概率分佈 Beta(438, 544) 中採集事後樣本，存儲到向量 `theta` 中</span></span>
<span id="cb346-2"><a href="single-para-model.html#cb346-2"></a>a &lt;-<span class="st"> </span><span class="dv">438</span> </span>
<span id="cb346-3"><a href="single-para-model.html#cb346-3"></a>b &lt;-<span class="st"> </span><span class="dv">544</span> </span>
<span id="cb346-4"><a href="single-para-model.html#cb346-4"></a></span>
<span id="cb346-5"><a href="single-para-model.html#cb346-5"></a>theta &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">10000</span>, a, b)</span>
<span id="cb346-6"><a href="single-para-model.html#cb346-6"></a></span>
<span id="cb346-7"><a href="single-para-model.html#cb346-7"></a><span class="co"># 計算每一個採集樣本的比值比 odds ratio</span></span>
<span id="cb346-8"><a href="single-para-model.html#cb346-8"></a></span>
<span id="cb346-9"><a href="single-para-model.html#cb346-9"></a>phi &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta) <span class="op">/</span><span class="st"> </span>theta</span>
<span id="cb346-10"><a href="single-para-model.html#cb346-10"></a></span>
<span id="cb346-11"><a href="single-para-model.html#cb346-11"></a><span class="co"># 計算事後概率分佈樣本，及其轉換之後的比值比的的 2.5% 和 97.5% 位點估計</span></span>
<span id="cb346-12"><a href="single-para-model.html#cb346-12"></a></span>
<span id="cb346-13"><a href="single-para-model.html#cb346-13"></a>quantiles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb346-14"><a href="single-para-model.html#cb346-14"></a>thetaq &lt;-<span class="st"> </span><span class="kw">quantile</span>(theta, quantiles)</span>
<span id="cb346-15"><a href="single-para-model.html#cb346-15"></a>phiq &lt;-<span class="st"> </span><span class="kw">quantile</span>(phi, quantiles)</span>
<span id="cb346-16"><a href="single-para-model.html#cb346-16"></a></span>
<span id="cb346-17"><a href="single-para-model.html#cb346-17"></a><span class="co"># 繪製事後樣本（及轉換的比值比）的 histogram </span></span>
<span id="cb346-18"><a href="single-para-model.html#cb346-18"></a></span>
<span id="cb346-19"><a href="single-para-model.html#cb346-19"></a><span class="co"># merge the data into one data frame for plotting</span></span>
<span id="cb346-20"><a href="single-para-model.html#cb346-20"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(phi,theta) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>()</span>
<span id="cb346-21"><a href="single-para-model.html#cb346-21"></a><span class="co"># merge quantiles into one data frame for plotting</span></span>
<span id="cb346-22"><a href="single-para-model.html#cb346-22"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">phi =</span> phiq, <span class="dt">theta =</span> thetaq) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>()</span>
<span id="cb346-23"><a href="single-para-model.html#cb346-23"></a></span>
<span id="cb346-24"><a href="single-para-model.html#cb346-24"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb346-25"><a href="single-para-model.html#cb346-25"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> df1, <span class="kw">aes</span>(value), <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></span>
<span id="cb346-26"><a href="single-para-model.html#cb346-26"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> df2, <span class="kw">aes</span>(<span class="dt">xintercept =</span> value), <span class="dt">linetype =</span> <span class="st">&#39;dotted&#39;</span>) <span class="op">+</span></span>
<span id="cb346-27"><a href="single-para-model.html#cb346-27"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&#39;free_x&#39;</span>)  <span class="op">+</span></span>
<span id="cb346-28"><a href="single-para-model.html#cb346-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span></span>
<span id="cb346-29"><a href="single-para-model.html#cb346-29"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-intro-to-Bayesfig4"></span>
<img src="bookdown_files/figure-html/08-intro-to-Bayesfig4-1.png" alt="Probability of a girl given placenta previa (BDA3, p.37), simulate samples from Beta(438, 544), draw a histogram with quantiles, and do the same for a transformed variable (the odds ratio)." width="90%" />
<p class="caption">
圖 42.4: Probability of a girl given placenta previa (BDA3, p.37), simulate samples from Beta(438, 544), draw a histogram with quantiles, and do the same for a transformed variable (the odds ratio).
</p>
</div>
</div>
<div id="使用非共軛先驗概率計算事後概率分佈" class="section level3" number="42.1.4">
<h3><span class="header-section-number">42.1.4</span> 使用非共軛先驗概率計算事後概率分佈</h3>
<p>當使用非共軛先驗概率分佈時，事後概率分佈的計算就是直接用該非共軛先驗概率乘以數據的似然 (multiplying the non-conjugate prior and the likelihood at each data point)。從計算獲得的事後概率分佈中再採集樣本。</p>
<p>參考原<a href="https://avehtari.github.io/BDA_R_demos/demos_ch2/demo2_4.html">作者的代碼</a>。</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="single-para-model.html#cb347-1"></a><span class="co"># 觀察數據 (437, 543)</span></span>
<span id="cb347-2"><a href="single-para-model.html#cb347-2"></a></span>
<span id="cb347-3"><a href="single-para-model.html#cb347-3"></a>a &lt;-<span class="st"> </span><span class="dv">437</span> </span>
<span id="cb347-4"><a href="single-para-model.html#cb347-4"></a>b &lt;-<span class="st"> </span><span class="dv">543</span></span>
<span id="cb347-5"><a href="single-para-model.html#cb347-5"></a></span>
<span id="cb347-6"><a href="single-para-model.html#cb347-6"></a><span class="co"># 計算0.1~1之間相同間距(0.001)的事後概率密度（使用單一分佈Beta(1,1)作為先驗概率分佈）</span></span>
<span id="cb347-7"><a href="single-para-model.html#cb347-7"></a></span>
<span id="cb347-8"><a href="single-para-model.html#cb347-8"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.001</span>))</span>
<span id="cb347-9"><a href="single-para-model.html#cb347-9"></a>df1<span class="op">$</span>con &lt;-<span class="st"> </span><span class="kw">dbeta</span>(df1<span class="op">$</span>theta, a, b)</span>
<span id="cb347-10"><a href="single-para-model.html#cb347-10"></a></span>
<span id="cb347-11"><a href="single-para-model.html#cb347-11"></a><span class="co"># 計算離散型非共軛先驗概率分佈的數據點上的概率密度</span></span>
<span id="cb347-12"><a href="single-para-model.html#cb347-12"></a></span>
<span id="cb347-13"><a href="single-para-model.html#cb347-13"></a>pp &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(df1))</span>
<span id="cb347-14"><a href="single-para-model.html#cb347-14"></a>pi &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="fl">0.388</span>, <span class="fl">0.488</span>, <span class="fl">0.588</span>), <span class="cf">function</span>(pi) <span class="kw">which</span>(df1<span class="op">$</span>theta <span class="op">==</span><span class="st"> </span>pi))</span>
<span id="cb347-15"><a href="single-para-model.html#cb347-15"></a>pm &lt;-<span class="st"> </span><span class="dv">11</span></span>
<span id="cb347-16"><a href="single-para-model.html#cb347-16"></a>pp[pi[<span class="dv">1</span>]<span class="op">:</span>pi[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, pm, <span class="dt">length.out =</span> <span class="kw">length</span>(pi[<span class="dv">1</span>]<span class="op">:</span>pi[<span class="dv">2</span>]))</span>
<span id="cb347-17"><a href="single-para-model.html#cb347-17"></a>pp[pi[<span class="dv">3</span>]<span class="op">:</span>pi[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, pm, <span class="dt">length.out =</span> <span class="kw">length</span>(pi[<span class="dv">3</span>]<span class="op">:</span>pi[<span class="dv">2</span>]))</span>
<span id="cb347-18"><a href="single-para-model.html#cb347-18"></a></span>
<span id="cb347-19"><a href="single-para-model.html#cb347-19"></a><span class="co"># 除以概率密度總和 normalize the prior</span></span>
<span id="cb347-20"><a href="single-para-model.html#cb347-20"></a></span>
<span id="cb347-21"><a href="single-para-model.html#cb347-21"></a>df1<span class="op">$</span>nc_p &lt;-<span class="st"> </span>pp <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(pp)</span>
<span id="cb347-22"><a href="single-para-model.html#cb347-22"></a></span>
<span id="cb347-23"><a href="single-para-model.html#cb347-23"></a><span class="co"># 計算每個離散點上的非共軛事後概率分佈</span></span>
<span id="cb347-24"><a href="single-para-model.html#cb347-24"></a></span>
<span id="cb347-25"><a href="single-para-model.html#cb347-25"></a>po &lt;-<span class="st"> </span><span class="kw">dbeta</span>(df1<span class="op">$</span>theta, a, b) <span class="op">*</span><span class="st"> </span>pp</span>
<span id="cb347-26"><a href="single-para-model.html#cb347-26"></a></span>
<span id="cb347-27"><a href="single-para-model.html#cb347-27"></a><span class="co"># 除以事後概率分佈的總和 normalize the posterior</span></span>
<span id="cb347-28"><a href="single-para-model.html#cb347-28"></a></span>
<span id="cb347-29"><a href="single-para-model.html#cb347-29"></a>df1<span class="op">$</span>nc_po &lt;-<span class="st"> </span>po <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(po)</span>
<span id="cb347-30"><a href="single-para-model.html#cb347-30"></a></span>
<span id="cb347-31"><a href="single-para-model.html#cb347-31"></a><span class="co"># 繪製使用單一分佈後的事後概率，非共軛概率分佈本身，及其對應的非共軛事後概率分佈 </span></span>
<span id="cb347-32"><a href="single-para-model.html#cb347-32"></a></span>
<span id="cb347-33"><a href="single-para-model.html#cb347-33"></a><span class="co"># gather the data frame into key-value pairs</span></span>
<span id="cb347-34"><a href="single-para-model.html#cb347-34"></a><span class="co"># and change variable names for plotting</span></span>
<span id="cb347-35"><a href="single-para-model.html#cb347-35"></a>df2 &lt;-<span class="st"> </span><span class="kw">gather</span>(df1, grp, p, <span class="op">-</span>theta, <span class="dt">factor_key =</span> T) </span>
<span id="cb347-36"><a href="single-para-model.html#cb347-36"></a><span class="kw">levels</span>(df2<span class="op">$</span>grp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Posterior with uniform prior&#39;</span>,</span>
<span id="cb347-37"><a href="single-para-model.html#cb347-37"></a>                     <span class="st">&#39;Non-conjugate prior&#39;</span>, <span class="st">&#39;Non-conjugate posterior&#39;</span>)</span>
<span id="cb347-38"><a href="single-para-model.html#cb347-38"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df2) <span class="op">+</span></span>
<span id="cb347-39"><a href="single-para-model.html#cb347-39"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(theta, p)) <span class="op">+</span></span>
<span id="cb347-40"><a href="single-para-model.html#cb347-40"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>grp, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&#39;free_y&#39;</span>) <span class="op">+</span></span>
<span id="cb347-41"><a href="single-para-model.html#cb347-41"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.35</span>,<span class="fl">0.6</span>)) <span class="op">+</span></span>
<span id="cb347-42"><a href="single-para-model.html#cb347-42"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb347-43"><a href="single-para-model.html#cb347-43"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-intro-to-Bayesfig5"></span>
<img src="bookdown_files/figure-html/08-intro-to-Bayesfig5-1.png" alt="Probability of a girl given placenta previa (BDA3, p.37). Calculate the posterior distribution on a discrete grid of points by multiplying the likelihood and a non-conjugate prior at each point, and normalizing over the points." width="90%" />
<p class="caption">
圖 42.5: Probability of a girl given placenta previa (BDA3, p.37). Calculate the posterior distribution on a discrete grid of points by multiplying the likelihood and a non-conjugate prior at each point, and normalizing over the points.
</p>
</div>
<p>下面從非共軛事後概率分佈中採集樣本，使用逆累積密度函數 (inverse cdf sampling)</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="single-para-model.html#cb348-1"></a><span class="co"># 計算事後累積密度</span></span>
<span id="cb348-2"><a href="single-para-model.html#cb348-2"></a></span>
<span id="cb348-3"><a href="single-para-model.html#cb348-3"></a>df1<span class="op">$</span>cs_po &lt;-<span class="st"> </span><span class="kw">cumsum</span>(df1<span class="op">$</span>nc_po)</span>
<span id="cb348-4"><a href="single-para-model.html#cb348-4"></a></span>
<span id="cb348-5"><a href="single-para-model.html#cb348-5"></a><span class="co"># 從單一分佈中採樣 Uniform(0, 1)</span></span>
<span id="cb348-6"><a href="single-para-model.html#cb348-6"></a><span class="kw">set.seed</span>(<span class="dv">2601</span>)</span>
<span id="cb348-7"><a href="single-para-model.html#cb348-7"></a><span class="co"># runif(k) returns k uniform random numbers from interval [0,1]</span></span>
<span id="cb348-8"><a href="single-para-model.html#cb348-8"></a>r &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb348-9"><a href="single-para-model.html#cb348-9"></a></span>
<span id="cb348-10"><a href="single-para-model.html#cb348-10"></a><span class="co"># 逆累積密度函數樣本採集 inverse-cdf sampling</span></span>
<span id="cb348-11"><a href="single-para-model.html#cb348-11"></a><span class="co"># function to find the smallest value theta at which the cumulative</span></span>
<span id="cb348-12"><a href="single-para-model.html#cb348-12"></a><span class="co"># sum of the posterior densities is greater than r.</span></span>
<span id="cb348-13"><a href="single-para-model.html#cb348-13"></a>invcdf &lt;-<span class="st"> </span><span class="cf">function</span>(r, df) df<span class="op">$</span>theta[<span class="kw">sum</span>(df<span class="op">$</span>cs_po <span class="op">&lt;</span><span class="st"> </span>r) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>]</span>
<span id="cb348-14"><a href="single-para-model.html#cb348-14"></a><span class="co"># sapply function for each sample r. The returned values s are now</span></span>
<span id="cb348-15"><a href="single-para-model.html#cb348-15"></a><span class="co"># random draws from the distribution.</span></span>
<span id="cb348-16"><a href="single-para-model.html#cb348-16"></a>s &lt;-<span class="st"> </span><span class="kw">sapply</span>(r, invcdf, df1)</span>
<span id="cb348-17"><a href="single-para-model.html#cb348-17"></a></span>
<span id="cb348-18"><a href="single-para-model.html#cb348-18"></a><span class="co"># 繪製三個圖形 p1 是非共軛事後概率分佈；p2 是非共軛事後概率分佈的累積密度函數；p3 為從非共軛事後概率分佈中採集的樣本直方圖</span></span>
<span id="cb348-19"><a href="single-para-model.html#cb348-19"></a></span>
<span id="cb348-20"><a href="single-para-model.html#cb348-20"></a></span>
<span id="cb348-21"><a href="single-para-model.html#cb348-21"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df1) <span class="op">+</span></span>
<span id="cb348-22"><a href="single-para-model.html#cb348-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(theta, nc_po)) <span class="op">+</span></span>
<span id="cb348-23"><a href="single-para-model.html#cb348-23"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.35</span>, <span class="fl">0.6</span>)) <span class="op">+</span></span>
<span id="cb348-24"><a href="single-para-model.html#cb348-24"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Non-conjugate posterior&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span></span>
<span id="cb348-25"><a href="single-para-model.html#cb348-25"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>)</span>
<span id="cb348-26"><a href="single-para-model.html#cb348-26"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df1) <span class="op">+</span></span>
<span id="cb348-27"><a href="single-para-model.html#cb348-27"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(theta, cs_po)) <span class="op">+</span></span>
<span id="cb348-28"><a href="single-para-model.html#cb348-28"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.35</span>, <span class="fl">0.6</span>)) <span class="op">+</span></span>
<span id="cb348-29"><a href="single-para-model.html#cb348-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Posterior-cdf&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span></span>
<span id="cb348-30"><a href="single-para-model.html#cb348-30"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>)</span>
<span id="cb348-31"><a href="single-para-model.html#cb348-31"></a>p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb348-32"><a href="single-para-model.html#cb348-32"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(s), <span class="dt">binwidth =</span> <span class="fl">0.003</span>) <span class="op">+</span></span>
<span id="cb348-33"><a href="single-para-model.html#cb348-33"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.35</span>, <span class="fl">0.6</span>)) <span class="op">+</span></span>
<span id="cb348-34"><a href="single-para-model.html#cb348-34"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Histogram of posterior samples&#39;</span>, <span class="dt">x =</span> <span class="st">&#39;&#39;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>) <span class="op">+</span></span>
<span id="cb348-35"><a href="single-para-model.html#cb348-35"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>)</span>
<span id="cb348-36"><a href="single-para-model.html#cb348-36"></a><span class="co"># combine the plots</span></span>
<span id="cb348-37"><a href="single-para-model.html#cb348-37"></a><span class="kw">grid.arrange</span>(p1, p2, p3)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-intro-to-Bayesfig6"></span>
<img src="bookdown_files/figure-html/08-intro-to-Bayesfig6-1.png" alt="Probability of a girl given placenta previa (BDA3, p.37). Simulate samples from the resulting non-standard posterior distribution using inverse cdf and the discrete grid." width="90%" />
<p class="caption">
圖 42.6: Probability of a girl given placenta previa (BDA3, p.37). Simulate samples from the resulting non-standard posterior distribution using inverse cdf and the discrete grid.
</p>
</div>
</div>
</div>
<div id="貝葉斯理論下的事後二項分佈概率密度方程-notation-for-probability-density-functions-in-binomial-data" class="section level2" number="42.2">
<h2><span class="header-section-number">42.2</span> 貝葉斯理論下的事後二項分佈概率密度方程 notation for probability density functions in binomial data</h2>
<ul>
<li><span class="math inline">\(R\)</span> 用來表示服從一個二項分佈的隨機變量， <span class="math inline">\(R\sim \text{Bin}(n, \theta)\)</span>。</li>
<li><span class="math inline">\(r\)</span> 表示觀察到 <span class="math inline">\(r\)</span> 次成功實驗，實驗次數爲 <span class="math inline">\(n\)</span>。</li>
<li>先驗概率分佈： <span class="math inline">\(\pi_\Theta(\theta)\)</span></li>
<li>應用貝葉斯定理：</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\pi_{\Theta|R}(\theta|r) &amp;= \frac{f_R(r|\theta)\pi_\Theta(\theta)}{\int_0^1f_R(r|\theta)\pi_\Theta(\theta)\text{ d}\theta}\\
&amp;= \frac{f_R(r|\theta)\pi_\Theta(\theta)}{f_R(r)}
\end{aligned}
\]</span></p>
<p>如果我們的先驗概率分佈：</p>
<p><span class="math display">\[\begin{equation}
\pi_\Theta(\theta)=\begin{cases}
1 \text{ if } \theta=0.2\\
0 \text{ otherwise}
\end{cases}
\end{equation}\]</span></p>
<p>意思就是，我們 100% 相信 <span class="math inline">\(\theta\)</span> 絕對就等於 0.2，不相信 <span class="math inline">\(\theta\)</span> 竟然還能取任何其他值（霸道自大又狂妄的我們）。</p>
<p>如果先驗概率分佈：</p>
<p><span class="math display">\[\begin{equation}
\pi_\Theta(\theta)=\begin{cases}
0.4 \text{ if } \theta=0.2\\
0.6 \text{ if } \theta=0.7
\end{cases}
\end{equation}\]</span></p>
<p>意思就是，我們有 60% 的把握相信 <span class="math inline">\(\theta=0.7\)</span>，有 40% 的把握相信 <span class="math inline">\(\theta=0.2\)</span>，稍微傾向於 <span class="math inline">\(\theta=0.7\)</span>。</p>
<p>假設進行10次實驗，觀察到3次成功。當 <span class="math inline">\(\theta=0.2\)</span> 時，觀察數據的似然 (likelihood) 爲：</p>
<p><span class="math display">\[f_R(3|\theta=0.2)=\binom{10}{3}0.2^3(1-0.2)^7\]</span></p>
<p>當 <span class="math inline">\(\theta=0.7\)</span> 時，觀察數據的似然爲：</p>
<p><span class="math display">\[f_R(3|\theta=0.7)=\binom{10}{3}0.7^3(1-0.7)^7\]</span></p>
<p>應用貝葉斯定理計算事後概率分佈：</p>
<p><span class="math display">\[
\begin{equation}
\pi_{\Theta|R}(\theta|3)=\begin{cases}
\frac{\binom{10}{3}0.2^3(1-0.2)^7\times0.4}{\binom{10}{3}0.2^3(1-0.2)^7\times0.4+\binom{10}{3}0.7^3(1-0.7)^7\times0.6}=0.937 \text{ if } \theta=0.2\\
\frac{\binom{10}{3}0.7^3(1-0.7)^7\times0.6}{\binom{10}{3}0.7^3(1-0.7)^7\times0.6+\binom{10}{3}0.2^3(1-0.2)^7\times0.4}=0.063 \text{ if }\theta=0.7
\end{cases}
\end{equation}
\]</span></p>
<p>所以，我們從一開始認爲只有40%的把握相信 <span class="math inline">\(\theta=0.2\)</span>，觀察數據告訴我們 10 次實驗，3次獲得了成功。所以我們現在有 93.7% 的把握相信 <span class="math inline">\(\theta=0.2\)</span>。也就是說，觀察數據讓我們對參數 <span class="math inline">\(\theta\)</span> 的取值可能性發生了質的變化，從原先的傾向於 <span class="math inline">\(\theta=0.7\)</span> 到現在幾乎接近 100% 的認爲 <span class="math inline">\(\theta=0.2\)</span>。也就是，觀察數據獲得的信息改變了我們的立場。</p>
<p>上面的例子很直觀，但是有下面幾個問題：</p>
<ol style="list-style-type: decimal">
<li>如果我們無法對參數 <span class="math inline">\(\theta\)</span> 賦予先驗概率的點估計時，該怎麼辦？</li>
<li>如果事後概率不是一個離散的分佈時，該如何才能表達事後概率？</li>
</ol>
</div>
<div id="theta-的先驗概率" class="section level2" number="42.3">
<h2><span class="header-section-number">42.3</span> <span class="math inline">\(\theta\)</span> 的先驗概率</h2>
<p>一種選擇是，我們用均一分佈 (uniform distribution)，即我們對數據一無所知，認爲所有的 <span class="math inline">\(\theta\)</span> 的可能性都一樣，概率密度方程爲 <span class="math inline">\(1\)</span>。在這一情況下，先驗概率爲 1： <span class="math inline">\(\pi_\Theta(\theta)=1\)</span>，其事後概率分佈爲：</p>
<p><span class="math display" id="eq:uniformBayes">\[
\begin{equation}
\pi_{\Theta|R}(\theta|r)=\frac{\binom{n}{r}\theta^r(1-\theta)^{n-r}}{\int_0^1\binom{n}{r}\theta^r(1-\theta)^{n-r} \text{ d}\theta}
\tag{42.5}
\end{equation}
\]</span></p>
<p>看到即使在如此簡單的先驗概率下，我們還是要使用複雜的微積分進行計算。幸運的是，像 <a href="single-para-model.html#eq:uniformBayes">(42.5)</a> 的分母這樣的積分公式其實是有跡可循的。這就是 beta (<span class="math inline">\(\beta\)</span>) 分佈。</p>
<div id="beta-distribution-intro" class="section level3" number="42.3.1">
<h3><span class="header-section-number">42.3.1</span> beta 分佈 the beta distribution</h3>
<div class="figure" style="text-align: center"><span id="fig:beta-distr"></span>
<img src="bookdown_files/figure-html/beta-distr-1.png" alt="Beta distribution functions for various values of a, b" width="90%" />
<p class="caption">
圖 42.7: Beta distribution functions for various values of a, b
</p>
</div>
<p>你會發現，beta分佈的圖形特徵由它的兩個超參數 (hyperparameter) <code>a, b</code> 決定。當相對地 <code>a</code> 比較大的時候，beta分佈的概率多傾向於較靠近橫軸右邊，也就是1的位置（較高概率），相對地 <code>b</code> 比較大的時候，beta分佈的曲線多傾向於靠近橫軸左邊，也就是0的位置（較低概率）。如果 <code>a</code> 和 <code>b</code>同時都在變大的話，beta分佈的曲線就變得比較“瘦”。這樣決定概率分佈形狀的參數，又被叫做<strong>形狀參數 (shape parameters)</strong></p>
<p>我們定義 <span class="math inline">\(a&gt;0\)</span> 時<a href="https://zh.wikipedia.org/wiki/%CE%93%E5%87%BD%E6%95%B0">伽馬方程</a>爲</p>
<p><span class="math display">\[\Gamma(a)=\int_0^\infty x^{a-1}e^{-ax}\text{ d}x\]</span></p>
<p>當 <span class="math inline">\(a\)</span> 取正整數時， <span class="math inline">\(\Gamma(a)\)</span> 是 <span class="math inline">\((a-1)!\)</span>。例如，當 <span class="math inline">\(a=4, \Gamma(a)=3\times2\times1=6\)</span>。</p>
<p>對於 <span class="math inline">\(\theta\in[0,1]\)</span> 時，beta 方程 <span class="math inline">\(Beta(a,b)\)</span> 被定義爲：</p>
<p><span class="math display">\[
\begin{aligned}
\pi\Theta(\theta|a,b) &amp;= \theta^{a-1}(1-\theta)^{b-1}\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\\
&amp;= \frac{\theta^{a-1}(1-\theta)^{b-1}}{B(a,b)}
\end{aligned}
\]</span></p>
<p>其中
<span class="math display">\[B(a,b)=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)} = \int_0^1\theta^{a-1}(1-\theta)^{b-1}\text{d}\theta\]</span></p>
<p><strong>莫要混淆 B 函數和 Beta 方程。B 函數的性質和詳細定義可以參照<a href="https://zh.wikipedia.org/wiki/%CE%92%E5%87%BD%E6%95%B0">其維基百科頁面</a>。</strong></p>
<p>利用 Beta 方程作爲先驗概率顯得十分便捷且靈活。圖 <a href="single-para-model.html#fig:beta-distr">42.7</a> 展示的是 6 種不同的 <span class="math inline">\((a,b)\)</span> 取值下的先驗概率分佈示意圖。其實我們可以看到，包括均一分佈在內的各種可能性都可以通過 Beta 分佈實現。其中 <span class="math inline">\((a,b)\)</span> 被叫做超參數 (hyperparameter)。<span class="math inline">\((a,b)\)</span> 取值越大，先驗概率分佈的方差越小。</p>
<p>關於 Beta 分佈的幾個性質：</p>
<ol style="list-style-type: decimal">
<li>均值：<span class="math inline">\(\text{mean}=\frac{a}{a+b}\)</span>；</li>
<li>衆數：<span class="math inline">\(\text{mode}=\frac{a-1}{a+b-2}\)</span>；</li>
<li>方差：<span class="math inline">\(\text{variance}=\frac{ab}{(a+b)^2(a+b+1)}\)</span>。</li>
</ol>
<p>回到均一分佈的簡單例子 <a href="single-para-model.html#eq:uniformBayes">(42.5)</a> 上：</p>
<p><span class="math inline">\(\pi_\Theta(\theta)=Beta(1,1)\)</span> 是 <span class="math inline">\(\theta\in[0,1]\)</span> 上的均一分佈。所以事後概率 posterior 和下面的式子成正比：</p>
<p><span class="math display">\[\theta^r(1-\theta)^{n-r}\]</span></p>
<p>換句話說，事後概率分佈服從 <span class="math inline">\(Beta(r+1,n-r+1)\)</span> 分布，均值爲 <span class="math inline">\(\frac{r+1}{n+2}\)</span>，方差爲 <span class="math inline">\(\frac{(1+r)(n-r+1)}{(n+2)^2(n+3)}\)</span>。</p>
<p>由此可見，在貝葉斯統計思維下，先驗概率爲均一分佈的二項分佈數據，其事後概率分佈的均值和方差，和經典概率論下的極大似然估計 <span class="math inline">\(r/n\)</span> 不同，和它的漸進樣本方差 <span class="math inline">\(r(n-r)/n^3\)</span> 也不同。但是，當 <span class="math inline">\(n\)</span> 越來越大，獲得的觀察數據越多提供的信息越來越多以後，我們會發現事後概率分佈的均值和方差也會越來越趨近於經典概率論下的極大似然估計和它的方差。</p>
<p>於是這裏可以總結以下兩點：</p>
<ol style="list-style-type: decimal">
<li>即使先驗概率對參數毫無用處（不能提供有效信息，或者我們對所觀察的數據一無所知），也可能會對事後概率分佈結果提供一些意外的信息。</li>
<li>當樣本量增加，似然就主導了整個貝葉斯方程，在數學計算上，經典概率論和貝葉斯推理的估計結果將會十分接近。當然，其各自的意義還是截然不同的。</li>
</ol>
</div>
<div id="conjugate" class="section level3" number="42.3.2">
<h3><span class="header-section-number">42.3.2</span> 二項分佈數據事後概率分佈的一般化：共軛性</h3>
<p>當 <span class="math inline">\(r\sim \text{Binomial}(n,\theta)\)</span> 時，如果先驗概率 <span class="math inline">\(\pi_\Theta(\theta)=\text{Beta}(a,b)\)</span>。那麼參數 <span class="math inline">\(\theta\)</span> 的事後概率分佈的密度方程滿足：</p>
<p><span class="math display">\[\pi_{\Theta|r}(\theta|r)=\text{Beta}(a+r, b+n-r)\]</span></p>
<p>它的事後概率分佈均值爲：</p>
<p><span class="math display">\[E[\theta|r]=\frac{a+r}{a+b+n}\]</span></p>
<p>事後概率分佈的衆數爲：</p>
<p><span class="math display">\[\text{Mode}[\theta|r]=\frac{a+r-1}{n+a+b-2}\]</span></p>
<p>事後概率分佈方差爲：</p>
<p><span class="math display">\[\text{Var}[\theta|r]=\frac{(a+r)(b+n-r)}{(a+b+n)^2(a+b+n+1)}\]</span></p>
<p>因此，我們看到先驗概率服從 <span class="math inline">\(\text{Beta}(a,b)\)</span> 分佈，觀察數據爲二項分佈時，事後概率分佈還是服從 <span class="math inline">\(\text{Beta}\)</span> 分佈，僅僅只是超參數發生了轉變（更新）。這就是<strong>共軛分佈</strong>的實例。<span class="math inline">\(\text{Beta}\)</span> 分佈是二項分佈的共軛先驗概率分佈 (the <span class="math inline">\(\text{Beta}(a,b)\)</span> is the conjugate prior for the binomial likelihood)。</p>
<p>在經典概率論的框架下，參數 <span class="math inline">\(\theta\)</span> 的估計就是極大似然估計 (MLE)。在二項分佈的例子中， <span class="math inline">\(\text{MLE}=\hat\theta=r/n\)</span>，當樣本量 <span class="math inline">\(n\rightarrow\infty\)</span> 時，事後概率分佈均值：</p>
<p><span class="math display">\[E[\theta|r]=\frac{a+r}{a+b+n}=\frac{\frac{r}{n}+\frac{a}{n}}{1+\frac{a+b}{n}}\approx\frac{r}{n}=\text{MLE}\]</span></p>
<p>事後概率分佈的衆數爲：</p>
<p><span class="math display">\[
\begin{aligned}
\text{Mode}[\theta|r] &amp;=\frac{a+r-1}{n+a+b-2} \\
&amp;= \frac{\frac{r}{n}+\frac{a-1}{n}}{1+\frac{a+b-2}{n}}\\
&amp;\approx \frac{r}{n}
\end{aligned}
\]</span></p>
<p>事後概率分佈的方差爲：</p>
<p><span class="math display">\[\frac{(a+r)(b+n+r)}{(a+b+n)^2(a+b+n+1)}\approx0\]</span></p>
<p>當 <span class="math inline">\(n\)</span>，樣本越來越大時，我們獲得更多的來自數據的信息，所以來自數據的信息逐漸主導 (dominate) 了整個貝葉斯推斷的過程，事後均值等衆多統計結果都越來越趨近於概率論統計思想下的極大似然估計等結論。</p>
<p>我們也可以注意到，當 <span class="math inline">\(a\rightarrow0, b\rightarrow0\)</span> 時，事後概率分佈的均值 <span class="math inline">\(E[\theta|r] = \frac{a+r}{a+b+n} \rightarrow \frac{r}{n}\)</span>，方差也趨向於樣本漸進方差 (asymptotic sample variance)。但是當 <span class="math inline">\(a\rightarrow 0, b\rightarrow0\)</span> 時，先驗概率是沒有被定義的，可是此例下事後概率卻可以正常被定義。所以當先驗概率分佈無法被定義，或者被定義的不恰當時，事後概率分佈依然不受太大影響。所以特別是對於均值（或迴歸係數，regression coefficients）等參數，我們常常會使用均一分佈這樣的無信息先驗概率。</p>
</div>
</div>
<div id="附贈加量不加價" class="section level2" number="42.4">
<h2><span class="header-section-number">42.4</span> 附贈–加量不加價</h2>
<p><strong>當樣本數據服從二項分布時使用 <span class="math inline">\(\text{Beta}(a,b)\)</span> 作爲先驗概率分布，試推導事後概率分布。並且證明 Beta 分布是二項分布的共軛分布 (conjugate distribution)。</strong></p>
<ul>
<li><p>當數據服從二項分布時，其似然方程 (或概率方程) 爲: <br> <span class="math display">\[f(n,r|\theta) = \binom{n}{r}\theta^r(1-\theta)^{n-r}\]</span></p></li>
<li><p>用 <span class="math inline">\(\text{Beta}(a,b)\)</span> 做先驗概率分布 (<span class="math inline">\(a,b\)</span> 是 <span class="math inline">\(\theta\)</span> 的超參數)，那麼 <br></p></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\pi(\theta) &amp;= \text{Beta}(\theta|a,b) \\
&amp; =  \theta^{a-1}(1-\theta)^{b-1}\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)} \\ 
&amp; = \frac{\theta^{a-1}(1-\theta)^{b-1}}{B(a,b)} \\
\text{Where } B(a,b) &amp;=\frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)} = \int_0^1\theta^{a-1}(1-\theta)^{b-1}\text{d}\theta
\end{aligned}
\]</span></p>
<ul>
<li>利用貝葉斯定理，後概率分布就可以推導爲 <br></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
\pi(\theta|n,r) &amp; = \frac{f(n,r|\theta)\pi(\theta)}{\int f(n,r |\theta)\pi(\theta)\text{d}\theta}   \\
                &amp; = \frac{\binom{n}{r}\theta^r(1-\theta)^{n-r}\pi(\theta)}{\int_0^1\binom{n}{r}\theta^r(1-\theta)^{n-r} \pi(\theta) \text{ d}\theta} \\
                &amp; = \frac{\binom{n}{r}\theta^r(1-\theta)^{n-r}\frac{\theta^{a-1}(1-\theta)^{b-1}}{B(a,b)}}{\int_0^1\binom{n}{r}\theta^r(1-\theta)^{n-r} \frac{\theta^{a-1}(1-\theta)^{b-1}}{B(a,b)} \text{ d}\theta} \\
                &amp; = \frac{\binom{n}{r}\theta^{r+a-1}(1-\theta)^{n+b-r-1}}{\int_0^1\binom{n}{r}\theta^{r+a-1}(1-\theta)^{n+b-r-1} \text{ d}\theta} \\
                &amp; = \frac{\theta^{r+a-1}(1-\theta)^{n+b-r-1}}{B(r+a, n+b-r)} \\
                &amp; \sim \text{Beta}(r+a, n+b-r)
\end{aligned}
\]</span>
這個推導的結果告訴我們，先驗概率 <span class="math inline">\(\pi(\theta) = \frac{\theta^{a-1}(1-\theta)^{b-1}}{B(a,b)}\sim \text{Beta}(a,b)\)</span>，通過和二項分布的似然方程相乘，獲得後驗概率 <span class="math inline">\(\pi(\theta|n,r) = \frac{\theta^{r+a-1}(1-\theta)^{n+b-r-1}}{B(r+a, n+b-r)}\sim\text{Beta}(r+a, n+b-r)\)</span>。這兩個概率都服從 <span class="math inline">\(\text{Beta}\)</span> 分布，也就是證明了 <span class="math inline">\(\text{Beta}\)</span> 分布，是二項分布的共軛分布。新產生的事後概率的性質有: <br></p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\theta\)</span> 的均值 mean <span class="math inline">\(\mu= \frac{a+r}{a+b+n}\)</span>;</li>
<li><span class="math inline">\(\theta\)</span> 的方差 variance <span class="math inline">\(\sigma^2 = \frac{(a+r)(n+b-r)}{(a+b+n)^2(a+b+n+1)}\)</span>;</li>
</ol>
</div>
<div id="practical-intro-to-bayes-02" class="section level2" number="42.5">
<h2><span class="header-section-number">42.5</span> Practical Intro-to-Bayes 02</h2>
<div id="q1-4" class="section level3" number="42.5.1">
<h3><span class="header-section-number">42.5.1</span> Q1</h3>
<p>當先驗概率分佈服從 <span class="math inline">\(\text{Beta}(0.5,0.5)\)</span>，觀察數據記錄到 <span class="math inline">\(5\)</span> 個患者中 <span class="math inline">\(3\)</span> 人死亡的事件。
試求：
死亡發生概率 <span class="math inline">\(\theta\)</span> 的 95% 可信區間 (credible intervals)。</p>
<p><strong>解</strong></p>
<p>根據 Section <a href="single-para-model.html#conjugate">42.3.2</a> 的公式，當先驗概率爲 <span class="math inline">\(\pi_{\Theta|r}(\theta|r)=\text{Beta}(a=0.5,b=0.5)\)</span> ，數據 <span class="math inline">\(n=5, r=3\)</span>。參數 <span class="math inline">\(\theta\)</span> 的事後概率分佈 <span class="math inline">\(\pi_{\Theta|r}(\theta|r)=\text{Beta}(a+r,b+n-r)=\text{Beta}(3.5,2.5)\)</span>。</p>
<p>在 <a href="https://www.r-project.org/">R</a> 裏進行貝葉斯計算十分簡便：</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="single-para-model.html#cb349-1"></a><span class="co"># 95% Credible Intervals</span></span>
<span id="cb349-2"><a href="single-para-model.html#cb349-2"></a>L &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.025</span>, <span class="fl">3.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb349-3"><a href="single-para-model.html#cb349-3"></a>U &lt;-<span class="st"> </span><span class="kw">qbeta</span>(<span class="fl">0.975</span>, <span class="fl">3.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb349-4"><a href="single-para-model.html#cb349-4"></a></span>
<span id="cb349-5"><a href="single-para-model.html#cb349-5"></a><span class="kw">print</span>(<span class="kw">c</span>(L,U))</span></code></pre></div>
<pre><code>## [1] 0.20941666 0.90560967</code></pre>
<p>事後分佈 <span class="math inline">\(\pi_{\Theta|r}(\theta|r)=\text{Beta}(3.5,2.5)\)</span> 的分佈圖形如下：</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="single-para-model.html#cb351-1"></a>post &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(theta) <span class="kw">dbeta</span>(theta, <span class="fl">3.5</span>, <span class="fl">2.5</span>))</span>
<span id="cb351-2"><a href="single-para-model.html#cb351-2"></a></span>
<span id="cb351-3"><a href="single-para-model.html#cb351-3"></a><span class="co"># Illustration</span></span>
<span id="cb351-4"><a href="single-para-model.html#cb351-4"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">length=</span><span class="dv">10000</span>)</span>
<span id="cb351-5"><a href="single-para-model.html#cb351-5"></a>y &lt;-<span class="st"> </span><span class="kw">post</span>(x)</span>
<span id="cb351-6"><a href="single-para-model.html#cb351-6"></a><span class="kw">plot</span>(x,y, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="op">~</span>theta, <span class="dt">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb351-7"><a href="single-para-model.html#cb351-7"></a></span>
<span id="cb351-8"><a href="single-para-model.html#cb351-8"></a><span class="kw">polygon</span>(<span class="kw">c</span>(L, x[x<span class="op">&gt;=</span>L <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;=</span><span class="st"> </span>U], U), <span class="kw">c</span>(<span class="dv">0</span>, y[x<span class="op">&gt;=</span>L <span class="op">&amp;</span><span class="st"> </span>x<span class="op">&lt;=</span>U], <span class="dv">0</span>), <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Bayes03"></span>
<img src="bookdown_files/figure-html/Bayes03-1.png" alt="Posterior distribution of Beta(3.5,2.5)" width="80%" />
<p class="caption">
圖 42.8: Posterior distribution of Beta(3.5,2.5)
</p>
</div>
<p>我們可以自己寫一個求可信區間的公式來計算：</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="single-para-model.html#cb352-1"></a><span class="co"># Credible Interval function:</span></span>
<span id="cb352-2"><a href="single-para-model.html#cb352-2"></a><span class="co"># a, b : shape / super parameters</span></span>
<span id="cb352-3"><a href="single-para-model.html#cb352-3"></a><span class="co"># level: probability level (0,1)</span></span>
<span id="cb352-4"><a href="single-para-model.html#cb352-4"></a></span>
<span id="cb352-5"><a href="single-para-model.html#cb352-5"></a>cred.int &lt;-<span class="st"> </span><span class="cf">function</span>(a,b,level){</span>
<span id="cb352-6"><a href="single-para-model.html#cb352-6"></a>  L &lt;-<span class="st"> </span><span class="kw">qbeta</span>((<span class="dv">1</span><span class="op">-</span>level)<span class="op">/</span><span class="dv">2</span>, a, b) <span class="co"># Lower limit</span></span>
<span id="cb352-7"><a href="single-para-model.html#cb352-7"></a>  U &lt;-<span class="st"> </span><span class="kw">qbeta</span>((<span class="dv">1</span><span class="op">+</span>level)<span class="op">/</span><span class="dv">2</span>, a, b) <span class="co"># Upper limit</span></span>
<span id="cb352-8"><a href="single-para-model.html#cb352-8"></a>  <span class="kw">return</span>(<span class="kw">c</span>(L,U))</span>
<span id="cb352-9"><a href="single-para-model.html#cb352-9"></a>}</span>
<span id="cb352-10"><a href="single-para-model.html#cb352-10"></a></span>
<span id="cb352-11"><a href="single-para-model.html#cb352-11"></a><span class="kw">cred.int</span>(<span class="fl">3.5</span>,<span class="fl">2.5</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## [1] 0.20941666 0.90560967</code></pre>
<p>95%可信區間 <span class="math inline">\((0.2094, 0.9056)\)</span> 告訴我們，參數 <span class="math inline">\(\theta\in(0.2094, 0.9056)\)</span> 的概率是 <span class="math inline">\(0.95\)</span>。</p>
<p>下面我們嘗試寫 Beta 分佈的其他統計量：均值，衆數，方差等。</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="single-para-model.html#cb354-1"></a><span class="co"># a, b: shape / super parameters</span></span>
<span id="cb354-2"><a href="single-para-model.html#cb354-2"></a>MeanBeta &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) a<span class="op">/</span>(a<span class="op">+</span>b)</span>
<span id="cb354-3"><a href="single-para-model.html#cb354-3"></a>ModeBeta &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) {</span>
<span id="cb354-4"><a href="single-para-model.html#cb354-4"></a>  m &lt;-<span class="st"> </span><span class="kw">ifelse</span>(a<span class="op">&gt;</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>b<span class="op">&gt;</span><span class="dv">1</span>, (a<span class="dv">-1</span>)<span class="op">/</span>(a<span class="op">+</span>b<span class="dv">-2</span>), <span class="ot">NA</span>)</span>
<span id="cb354-5"><a href="single-para-model.html#cb354-5"></a>  <span class="kw">return</span>(m)</span>
<span id="cb354-6"><a href="single-para-model.html#cb354-6"></a>}</span>
<span id="cb354-7"><a href="single-para-model.html#cb354-7"></a>VarianceBeta &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) (a<span class="op">*</span>b)<span class="op">/</span>((a<span class="op">+</span>b)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(a<span class="op">+</span>b<span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb354-8"><a href="single-para-model.html#cb354-8"></a></span>
<span id="cb354-9"><a href="single-para-model.html#cb354-9"></a><span class="co"># mean</span></span>
<span id="cb354-10"><a href="single-para-model.html#cb354-10"></a><span class="kw">MeanBeta</span>(<span class="fl">3.5</span>,<span class="fl">2.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.58333333</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="single-para-model.html#cb356-1"></a><span class="co"># mode</span></span>
<span id="cb356-2"><a href="single-para-model.html#cb356-2"></a><span class="kw">ModeBeta</span>(<span class="fl">3.5</span>,<span class="fl">2.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.625</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="single-para-model.html#cb358-1"></a><span class="co"># Variance</span></span>
<span id="cb358-2"><a href="single-para-model.html#cb358-2"></a><span class="kw">VarianceBeta</span>(<span class="fl">3.5</span>, <span class="fl">2.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.034722222</code></pre>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="single-para-model.html#cb360-1"></a><span class="co"># SD</span></span>
<span id="cb360-2"><a href="single-para-model.html#cb360-2"></a><span class="kw">sqrt</span>(<span class="kw">VarianceBeta</span>(<span class="fl">3.5</span>, <span class="fl">2.5</span>))</span></code></pre></div>
<pre><code>## [1] 0.186339</code></pre>
</div>
<div id="q2-3" class="section level3" number="42.5.2">
<h3><span class="header-section-number">42.5.2</span> Q2</h3>
<p>假如數據還是 Q1 的數據，然而先驗概率讓我們認爲可能在 5 名受試對象中觀察到 1 次事件。</p>
<ol style="list-style-type: decimal">
<li>試求超參數 <span class="math inline">\((a,b)\)</span> 滿足先驗概率的 Beta 分佈。(不止一組)</li>
</ol>
<p><strong>解</strong></p>
<p>我們認爲最有可能發生 “5 名受試對象中觀察到 1 次事件” 的情況，那麼先驗概率的均值爲 <span class="math inline">\(\frac{a}{a+b}=0.2\)</span>。所以，在實數中有無數組超參數都可以用來模擬先驗概率分佈。例如 <span class="math inline">\(a=1, b=4; a=10, b=40; a=100, b=400; a=0.317, b=1.268, \cdots\)</span>。</p>
<ol start="2" style="list-style-type: decimal">
<li>假如觀察數據是 <span class="math inline">\(n=5, r=1\)</span>，計算事後概率分佈及其均值，標準差。</li>
</ol>
<p><strong>解</strong></p>
<p>先來嘗試寫一個計算貝葉斯二項分佈的方程：</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="single-para-model.html#cb362-1"></a><span class="co"># binbayes function in R</span></span>
<span id="cb362-2"><a href="single-para-model.html#cb362-2"></a><span class="co">#------------------------------</span></span>
<span id="cb362-3"><a href="single-para-model.html#cb362-3"></a><span class="co"># a, b: shape / super parameters</span></span>
<span id="cb362-4"><a href="single-para-model.html#cb362-4"></a><span class="co"># r   : number of successes</span></span>
<span id="cb362-5"><a href="single-para-model.html#cb362-5"></a><span class="co"># n   : number of trials</span></span>
<span id="cb362-6"><a href="single-para-model.html#cb362-6"></a></span>
<span id="cb362-7"><a href="single-para-model.html#cb362-7"></a>binbayes &lt;-<span class="st"> </span><span class="cf">function</span>(a, b, r, n) {</span>
<span id="cb362-8"><a href="single-para-model.html#cb362-8"></a>  prior &lt;-<span class="st"> </span><span class="kw">c</span>(a, b, <span class="ot">NA</span>, <span class="kw">MeanBeta</span>(a,b), <span class="kw">sqrt</span>(<span class="kw">VarianceBeta</span>(a, b)), <span class="kw">qbeta</span>(<span class="fl">0.025</span>, a, b), <span class="kw">qbeta</span>(<span class="fl">0.5</span>, a, b), <span class="kw">qbeta</span>(<span class="fl">0.975</span>, a, b))</span>
<span id="cb362-9"><a href="single-para-model.html#cb362-9"></a>  posterior &lt;-<span class="st"> </span><span class="kw">c</span>(a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r, r<span class="op">/</span>n, <span class="kw">MeanBeta</span>(a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r), <span class="kw">sqrt</span>(<span class="kw">VarianceBeta</span>(a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r)), <span class="kw">qbeta</span>(<span class="fl">0.025</span>, a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r), <span class="kw">qbeta</span>(<span class="fl">0.5</span>, a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r), <span class="kw">qbeta</span>(<span class="fl">0.975</span>, a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r))</span>
<span id="cb362-10"><a href="single-para-model.html#cb362-10"></a>  out &lt;-<span class="st"> </span><span class="kw">rbind</span>(prior, posterior)</span>
<span id="cb362-11"><a href="single-para-model.html#cb362-11"></a>  out &lt;-<span class="st"> </span><span class="kw">round</span>(out, <span class="dv">4</span>)</span>
<span id="cb362-12"><a href="single-para-model.html#cb362-12"></a>  <span class="kw">colnames</span>(out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;r/n&quot;</span>,<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;2.5%&quot;</span>, <span class="st">&quot;50%&quot;</span>, <span class="st">&quot;97.5%&quot;</span>)</span>
<span id="cb362-13"><a href="single-para-model.html#cb362-13"></a>  <span class="kw">return</span>(out)</span>
<span id="cb362-14"><a href="single-para-model.html#cb362-14"></a>}</span>
<span id="cb362-15"><a href="single-para-model.html#cb362-15"></a></span>
<span id="cb362-16"><a href="single-para-model.html#cb362-16"></a><span class="co"># a=1, b=4, r=1, n=5</span></span>
<span id="cb362-17"><a href="single-para-model.html#cb362-17"></a><span class="kw">binbayes</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           a b r/n Mean     SD   2.5%    50%  97.5%
## prior     1 4  NA  0.2 0.1633 0.0063 0.1591 0.6024
## posterior 2 8 0.2  0.2 0.1206 0.0281 0.1796 0.4825</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="single-para-model.html#cb364-1"></a><span class="co"># a=10, b=40, r=1, n=5</span></span>
<span id="cb364-2"><a href="single-para-model.html#cb364-2"></a><span class="kw">binbayes</span>(<span class="dv">10</span>,<span class="dv">40</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##            a  b r/n Mean     SD   2.5%    50%  97.5%
## prior     10 40  NA  0.2 0.0560 0.1024 0.1960 0.3202
## posterior 11 44 0.2  0.2 0.0535 0.1063 0.1963 0.3143</code></pre>
<p>通過繪製先驗概率分佈圖和事後概率分佈圖來比較二者的變化：</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="single-para-model.html#cb366-1"></a><span class="co"># Prior vs posterior graphs</span></span>
<span id="cb366-2"><a href="single-para-model.html#cb366-2"></a><span class="co"># a,b : shape / super parameters</span></span>
<span id="cb366-3"><a href="single-para-model.html#cb366-3"></a><span class="co"># r   : number of successes</span></span>
<span id="cb366-4"><a href="single-para-model.html#cb366-4"></a><span class="co"># n   : number of trials</span></span>
<span id="cb366-5"><a href="single-para-model.html#cb366-5"></a>graph.binbayes &lt;-<span class="st"> </span><span class="cf">function</span>(a,b,r,n) {</span>
<span id="cb366-6"><a href="single-para-model.html#cb366-6"></a>  prior &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(theta) <span class="kw">dbeta</span>(theta, a,b))</span>
<span id="cb366-7"><a href="single-para-model.html#cb366-7"></a>  posterior &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(theta) <span class="kw">dbeta</span>(theta, a<span class="op">+</span>r, b<span class="op">+</span>n<span class="op">-</span>r))</span>
<span id="cb366-8"><a href="single-para-model.html#cb366-8"></a>  YL &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">prior</span>(<span class="kw">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>,<span class="dt">by=</span><span class="fl">0.001</span>)),<span class="kw">posterior</span>(<span class="kw">seq</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>,<span class="dt">by=</span><span class="fl">0.001</span>)))</span>
<span id="cb366-9"><a href="single-para-model.html#cb366-9"></a>  <span class="kw">curve</span>(prior, <span class="dt">xlab=</span><span class="op">~</span>theta, <span class="dt">ylab=</span><span class="st">&quot;Density&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>, <span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">n=</span><span class="dv">10000</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,YL), <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>)</span>
<span id="cb366-10"><a href="single-para-model.html#cb366-10"></a>  <span class="kw">curve</span>(posterior, <span class="dt">xlab=</span><span class="op">~</span>theta,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">add=</span>T,<span class="dt">n=</span><span class="dv">10000</span>)</span>
<span id="cb366-11"><a href="single-para-model.html#cb366-11"></a>}</span>
<span id="cb366-12"><a href="single-para-model.html#cb366-12"></a></span>
<span id="cb366-13"><a href="single-para-model.html#cb366-13"></a><span class="kw">graph.binbayes</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-2"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-2-1.png" alt="Prior (dashed) Beta(1,4) vs. Posterior (cont.) Beta(2,8)" width="80%" />
<p class="caption">
圖 42.9: Prior (dashed) Beta(1,4) vs. Posterior (cont.) Beta(2,8)
</p>
</div>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="single-para-model.html#cb367-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">10</span>,<span class="dv">40</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-3"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-3-1.png" alt="Prior (dashed) Beta(10,40) vs. Posterior (cont.) Beta(11, 44)" width="80%" />
<p class="caption">
圖 42.10: Prior (dashed) Beta(10,40) vs. Posterior (cont.) Beta(11, 44)
</p>
</div>
<p>我們可以很清楚的看見，先驗概率相同時，<span class="math inline">\(\text{Beta} (a,b)\)</span> 的超參數如果越大，先驗概率的分佈就越趨近與對稱圖形，且極大值也就越出現在均值的地方 (本例中是 <span class="math inline">\(0.2\)</span>)。而且也會使事後概率的 HPD (highest posterior density) 的區間更狹窄 (意爲對事後概率的預測越準確)，同時事後概率分佈也更加接近左右對稱。</p>
</div>
<div id="q3-2" class="section level3" number="42.5.3">
<h3><span class="header-section-number">42.5.3</span> Q3</h3>
<p>我們事先估計某個事件在 <span class="math inline">\(n=20\)</span> 名患者中發生的概率爲 <span class="math inline">\(15\%\)</span>。當實際觀察數據爲 <span class="math inline">\(n=15,r=3\)</span> 時，計算相應的事後概率。</p>
<p><strong>解</strong></p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="single-para-model.html#cb368-1"></a><span class="co"># because 15% events happened in 20 subjects, assuming prior Beta(a=3, b=17)</span></span>
<span id="cb368-2"><a href="single-para-model.html#cb368-2"></a><span class="co"># observed n=15, r=3</span></span>
<span id="cb368-3"><a href="single-para-model.html#cb368-3"></a><span class="kw">binbayes</span>(<span class="dv">3</span>,<span class="dv">17</span>,<span class="dv">3</span>,<span class="dv">15</span>)</span></code></pre></div>
<pre><code>##           a  b r/n   Mean     SD   2.5%    50%  97.5%
## prior     3 17  NA 0.1500 0.0779 0.0338 0.1383 0.3314
## posterior 6 29 0.2 0.1714 0.0628 0.0676 0.1651 0.3106</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="single-para-model.html#cb370-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">3</span>,<span class="dv">17</span>,<span class="dv">3</span>,<span class="dv">15</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-5"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-5-1.png" alt="Prior (dashed) Beta(3,17) vs. Posterior (cont.) Beta(6,29)" width="80%" />
<p class="caption">
圖 42.11: Prior (dashed) Beta(3,17) vs. Posterior (cont.) Beta(6,29)
</p>
</div>
<p>試着繪製先驗概率服從 <span class="math inline">\(\text{Beta} (1,1)\)</span>，回憶之前本章開頭的圖 <a href="single-para-model.html#fig:beta-distr">42.7</a>，這個先驗概率的含義就是我們沒有任何背景知識，對數據完全陌生的情況：</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="single-para-model.html#cb371-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">15</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-6"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-6-1.png" alt="Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(4,13)" width="80%" />
<p class="caption">
圖 42.12: Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(4,13)
</p>
</div>
</div>
<div id="q4" class="section level3" number="42.5.4">
<h3><span class="header-section-number">42.5.4</span> Q4</h3>
<p>試給出上面各題中參數 <span class="math inline">\(\theta\)</span> 落在 <span class="math inline">\((0.1,0.25)\)</span> 之間的概率。</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="single-para-model.html#cb372-1"></a><span class="co"># function to calculate probabilities in a interval</span></span>
<span id="cb372-2"><a href="single-para-model.html#cb372-2"></a><span class="co"># a, b: super parameters</span></span>
<span id="cb372-3"><a href="single-para-model.html#cb372-3"></a><span class="co"># r   : number of successes</span></span>
<span id="cb372-4"><a href="single-para-model.html#cb372-4"></a><span class="co"># n   : number of trials</span></span>
<span id="cb372-5"><a href="single-para-model.html#cb372-5"></a><span class="co"># L   : Lower limit of the probability interval</span></span>
<span id="cb372-6"><a href="single-para-model.html#cb372-6"></a><span class="co"># U   : Upper limit of the probability interval</span></span>
<span id="cb372-7"><a href="single-para-model.html#cb372-7"></a></span>
<span id="cb372-8"><a href="single-para-model.html#cb372-8"></a>prob.int &lt;-<span class="st"> </span><span class="cf">function</span>(a,b,r,n,L,U){</span>
<span id="cb372-9"><a href="single-para-model.html#cb372-9"></a>prior0 &lt;-<span class="st"> </span><span class="kw">pbeta</span>(U,a,b) <span class="op">-</span><span class="st"> </span><span class="kw">pbeta</span>(L,a,b)</span>
<span id="cb372-10"><a href="single-para-model.html#cb372-10"></a>posterior0 &lt;-<span class="st"> </span><span class="kw">pbeta</span>(U,a<span class="op">+</span>r,n<span class="op">-</span>r<span class="op">+</span>b) <span class="op">-</span><span class="st"> </span><span class="kw">pbeta</span>(L,a<span class="op">+</span>r,n<span class="op">-</span>r<span class="op">+</span>b)</span>
<span id="cb372-11"><a href="single-para-model.html#cb372-11"></a>prob &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(prior0, posterior0))</span>
<span id="cb372-12"><a href="single-para-model.html#cb372-12"></a>prob &lt;-<span class="st"> </span><span class="kw">round</span>(prob,<span class="dv">4</span>)</span>
<span id="cb372-13"><a href="single-para-model.html#cb372-13"></a><span class="kw">colnames</span>(prob) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Probability of theta lies between the Interval&quot;</span>, L, U)</span>
<span id="cb372-14"><a href="single-para-model.html#cb372-14"></a><span class="kw">rownames</span>(prob) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Prior&quot;</span>,<span class="st">&quot;Posterior&quot;</span>)</span>
<span id="cb372-15"><a href="single-para-model.html#cb372-15"></a>  <span class="kw">return</span>(prob)</span>
<span id="cb372-16"><a href="single-para-model.html#cb372-16"></a>}</span>
<span id="cb372-17"><a href="single-para-model.html#cb372-17"></a></span>
<span id="cb372-18"><a href="single-para-model.html#cb372-18"></a><span class="co"># Prior Beta(0.317,1.286) n = 5, r=1</span></span>
<span id="cb372-19"><a href="single-para-model.html#cb372-19"></a><span class="kw">binbayes</span>(<span class="fl">0.317</span>, <span class="fl">1.286</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##               a     b r/n   Mean     SD  2.5%    50%  97.5%
## prior     0.317 1.286  NA 0.1978 0.2469 0.000 0.0823 0.8516
## posterior 1.317 5.286 0.2 0.1995 0.1449 0.013 0.1684 0.5493</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="single-para-model.html#cb374-1"></a><span class="kw">prob.int</span>(<span class="fl">0.317</span>, <span class="fl">1.286</span>, <span class="dv">1</span>, <span class="dv">5</span>,<span class="fl">0.1</span>,<span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>##           Probability of theta lies between the Interval 0.1 0.25
## Prior                                                      0.1711
## Posterior                                                  0.3911</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="single-para-model.html#cb376-1"></a><span class="kw">graph.binbayes</span>(<span class="fl">0.317</span>, <span class="fl">1.286</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-8"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-8-1.png" alt="Prior (dashed) Beta(0.317,1.286) vs. Posterior (cont.) Beta(1.317, 5.286)" width="80%" />
<p class="caption">
圖 42.13: Prior (dashed) Beta(0.317,1.286) vs. Posterior (cont.) Beta(1.317, 5.286)
</p>
</div>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="single-para-model.html#cb377-1"></a><span class="co"># Prior Beta(10,40) n = 5, r=1</span></span>
<span id="cb377-2"><a href="single-para-model.html#cb377-2"></a><span class="kw">binbayes</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">1</span>, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##            a  b r/n Mean     SD   2.5%    50%  97.5%
## prior     10 40  NA  0.2 0.0560 0.1024 0.1960 0.3202
## posterior 11 44 0.2  0.2 0.0535 0.1063 0.1963 0.3143</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="single-para-model.html#cb379-1"></a><span class="kw">prob.int</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">1</span>, <span class="dv">5</span>,<span class="fl">0.1</span>,<span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>##           Probability of theta lies between the Interval 0.1 0.25
## Prior                                                      0.7951
## Posterior                                                  0.8099</code></pre>
<p>所以在範圍固定的時候，事後概率分佈總是能夠比先驗概率分佈給出更高的累計概率。</p>
</div>
<div id="q5" class="section level3" number="42.5.5">
<h3><span class="header-section-number">42.5.5</span> Q5</h3>
<p>一個臨牀試驗要進行兩個階段 (two phases)，第一階段我們觀察到 <span class="math inline">\(10\)</span> 個患者中 <span class="math inline">\(1\)</span> 個事件。第二階段，觀察到 <span class="math inline">\(n=50, r=5\)</span>。</p>
<ol style="list-style-type: decimal">
<li>兩個階段都使用 <span class="math inline">\(\text{Beta}(1,1)\)</span> 作先驗概率。求兩個實驗階段參數 <span class="math inline">\(\theta&lt;0.1\)</span> 的概率。</li>
</ol>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="single-para-model.html#cb381-1"></a><span class="co"># Phase I</span></span>
<span id="cb381-2"><a href="single-para-model.html#cb381-2"></a><span class="kw">binbayes</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##           a  b r/n   Mean     SD   2.5%   50%  97.5%
## prior     1  1  NA 0.5000 0.2887 0.0250 0.500 0.9750
## posterior 2 10 0.1 0.1667 0.1034 0.0228 0.148 0.4128</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="single-para-model.html#cb383-1"></a><span class="kw">prob.int</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##           Probability of theta lies between the Interval 0 0.1
## Prior                                                   0.1000
## Posterior                                               0.3026</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="single-para-model.html#cb385-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-11"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-11-1.png" alt="Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(2, 10)" width="80%" />
<p class="caption">
圖 42.14: Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(2, 10)
</p>
</div>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="single-para-model.html#cb386-1"></a><span class="co"># Phase II</span></span>
<span id="cb386-2"><a href="single-para-model.html#cb386-2"></a><span class="kw">binbayes</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">50</span>)</span></code></pre></div>
<pre><code>##           a  b r/n   Mean     SD   2.5%    50%  97.5%
## prior     1  1  NA 0.5000 0.2887 0.0250 0.5000 0.9750
## posterior 6 46 0.1 0.1154 0.0439 0.0444 0.1105 0.2141</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="single-para-model.html#cb388-1"></a><span class="kw">prob.int</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##           Probability of theta lies between the Interval 0 0.1
## Prior                                                   0.1000
## Posterior                                               0.4024</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="single-para-model.html#cb390-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">50</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-13"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-13-1.png" alt="Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(6, 46)" width="80%" />
<p class="caption">
圖 42.15: Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(6, 46)
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>繼續使用先驗概率分佈 <span class="math inline">\(\text{Beta}(1,1)\)</span>，合併兩個實驗階段，求此時的事後概率分佈，以及參數 <span class="math inline">\(\theta&lt;0.1\)</span> 的概率。</li>
</ol>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="single-para-model.html#cb391-1"></a><span class="co"># Combining both phases</span></span>
<span id="cb391-2"><a href="single-para-model.html#cb391-2"></a><span class="kw">binbayes</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">60</span>)</span></code></pre></div>
<pre><code>##           a  b r/n   Mean     SD   2.5%    50%  97.5%
## prior     1  1  NA 0.5000 0.2887 0.0250 0.5000 0.9750
## posterior 7 55 0.1 0.1129 0.0399 0.0474 0.1087 0.2019</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="single-para-model.html#cb393-1"></a><span class="kw">prob.int</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">60</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##           Probability of theta lies between the Interval 0 0.1
## Prior                                                   0.1000
## Posterior                                               0.4105</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="single-para-model.html#cb395-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">60</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-15"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-15-1.png" alt="Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(7, 55)" width="80%" />
<p class="caption">
圖 42.16: Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(7, 55)
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>用第一階段的實驗結果做第二階段實驗的先驗概率分佈，再計算事後概率分佈，以及 <span class="math inline">\(\theta&lt;0.1\)</span> 的概率。</li>
</ol>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="single-para-model.html#cb396-1"></a><span class="co"># Using Phase I results as a prior for Phase II</span></span>
<span id="cb396-2"><a href="single-para-model.html#cb396-2"></a><span class="kw">binbayes</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">50</span>)</span></code></pre></div>
<pre><code>##           a  b r/n   Mean     SD   2.5%    50%  97.5%
## prior     2 10  NA 0.1667 0.1034 0.0228 0.1480 0.4128
## posterior 7 55 0.1 0.1129 0.0399 0.0474 0.1087 0.2019</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="single-para-model.html#cb398-1"></a><span class="kw">prob.int</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">5</span>,<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##           Probability of theta lies between the Interval 0 0.1
## Prior                                                   0.3026
## Posterior                                               0.4105</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="single-para-model.html#cb400-1"></a><span class="kw">graph.binbayes</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">50</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-17"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-17-1.png" alt="Prior (dashed) Beta(2,10) vs. Posterior (cont.) Beta(7, 55)" width="80%" />
<p class="caption">
圖 42.17: Prior (dashed) Beta(2,10) vs. Posterior (cont.) Beta(7, 55)
</p>
</div>
<p>第2，3兩個小問題提示我們，無論是將第一階段實驗結果作爲第二階段實驗的先驗假設還是將兩次實驗合併，最終的結果是不會改變的。Both approaches are equivalent.</p>
</div>
<div id="q6" class="section level3" number="42.5.6">
<h3><span class="header-section-number">42.5.6</span> Q6</h3>
<p>藥物 A 和藥物 B 都被批准用於治療某種疾病。在 5000 例病例中使用藥物 A，發現有 3 人發生了不良副作用。在另外 7000 例病例中使用藥物 B，發現只有 1 例發生了副作用。</p>
<ol style="list-style-type: decimal">
<li>先使用單一分佈作爲先驗概率 (uniform prior: <span class="math inline">\(\text{Beta}(1,1)\)</span>)。求藥物 A 和藥物 B 各自發生不良反應的事後概率。</li>
</ol>
<p><strong>藥物 A</strong></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="single-para-model.html#cb401-1"></a><span class="co"># Drug A</span></span>
<span id="cb401-2"><a href="single-para-model.html#cb401-2"></a><span class="kw">binbayes</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5000</span>)</span></code></pre></div>
<pre><code>##           a    b    r/n   Mean     SD   2.5%    50%  97.5%
## prior     1    1     NA 0.5000 0.2887 0.0250 0.5000 0.9750
## posterior 4 4998 0.0006 0.0008 0.0004 0.0002 0.0007 0.0018</code></pre>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-19"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-19-1.png" alt="Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(4, 4998)" width="80%" />
<p class="caption">
圖 42.18: Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(4, 4998)
</p>
</div>
<p><strong>藥物 B</strong></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="single-para-model.html#cb403-1"></a><span class="co"># Drug B</span></span>
<span id="cb403-2"><a href="single-para-model.html#cb403-2"></a><span class="kw">binbayes</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">7000</span>)</span></code></pre></div>
<pre><code>##           a    b    r/n   Mean     SD  2.5%    50%  97.5%
## prior     1    1     NA 0.5000 0.2887 0.025 0.5000 0.9750
## posterior 2 7000 0.0001 0.0003 0.0002 0.000 0.0002 0.0008</code></pre>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-21"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-21-1.png" alt="Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(2, 7000)" width="80%" />
<p class="caption">
圖 42.19: Prior (dashed) Beta(1,1) vs. Posterior (cont.) Beta(2, 7000)
</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>使用 <span class="math inline">\(\text{Beta}(0.00001,0.00001)\)</span> 作爲先驗概率，重複上面的計算</li>
</ol>
<p><strong>藥物 A</strong></p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="single-para-model.html#cb405-1"></a><span class="co"># Drug A</span></span>
<span id="cb405-2"><a href="single-para-model.html#cb405-2"></a><span class="kw">binbayes</span>(<span class="fl">0.00001</span>, <span class="fl">0.00001</span>, <span class="dv">3</span>, <span class="dv">5000</span>)</span></code></pre></div>
<pre><code>##           a    b    r/n   Mean     SD   2.5%    50%  97.5%
## prior     0    0     NA 0.5000 0.5000 0.0000 0.5000 1.0000
## posterior 3 4997 0.0006 0.0006 0.0003 0.0001 0.0005 0.0014</code></pre>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-23"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-23-1.png" alt="Prior (dashed) Beta(0.00001,0.00001) vs. Posterior (cont.) Beta(3, 4997)" width="80%" />
<p class="caption">
圖 42.20: Prior (dashed) Beta(0.00001,0.00001) vs. Posterior (cont.) Beta(3, 4997)
</p>
</div>
<p><strong>藥物 B</strong></p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="single-para-model.html#cb407-1"></a><span class="co"># Drug B</span></span>
<span id="cb407-2"><a href="single-para-model.html#cb407-2"></a><span class="kw">binbayes</span>(<span class="fl">0.00001</span>, <span class="fl">0.00001</span>, <span class="dv">1</span>, <span class="dv">7000</span>)</span></code></pre></div>
<pre><code>##           a    b    r/n   Mean     SD 2.5%    50%  97.5%
## prior     0    0     NA 0.5000 0.5000    0 0.5000 1.0000
## posterior 1 6999 0.0001 0.0001 0.0001    0 0.0001 0.0005</code></pre>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-25"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-25-1.png" alt="Prior (dashed) Beta(0.00001,0.00001) vs. Posterior (cont.) Beta(1, 6999)" width="80%" />
<p class="caption">
圖 42.21: Prior (dashed) Beta(0.00001,0.00001) vs. Posterior (cont.) Beta(1, 6999)
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>現在使用概率論的計算信賴區間 (confidence intervals) 的方法，求上面數據的精確二項分佈 95% 信賴區間。之前兩問中使用的哪個先驗概率更加接近概率論算法？</li>
</ol>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="single-para-model.html#cb409-1"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb409-2"><a href="single-para-model.html#cb409-2"></a><span class="co"># Binomial confidence intervals</span></span>
<span id="cb409-3"><a href="single-para-model.html#cb409-3"></a><span class="co">#------------------------------------------------</span></span>
<span id="cb409-4"><a href="single-para-model.html#cb409-4"></a><span class="co"># r    : number of successes</span></span>
<span id="cb409-5"><a href="single-para-model.html#cb409-5"></a><span class="co"># n    : number of trials</span></span>
<span id="cb409-6"><a href="single-para-model.html#cb409-6"></a><span class="co"># level: confidence level</span></span>
<span id="cb409-7"><a href="single-para-model.html#cb409-7"></a>binom.confint &lt;-<span class="st"> </span><span class="cf">function</span>(r,n,level){</span>
<span id="cb409-8"><a href="single-para-model.html#cb409-8"></a> p &lt;-<span class="st"> </span>r<span class="op">/</span>n</span>
<span id="cb409-9"><a href="single-para-model.html#cb409-9"></a>conf &lt;-<span class="st">  </span><span class="kw">as.vector</span>(<span class="kw">binom.test</span>(r,n,<span class="dt">conf.level =</span> <span class="fl">0.95</span>)<span class="op">$</span>conf.int)</span>
<span id="cb409-10"><a href="single-para-model.html#cb409-10"></a>out &lt;-<span class="st"> </span><span class="kw">c</span>(p,conf)</span>
<span id="cb409-11"><a href="single-para-model.html#cb409-11"></a>out &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">t</span>(<span class="kw">round</span>(out,<span class="dv">8</span>)))</span>
<span id="cb409-12"><a href="single-para-model.html#cb409-12"></a><span class="kw">colnames</span>(out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MLE&quot;</span>, <span class="st">&quot;L&quot;</span>, <span class="st">&quot;U&quot;</span>)</span>
<span id="cb409-13"><a href="single-para-model.html#cb409-13"></a><span class="kw">return</span>(out)</span>
<span id="cb409-14"><a href="single-para-model.html#cb409-14"></a>}</span>
<span id="cb409-15"><a href="single-para-model.html#cb409-15"></a></span>
<span id="cb409-16"><a href="single-para-model.html#cb409-16"></a><span class="co"># Drug A</span></span>
<span id="cb409-17"><a href="single-para-model.html#cb409-17"></a><span class="kw">binom.confint</span>(<span class="dv">3</span>,<span class="dv">5000</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##         MLE          L          U
## [1,] 0.0006 0.00012375 0.00175244</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="single-para-model.html#cb411-1"></a><span class="co"># Drug B</span></span>
<span id="cb411-2"><a href="single-para-model.html#cb411-2"></a><span class="kw">binom.confint</span>(<span class="dv">1</span>,<span class="dv">7000</span>,<span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##             MLE        L          U
## [1,] 0.00014286 3.62e-06 0.00079569</code></pre>
<p>明顯可以看到，先驗概率使用 <span class="math inline">\(\text{Beta}(0.00001,0.00001)\)</span> 時，事後概率的均值和可信區間的下限值更接近概率論算法。使用先驗概率 <span class="math inline">\(\text{Beta}(1,1)\)</span> 時，事後概率的可信區間的上限值更接近概率論算法。</p>
<ol start="4" style="list-style-type: decimal">
<li>如果需要你來下結論說，藥物 B 和藥物 A 哪個更加安全？ 求 <span class="math inline">\(\text{Pr}(\theta_B &lt; \theta_A|data)\)</span>。</li>
</ol>
<p><strong>解</strong></p>
<p><strong>貝葉斯</strong></p>
<p>在計算機的輔助下，這是一個十分簡單的計算。我們從各自的事後分佈中採集大量隨機樣本，然後求 <span class="math inline">\(\theta_B-\theta_A\)</span> 然後看有多少比例這個數值是小於零的就可以得出結論：</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="single-para-model.html#cb413-1"></a><span class="co"># Simulating from each posterior</span></span>
<span id="cb413-2"><a href="single-para-model.html#cb413-2"></a><span class="kw">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb413-3"><a href="single-para-model.html#cb413-3"></a>post.thetaA &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1000000</span>, <span class="dv">3</span>, <span class="dv">4997</span>)</span>
<span id="cb413-4"><a href="single-para-model.html#cb413-4"></a>post.thetaB &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1000000</span>, <span class="dv">1</span>, <span class="dv">6999</span>)</span>
<span id="cb413-5"><a href="single-para-model.html#cb413-5"></a></span>
<span id="cb413-6"><a href="single-para-model.html#cb413-6"></a><span class="co"># Taking the differences</span></span>
<span id="cb413-7"><a href="single-para-model.html#cb413-7"></a>theta.diff0 &lt;-<span class="st"> </span>post.thetaB <span class="op">-</span><span class="st"> </span>post.thetaA</span></code></pre></div>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="single-para-model.html#cb414-1"></a><span class="co"># Histogram of the differences</span></span>
<span id="cb414-2"><a href="single-para-model.html#cb414-2"></a><span class="kw">hist</span>(theta.diff0,<span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">xlab=</span><span class="kw">expression</span>(theta[B] <span class="op">-</span><span class="st"> </span>theta[A]),<span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb414-3"><a href="single-para-model.html#cb414-3"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb414-4"><a href="single-para-model.html#cb414-4"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-28"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-28-1.png" alt="Histogram of  Drug B - Drug A" width="80%" />
<p class="caption">
圖 42.22: Histogram of Drug B - Drug A
</p>
</div>
<p>也可以不採用直方圖而是使用連續曲線：</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="single-para-model.html#cb415-1"></a><span class="co"># Continuous version</span></span>
<span id="cb415-2"><a href="single-para-model.html#cb415-2"></a><span class="kw">plot</span>(<span class="kw">density</span>(theta.diff0), <span class="dt">xlab=</span><span class="kw">expression</span>(theta[B] <span class="op">-</span><span class="st"> </span>theta[A]), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">frame=</span><span class="ot">FALSE</span>)</span>
<span id="cb415-3"><a href="single-para-model.html#cb415-3"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb415-4"><a href="single-para-model.html#cb415-4"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-29"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-29-1.png" alt="Density of Drug B - Drug A" width="80%" />
<p class="caption">
圖 42.23: Density of Drug B - Drug A
</p>
</div>
<p>計算 <span class="math inline">\(\text{Pr}(\theta_B &lt; \theta_A|data)\)</span> 和可信區間：</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="single-para-model.html#cb416-1"></a><span class="co"># P(theta[B] &lt; theta[A] | Data)</span></span>
<span id="cb416-2"><a href="single-para-model.html#cb416-2"></a><span class="kw">mean</span>(theta.diff0 <span class="op">&lt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.927829</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="single-para-model.html#cb418-1"></a><span class="co"># Credible interval for theta[B] - theta[A]</span></span>
<span id="cb418-2"><a href="single-para-model.html#cb418-2"></a><span class="kw">quantile</span>(theta.diff0, <span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##              5%             95% 
## -0.001142862872  0.000052484912</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="single-para-model.html#cb420-1"></a><span class="kw">quantile</span>(theta.diff0, <span class="kw">c</span>(<span class="fl">0.10</span>,<span class="fl">0.90</span>))</span></code></pre></div>
<pre><code>##            10%            90% 
## -0.00094605885 -0.00004674857</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="single-para-model.html#cb422-1"></a><span class="co"># Simulating from each posterior</span></span>
<span id="cb422-2"><a href="single-para-model.html#cb422-2"></a><span class="kw">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb422-3"><a href="single-para-model.html#cb422-3"></a>post.thetaA &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1000000</span>, <span class="dv">4</span>, <span class="dv">4998</span>)</span>
<span id="cb422-4"><a href="single-para-model.html#cb422-4"></a>post.thetaB &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1000000</span>, <span class="dv">2</span>, <span class="dv">7000</span>)</span>
<span id="cb422-5"><a href="single-para-model.html#cb422-5"></a></span>
<span id="cb422-6"><a href="single-para-model.html#cb422-6"></a><span class="co"># Taking the differences</span></span>
<span id="cb422-7"><a href="single-para-model.html#cb422-7"></a>theta.diff1 &lt;-<span class="st"> </span>post.thetaB <span class="op">-</span><span class="st"> </span>post.thetaA</span></code></pre></div>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="single-para-model.html#cb423-1"></a><span class="kw">hist</span>(theta.diff1,<span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">xlab=</span><span class="kw">expression</span>(theta[B] <span class="op">-</span><span class="st"> </span>theta[A]),<span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb423-2"><a href="single-para-model.html#cb423-2"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb423-3"><a href="single-para-model.html#cb423-3"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-32"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-32-1.png" alt="Histogram of  Drug B - Drug A" width="80%" />
<p class="caption">
圖 42.24: Histogram of Drug B - Drug A
</p>
</div>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="single-para-model.html#cb424-1"></a><span class="co"># Continuous version</span></span>
<span id="cb424-2"><a href="single-para-model.html#cb424-2"></a><span class="kw">plot</span>(<span class="kw">density</span>(theta.diff1), <span class="dt">xlab=</span><span class="kw">expression</span>(theta[B] <span class="op">-</span><span class="st"> </span>theta[A]), <span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb424-3"><a href="single-para-model.html#cb424-3"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb424-4"><a href="single-para-model.html#cb424-4"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-33"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-33-1.png" alt="Density of  Drug B - Drug A" width="80%" />
<p class="caption">
圖 42.25: Density of Drug B - Drug A
</p>
</div>
<p>計算 <span class="math inline">\(\text{Pr}(\theta_B &lt; \theta_A|data)\)</span> 和可信區間：</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="single-para-model.html#cb425-1"></a><span class="co"># P(theta[B] &lt; theta[A] | Data)</span></span>
<span id="cb425-2"><a href="single-para-model.html#cb425-2"></a></span>
<span id="cb425-3"><a href="single-para-model.html#cb425-3"></a><span class="kw">mean</span>(theta.diff1 <span class="op">&lt;</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 0.899677</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="single-para-model.html#cb427-1"></a><span class="co"># Credible interval for theta[B] - theta[A]</span></span>
<span id="cb427-2"><a href="single-para-model.html#cb427-2"></a><span class="kw">quantile</span>(theta.diff1, <span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.95</span>))</span></code></pre></div>
<pre><code>##             5%            95% 
## -0.00131289334  0.00013423126</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="single-para-model.html#cb429-1"></a><span class="kw">quantile</span>(theta.diff1, <span class="kw">c</span>(<span class="fl">0.10</span>,<span class="fl">0.90</span>))</span></code></pre></div>
<pre><code>##            10%            90% 
## -1.0955252e-03  6.5146438e-07</code></pre>
<p><strong>概率論算法</strong></p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="single-para-model.html#cb431-1"></a><span class="co"># Normal Approximation</span></span>
<span id="cb431-2"><a href="single-para-model.html#cb431-2"></a>diff_mle &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">/</span><span class="dv">7000</span>)<span class="op">-</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">5000</span>)</span>
<span id="cb431-3"><a href="single-para-model.html#cb431-3"></a>diff_se &lt;-<span class="st"> </span><span class="kw">sqrt</span>( <span class="dv">1</span><span class="op">*</span><span class="dv">6999</span><span class="op">/</span><span class="dv">7000</span><span class="op">^</span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span><span class="dv">4997</span><span class="op">/</span><span class="dv">5000</span><span class="op">^</span><span class="dv">3</span> )</span>
<span id="cb431-4"><a href="single-para-model.html#cb431-4"></a>U &lt;-<span class="st"> </span>diff_mle <span class="op">+</span><span class="st"> </span><span class="fl">1.28</span><span class="op">*</span>diff_se</span>
<span id="cb431-5"><a href="single-para-model.html#cb431-5"></a>L &lt;-<span class="st"> </span>diff_mle <span class="op">-</span><span class="st"> </span><span class="fl">1.28</span><span class="op">*</span>diff_se</span>
<span id="cb431-6"><a href="single-para-model.html#cb431-6"></a><span class="kw">print</span>(<span class="kw">c</span>(U,L))</span></code></pre></div>
<pre><code>## [1]  0.000022358961 -0.000936644675</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="single-para-model.html#cb433-1"></a>norm.app &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(<span class="cf">function</span>(x) <span class="kw">dnorm</span>(x,diff_mle,diff_se))</span></code></pre></div>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="single-para-model.html#cb434-1"></a><span class="co"># Comparison</span></span>
<span id="cb434-2"><a href="single-para-model.html#cb434-2"></a><span class="kw">plot</span>(<span class="kw">density</span>(theta.diff0), <span class="dt">xlab=</span><span class="kw">expression</span>(theta[B] <span class="op">-</span><span class="st"> </span>theta[A]), <span class="dt">xlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.002</span>,<span class="fl">0.001</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb434-3"><a href="single-para-model.html#cb434-3"></a><span class="kw">points</span>(<span class="kw">density</span>(theta.diff1), <span class="dt">xlab=</span><span class="kw">expression</span>(theta[B] <span class="op">-</span><span class="st"> </span>theta[A]), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</span>
<span id="cb434-4"><a href="single-para-model.html#cb434-4"></a><span class="kw">curve</span>(norm.app,<span class="op">-</span><span class="fl">0.0045</span>,<span class="fl">0.002</span>,<span class="dt">add=</span>T,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">n=</span><span class="dv">10000</span>)</span>
<span id="cb434-5"><a href="single-para-model.html#cb434-5"></a><span class="kw">legend</span>(<span class="op">-</span><span class="fl">0.0021</span>, <span class="dv">1300</span>, <span class="kw">c</span>(<span class="st">&quot;Posterior with B(0,0)&quot;</span>,<span class="st">&quot;Posterior with B(1,1)&quot;</span>,<span class="st">&quot;Frequentist Normal App&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;black&quot;</span>),</span>
<span id="cb434-6"><a href="single-para-model.html#cb434-6"></a>       <span class="dt">text.col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb434-7"><a href="single-para-model.html#cb434-7"></a>       <span class="dt">merge =</span> <span class="ot">TRUE</span>, <span class="dt">bg =</span> <span class="st">&quot;gray90&quot;</span>,<span class="dt">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb434-8"><a href="single-para-model.html#cb434-8"></a><span class="kw">box</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:08-Intro-to-Bayes-36"></span>
<img src="bookdown_files/figure-html/08-Intro-to-Bayes-36-1.png" alt="Comparison of different prior distribution and frequentist approximation" width="80%" />
<p class="caption">
圖 42.26: Comparison of different prior distribution and frequentist approximation
</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-Bayes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="normal-distr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/winterwang/LSHTMlearningnote/edit/master/08-Intro-to-Bayes.Rmd",
"text": "編輯"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
