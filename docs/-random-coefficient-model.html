<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>醫學統計學</title>
  <meta name="description" content="在LSHTM的學習筆記">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="醫學統計學" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.jpg" />
  <meta property="og:description" content="在LSHTM的學習筆記" />
  <meta name="github-repo" content="winterwang/LSHTMlearningnote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="醫學統計學" />
  
  <meta name="twitter:description" content="在LSHTM的學習筆記" />
  <meta name="twitter:image" content="img/cover.jpg" />

<meta name="author" content="王 超辰 Chaochen Wang">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="-random-intercept-model-with-covariates.html">
<link rel="next" href="-longitudinal-data-1.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">在LSHTM的學習筆記</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>我是誰</a></li>
<li class="part"><span><b>I 概率論 Probability</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 概率論入門：定義與公理</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#section-1.1"><i class="fa fa-check"></i><b>1.1</b> 三個概率公理：</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#conditonalProb"><i class="fa fa-check"></i><b>1.2</b> 條件概率 Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#-independence-"><i class="fa fa-check"></i><b>1.3</b> 獨立 (independence) 的定義</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#section-1.4"><i class="fa fa-check"></i><b>1.4</b> 賭博問題</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#section-1.5"><i class="fa fa-check"></i><b>1.5</b> 賭博問題的答案</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Bayes-Definition.html"><a href="Bayes-Definition.html"><i class="fa fa-check"></i><b>2</b> Bayes 貝葉斯理論的概念</a></li>
<li class="chapter" data-level="3" data-path="-expectation-or-mean-variance.html"><a href="-expectation-or-mean-variance.html"><i class="fa fa-check"></i><b>3</b> 期望 Expectation (或均值 or mean) 和 方差 Variance</a><ul>
<li class="chapter" data-level="3.1" data-path="-expectation-or-mean-variance.html"><a href="-expectation-or-mean-variance.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 方差的性質：</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bernoulli.html"><a href="bernoulli.html"><i class="fa fa-check"></i><b>4</b> 伯努利分佈 Bernoulli distribution</a></li>
<li class="chapter" data-level="5" data-path="binomial.html"><a href="binomial.html"><i class="fa fa-check"></i><b>5</b> 二項分佈的概念 Binomial distribution</a><ul>
<li class="chapter" data-level="5.1" data-path="binomial.html"><a href="binomial.html#section-5.1"><i class="fa fa-check"></i><b>5.1</b> 二項分佈的期望和方差</a></li>
<li class="chapter" data-level="5.2" data-path="binomial.html"><a href="binomial.html#hyperdist"><i class="fa fa-check"></i><b>5.2</b> 超幾何分佈 hypergeometric distribution</a></li>
<li class="chapter" data-level="5.3" data-path="binomial.html"><a href="binomial.html#section-5.3"><i class="fa fa-check"></i><b>5.3</b> 樂透中獎概率問題：</a><ul>
<li class="chapter" data-level="5.3.1" data-path="binomial.html"><a href="binomial.html#-3-"><i class="fa fa-check"></i><b>5.3.1</b> 如果我只想中其中的 <span class="math inline">\(3\)</span> 個號碼，概率有多大？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>6</b> 泊松分佈 Poisson Distribution</a></li>
<li class="chapter" data-level="7" data-path="section-7.html"><a href="section-7.html"><i class="fa fa-check"></i><b>7</b> 正態分佈</a><ul>
<li class="chapter" data-level="7.1" data-path="section-7.html"><a href="section-7.html#-probability-density-function-pdf"><i class="fa fa-check"></i><b>7.1</b> 概率密度曲線 probability density function， PDF</a></li>
<li class="chapter" data-level="7.2" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>7.2</b> 正態分佈</a></li>
<li class="chapter" data-level="7.3" data-path="section-7.html"><a href="section-7.html#standardNormal"><i class="fa fa-check"></i><b>7.3</b> 標準正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="CLT.html"><a href="CLT.html"><i class="fa fa-check"></i><b>8</b> 中心極限定理 the Central Limit Theorem</a><ul>
<li class="chapter" data-level="8.1" data-path="CLT.html"><a href="CLT.html#covariance"><i class="fa fa-check"></i><b>8.1</b> 協方差 Covariance</a></li>
<li class="chapter" data-level="8.2" data-path="CLT.html"><a href="CLT.html#correlation"><i class="fa fa-check"></i><b>8.2</b> 相關 Correlation</a></li>
<li class="chapter" data-level="8.3" data-path="CLT.html"><a href="CLT.html#-the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> 中心極限定理 the Central Limit Theorem</a></li>
<li class="chapter" data-level="8.4" data-path="CLT.html"><a href="CLT.html#binomial-normal-approx"><i class="fa fa-check"></i><b>8.4</b> 二項分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.5" data-path="CLT.html"><a href="CLT.html#section-8.5"><i class="fa fa-check"></i><b>8.5</b> 泊松分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.6" data-path="CLT.html"><a href="CLT.html#continuity-correction"><i class="fa fa-check"></i><b>8.6</b> 正態分佈模擬的校正：continuity corrections</a><ul>
<li class="chapter" data-level="8.6.1" data-path="CLT.html"><a href="CLT.html#section-8.6.1"><i class="fa fa-check"></i><b>8.6.1</b> 例題</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="CLT.html"><a href="CLT.html#section-8.7"><i class="fa fa-check"></i><b>8.7</b> 兩個連續隨機變量</a></li>
<li class="chapter" data-level="8.8" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>8.8</b> 兩個連續隨機變量 例子：</a></li>
<li class="chapter" data-level="8.9" data-path="CLT.html"><a href="CLT.html#section-8.9"><i class="fa fa-check"></i><b>8.9</b> 條件分佈和邊緣分佈的概念</a></li>
<li class="chapter" data-level="8.10" data-path="CLT.html"><a href="CLT.html#section-8.10"><i class="fa fa-check"></i><b>8.10</b> 條件分佈和邊緣分佈的例子</a><ul>
<li class="chapter" data-level="8.10.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>8.10.1</b> 例題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 統計推斷 Inference</b></span></li>
<li class="chapter" data-level="9" data-path="section-9.html"><a href="section-9.html"><i class="fa fa-check"></i><b>9</b> 統計推斷的概念</a><ul>
<li class="chapter" data-level="9.1" data-path="section-9.html"><a href="section-9.html#-population-and-sample"><i class="fa fa-check"></i><b>9.1</b> 人羣與樣本 (population and sample)</a></li>
<li class="chapter" data-level="9.2" data-path="section-9.html"><a href="section-9.html#-sample-and-statistic"><i class="fa fa-check"></i><b>9.2</b> 樣本和統計量 (sample and statistic)</a></li>
<li class="chapter" data-level="9.3" data-path="section-9.html"><a href="section-9.html#-estimation"><i class="fa fa-check"></i><b>9.3</b> 估計 Estimation</a></li>
<li class="chapter" data-level="9.4" data-path="section-9.html"><a href="section-9.html#-confidence-intervals"><i class="fa fa-check"></i><b>9.4</b> 信賴區間 confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html"><i class="fa fa-check"></i><b>10</b> 估計和精確度 Estimation and Precision</a><ul>
<li class="chapter" data-level="10.1" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#CI-for-sample-mean"><i class="fa fa-check"></i><b>10.1</b> 估計量和他們的樣本分佈</a></li>
<li class="chapter" data-level="10.2" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.2"><i class="fa fa-check"></i><b>10.2</b> 估計量的特質</a><ul>
<li class="chapter" data-level="10.2.1" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#bias"><i class="fa fa-check"></i><b>10.2.1</b> 偏倚</a></li>
<li class="chapter" data-level="10.2.2" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#-efficiency"><i class="fa fa-check"></i><b>10.2.2</b> 估計量的效能 Efficiency</a></li>
<li class="chapter" data-level="10.2.3" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#section-10.2.3"><i class="fa fa-check"></i><b>10.2.3</b> 均值和中位數的相對效能</a></li>
<li class="chapter" data-level="10.2.4" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#-mean-square-error-mse"><i class="fa fa-check"></i><b>10.2.4</b> 均方差 mean square error (MSE)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#samplevarbias"><i class="fa fa-check"></i><b>10.3</b> 總體方差的估計，自由度</a></li>
<li class="chapter" data-level="10.4" data-path="-estimation-and-precision.html"><a href="-estimation-and-precision.html#samplevar"><i class="fa fa-check"></i><b>10.4</b> 樣本方差的樣本分佈</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html"><i class="fa fa-check"></i><b>11</b> 卡方分佈 Chi-square distribution</a><ul>
<li class="chapter" data-level="11.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.1"><i class="fa fa-check"></i><b>11.1</b> 卡方分佈的期望和方差的證明</a></li>
<li class="chapter" data-level="11.2" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.2"><i class="fa fa-check"></i><b>11.2</b> 卡方分佈的期望</a></li>
<li class="chapter" data-level="11.3" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.3"><i class="fa fa-check"></i><b>11.3</b> 卡方分佈的方差</a><ul>
<li class="chapter" data-level="11.3.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#-ex_14"><i class="fa fa-check"></i><b>11.3.1</b> 下面來求 <span class="math inline">\(E(X_1^4)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-11.4"><i class="fa fa-check"></i><b>11.4</b> 把上面的推導擴展</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="likelihood-definition.html"><a href="likelihood-definition.html"><i class="fa fa-check"></i><b>12</b> 似然 Likelihood</a><ul>
<li class="chapter" data-level="12.1" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-vs.-probability-vs.inference"><i class="fa fa-check"></i><b>12.1</b> 概率 vs. 推斷 Probability vs. Inference</a></li>
<li class="chapter" data-level="12.2" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-likelihood-and-maximum-likelihood-estimators"><i class="fa fa-check"></i><b>12.2</b> 似然和極大似然估計 Likelihood and maximum likelihood estimators</a></li>
<li class="chapter" data-level="12.3" data-path="likelihood-definition.html"><a href="likelihood-definition.html#section-12.3"><i class="fa fa-check"></i><b>12.3</b> 似然方程的一般化定義</a></li>
<li class="chapter" data-level="12.4" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-log-likelihood"><i class="fa fa-check"></i><b>12.4</b> 對數似然方程 log-likelihood</a></li>
<li class="chapter" data-level="12.5" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-maximum-likelihood-estimator-mle-"><i class="fa fa-check"></i><b>12.5</b> 極大似然估計 (maximum likelihood estimator, MLE) 的性質：</a></li>
<li class="chapter" data-level="12.6" data-path="likelihood-definition.html"><a href="likelihood-definition.html#likelihood-poi"><i class="fa fa-check"></i><b>12.6</b> 率的似然估計 Likelihood for a rate</a></li>
<li class="chapter" data-level="12.7" data-path="likelihood-definition.html"><a href="likelihood-definition.html#-n-"><i class="fa fa-check"></i><b>12.7</b> 有 <span class="math inline">\(n\)</span> 個獨立觀察時的似然方程和對數似然方程</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="llr.html"><a href="llr.html"><i class="fa fa-check"></i><b>13</b> 對數似然比 Log-likelihood ratio</a><ul>
<li class="chapter" data-level="13.1" data-path="llr.html"><a href="llr.html#section-13.1"><i class="fa fa-check"></i><b>13.1</b> 正態分佈數據的極大似然和對數似然比</a></li>
<li class="chapter" data-level="13.2" data-path="llr.html"><a href="llr.html#llr-chi1"><i class="fa fa-check"></i><b>13.2</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比</a></li>
<li class="chapter" data-level="13.3" data-path="llr.html"><a href="llr.html#llr-chi"><i class="fa fa-check"></i><b>13.3</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比的分佈</a></li>
<li class="chapter" data-level="13.4" data-path="llr.html"><a href="llr.html#section-13.4"><i class="fa fa-check"></i><b>13.4</b> 似然比信賴區間</a><ul>
<li class="chapter" data-level="13.4.1" data-path="llr.html"><a href="llr.html#binomial-ex"><i class="fa fa-check"></i><b>13.4.1</b> 以二項分佈數據爲例</a></li>
<li class="chapter" data-level="13.4.2" data-path="llr.html"><a href="llr.html#normal-ex"><i class="fa fa-check"></i><b>13.4.2</b> 以正態分佈數據爲例</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="llr.html"><a href="llr.html#section-13.5"><i class="fa fa-check"></i><b>13.5</b> 練習題</a><ul>
<li class="chapter" data-level="13.5.1" data-path="llr.html"><a href="llr.html#q1"><i class="fa fa-check"></i><b>13.5.1</b> Q1</a></li>
<li class="chapter" data-level="13.5.2" data-path="llr.html"><a href="llr.html#q2"><i class="fa fa-check"></i><b>13.5.2</b> Q2</a></li>
<li class="chapter" data-level="13.5.3" data-path="llr.html"><a href="llr.html#q3"><i class="fa fa-check"></i><b>13.5.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="quadratic-llr.html"><a href="quadratic-llr.html"><i class="fa fa-check"></i><b>14</b> 二次方程近似法求對數似然比 approximate log-likelihood ratios</a><ul>
<li class="chapter" data-level="14.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#quadratic-llr2"><i class="fa fa-check"></i><b>14.1</b> 正態近似法求對數似然 Normal approximation to the log-likelihood</a><ul>
<li class="chapter" data-level="14.1.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-14.1.1"><i class="fa fa-check"></i><b>14.1.1</b> 近似法估算對數似然比的信賴區間</a></li>
<li class="chapter" data-level="14.1.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-14.1.2"><i class="fa fa-check"></i><b>14.1.2</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.1.3" data-path="quadratic-llr.html"><a href="quadratic-llr.html#quadratic-binomial-approx"><i class="fa fa-check"></i><b>14.1.3</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#para-trans"><i class="fa fa-check"></i><b>14.2</b> 參數转换 parameter transformations</a><ul>
<li class="chapter" data-level="14.2.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#Possion-log-transform"><i class="fa fa-check"></i><b>14.2.1</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.2.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-14.2.2"><i class="fa fa-check"></i><b>14.2.2</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>14.3</b> 練習題</a><ul>
<li class="chapter" data-level="14.3.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#q1-1"><i class="fa fa-check"></i><b>14.3.1</b> Q1</a></li>
<li class="chapter" data-level="14.3.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#q2-1"><i class="fa fa-check"></i><b>14.3.2</b> Q2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html"><i class="fa fa-check"></i><b>15</b> 假設檢驗的構建 Construction of a hypothesis test</a><ul>
<li class="chapter" data-level="15.1" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#null-and-alter"><i class="fa fa-check"></i><b>15.1</b> 什麼是假設檢驗 Hypothesis testing</a></li>
<li class="chapter" data-level="15.2" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-error-probabilities-and-the-power-function"><i class="fa fa-check"></i><b>15.2</b> 錯誤概率和效能方程 error probabilities and the power function</a><ul>
<li class="chapter" data-level="15.2.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>15.2.1</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#Neyman-Pearson"><i class="fa fa-check"></i><b>15.3</b> 如何選擇要檢驗的統計量</a><ul>
<li class="chapter" data-level="15.3.1" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#section-15.3.1"><i class="fa fa-check"></i><b>15.3.1</b> 以已知方差的正態分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-composite-hypotheses"><i class="fa fa-check"></i><b>15.4</b> 複合假設 composite hypotheses</a><ul>
<li class="chapter" data-level="15.4.1" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#section-15.4.1"><i class="fa fa-check"></i><b>15.4.1</b> 單側替代假設</a></li>
<li class="chapter" data-level="15.4.2" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#section-15.4.2"><i class="fa fa-check"></i><b>15.4.2</b> 雙側替代假設</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-h_0-"><i class="fa fa-check"></i><b>15.5</b> 爲反對零假設 <span class="math inline">\(H_0\)</span> 的證據定量</a><ul>
<li class="chapter" data-level="15.5.1" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#normal-mean-compare"><i class="fa fa-check"></i><b>15.5.1</b> 回到正態分佈的均值比較問題上來(單側替代假設)</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-p-"><i class="fa fa-check"></i><b>15.6</b> 雙側替代假設情況下，雙側 <span class="math inline">\(p\)</span> 值的定量方法</a></li>
<li class="chapter" data-level="15.7" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#test-summary"><i class="fa fa-check"></i><b>15.7</b> 假設檢驗構建之總結</a></li>
<li class="chapter" data-level="15.8" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-2"><i class="fa fa-check"></i><b>15.8</b> 練習題</a><ul>
<li class="chapter" data-level="15.8.1" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#q1-2"><i class="fa fa-check"></i><b>15.8.1</b> Q1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="section-16.html"><a href="section-16.html"><i class="fa fa-check"></i><b>16</b> 假設檢驗的近似方法</a><ul>
<li class="chapter" data-level="16.1" data-path="section-16.html"><a href="section-16.html#-approximate-and-exact-tests"><i class="fa fa-check"></i><b>16.1</b> 近似和精確檢驗 approximate and exact tests</a></li>
<li class="chapter" data-level="16.2" data-path="section-16.html"><a href="section-16.html#LRT"><i class="fa fa-check"></i><b>16.2</b> 精確檢驗法之 – 似然比檢驗法 Likelihood ratio test</a></li>
<li class="chapter" data-level="16.3" data-path="section-16.html"><a href="section-16.html#-3"><i class="fa fa-check"></i><b>16.3</b> 練習題</a></li>
<li class="chapter" data-level="16.4" data-path="section-16.html"><a href="section-16.html#Wald"><i class="fa fa-check"></i><b>16.4</b> 近似檢驗法之 – Wald 檢驗</a><ul>
<li class="chapter" data-level="16.4.1" data-path="section-16.html"><a href="section-16.html#section-16.4.1"><i class="fa fa-check"></i><b>16.4.1</b> 再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="section-16.html"><a href="section-16.html#Score"><i class="fa fa-check"></i><b>16.5</b> 近似檢驗法之 – Score 检验</a><ul>
<li class="chapter" data-level="16.5.1" data-path="section-16.html"><a href="section-16.html#section-16.5.1"><i class="fa fa-check"></i><b>16.5.1</b> 再再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="section-16.html"><a href="section-16.html#LRTwaldScore-Compare"><i class="fa fa-check"></i><b>16.6</b> LRT, Wald, Score 檢驗三者的比較</a></li>
<li class="chapter" data-level="16.7" data-path="section-16.html"><a href="section-16.html#-4"><i class="fa fa-check"></i><b>16.7</b> 練習題</a><ul>
<li class="chapter" data-level="16.7.1" data-path="section-16.html"><a href="section-16.html#q1-3"><i class="fa fa-check"></i><b>16.7.1</b> Q1</a></li>
<li class="chapter" data-level="16.7.2" data-path="section-16.html"><a href="section-16.html#q2-2"><i class="fa fa-check"></i><b>16.7.2</b> Q2</a></li>
<li class="chapter" data-level="16.7.3" data-path="section-16.html"><a href="section-16.html#q3-1"><i class="fa fa-check"></i><b>16.7.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="-normal-error-models.html"><a href="-normal-error-models.html"><i class="fa fa-check"></i><b>17</b> 正態誤差模型 Normal error models</a><ul>
<li class="chapter" data-level="17.1" data-path="-normal-error-models.html"><a href="-normal-error-models.html#section-17.1"><i class="fa fa-check"></i><b>17.1</b> 服從正態分佈的隨機變量</a></li>
<li class="chapter" data-level="17.2" data-path="-normal-error-models.html"><a href="-normal-error-models.html#Fandtdistr"><i class="fa fa-check"></i><b>17.2</b> <span class="math inline">\(F\)</span> 分佈和 <span class="math inline">\(t\)</span> 分佈的概念</a></li>
<li class="chapter" data-level="17.3" data-path="-normal-error-models.html"><a href="-normal-error-models.html#section-17.3"><i class="fa fa-check"></i><b>17.3</b> 兩個參數的模型</a><ul>
<li class="chapter" data-level="17.3.1" data-path="-normal-error-models.html"><a href="-normal-error-models.html#section-17.3.1"><i class="fa fa-check"></i><b>17.3.1</b> 一組數據兩個參數</a></li>
<li class="chapter" data-level="17.3.2" data-path="-normal-error-models.html"><a href="-normal-error-models.html#section-17.3.2"><i class="fa fa-check"></i><b>17.3.2</b> 兩組數據各一個參數</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="-normal-error-models.html"><a href="-normal-error-models.html#--t--one-sample-t-test-"><i class="fa fa-check"></i><b>17.4</b> 正態分佈概率密度方程中總體均值和方差都未知 (單樣本 <span class="math inline">\(t\)</span> 檢驗 one sample <span class="math inline">\(t\)</span> test 的統計學推導)</a></li>
<li class="chapter" data-level="17.5" data-path="-normal-error-models.html"><a href="-normal-error-models.html#-two-sample-t-test-with-equal-unknown-sigma2"><i class="fa fa-check"></i><b>17.5</b> 比較兩組獨立數據的均值 two sample <span class="math inline">\(t\)</span> test with equal unknown <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="17.6" data-path="-normal-error-models.html"><a href="-normal-error-models.html#section-17.6"><i class="fa fa-check"></i><b>17.6</b> 各個統計分佈之間的關係</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html"><i class="fa fa-check"></i><b>18</b> 多個參數時的統計推斷 Inference with multiple parameters I</a><ul>
<li class="chapter" data-level="18.1" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#-multiple-parameters---lrt"><i class="fa fa-check"></i><b>18.1</b> 多參數 multiple parameters - LRT</a><ul>
<li class="chapter" data-level="18.1.1" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#-likelihood"><i class="fa fa-check"></i><b>18.1.1</b> 似然 likelihood</a></li>
<li class="chapter" data-level="18.1.2" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#section-18.1.2"><i class="fa fa-check"></i><b>18.1.2</b> 對數似然比檢驗</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#-wald----wald-test"><i class="fa fa-check"></i><b>18.2</b> 多參數 Wald 檢驗 - Wald test</a></li>
<li class="chapter" data-level="18.3" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#-score----score-test"><i class="fa fa-check"></i><b>18.3</b> 多參數 Score 檢驗 - Score test</a></li>
<li class="chapter" data-level="18.4" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#condilikeli"><i class="fa fa-check"></i><b>18.4</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="18.5" data-path="-inference-with-multiple-parameters-i.html"><a href="-inference-with-multiple-parameters-i.html#section-18.5"><i class="fa fa-check"></i><b>18.5</b> 練習</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html"><i class="fa fa-check"></i><b>19</b> 多個參數時的統計推斷 – 子集似然函數 profile log-likelihoods</a><ul>
<li class="chapter" data-level="19.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.1"><i class="fa fa-check"></i><b>19.1</b> 子集似然法推導的過程總結</a><ul>
<li class="chapter" data-level="19.1.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.1.1"><i class="fa fa-check"></i><b>19.1.1</b> 子集對數似然方程的分佈</a></li>
<li class="chapter" data-level="19.1.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.1.2"><i class="fa fa-check"></i><b>19.1.2</b> 假設檢驗過程舉例</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.2"><i class="fa fa-check"></i><b>19.2</b> 子集對數似然比的近似</a><ul>
<li class="chapter" data-level="19.2.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.2.1"><i class="fa fa-check"></i><b>19.2.1</b> 子集對數似然比近似的一般化</a></li>
<li class="chapter" data-level="19.2.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#-wald-"><i class="fa fa-check"></i><b>19.2.2</b> 事件發生率之比的 Wald 檢驗統計量</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#-practical"><i class="fa fa-check"></i><b>19.3</b> 練習 Practical</a></li>
<li class="chapter" data-level="19.4" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.4"><i class="fa fa-check"></i><b>19.4</b> 總結</a><ul>
<li class="chapter" data-level="19.4.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.4.1"><i class="fa fa-check"></i><b>19.4.1</b> 快速複習</a></li>
<li class="chapter" data-level="19.4.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.4.2"><i class="fa fa-check"></i><b>19.4.2</b> 試爲下面的醫學研究問題提出合適的統計學模型</a></li>
<li class="chapter" data-level="19.4.3" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-19.4.3"><i class="fa fa-check"></i><b>19.4.3</b> 醫生來找統計學家問問題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III 統計分析方法 Analytical Techniques</b></span></li>
<li class="chapter" data-level="20" data-path="section-20.html"><a href="section-20.html"><i class="fa fa-check"></i><b>20</b> 探索數據和簡單描述</a><ul>
<li class="chapter" data-level="20.1" data-path="section-20.html"><a href="section-20.html#section-20.1"><i class="fa fa-check"></i><b>20.1</b> 數據分析的流程</a><ul>
<li class="chapter" data-level="20.1.1" data-path="section-20.html"><a href="section-20.html#section-20.1.1"><i class="fa fa-check"></i><b>20.1.1</b> 研究設計和實施</a></li>
<li class="chapter" data-level="20.1.2" data-path="section-20.html"><a href="section-20.html#section-20.1.2"><i class="fa fa-check"></i><b>20.1.2</b> 數據分析</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="section-20.html"><a href="section-20.html#section-20.2"><i class="fa fa-check"></i><b>20.2</b> 數據類型</a></li>
<li class="chapter" data-level="20.3" data-path="section-20.html"><a href="section-20.html#section-20.3"><i class="fa fa-check"></i><b>20.3</b> 如何總結並展示數據</a><ul>
<li class="chapter" data-level="20.3.1" data-path="section-20.html"><a href="section-20.html#----frequency-table"><i class="fa fa-check"></i><b>20.3.1</b> 離散型分類型數據的描述 - 頻數分佈表 frequency table</a></li>
<li class="chapter" data-level="20.3.2" data-path="section-20.html"><a href="section-20.html#section-20.3.2"><i class="fa fa-check"></i><b>20.3.2</b> 連續型變量</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="section-20.html"><a href="section-20.html#section-20.4"><i class="fa fa-check"></i><b>20.4</b> 數據總結方案：位置，分散，偏度，和峰度</a><ul>
<li class="chapter" data-level="20.4.1" data-path="section-20.html"><a href="section-20.html#section-20.4.1"><i class="fa fa-check"></i><b>20.4.1</b> 位置</a></li>
<li class="chapter" data-level="20.4.2" data-path="section-20.html"><a href="section-20.html#section-20.4.2"><i class="fa fa-check"></i><b>20.4.2</b> 分散</a></li>
<li class="chapter" data-level="20.4.3" data-path="section-20.html"><a href="section-20.html#-skewness"><i class="fa fa-check"></i><b>20.4.3</b> 偏度 skewness</a></li>
<li class="chapter" data-level="20.4.4" data-path="section-20.html"><a href="section-20.html#-kurtosis"><i class="fa fa-check"></i><b>20.4.4</b> 峯度 kurtosis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html"><i class="fa fa-check"></i><b>21</b> 信賴區間 confidence intervals</a><ul>
<li class="chapter" data-level="21.1" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.1"><i class="fa fa-check"></i><b>21.1</b> 定義</a></li>
<li class="chapter" data-level="21.2" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.2"><i class="fa fa-check"></i><b>21.2</b> 利用總體參數的樣本分佈求信賴區間</a></li>
<li class="chapter" data-level="21.3" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#1"><i class="fa fa-check"></i><b>21.3</b> 情況1：已知方差的正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="21.4" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#CImean"><i class="fa fa-check"></i><b>21.4</b> 信賴區間的意義</a></li>
<li class="chapter" data-level="21.5" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#AT2-5"><i class="fa fa-check"></i><b>21.5</b> 情況2：未知方差，但是已知服從正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="21.6" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#varCI"><i class="fa fa-check"></i><b>21.6</b> 情況3：服從正態分佈的隨機變量方差的信賴區間</a></li>
<li class="chapter" data-level="21.7" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.7"><i class="fa fa-check"></i><b>21.7</b> 當樣本量足夠大時</a></li>
<li class="chapter" data-level="21.8" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#4"><i class="fa fa-check"></i><b>21.8</b> 情況4：求人羣百分比的信賴區間</a><ul>
<li class="chapter" data-level="21.8.1" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.8.1"><i class="fa fa-check"></i><b>21.8.1</b> 一般原則</a></li>
<li class="chapter" data-level="21.8.2" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#exactprop"><i class="fa fa-check"></i><b>21.8.2</b> 二項分佈的“精確法”計算信賴區間</a></li>
<li class="chapter" data-level="21.8.3" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.8.3"><i class="fa fa-check"></i><b>21.8.3</b> 二項分佈的近似法計算信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#CIrate"><i class="fa fa-check"></i><b>21.9</b> 率的信賴區間</a><ul>
<li class="chapter" data-level="21.9.1" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.9.1"><i class="fa fa-check"></i><b>21.9.1</b> 利用泊松分佈精確計算</a></li>
<li class="chapter" data-level="21.9.2" data-path="-confidence-intervals-1.html"><a href="-confidence-intervals-1.html#section-21.9.2"><i class="fa fa-check"></i><b>21.9.2</b> 利用正態近似法計算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="section-22.html"><a href="section-22.html"><i class="fa fa-check"></i><b>22</b> 假設檢驗</a><ul>
<li class="chapter" data-level="22.1" data-path="section-22.html"><a href="section-22.html#section-22.1"><i class="fa fa-check"></i><b>22.1</b> 拋硬幣的例子</a><ul>
<li class="chapter" data-level="22.1.1" data-path="section-22.html"><a href="section-22.html#section-22.1.1"><i class="fa fa-check"></i><b>22.1.1</b> 單側和雙側檢驗</a></li>
<li class="chapter" data-level="22.1.2" data-path="section-22.html"><a href="section-22.html#p-"><i class="fa fa-check"></i><b>22.1.2</b> <span class="math inline">\(p\)</span> 值的意義</a></li>
<li class="chapter" data-level="22.1.3" data-path="section-22.html"><a href="section-22.html#p-"><i class="fa fa-check"></i><b>22.1.3</b> <span class="math inline">\(p\)</span> 值和信賴區間的關係</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="section-22.html"><a href="section-22.html#section-22.2"><i class="fa fa-check"></i><b>22.2</b> 二項分佈的精確假設檢驗</a></li>
<li class="chapter" data-level="22.3" data-path="section-22.html"><a href="section-22.html#section-22.3"><i class="fa fa-check"></i><b>22.3</b> 當樣本量較大</a></li>
<li class="chapter" data-level="22.4" data-path="section-22.html"><a href="section-22.html#section-22.4"><i class="fa fa-check"></i><b>22.4</b> 二項分佈的正態近似法假設檢驗</a><ul>
<li class="chapter" data-level="22.4.1" data-path="section-22.html"><a href="section-22.html#-continuity-correction"><i class="fa fa-check"></i><b>22.4.1</b> 連續性校正 continuity correction</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="section-22.html"><a href="section-22.html#AT3-5"><i class="fa fa-check"></i><b>22.5</b> 情況1：對均值進行假設檢驗 (方差已知)</a></li>
<li class="chapter" data-level="22.6" data-path="section-22.html"><a href="section-22.html#OneSampleT"><i class="fa fa-check"></i><b>22.6</b> 情況2：對均值進行假設檢驗 (方差未知) the one-sample t-test</a></li>
<li class="chapter" data-level="22.7" data-path="section-22.html"><a href="section-22.html#3-the-paired-t-test"><i class="fa fa-check"></i><b>22.7</b> 情況3：對配對實驗數據的均值差進行假設檢驗 the paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="-association.html"><a href="-association.html"><i class="fa fa-check"></i><b>23</b> 相關 association</a><ul>
<li class="chapter" data-level="23.1" data-path="-association.html"><a href="-association.html#section-23.1"><i class="fa fa-check"></i><b>23.1</b> 背景介紹</a></li>
<li class="chapter" data-level="23.2" data-path="-association.html"><a href="-association.html#section-23.2"><i class="fa fa-check"></i><b>23.2</b> 兩個連續型變量的相關分析</a><ul>
<li class="chapter" data-level="23.2.1" data-path="-association.html"><a href="-association.html#section-23.2.1"><i class="fa fa-check"></i><b>23.2.1</b> 相關係數的定義</a></li>
<li class="chapter" data-level="23.2.2" data-path="-association.html"><a href="-association.html#section-23.2.2"><i class="fa fa-check"></i><b>23.2.2</b> 相關係數的性質</a></li>
<li class="chapter" data-level="23.2.3" data-path="-association.html"><a href="-association.html#section-23.2.3"><i class="fa fa-check"></i><b>23.2.3</b> 對相關係數是否爲零進行假設檢驗</a></li>
<li class="chapter" data-level="23.2.4" data-path="-association.html"><a href="-association.html#-95-"><i class="fa fa-check"></i><b>23.2.4</b> 相關係數的 <span class="math inline">\(95\%\)</span> 信賴區間</a></li>
<li class="chapter" data-level="23.2.5" data-path="-association.html"><a href="-association.html#section-23.2.5"><i class="fa fa-check"></i><b>23.2.5</b> 比較兩個相關係數是否相等</a></li>
<li class="chapter" data-level="23.2.6" data-path="-association.html"><a href="-association.html#section-23.2.6"><i class="fa fa-check"></i><b>23.2.6</b> 相關係數那些事兒</a></li>
<li class="chapter" data-level="23.2.7" data-path="-association.html"><a href="-association.html#-r-"><i class="fa fa-check"></i><b>23.2.7</b> 在 R 裏面計算相關係數</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="-association.html"><a href="-association.html#-association-between-pairs-of-binary-variables"><i class="fa fa-check"></i><b>23.3</b> 二元變量之間的相關性 association between pairs of binary variables</a><ul>
<li class="chapter" data-level="23.3.1" data-path="-association.html"><a href="-association.html#or-"><i class="fa fa-check"></i><b>23.3.1</b> OR 的信賴區間</a></li>
<li class="chapter" data-level="23.3.2" data-path="-association.html"><a href="-association.html#section-23.3.2"><i class="fa fa-check"></i><b>23.3.2</b> 比值比的假設檢驗</a></li>
<li class="chapter" data-level="23.3.3" data-path="-association.html"><a href="-association.html#chisquaretest"><i class="fa fa-check"></i><b>23.3.3</b> 兩個百分比的卡方檢驗</a></li>
<li class="chapter" data-level="23.3.4" data-path="-association.html"><a href="-association.html#-fishers-exact-test"><i class="fa fa-check"></i><b>23.3.4</b> 確切檢驗法 Fisher’s “exact” test</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="-association.html"><a href="-association.html#---mtimes-n-"><i class="fa fa-check"></i><b>23.4</b> 多分類 (無排序) 的情況 <span class="math inline">\(M\times N\)</span> 表格</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="-comparisons.html"><a href="-comparisons.html"><i class="fa fa-check"></i><b>24</b> 比較 Comparisons</a><ul>
<li class="chapter" data-level="24.1" data-path="-comparisons.html"><a href="-comparisons.html#-comparing-two-population-means"><i class="fa fa-check"></i><b>24.1</b> 比較兩個均值 comparing two population means</a><ul>
<li class="chapter" data-level="24.1.1" data-path="-comparisons.html"><a href="-comparisons.html#-z-test"><i class="fa fa-check"></i><b>24.1.1</b> 當方差已知，且數據服從正態分佈 Z-test</a></li>
<li class="chapter" data-level="24.1.2" data-path="-comparisons.html"><a href="-comparisons.html#-two-sample-t-test"><i class="fa fa-check"></i><b>24.1.2</b> 當方差未知，但是方差可以被認爲相等，且數據服從正態分佈 two sample <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="24.1.3" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>24.1.3</b> 練習</a></li>
<li class="chapter" data-level="24.1.4" data-path="-comparisons.html"><a href="-comparisons.html#section-24.1.4"><i class="fa fa-check"></i><b>24.1.4</b> 當方差未知，但是方差<strong>不可以</strong>被認爲相等，且數據服從正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="-comparisons.html"><a href="-comparisons.html#section-24.2"><i class="fa fa-check"></i><b>24.2</b> 兩個人羣的方差比較</a><ul>
<li class="chapter" data-level="24.2.1" data-path="-comparisons.html"><a href="-comparisons.html#Ftest"><i class="fa fa-check"></i><b>24.2.1</b> 方差比值檢驗 variance ratio test</a></li>
<li class="chapter" data-level="24.2.2" data-path="-comparisons.html"><a href="-comparisons.html#section-24.2.2"><i class="fa fa-check"></i><b>24.2.2</b> 信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="-comparisons.html"><a href="-comparisons.html#section-24.3"><i class="fa fa-check"></i><b>24.3</b> 比較兩個百分比</a><ul>
<li class="chapter" data-level="24.3.1" data-path="-comparisons.html"><a href="-comparisons.html#proportiontest"><i class="fa fa-check"></i><b>24.3.1</b> 兩個百分比差是否爲零的推斷 Risk difference</a></li>
<li class="chapter" data-level="24.3.2" data-path="-comparisons.html"><a href="-comparisons.html#-1--relative-riskrisk-ratio"><i class="fa fa-check"></i><b>24.3.2</b> 兩個百分比商是否爲 1 的推斷 relative risk/risk ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html"><i class="fa fa-check"></i><b>25</b> 前提和數據轉換 Assumptions and transformations</a><ul>
<li class="chapter" data-level="25.1" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#section-25.1"><i class="fa fa-check"></i><b>25.1</b> 穩健性</a></li>
<li class="chapter" data-level="25.2" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#section-25.2"><i class="fa fa-check"></i><b>25.2</b> 正態性</a><ul>
<li class="chapter" data-level="25.2.1" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#normalplot"><i class="fa fa-check"></i><b>25.2.1</b> 正態分佈圖 normal plot</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#section-25.3"><i class="fa fa-check"></i><b>25.3</b> 總結連續型變量不服從正態分佈時的處理方案</a></li>
<li class="chapter" data-level="25.4" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#-power-transformations"><i class="fa fa-check"></i><b>25.4</b> 數學冪轉換 power transformations</a><ul>
<li class="chapter" data-level="25.4.1" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#-logarithmic-transformation"><i class="fa fa-check"></i><b>25.4.1</b> 對數轉換 logarithmic Transformation</a></li>
<li class="chapter" data-level="25.4.2" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#-back-transformation-of-cis"><i class="fa fa-check"></i><b>25.4.2</b> 逆轉換信賴區間 back-transformation of CIs</a></li>
<li class="chapter" data-level="25.4.3" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#-log-normal-distribution"><i class="fa fa-check"></i><b>25.4.3</b> 對數正態分佈 log-normal distribution</a></li>
<li class="chapter" data-level="25.4.4" data-path="-assumptions-and-transformations.html"><a href="-assumptions-and-transformations.html#section-25.4.4"><i class="fa fa-check"></i><b>25.4.4</b> 百分比的轉換</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 線性迴歸 Linear Regression</b></span></li>
<li class="chapter" data-level="26" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>26</b> 簡單線性迴歸 Simple Linear Regression</a><ul>
<li class="chapter" data-level="26.1" data-path="lm.html"><a href="lm.html#section-26.1"><i class="fa fa-check"></i><b>26.1</b> 一些背景和術語</a></li>
<li class="chapter" data-level="26.2" data-path="lm.html"><a href="lm.html#-simple-linear-regression-model"><i class="fa fa-check"></i><b>26.2</b> 簡單線性迴歸模型 simple linear regression model</a><ul>
<li class="chapter" data-level="26.2.1" data-path="lm.html"><a href="lm.html#-a"><i class="fa fa-check"></i><b>26.2.1</b> 數據 A</a></li>
<li class="chapter" data-level="26.2.2" data-path="lm.html"><a href="lm.html#-b"><i class="fa fa-check"></i><b>26.2.2</b> 數據 B</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="lm.html"><a href="lm.html#section-26.3"><i class="fa fa-check"></i><b>26.3</b> 區分因變量和預測變量</a><ul>
<li class="chapter" data-level="26.3.1" data-path="lm.html"><a href="lm.html#meanfunction"><i class="fa fa-check"></i><b>26.3.1</b> 均值 (期待值) 公式</a></li>
<li class="chapter" data-level="26.3.2" data-path="lm.html"><a href="lm.html#-the-conditional-distribution-and-the-variance-function"><i class="fa fa-check"></i><b>26.3.2</b> 條件分佈和方差 the conditional distribution and the variance function</a></li>
<li class="chapter" data-level="26.3.3" data-path="lm.html"><a href="lm.html#defLM"><i class="fa fa-check"></i><b>26.3.3</b> 定義簡單線性迴歸模型</a></li>
<li class="chapter" data-level="26.3.4" data-path="lm.html"><a href="lm.html#-residuals"><i class="fa fa-check"></i><b>26.3.4</b> 殘差 residuals</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="lm.html"><a href="lm.html#-estimation-of-parameters"><i class="fa fa-check"></i><b>26.4</b> 參數的估計 estimation of parameters</a><ul>
<li class="chapter" data-level="26.4.1" data-path="lm.html"><a href="lm.html#MLEalphabeta"><i class="fa fa-check"></i><b>26.4.1</b> 普通最小二乘法估計 <span class="math inline">\(\alpha, \beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="lm.html"><a href="lm.html#ResidualVar"><i class="fa fa-check"></i><b>26.5</b> 殘差方差的估計 Estimation of the residual variance <span class="math inline">\((\sigma^2)\)</span></a></li>
<li class="chapter" data-level="26.6" data-path="lm.html"><a href="lm.html#r---1--reffigage-wt-"><i class="fa fa-check"></i><b>26.6</b> R 演示 例 1： 圖 @ref(fig:age-wt) 數據</a></li>
<li class="chapter" data-level="26.7" data-path="lm.html"><a href="lm.html#binarylms"><i class="fa fa-check"></i><b>26.7</b> R 演示 例 2： 表@ref(tab:walk) 數據</a></li>
<li class="chapter" data-level="26.8" data-path="lm.html"><a href="lm.html#exeChol"><i class="fa fa-check"></i><b>26.8</b> 練習</a><ul>
<li class="chapter" data-level="26.8.1" data-path="lm.html"><a href="lm.html#-c_1-c_2-c_2alphabeta-c_2-varepsilon"><i class="fa fa-check"></i><b>26.8.1</b> 兩次測量的膽固醇水平分別用 <span class="math inline">\(C_1, C_2\)</span> 來標記的話，考慮這樣的簡單線性迴歸模型：<span class="math inline">\(C_2=\alpha+\beta C_2 + \varepsilon\)</span>。我們進行這樣迴歸的前提假設有哪些？</a></li>
<li class="chapter" data-level="26.8.2" data-path="lm.html"><a href="lm.html#-ols--hatalpha-hatbeta"><i class="fa fa-check"></i><b>26.8.2</b> 計算普通最小二乘法 (OLS) 下，截距和斜率的估計值 <span class="math inline">\(\hat\alpha, \hat\beta\)</span></a></li>
<li class="chapter" data-level="26.8.3" data-path="lm.html"><a href="lm.html#section-26.8.3"><i class="fa fa-check"></i><b>26.8.3</b> 和迴歸模型計算的結果作比較，解釋這些估計值的含義</a></li>
<li class="chapter" data-level="26.8.4" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>26.8.4</b> 加上計算的估計值直線 (即迴歸直線)</a></li>
<li class="chapter" data-level="26.8.5" data-path="lm.html"><a href="lm.html#diagnosis"><i class="fa fa-check"></i><b>26.8.5</b> 下面的代碼用於模型的假設診斷</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html"><i class="fa fa-check"></i><b>27</b> 最小二乘估計的性質和推斷 Ordinary Least Squares Estimators and Inference</a><ul>
<li class="chapter" data-level="27.1" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#ols-"><i class="fa fa-check"></i><b>27.1</b> OLS 估計量的性質</a></li>
<li class="chapter" data-level="27.2" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#hatbeta-"><i class="fa fa-check"></i><b>27.2</b> <span class="math inline">\(\hat\beta\)</span> 的性質</a><ul>
<li class="chapter" data-level="27.2.1" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#randbeta"><i class="fa fa-check"></i><b>27.2.1</b> <span class="math inline">\(Y\)</span> 對 <span class="math inline">\(X\)</span> 迴歸， 和 <span class="math inline">\(X\)</span> 對 <span class="math inline">\(Y\)</span> 迴歸</a></li>
<li class="chapter" data-level="27.2.2" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#-1--reffigage-wt-"><i class="fa fa-check"></i><b>27.2.2</b> 例 1： 還是圖 @ref(fig:age-wt) 數據</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#section-27.3"><i class="fa fa-check"></i><b>27.3</b> 截距和迴歸係數的方差，協方差</a><ul>
<li class="chapter" data-level="27.3.1" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#centring"><i class="fa fa-check"></i><b>27.3.1</b> 中心化 centring</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#alpha-beta-"><i class="fa fa-check"></i><b>27.4</b> <span class="math inline">\(\alpha, \beta\)</span> 的推斷</a><ul>
<li class="chapter" data-level="27.4.1" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#section-27.4.1"><i class="fa fa-check"></i><b>27.4.1</b> 對迴歸係數進行假設檢驗</a></li>
<li class="chapter" data-level="27.4.2" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#section-27.4.2"><i class="fa fa-check"></i><b>27.4.2</b> 迴歸係數，截距的信賴區間</a></li>
<li class="chapter" data-level="27.4.3" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#----"><i class="fa fa-check"></i><b>27.4.3</b> 預測值的信賴區間 (置信帶) - 測量迴歸曲線本身的不確定性</a></li>
<li class="chapter" data-level="27.4.4" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#-reference-range----95-"><i class="fa fa-check"></i><b>27.4.4</b> 預測帶 Reference range - 包含了 95% 觀察值的區間</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#rsquare"><i class="fa fa-check"></i><b>27.5</b> 線性迴歸模型和 Pearson 相關係數</a><ul>
<li class="chapter" data-level="27.5.1" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#r2-"><i class="fa fa-check"></i><b>27.5.1</b> <span class="math inline">\(r^2\)</span> 可以理解爲因變量平方和被模型解釋的比例</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="-ordinary-least-squares-estimators-and-inference.html"><a href="-ordinary-least-squares-estimators-and-inference.html#t-r2-F"><i class="fa fa-check"></i><b>27.6</b> Pearson 相關係數和模型迴歸係數的檢驗統計量 <span class="math inline">\(t\)</span> 之間的關係</a></li>
<li class="chapter" data-level="27.7" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-2"><i class="fa fa-check"></i><b>27.7</b> 練習</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>28</b> 方差分析 Introduction to Analysis of Variance</a><ul>
<li class="chapter" data-level="28.1" data-path="ANOVA.html"><a href="ANOVA.html#section-28.1"><i class="fa fa-check"></i><b>28.1</b> 背景</a></li>
<li class="chapter" data-level="28.2" data-path="ANOVA.html"><a href="ANOVA.html#section-28.2"><i class="fa fa-check"></i><b>28.2</b> 簡單線性迴歸模型的方差分析</a><ul>
<li class="chapter" data-level="28.2.1" data-path="ANOVA.html"><a href="ANOVA.html#section-28.2.1"><i class="fa fa-check"></i><b>28.2.1</b> 兩個模型的參數估計</a></li>
<li class="chapter" data-level="28.2.2" data-path="ANOVA.html"><a href="ANOVA.html#section-28.2.2"><i class="fa fa-check"></i><b>28.2.2</b> 分割零假設模型的殘差平方和</a></li>
<li class="chapter" data-level="28.2.3" data-path="ANOVA.html"><a href="ANOVA.html#Rsquare"><i class="fa fa-check"></i><b>28.2.3</b> <span class="math inline">\(R^2\)</span> – 我的名字叫<strong>決定係數</strong> coefficient of determination</a></li>
<li class="chapter" data-level="28.2.4" data-path="ANOVA.html"><a href="ANOVA.html#-the-anova-table"><i class="fa fa-check"></i><b>28.2.4</b> 方差分析表格 the ANOVA table</a></li>
<li class="chapter" data-level="28.2.5" data-path="ANOVA.html"><a href="ANOVA.html#-anova-"><i class="fa fa-check"></i><b>28.2.5</b> 用 ANOVA 進行假設檢驗</a></li>
<li class="chapter" data-level="28.2.6" data-path="ANOVA.html"><a href="ANOVA.html#lm-Ftest"><i class="fa fa-check"></i><b>28.2.6</b> 簡單線性迴歸時的 <span class="math inline">\(F\)</span> 檢驗</a></li>
<li class="chapter" data-level="28.2.7" data-path="ANOVA.html"><a href="ANOVA.html#F-t-same"><i class="fa fa-check"></i><b>28.2.7</b> 簡單線性迴歸時 <span class="math inline">\(F\)</span> 檢驗和 <span class="math inline">\(t\)</span> 檢驗的一致性</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="ANOVA.html"><a href="ANOVA.html#-anova"><i class="fa fa-check"></i><b>28.3</b> 分類變量用作預測變量時的 ANOVA</a><ul>
<li class="chapter" data-level="28.3.1" data-path="ANOVA.html"><a href="ANOVA.html#section-28.3.1"><i class="fa fa-check"></i><b>28.3.1</b> 一個二分類預測變量</a></li>
<li class="chapter" data-level="28.3.2" data-path="ANOVA.html"><a href="ANOVA.html#section-28.3.2"><i class="fa fa-check"></i><b>28.3.2</b> 一個模型，兩種表述</a></li>
<li class="chapter" data-level="28.3.3" data-path="ANOVA.html"><a href="ANOVA.html#section-28.3.3"><i class="fa fa-check"></i><b>28.3.3</b> 分組變量的平方和</a></li>
<li class="chapter" data-level="28.3.4" data-path="ANOVA.html"><a href="ANOVA.html#section-28.3.4"><i class="fa fa-check"></i><b>28.3.4</b> 簡單模型的分組變量大於兩組的情況</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="-multivariable-models.html"><a href="-multivariable-models.html"><i class="fa fa-check"></i><b>29</b> 多元模型分析 Multivariable Models</a><ul>
<li class="chapter" data-level="29.1" data-path="-multivariable-models.html"><a href="-multivariable-models.html#section-29.1"><i class="fa fa-check"></i><b>29.1</b> 兩個預測變量的線性迴歸模型</a><ul>
<li class="chapter" data-level="29.1.1" data-path="-multivariable-models.html"><a href="-multivariable-models.html#section-29.1.1"><i class="fa fa-check"></i><b>29.1.1</b> 數學標記法和解釋</a></li>
<li class="chapter" data-level="29.1.2" data-path="-multivariable-models.html"><a href="-multivariable-models.html#-least-squares-estimation"><i class="fa fa-check"></i><b>29.1.2</b> 最小平方和估計 Least Squares Estimation</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="-multivariable-models.html"><a href="-multivariable-models.html#section-29.2"><i class="fa fa-check"></i><b>29.2</b> 線性回歸模型中使用分組變量</a></li>
<li class="chapter" data-level="29.3" data-path="-multivariable-models.html"><a href="-multivariable-models.html#-the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>29.3</b> 協方差分析模型 the Analysis of Covariance (ANCOVA) Model</a></li>
<li class="chapter" data-level="29.4" data-path="-multivariable-models.html"><a href="-multivariable-models.html#section-29.4"><i class="fa fa-check"></i><b>29.4</b> 偏回歸係數的變化</a><ul>
<li class="chapter" data-level="29.4.1" data-path="-multivariable-models.html"><a href="-multivariable-models.html#1-beta_1-beta_1"><i class="fa fa-check"></i><b>29.4.1</b> 情況1： <span class="math inline">\(\beta_1 &gt; \beta_1^*\)</span></a></li>
<li class="chapter" data-level="29.4.2" data-path="-multivariable-models.html"><a href="-multivariable-models.html#2beta_1beta_1"><i class="fa fa-check"></i><b>29.4.2</b> 情況2：<span class="math inline">\(\beta_1&lt;\beta_1^*\)</span></a></li>
<li class="chapter" data-level="29.4.3" data-path="-multivariable-models.html"><a href="-multivariable-models.html#3-beta_1-beta_1"><i class="fa fa-check"></i><b>29.4.3</b> 情況3： <span class="math inline">\(\beta_1 = \beta_1^*\)</span></a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="-multivariable-models.html"><a href="-multivariable-models.html#confounding"><i class="fa fa-check"></i><b>29.5</b> 混雜 confounding</a><ul>
<li class="chapter" data-level="29.5.1" data-path="-multivariable-models.html"><a href="-multivariable-models.html#-mediation-effect"><i class="fa fa-check"></i><b>29.5.1</b> 作為媒介 mediation effect</a></li>
<li class="chapter" data-level="29.5.2" data-path="-multivariable-models.html"><a href="-multivariable-models.html#section-29.5.2"><i class="fa fa-check"></i><b>29.5.2</b> 兩個預測變量之間的關係</a></li>
<li class="chapter" data-level="29.5.3" data-path="-multivariable-models.html"><a href="-multivariable-models.html#rct"><i class="fa fa-check"></i><b>29.5.3</b> RCT臨床實驗是個特例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="section-30.html"><a href="section-30.html"><i class="fa fa-check"></i><b>30</b> 多元模型分析：矩陣標記與其意義</a><ul>
<li class="chapter" data-level="30.1" data-path="section-30.html"><a href="section-30.html#section-30.1"><i class="fa fa-check"></i><b>30.1</b> 線性回歸模型的矩陣/非矩陣標記法</a><ul>
<li class="chapter" data-level="30.1.1" data-path="section-30.html"><a href="section-30.html#section-30.1.1"><i class="fa fa-check"></i><b>30.1.1</b> 模型標記：</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="section-30.html"><a href="section-30.html#section-30.2"><i class="fa fa-check"></i><b>30.2</b> 解讀參數</a><ul>
<li class="chapter" data-level="30.2.1" data-path="section-30.html"><a href="section-30.html#section-30.2.1"><i class="fa fa-check"></i><b>30.2.1</b> 最小二乘估計</a></li>
<li class="chapter" data-level="30.2.2" data-path="section-30.html"><a href="section-30.html#-mathbfhat-y"><i class="fa fa-check"></i><b>30.2.2</b> 因變量的期待值 <span class="math inline">\(\mathbf{\hat Y}\)</span></a></li>
<li class="chapter" data-level="30.2.3" data-path="section-30.html"><a href="section-30.html#section-30.2.3"><i class="fa fa-check"></i><b>30.2.3</b> 殘差</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="section-30.html"><a href="section-30.html#-f-"><i class="fa fa-check"></i><b>30.3</b> 方差分析一般化和 <span class="math inline">\(F\)</span> 檢驗</a><ul>
<li class="chapter" data-level="30.3.1" data-path="section-30.html"><a href="section-30.html#section-30.3.1"><i class="fa fa-check"></i><b>30.3.1</b> 多元線性迴歸時的決定係數和殘差方差</a></li>
<li class="chapter" data-level="30.3.2" data-path="section-30.html"><a href="section-30.html#section-30.3.2"><i class="fa fa-check"></i><b>30.3.2</b> 方差分析表格</a></li>
<li class="chapter" data-level="30.3.3" data-path="section-30.html"><a href="section-30.html#globalsig"><i class="fa fa-check"></i><b>30.3.3</b> 迴歸方程的顯著性檢驗</a></li>
<li class="chapter" data-level="30.3.4" data-path="section-30.html"><a href="section-30.html#partialF"><i class="fa fa-check"></i><b>30.3.4</b> <span class="math inline">\(\text{partial }F\)</span> 檢驗</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="section-30.html"><a href="section-30.html#section-30.4"><i class="fa fa-check"></i><b>30.4</b> 添加新變量對迴歸模型的影響</a><ul>
<li class="chapter" data-level="30.4.1" data-path="section-30.html"><a href="section-30.html#section-30.4.1"><i class="fa fa-check"></i><b>30.4.1</b> 偏迴歸係數方差的改變</a></li>
<li class="chapter" data-level="30.4.2" data-path="section-30.html"><a href="section-30.html#section-30.4.2"><i class="fa fa-check"></i><b>30.4.2</b> 偏迴歸係數檢驗結果的改變</a></li>
<li class="chapter" data-level="30.4.3" data-path="section-30.html"><a href="section-30.html#section-30.4.3"><i class="fa fa-check"></i><b>30.4.3</b> 擬合值的改變</a></li>
<li class="chapter" data-level="30.4.4" data-path="section-30.html"><a href="section-30.html#section-30.4.4"><i class="fa fa-check"></i><b>30.4.4</b> 決定係數的改變</a></li>
<li class="chapter" data-level="30.4.5" data-path="section-30.html"><a href="section-30.html#-collinearity"><i class="fa fa-check"></i><b>30.4.5</b> 共線性 collinearity</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="section-30.html"><a href="section-30.html#section-30.5"><i class="fa fa-check"></i><b>30.5</b> 實戰演習</a><ul>
<li class="chapter" data-level="30.5.1" data-path="section-30.html"><a href="section-30.html#-c-"><i class="fa fa-check"></i><b>30.5.1</b> 血清維生素 C 濃度的預測變量</a></li>
<li class="chapter" data-level="30.5.2" data-path="section-30.html"><a href="section-30.html#section-30.5.2"><i class="fa fa-check"></i><b>30.5.2</b> 紅細胞容積與血紅蛋白</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="section-31.html"><a href="section-31.html"><i class="fa fa-check"></i><b>31</b> 線性迴歸的模型診斷</a><ul>
<li class="chapter" data-level="31.1" data-path="section-31.html"><a href="section-31.html#section-31.1"><i class="fa fa-check"></i><b>31.1</b> 線性迴歸模型的前提條件</a></li>
<li class="chapter" data-level="31.2" data-path="section-31.html"><a href="section-31.html#section-31.2"><i class="fa fa-check"></i><b>31.2</b> 用圖形來視覺診斷</a></li>
<li class="chapter" data-level="31.3" data-path="section-31.html"><a href="section-31.html#section-31.3"><i class="fa fa-check"></i><b>31.3</b> 殘差圖</a></li>
<li class="chapter" data-level="31.4" data-path="section-31.html"><a href="section-31.html#-normal-plot-of-residuals"><i class="fa fa-check"></i><b>31.4</b> 殘差正態圖 normal plot of residuals</a><ul>
<li class="chapter" data-level="31.4.1" data-path="section-31.html"><a href="section-31.html#section-31.4.1"><i class="fa fa-check"></i><b>31.4.1</b> 模型診斷實例</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="section-31.html"><a href="section-31.html#section-31.5"><i class="fa fa-check"></i><b>31.5</b> 前提條件的統計學檢驗</a><ul>
<li class="chapter" data-level="31.5.1" data-path="section-31.html"><a href="section-31.html#section-31.5.1"><i class="fa fa-check"></i><b>31.5.1</b> 二次方程迴歸法檢驗非線性</a></li>
<li class="chapter" data-level="31.5.2" data-path="section-31.html"><a href="section-31.html#section-31.5.2"><i class="fa fa-check"></i><b>31.5.2</b> 非線性關係模型</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="section-31.html"><a href="section-31.html#section-31.6"><i class="fa fa-check"></i><b>31.6</b> 異常值，槓桿值，和庫克距離</a><ul>
<li class="chapter" data-level="31.6.1" data-path="section-31.html"><a href="section-31.html#standardres"><i class="fa fa-check"></i><b>31.6.1</b> 異常值和標準化殘差</a></li>
<li class="chapter" data-level="31.6.2" data-path="section-31.html"><a href="section-31.html#-leverage"><i class="fa fa-check"></i><b>31.6.2</b> 槓桿值 Leverage</a></li>
<li class="chapter" data-level="31.6.3" data-path="section-31.html"><a href="section-31.html#-cooks-distance"><i class="fa fa-check"></i><b>31.6.3</b> 庫克距離 Cook’s Distance</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="section-31.html"><a href="section-31.html#section-31.7"><i class="fa fa-check"></i><b>31.7</b> 在統計忍者包裏面對模型診斷作圖</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>32</b> 交互作用 Interactions</a><ul>
<li class="chapter" data-level="32.1" data-path="interaction.html"><a href="interaction.html#section-32.1"><i class="fa fa-check"></i><b>32.1</b> 兩個預測變量之間的線性模型交互作用</a><ul>
<li class="chapter" data-level="32.1.1" data-path="interaction.html"><a href="interaction.html#section-32.1.1"><i class="fa fa-check"></i><b>32.1.1</b> 交互作用線性模型的一般表達式</a></li>
<li class="chapter" data-level="32.1.2" data-path="interaction.html"><a href="interaction.html#interaction-cont-bin"><i class="fa fa-check"></i><b>32.1.2</b> 連續型變量和二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="32.1.3" data-path="interaction.html"><a href="interaction.html#section-32.1.3"><i class="fa fa-check"></i><b>32.1.3</b> 兩個二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="32.1.4" data-path="interaction.html"><a href="interaction.html#section-32.1.4"><i class="fa fa-check"></i><b>32.1.4</b> 兩個連續變量之間的交互作用</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V 臨床實驗 Clinical Trials</b></span></li>
<li class="chapter" data-level="33" data-path="sample-size.html"><a href="sample-size.html"><i class="fa fa-check"></i><b>33</b> 樣本量計算問題</a><ul>
<li class="chapter" data-level="33.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>33.1</b> 背景</a></li>
<li class="chapter" data-level="33.2" data-path="sample-size.html"><a href="sample-size.html#section-33.2"><i class="fa fa-check"></i><b>33.2</b> 決定所需樣本量大小的統計學因素</a></li>
<li class="chapter" data-level="33.3" data-path="sample-size.html"><a href="sample-size.html#-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>33.3</b> 第一類和第二類錯誤 Type I and type II errors</a></li>
<li class="chapter" data-level="33.4" data-path="sample-size.html"><a href="sample-size.html#-percentages-or-proportions"><i class="fa fa-check"></i><b>33.4</b> 比較兩組之間的百分比 (percentages or proportions)</a><ul>
<li class="chapter" data-level="33.4.1" data-path="sample-size.html"><a href="sample-size.html#--5--90"><i class="fa fa-check"></i><b>33.4.1</b> 樣本量計算公式 (使用顯著水平 5%, 和檢驗效能 90%)</a></li>
<li class="chapter" data-level="33.4.2" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>33.4.2</b> 樣本量計算公式的一般化 (不同的顯著水平和檢驗效能條件下)</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="sample-size.html"><a href="sample-size.html#section-33.5"><i class="fa fa-check"></i><b>33.5</b> 比較兩組之間的均值</a><ul>
<li class="chapter" data-level="33.5.1" data-path="sample-size.html"><a href="sample-size.html#section-33.5.1"><i class="fa fa-check"></i><b>33.5.1</b> 樣本量計算公式</a></li>
</ul></li>
<li class="chapter" data-level="33.6" data-path="sample-size.html"><a href="sample-size.html#section-33.6"><i class="fa fa-check"></i><b>33.6</b> 樣本量計算的調整</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="baseline-adjustment-using-ancova.html"><a href="baseline-adjustment-using-ancova.html"><i class="fa fa-check"></i><b>34</b> Baseline Adjustment using ANCOVA</a></li>
<li class="part"><span><b>VI 穩健統計方法 Robust Statistic Methods</b></span></li>
<li class="chapter" data-level="35" data-path="section-35.html"><a href="section-35.html"><i class="fa fa-check"></i><b>35</b> 穩健統計方法入門</a></li>
<li class="chapter" data-level="36" data-path="section-36.html"><a href="section-36.html"><i class="fa fa-check"></i><b>36</b> 基於秩次的非參數檢驗</a><ul>
<li class="chapter" data-level="36.1" data-path="section-36.html"><a href="section-36.html#sign-test"><i class="fa fa-check"></i><b>36.1</b> 符號檢驗 the Sign test</a><ul>
<li class="chapter" data-level="36.1.1" data-path="section-36.html"><a href="section-36.html#section-36.1.1"><i class="fa fa-check"></i><b>36.1.1</b> 符號檢驗的特點</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="section-36.html"><a href="section-36.html#Wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>36.2</b> Wilcoxon 符號秩和檢驗，the Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="36.3" data-path="section-36.html"><a href="section-36.html#wilcoxon-mann-whitney-wmw-"><i class="fa fa-check"></i><b>36.3</b> Wilcoxon-Mann-Whitney (WMW) 檢驗</a></li>
<li class="chapter" data-level="36.4" data-path="section-36.html"><a href="section-36.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>36.4</b> 秩相關，Spearman’s Rank Correlation Coefficient</a></li>
<li class="chapter" data-level="36.5" data-path="section-36.html"><a href="section-36.html#section-36.5"><i class="fa fa-check"></i><b>36.5</b> 基於秩次的非參數檢驗的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html"><i class="fa fa-check"></i><b>37</b> 排列置換法 Permutation procedures</a><ul>
<li class="chapter" data-level="37.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>37.1</b> 背景介紹</a></li>
<li class="chapter" data-level="37.2" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-37.2"><i class="fa fa-check"></i><b>37.2</b> 直接上實例</a></li>
<li class="chapter" data-level="37.3" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-37.3"><i class="fa fa-check"></i><b>37.3</b> 排列置換法三板斧</a><ul>
<li class="chapter" data-level="37.3.1" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#-t"><i class="fa fa-check"></i><b>37.3.1</b> 該如何選用合適的檢驗統計量 <span class="math inline">\(T\)</span>？</a></li>
<li class="chapter" data-level="37.3.2" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#-adjustment-"><i class="fa fa-check"></i><b>37.3.2</b> 可以在排列置換法中對其他變量進行統計學調整 (adjustment) 嗎？</a></li>
<li class="chapter" data-level="37.3.3" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-37.3.3"><i class="fa fa-check"></i><b>37.3.3</b> 排列置換法，基於秩次的非參數檢驗之間的關係</a></li>
<li class="chapter" data-level="37.3.4" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-37.3.4"><i class="fa fa-check"></i><b>37.3.4</b> 排列置換檢驗法，是一種精確檢驗</a></li>
</ul></li>
<li class="chapter" data-level="37.4" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-37.4"><i class="fa fa-check"></i><b>37.4</b> 基於排序置換檢驗法計算信賴區間</a></li>
<li class="chapter" data-level="37.5" data-path="-permutation-procedures.html"><a href="-permutation-procedures.html#section-37.5"><i class="fa fa-check"></i><b>37.5</b> 排序置換法的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="-the-bootstrap.html"><a href="-the-bootstrap.html"><i class="fa fa-check"></i><b>38</b> 自助重抽法 The bootstrap</a><ul>
<li class="chapter" data-level="38.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>38.1</b> 定義</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="the-sandwich-estimator.html"><a href="the-sandwich-estimator.html"><i class="fa fa-check"></i><b>39</b> The sandwich estimator</a></li>
<li class="part"><span><b>VII 貝葉斯統計</b></span></li>
<li class="chapter" data-level="40" data-path="section-40.html"><a href="section-40.html"><i class="fa fa-check"></i><b>40</b> 貝葉斯統計入門</a><ul>
<li class="chapter" data-level="40.1" data-path="section-40.html"><a href="section-40.html#section-40.1"><i class="fa fa-check"></i><b>40.1</b> 概率論推斷的複習</a></li>
<li class="chapter" data-level="40.2" data-path="section-40.html"><a href="section-40.html#-bayesian-reasoninginverse-probability"><i class="fa fa-check"></i><b>40.2</b> 貝葉斯概率推理/逆概率 Bayesian reasoning/inverse probability</a><ul>
<li class="chapter" data-level="40.2.1" data-path="section-40.html"><a href="section-40.html#-deductive-reasoning---weak-syllogisms"><i class="fa fa-check"></i><b>40.2.1</b> 演繹推理 deductive reasoning 和 三段論 weak syllogisms</a></li>
<li class="chapter" data-level="40.2.2" data-path="section-40.html"><a href="section-40.html#-quantifying-plausibility"><i class="fa fa-check"></i><b>40.2.2</b> 如何給可能性定量 Quantifying plausibility</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="section-40.html"><a href="section-40.html#section-40.3"><i class="fa fa-check"></i><b>40.3</b> 貝葉斯推理的統計學實現</a><ul>
<li class="chapter" data-level="40.3.1" data-path="section-40.html"><a href="section-40.html#-diagnostic-testing"><i class="fa fa-check"></i><b>40.3.1</b> 醫學診斷測試 diagnostic testing</a></li>
<li class="chapter" data-level="40.3.2" data-path="section-40.html"><a href="section-40.html#hiv-"><i class="fa fa-check"></i><b>40.3.2</b> HIV 檢查時的應用</a></li>
<li class="chapter" data-level="40.3.3" data-path="section-40.html"><a href="section-40.html#section-40.3.3"><i class="fa fa-check"></i><b>40.3.3</b> 說點小歷史</a></li>
</ul></li>
<li class="chapter" data-level="40.4" data-path="section-40.html"><a href="section-40.html#-5"><i class="fa fa-check"></i><b>40.4</b> 練習題</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="section-41.html"><a href="section-41.html"><i class="fa fa-check"></i><b>41</b> 貝葉斯定理的應用：單一參數模型</a><ul>
<li class="chapter" data-level="41.1" data-path="section-41.html"><a href="section-41.html#-notation-for-probability-density-functions"><i class="fa fa-check"></i><b>41.1</b> 貝葉斯理論下的事後二項分佈概率密度方程 notation for probability density functions</a></li>
<li class="chapter" data-level="41.2" data-path="section-41.html"><a href="section-41.html#theta-"><i class="fa fa-check"></i><b>41.2</b> <span class="math inline">\(\theta\)</span> 的先驗概率</a><ul>
<li class="chapter" data-level="41.2.1" data-path="section-41.html"><a href="section-41.html#beta--the-beta-distribution"><i class="fa fa-check"></i><b>41.2.1</b> beta 分佈 the beta distribution</a></li>
<li class="chapter" data-level="41.2.2" data-path="section-41.html"><a href="section-41.html#conjugate"><i class="fa fa-check"></i><b>41.2.2</b> 二項分佈數據事後概率分佈的一般化：共軛性</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="section-41.html"><a href="section-41.html#section-41.3"><i class="fa fa-check"></i><b>41.3</b> 附贈–加量不加價</a></li>
<li class="chapter" data-level="41.4" data-path="section-41.html"><a href="section-41.html#-6"><i class="fa fa-check"></i><b>41.4</b> 練習題</a><ul>
<li class="chapter" data-level="41.4.1" data-path="section-41.html"><a href="section-41.html#q1-4"><i class="fa fa-check"></i><b>41.4.1</b> Q1</a></li>
<li class="chapter" data-level="41.4.2" data-path="section-41.html"><a href="section-41.html#q2-3"><i class="fa fa-check"></i><b>41.4.2</b> Q2</a></li>
<li class="chapter" data-level="41.4.3" data-path="section-41.html"><a href="section-41.html#q3-2"><i class="fa fa-check"></i><b>41.4.3</b> Q3</a></li>
<li class="chapter" data-level="41.4.4" data-path="section-41.html"><a href="section-41.html#q4"><i class="fa fa-check"></i><b>41.4.4</b> Q4</a></li>
<li class="chapter" data-level="41.4.5" data-path="section-41.html"><a href="section-41.html#q5"><i class="fa fa-check"></i><b>41.4.5</b> Q5</a></li>
<li class="chapter" data-level="41.4.6" data-path="section-41.html"><a href="section-41.html#q6"><i class="fa fa-check"></i><b>41.4.6</b> Q6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="42" data-path="-normal-distribution-applying-bayes-theorem.html"><a href="-normal-distribution-applying-bayes-theorem.html"><i class="fa fa-check"></i><b>42</b> 貝葉斯理論在正態分布數據中的應用 Normal distribution applying Bayes’ Theorem</a><ul>
<li class="chapter" data-level="42.1" data-path="-normal-distribution-applying-bayes-theorem.html"><a href="-normal-distribution-applying-bayes-theorem.html#section-42.1"><i class="fa fa-check"></i><b>42.1</b> 事後概率的總結方法</a></li>
<li class="chapter" data-level="42.2" data-path="-normal-distribution-applying-bayes-theorem.html"><a href="-normal-distribution-applying-bayes-theorem.html#section-42.2"><i class="fa fa-check"></i><b>42.2</b> 貝葉斯統計推斷中的正態分布</a><ul>
<li class="chapter" data-level="42.2.1" data-path="-normal-distribution-applying-bayes-theorem.html"><a href="-normal-distribution-applying-bayes-theorem.html#n-independent-identically-distributed-observations"><i class="fa fa-check"></i><b>42.2.1</b> <span class="math inline">\(n\)</span> independent identically distributed observations</a></li>
</ul></li>
<li class="chapter" data-level="42.3" data-path="-normal-distribution-applying-bayes-theorem.html"><a href="-normal-distribution-applying-bayes-theorem.html#section-42.3"><i class="fa fa-check"></i><b>42.3</b> 貝葉斯預測分布</a></li>
</ul></li>
<li class="part"><span><b>VIII 廣義線性迴歸模型</b></span></li>
<li class="chapter" data-level="43" data-path="section-43.html"><a href="section-43.html"><i class="fa fa-check"></i><b>43</b> 重要概念複習</a><ul>
<li class="chapter" data-level="43.1" data-path="section-43.html"><a href="section-43.html#section-43.1"><i class="fa fa-check"></i><b>43.1</b> 概率論學派統計推斷要點複習</a></li>
<li class="chapter" data-level="43.2" data-path="section-43.html"><a href="section-43.html#section-43.2"><i class="fa fa-check"></i><b>43.2</b> 似然</a></li>
<li class="chapter" data-level="43.3" data-path="section-43.html"><a href="section-43.html#section-43.3"><i class="fa fa-check"></i><b>43.3</b> 極大似然估計</a></li>
<li class="chapter" data-level="43.4" data-path="section-43.html"><a href="section-43.html#section-43.4"><i class="fa fa-check"></i><b>43.4</b> 關於假設檢驗的複習</a><ul>
<li class="chapter" data-level="43.4.1" data-path="section-43.html"><a href="section-43.html#section-43.4.1"><i class="fa fa-check"></i><b>43.4.1</b> 子集似然函數</a></li>
</ul></li>
<li class="chapter" data-level="43.5" data-path="section-43.html"><a href="section-43.html#section-43.5"><i class="fa fa-check"></i><b>43.5</b> 線性迴歸複習</a><ul>
<li class="chapter" data-level="43.5.1" data-path="section-43.html"><a href="section-43.html#section-43.5.1"><i class="fa fa-check"></i><b>43.5.1</b> 簡單線性迴歸</a></li>
<li class="chapter" data-level="43.5.2" data-path="section-43.html"><a href="section-43.html#section-43.5.2"><i class="fa fa-check"></i><b>43.5.2</b> 多元線性迴歸</a></li>
<li class="chapter" data-level="43.5.3" data-path="section-43.html"><a href="section-43.html#score-equations"><i class="fa fa-check"></i><b>43.5.3</b> 簡單線性迴歸的統計推斷</a></li>
</ul></li>
<li class="chapter" data-level="43.6" data-path="section-43.html"><a href="section-43.html#glm-practical-01"><i class="fa fa-check"></i><b>43.6</b> GLM-Practical 01</a><ul>
<li class="chapter" data-level="43.6.1" data-path="section-43.html"><a href="section-43.html#section-43.6.1"><i class="fa fa-check"></i><b>43.6.1</b> 建立似然方程</a></li>
<li class="chapter" data-level="43.6.2" data-path="section-43.html"><a href="section-43.html#section-43.6.2"><i class="fa fa-check"></i><b>43.6.2</b> 建立對數似然方程</a></li>
<li class="chapter" data-level="43.6.3" data-path="section-43.html"><a href="section-43.html#section-43.6.3"><i class="fa fa-check"></i><b>43.6.3</b> 線性回歸模型</a></li>
<li class="chapter" data-level="43.6.4" data-path="section-43.html"><a href="section-43.html#wald-score-"><i class="fa fa-check"></i><b>43.6.4</b> 似然比檢驗，Wald 檢驗，Score 檢驗</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="section-44.html"><a href="section-44.html"><i class="fa fa-check"></i><b>44</b> 廣義線性迴歸入門</a><ul>
<li class="chapter" data-level="44.1" data-path="section-44.html"><a href="section-44.html#section-44.1"><i class="fa fa-check"></i><b>44.1</b> 指數分佈家族</a><ul>
<li class="chapter" data-level="44.1.1" data-path="section-44.html"><a href="section-44.html#section-44.1.1"><i class="fa fa-check"></i><b>44.1.1</b> 泊松分佈和二項分佈的指數分佈家族屬性</a></li>
<li class="chapter" data-level="44.1.2" data-path="section-44.html"><a href="section-44.html#exercise.-exponential-distribution"><i class="fa fa-check"></i><b>44.1.2</b> Exercise. Exponential distribution</a></li>
</ul></li>
<li class="chapter" data-level="44.2" data-path="section-44.html"><a href="section-44.html#defineaGLM"><i class="fa fa-check"></i><b>44.2</b> 廣義線性迴歸模型之定義</a></li>
<li class="chapter" data-level="44.3" data-path="section-44.html"><a href="section-44.html#section-44.3"><i class="fa fa-check"></i><b>44.3</b> 注意</a></li>
<li class="chapter" data-level="44.4" data-path="section-44.html"><a href="section-44.html#-r--glm"><i class="fa fa-check"></i><b>44.4</b> 如何在 R 裏擬合 “GLM”</a><ul>
<li class="chapter" data-level="44.4.1" data-path="section-44.html"><a href="section-44.html#margins-"><i class="fa fa-check"></i><b>44.4.1</b> <code>margins</code> 命令</a></li>
<li class="chapter" data-level="44.4.2" data-path="section-44.html"><a href="section-44.html#ggplot2geom_smoothmethod-loess-"><i class="fa fa-check"></i><b>44.4.2</b> <code>ggplot2::geom_smooth(method = &quot;loess&quot;)</code> 命令</a></li>
</ul></li>
<li class="chapter" data-level="44.5" data-path="section-44.html"><a href="section-44.html#glm-practical-02"><i class="fa fa-check"></i><b>44.5</b> GLM-Practical 02</a><ul>
<li class="chapter" data-level="44.5.1" data-path="section-44.html"><a href="section-44.html#-y-"><i class="fa fa-check"></i><b>44.5.1</b> 思考本章中指數分布家族的參數設置。假如，有一個觀測值 <span class="math inline">\(y\)</span> 來自指數家族。試求證:</a></li>
<li class="chapter" data-level="44.5.2" data-path="section-44.html"><a href="section-44.html#r-"><i class="fa fa-check"></i><b>44.5.2</b> R 練習</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="45" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html"><i class="fa fa-check"></i><b>45</b> 二項分佈數據的廣義線性迴歸模型 logistic regression model</a><ul>
<li class="chapter" data-level="45.1" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#-grouped-individual-"><i class="fa fa-check"></i><b>45.1</b> 分組/個人 (grouped / individual) 的二項分佈數據</a></li>
<li class="chapter" data-level="45.2" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#section-45.2"><i class="fa fa-check"></i><b>45.2</b> 二項分佈數據的廣義線性迴歸模型</a></li>
<li class="chapter" data-level="45.3" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#logit-or-log"><i class="fa fa-check"></i><b>45.3</b> 注</a><ul>
<li class="chapter" data-level="45.3.1" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#exercise.-link-functions."><i class="fa fa-check"></i><b>45.3.1</b> Exercise. Link functions.</a></li>
</ul></li>
<li class="chapter" data-level="45.4" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#section-45.4"><i class="fa fa-check"></i><b>45.4</b> 邏輯迴歸模型迴歸係數的實際意義</a></li>
<li class="chapter" data-level="45.5" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#BSEinfection"><i class="fa fa-check"></i><b>45.5</b> 邏輯迴歸實際案例</a><ul>
<li class="chapter" data-level="45.5.1" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#section-45.5.1"><i class="fa fa-check"></i><b>45.5.1</b> 分析目的</a></li>
<li class="chapter" data-level="45.5.2" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#-1--"><i class="fa fa-check"></i><b>45.5.2</b> 模型 1 飼料 + 羣</a></li>
<li class="chapter" data-level="45.5.3" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#-2---times-"><i class="fa fa-check"></i><b>45.5.3</b> 模型 2 增加交互作用項 飼料 <span class="math inline">\(\times\)</span> 羣</a></li>
</ul></li>
<li class="chapter" data-level="45.6" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#glm-practical-03"><i class="fa fa-check"></i><b>45.6</b> GLM-Practical 03</a><ul>
<li class="chapter" data-level="45.6.1" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#section-45.6.1"><i class="fa fa-check"></i><b>45.6.1</b> 昆蟲的死亡率</a></li>
<li class="chapter" data-level="45.6.2" data-path="-logistic-regression-model.html"><a href="-logistic-regression-model.html#section-45.6.2"><i class="fa fa-check"></i><b>45.6.2</b> 哮喘門診數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="46" data-path="section-46.html"><a href="section-46.html"><i class="fa fa-check"></i><b>46</b> 模型比較和擬合優度</a><ul>
<li class="chapter" data-level="46.1" data-path="section-46.html"><a href="section-46.html#-nested-models"><i class="fa fa-check"></i><b>46.1</b> 嵌套式模型的比較 nested models</a></li>
<li class="chapter" data-level="46.2" data-path="section-46.html"><a href="section-46.html#section-46.2"><i class="fa fa-check"></i><b>46.2</b> 嵌套式模型比較實例</a></li>
<li class="chapter" data-level="46.3" data-path="section-46.html"><a href="section-46.html#section-46.3"><i class="fa fa-check"></i><b>46.3</b> 飽和模型，模型的偏差，擬合優度</a><ul>
<li class="chapter" data-level="46.3.1" data-path="section-46.html"><a href="section-46.html#-saturated-model"><i class="fa fa-check"></i><b>46.3.1</b> 飽和模型 saturated model</a></li>
<li class="chapter" data-level="46.3.2" data-path="section-46.html"><a href="section-46.html#deviance"><i class="fa fa-check"></i><b>46.3.2</b> 模型偏差 deviance</a></li>
</ul></li>
<li class="chapter" data-level="46.4" data-path="section-46.html"><a href="section-46.html#gof"><i class="fa fa-check"></i><b>46.4</b> 個人數據擬合模型的優度檢驗</a></li>
</ul></li>
<li class="chapter" data-level="47" data-path="-poisson-regression.html"><a href="-poisson-regression.html"><i class="fa fa-check"></i><b>47</b> 計數型因變量 Poisson regression</a><ul>
<li class="chapter" data-level="47.1" data-path="-poisson-regression.html"><a href="-poisson-regression.html#-glm"><i class="fa fa-check"></i><b>47.1</b> 泊松 GLM</a></li>
<li class="chapter" data-level="47.2" data-path="-poisson-regression.html"><a href="-poisson-regression.html#section-47.2"><i class="fa fa-check"></i><b>47.2</b> 泊松迴歸實例</a></li>
<li class="chapter" data-level="47.3" data-path="-poisson-regression.html"><a href="-poisson-regression.html#-overdispersion"><i class="fa fa-check"></i><b>47.3</b> 過度離散 overdispersion</a><ul>
<li class="chapter" data-level="47.3.1" data-path="-poisson-regression.html"><a href="-poisson-regression.html#section-47.3.1"><i class="fa fa-check"></i><b>47.3.1</b> 過度離散怎麼查？</a></li>
<li class="chapter" data-level="47.3.2" data-path="-poisson-regression.html"><a href="-poisson-regression.html#-negative-binomial-model"><i class="fa fa-check"></i><b>47.3.2</b> 負二項式分佈模型 negative binomial model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="48" data-path="-poisson-glm-for-rates.html"><a href="-poisson-glm-for-rates.html"><i class="fa fa-check"></i><b>48</b> 率的廣義線性迴歸 Poisson GLM for rates</a><ul>
<li class="chapter" data-level="48.1" data-path="-poisson-glm-for-rates.html"><a href="-poisson-glm-for-rates.html#section-48.1"><i class="fa fa-check"></i><b>48.1</b> 醫學中的率</a></li>
<li class="chapter" data-level="48.2" data-path="-poisson-glm-for-rates.html"><a href="-poisson-glm-for-rates.html#section-48.2"><i class="fa fa-check"></i><b>48.2</b> 泊松過程</a></li>
<li class="chapter" data-level="48.3" data-path="-poisson-glm-for-rates.html"><a href="-poisson-glm-for-rates.html#section-48.3"><i class="fa fa-check"></i><b>48.3</b> 率的模型</a></li>
<li class="chapter" data-level="48.4" data-path="-poisson-regression.html"><a href="-poisson-regression.html#-glm"><i class="fa fa-check"></i><b>48.4</b> 率的 GLM</a></li>
<li class="chapter" data-level="48.5" data-path="-poisson-glm-for-rates.html"><a href="-poisson-glm-for-rates.html#section-48.5"><i class="fa fa-check"></i><b>48.5</b> 實戰演練</a><ul>
<li class="chapter" data-level="48.5.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>48.5.1</b> 模型 1</a></li>
<li class="chapter" data-level="48.5.2" data-path="-construction-of-a-hypothesis-test.html"><a href="-construction-of-a-hypothesis-test.html#-2"><i class="fa fa-check"></i><b>48.5.2</b> 模型 2</a></li>
<li class="chapter" data-level="48.5.3" data-path="section-16.html"><a href="section-16.html#-3"><i class="fa fa-check"></i><b>48.5.3</b> 模型 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="49" data-path="section-49.html"><a href="section-49.html"><i class="fa fa-check"></i><b>49</b> 混雜的調整，交互作用，和模型的可壓縮性</a><ul>
<li class="chapter" data-level="49.1" data-path="section-49.html"><a href="section-49.html#section-49.1"><i class="fa fa-check"></i><b>49.1</b> 混雜因素的調整</a><ul>
<li class="chapter" data-level="49.1.1" data-path="section-49.html"><a href="section-49.html#woolf-"><i class="fa fa-check"></i><b>49.1.1</b> Woolf 法估算合併比值比</a></li>
</ul></li>
<li class="chapter" data-level="49.2" data-path="section-49.html"><a href="section-49.html#section-49.2"><i class="fa fa-check"></i><b>49.2</b> 交互作用</a></li>
<li class="chapter" data-level="49.3" data-path="section-49.html"><a href="section-49.html#-collapsibility"><i class="fa fa-check"></i><b>49.3</b> 可壓縮性 collapsibility</a><ul>
<li class="chapter" data-level="49.3.1" data-path="section-49.html"><a href="section-49.html#section-49.3.1"><i class="fa fa-check"></i><b>49.3.1</b> 線性迴歸的可壓縮性</a></li>
<li class="chapter" data-level="49.3.2" data-path="section-49.html"><a href="section-49.html#collapsibility"><i class="fa fa-check"></i><b>49.3.2</b> 邏輯鏈接方程時的不可壓縮性</a></li>
</ul></li>
<li class="chapter" data-level="49.4" data-path="section-49.html"><a href="section-49.html#interaction-depend-scale"><i class="fa fa-check"></i><b>49.4</b> 交互作用對尺度的依賴性</a></li>
</ul></li>
<li class="chapter" data-level="50" data-path="section-50.html"><a href="section-50.html"><i class="fa fa-check"></i><b>50</b> 流行病學中的邏輯迴歸</a><ul>
<li class="chapter" data-level="50.1" data-path="section-50.html"><a href="section-50.html#section-50.1"><i class="fa fa-check"></i><b>50.1</b> 流行病學研究最常用的實驗設計</a></li>
<li class="chapter" data-level="50.2" data-path="section-50.html"><a href="section-50.html#GLM8-3"><i class="fa fa-check"></i><b>50.2</b> 以簡單二分類暴露變量爲例</a><ul>
<li class="chapter" data-level="50.2.1" data-path="section-50.html"><a href="section-50.html#section-50.2.1"><i class="fa fa-check"></i><b>50.2.1</b> 先決條件</a></li>
<li class="chapter" data-level="50.2.2" data-path="section-50.html"><a href="section-50.html#-odds-ratios"><i class="fa fa-check"></i><b>50.2.2</b> 比值比 Odds ratios</a></li>
<li class="chapter" data-level="50.2.3" data-path="section-50.html"><a href="section-50.html#GLM8-3-4"><i class="fa fa-check"></i><b>50.2.3</b> 邏輯迴歸應用於病例對照研究的合理性</a></li>
</ul></li>
<li class="chapter" data-level="50.3" data-path="section-50.html"><a href="section-50.html#section-50.3"><i class="fa fa-check"></i><b>50.3</b> 拓展到多個暴露變量的邏輯迴歸模型</a><ul>
<li class="chapter" data-level="50.3.1" data-path="section-50.html"><a href="section-50.html#mantel-haenszel-"><i class="fa fa-check"></i><b>50.3.1</b> Mantel Haenszel 法</a></li>
<li class="chapter" data-level="50.3.2" data-path="section-50.html"><a href="section-50.html#section-50.3.2"><i class="fa fa-check"></i><b>50.3.2</b> 隊列研究和病例對照研究的似然</a></li>
<li class="chapter" data-level="50.3.3" data-path="section-50.html"><a href="section-50.html#section-50.3.3"><i class="fa fa-check"></i><b>50.3.3</b> 病例對照研究中的邏輯迴歸</a></li>
</ul></li>
<li class="chapter" data-level="50.4" data-path="section-50.html"><a href="section-50.html#section-50.4"><i class="fa fa-check"></i><b>50.4</b> 流行病學研究中變量的調整策略</a></li>
</ul></li>
<li class="chapter" data-level="51" data-path="section-51.html"><a href="section-51.html"><i class="fa fa-check"></i><b>51</b> 分析策略</a><ul>
<li class="chapter" data-level="51.1" data-path="section-51.html"><a href="section-51.html#section-51.1"><i class="fa fa-check"></i><b>51.1</b> 明確分析目的</a></li>
<li class="chapter" data-level="51.2" data-path="section-51.html"><a href="section-51.html#-1.1--rct--treatment-effect"><i class="fa fa-check"></i><b>51.2</b> 分析目的 1.1 – 估計 RCT 中治療效果 (treatment effect)</a><ul>
<li class="chapter" data-level="51.2.1" data-path="section-51.html"><a href="section-51.html#rct-"><i class="fa fa-check"></i><b>51.2.1</b> RCT 數據分析的一些不成熟的小建議</a></li>
</ul></li>
<li class="chapter" data-level="51.3" data-path="section-51.html"><a href="section-51.html#-1.2--exposure-effect"><i class="fa fa-check"></i><b>51.3</b> 分析目的 1.2 – 估計流行病學研究中暴露變量和結果變量的關係 (exposure effect)</a><ul>
<li class="chapter" data-level="51.3.1" data-path="section-51.html"><a href="section-51.html#section-51.3.1"><i class="fa fa-check"></i><b>51.3.1</b> 不成熟的小策略</a></li>
<li class="chapter" data-level="51.3.2" data-path="section-51.html"><a href="section-51.html#section-51.3.2"><i class="fa fa-check"></i><b>51.3.2</b> 補充</a></li>
</ul></li>
<li class="chapter" data-level="51.4" data-path="section-51.html"><a href="section-51.html#-2--3--predictive-models"><i class="fa fa-check"></i><b>51.4</b> 分析目的 2 和 3 – 建立預測模型 (predictive models)</a></li>
</ul></li>
<li class="chapter" data-level="52" data-path="-model-checking.html"><a href="-model-checking.html"><i class="fa fa-check"></i><b>52</b> 檢查你的模型 Model Checking</a><ul>
<li class="chapter" data-level="52.1" data-path="-model-checking.html"><a href="-model-checking.html#section-52.1"><i class="fa fa-check"></i><b>52.1</b> 線性預測方程的定義</a><ul>
<li class="chapter" data-level="52.1.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>52.1.1</b> 殘差</a></li>
<li class="chapter" data-level="52.1.2" data-path="-model-checking.html"><a href="-model-checking.html#glm--r-"><i class="fa fa-check"></i><b>52.1.2</b> GLM 在 R 裏獲取殘差</a></li>
<li class="chapter" data-level="52.1.3" data-path="-model-checking.html"><a href="-model-checking.html#section-52.1.3"><i class="fa fa-check"></i><b>52.1.3</b> 如何利用獲得的殘差</a></li>
</ul></li>
<li class="chapter" data-level="52.2" data-path="-model-checking.html"><a href="-model-checking.html#-covariate-pattern-residuals"><i class="fa fa-check"></i><b>52.2</b> 共變量模式殘差 covariate pattern residuals</a></li>
<li class="chapter" data-level="52.3" data-path="-model-checking.html"><a href="-model-checking.html#section-52.3"><i class="fa fa-check"></i><b>52.3</b> 鏈接方程</a></li>
<li class="chapter" data-level="52.4" data-path="-model-checking.html"><a href="-model-checking.html#NHANESdrinker"><i class="fa fa-check"></i><b>52.4</b> NHANES 飲酒量數據實例</a></li>
<li class="chapter" data-level="52.5" data-path="-model-checking.html"><a href="-model-checking.html#practical-10"><i class="fa fa-check"></i><b>52.5</b> Practical 10</a></li>
</ul></li>
<li class="chapter" data-level="53" data-path="-assessing-model-performance.html"><a href="-assessing-model-performance.html"><i class="fa fa-check"></i><b>53</b> 評價模型的表現 Assessing model performance</a><ul>
<li class="chapter" data-level="53.1" data-path="-assessing-model-performance.html"><a href="-assessing-model-performance.html#calibration"><i class="fa fa-check"></i><b>53.1</b> 精準度 calibration</a></li>
<li class="chapter" data-level="53.2" data-path="-assessing-model-performance.html"><a href="-assessing-model-performance.html#-r2-"><i class="fa fa-check"></i><b>53.2</b> 可解釋因變量的變異度及 <span class="math inline">\(R^2\)</span> 決定係數</a></li>
<li class="chapter" data-level="53.3" data-path="-assessing-model-performance.html"><a href="-assessing-model-performance.html#-descrimination"><i class="fa fa-check"></i><b>53.3</b> 分辨能力 descrimination</a><ul>
<li class="chapter" data-level="53.3.1" data-path="-assessing-model-performance.html"><a href="-assessing-model-performance.html#section-53.3.1"><i class="fa fa-check"></i><b>53.3.1</b> 敏感度和特異度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="54" data-path="section-54.html"><a href="section-54.html"><i class="fa fa-check"></i><b>54</b> 配對實驗數據的分析法</a><ul>
<li class="chapter" data-level="54.1" data-path="section-54.html"><a href="section-54.html#section-54.1"><i class="fa fa-check"></i><b>54.1</b> 配對的原理</a><ul>
<li class="chapter" data-level="54.1.1" data-path="section-54.html"><a href="section-54.html#section-54.1.1"><i class="fa fa-check"></i><b>54.1.1</b> 爲了提升估計的精確度</a></li>
<li class="chapter" data-level="54.1.2" data-path="section-54.html"><a href="section-54.html#section-54.1.2"><i class="fa fa-check"></i><b>54.1.2</b> 控制混雜因素</a></li>
</ul></li>
<li class="chapter" data-level="54.2" data-path="section-54.html"><a href="section-54.html#section-54.2"><i class="fa fa-check"></i><b>54.2</b> 結果變量爲連續型變量的配對實驗</a><ul>
<li class="chapter" data-level="54.2.1" data-path="section-54.html"><a href="section-54.html#section-54.2.1"><i class="fa fa-check"></i><b>54.2.1</b> 一般檢驗方法</a></li>
<li class="chapter" data-level="54.2.2" data-path="section-54.html"><a href="section-54.html#section-54.2.2"><i class="fa fa-check"></i><b>54.2.2</b> 用迴歸法分析</a></li>
</ul></li>
<li class="chapter" data-level="54.3" data-path="section-54.html"><a href="section-54.html#section-54.3"><i class="fa fa-check"></i><b>54.3</b> 結果變量是二分類變量的配對實驗</a><ul>
<li class="chapter" data-level="54.3.1" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>54.3.1</b> 第一步 對數據作表格</a></li>
<li class="chapter" data-level="54.3.2" data-path="section-54.html"><a href="section-54.html#mcnemars-test"><i class="fa fa-check"></i><b>54.3.2</b> McNemar’s test</a></li>
<li class="chapter" data-level="54.3.3" data-path="section-54.html"><a href="section-54.html#section-54.3.3"><i class="fa fa-check"></i><b>54.3.3</b> 二分類型結果變量配對實驗的比值比</a></li>
<li class="chapter" data-level="54.3.4" data-path="section-54.html"><a href="section-54.html#section-54.3.4"><i class="fa fa-check"></i><b>54.3.4</b> 配對實驗比值比的信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="54.4" data-path="section-54.html"><a href="section-54.html#-conditional--marginal-"><i class="fa fa-check"></i><b>54.4</b> 條件 (conditional) 比值比和邊際 (marginal) 比值比</a></li>
</ul></li>
<li class="chapter" data-level="55" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html"><i class="fa fa-check"></i><b>55</b> 條件邏輯迴歸 Conditional logistic regression</a><ul>
<li class="chapter" data-level="55.1" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#section-55.1"><i class="fa fa-check"></i><b>55.1</b> 配對實驗的邏輯迴歸模型</a><ul>
<li class="chapter" data-level="55.1.1" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#section-55.1.1"><i class="fa fa-check"></i><b>55.1.1</b> 配對病例對照研究</a></li>
<li class="chapter" data-level="55.1.2" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#section-55.1.2"><i class="fa fa-check"></i><b>55.1.2</b> 配對隊列研究</a></li>
</ul></li>
<li class="chapter" data-level="55.2" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>55.2</b> 條件邏輯回歸 – 二分類暴露變量</a><ul>
<li class="chapter" data-level="55.2.1" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#-sufficient-statistics"><i class="fa fa-check"></i><b>55.2.1</b> 充分統計量 sufficient statistics</a></li>
<li class="chapter" data-level="55.2.2" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#section-55.2.2"><i class="fa fa-check"></i><b>55.2.2</b> 條件邏輯回歸的推導</a></li>
<li class="chapter" data-level="55.2.3" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#-conditional-likelihood"><i class="fa fa-check"></i><b>55.2.3</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="55.2.4" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#section-55.2.4"><i class="fa fa-check"></i><b>55.2.4</b> 進一步擴展</a></li>
</ul></li>
<li class="chapter" data-level="55.3" data-path="-conditional-logistic-regression.html"><a href="-conditional-logistic-regression.html#section-55.3"><i class="fa fa-check"></i><b>55.3</b> 條件邏輯回歸模型的一般化</a></li>
</ul></li>
<li class="chapter" data-level="56" data-path="multinomial-logistic-regression.html"><a href="multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>56</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="57" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html"><i class="fa fa-check"></i><b>57</b> Ordinal Logistic Regression</a></li>
<li class="part"><span><b>IX 等級線性迴歸模型 analysis of hierarchical and other dependent data</b></span></li>
<li class="chapter" data-level="58" data-path="Hierarchical.html"><a href="Hierarchical.html"><i class="fa fa-check"></i><b>58</b> 相互依賴數據及簡單的應對方案</a><ul>
<li class="chapter" data-level="58.1" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.1"><i class="fa fa-check"></i><b>58.1</b> 相互依賴的數據</a></li>
<li class="chapter" data-level="58.2" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.2"><i class="fa fa-check"></i><b>58.2</b> 依賴性的來源在哪裏</a></li>
<li class="chapter" data-level="58.3" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.3"><i class="fa fa-check"></i><b>58.3</b> 數據有依賴性導致的結果</a></li>
<li class="chapter" data-level="58.4" data-path="Hierarchical.html"><a href="Hierarchical.html#-marginal-and-conditional-models"><i class="fa fa-check"></i><b>58.4</b> 邊際模型和條件模型 marginal and conditional models</a><ul>
<li class="chapter" data-level="58.4.1" data-path="Hierarchical.html"><a href="Hierarchical.html#-notation"><i class="fa fa-check"></i><b>58.4.1</b> 標記法 notation</a></li>
<li class="chapter" data-level="58.4.2" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.4.2"><i class="fa fa-check"></i><b>58.4.2</b> 合並每個階層</a></li>
<li class="chapter" data-level="58.4.3" data-path="Hierarchical.html"><a href="Hierarchical.html#-ecological-fallacy"><i class="fa fa-check"></i><b>58.4.3</b> 生物學悖論 ecological fallacy</a></li>
<li class="chapter" data-level="58.4.4" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.4.4"><i class="fa fa-check"></i><b>58.4.4</b> 分解層級數據</a></li>
<li class="chapter" data-level="58.4.5" data-path="Hierarchical.html"><a href="Hierarchical.html#-fixed-effect-model"><i class="fa fa-check"></i><b>58.4.5</b> 固定效應模型 fixed effect model</a></li>
</ul></li>
<li class="chapter" data-level="58.5" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.5"><i class="fa fa-check"></i><b>58.5</b> 簡單線性迴歸複習</a></li>
<li class="chapter" data-level="58.6" data-path="Hierarchical.html"><a href="Hierarchical.html#-7"><i class="fa fa-check"></i><b>58.6</b> 練習題</a><ul>
<li class="chapter" data-level="58.6.1" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.6.1"><i class="fa fa-check"></i><b>58.6.1</b> 數據</a></li>
<li class="chapter" data-level="58.6.2" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.6.2"><i class="fa fa-check"></i><b>58.6.2</b> 問題</a></li>
<li class="chapter" data-level="58.6.3" data-path="Hierarchical.html"><a href="Hierarchical.html#-high-school-and-beyond--r-"><i class="fa fa-check"></i><b>58.6.3</b> 將 High-School-and-Beyond 數據導入 R 中，熟悉數據結構及內容，特別要注意觀察每個學校的學生特徵。</a></li>
<li class="chapter" data-level="58.6.4" data-path="Hierarchical.html"><a href="Hierarchical.html#-188--ses-ses-"><i class="fa fa-check"></i><b>58.6.4</b> 爲了簡便起見，接下來的分析只節選數據中前五所學校 188 名學生的數學成績，和 SES。分別計算每所學校的數學成績,及 SES 的平均值。</a></li>
<li class="chapter" data-level="58.6.5" data-path="Hierarchical.html"><a href="Hierarchical.html#-ses--total-regression-model"><i class="fa fa-check"></i><b>58.6.5</b> 先無視掉學校這一分層變量，把所有學生看作是相互獨立的，擬合總體的 SES 和數學成績的線性迴歸 <strong>(Total regression model)</strong>。把該總體模型的預測值提取並存儲在數據庫中。</a></li>
<li class="chapter" data-level="58.6.6" data-path="Hierarchical.html"><a href="Hierarchical.html#-ses--between-regression-model"><i class="fa fa-check"></i><b>58.6.6</b> 用各個學校 SES 和數學成績的均值擬合一個學校間的線性迴歸模型 <strong>(between regression model)</strong>。</a></li>
<li class="chapter" data-level="58.6.7" data-path="Hierarchical.html"><a href="Hierarchical.html#-ses-"><i class="fa fa-check"></i><b>58.6.7</b> 分別對每個學校內的學生進行 SES 和數學成績擬合線性迴歸模型。</a></li>
<li class="chapter" data-level="58.6.8" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.6.8"><i class="fa fa-check"></i><b>58.6.8</b> 比較三種模型計算的數學成績的擬合值，他們一致？還是有所不同？爲什麼會有不同？</a></li>
<li class="chapter" data-level="58.6.9" data-path="Hierarchical.html"><a href="Hierarchical.html#section-58.6.9"><i class="fa fa-check"></i><b>58.6.9</b> 把三種模型的數學成績擬合值散點圖繪製在同一張圖內。</a></li>
<li class="chapter" data-level="58.6.10" data-path="Hierarchical.html"><a href="Hierarchical.html#-5-"><i class="fa fa-check"></i><b>58.6.10</b> 用這 5 個學校的數據擬合一個固定效應線性迴歸模型</a></li>
<li class="chapter" data-level="58.6.11" data-path="Hierarchical.html"><a href="Hierarchical.html#-pefr-"><i class="fa fa-check"></i><b>58.6.11</b> 讀入 PEFR 數據。</a></li>
<li class="chapter" data-level="58.6.12" data-path="Hierarchical.html"><a href="Hierarchical.html#-wp-"><i class="fa fa-check"></i><b>58.6.12</b> 求每個患者的 <code>wp</code> 兩次測量平均值</a></li>
<li class="chapter" data-level="58.6.13" data-path="Hierarchical.html"><a href="Hierarchical.html#-r--anova--wp--lme4lmer--id--std.dev-for-id-effect--anova--sqrtfractextmms-msen-n-"><i class="fa fa-check"></i><b>58.6.13</b> 在 R 裏先用 ANOVA 分析個人的 <code>wp</code> 變異。再用 <code>lme4::lmer</code> 擬合用 <code>id</code> 作隨機效應的混合效應模型。確認後者報告的 <code>Std.Dev for id effect</code> 其實可以用 ANOVA 結果的 <span class="math inline">\(\sqrt{\frac{\text{MMS-MSE}}{n}}\)</span> (n 是每個個體重複測量值的個數)。</a></li>
<li class="chapter" data-level="58.6.14" data-path="Hierarchical.html"><a href="Hierarchical.html#-wp-id-"><i class="fa fa-check"></i><b>58.6.14</b> 擬合結果變量爲 <code>wp</code>，解釋變量爲 <code>id</code> 的簡單線性迴歸模型。用數學表達式描述這個模型。</a></li>
<li class="chapter" data-level="58.6.15" data-path="Hierarchical.html"><a href="Hierarchical.html#-wp-"><i class="fa fa-check"></i><b>58.6.15</b> 將 <code>wp</code> 中心化之後，重新擬合相同的模型，把截距去除掉。寫下這個模型的數學表達式。</a></li>
<li class="chapter" data-level="58.6.16" data-path="Hierarchical.html"><a href="Hierarchical.html#--"><i class="fa fa-check"></i><b>58.6.16</b> 計算這些迴歸係數 (其實是不同羣之間的隨機截距) 的均值和標準差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="59" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html"><i class="fa fa-check"></i><b>59</b> 隨機截距模型 random intercept model</a><ul>
<li class="chapter" data-level="59.1" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#section-59.1"><i class="fa fa-check"></i><b>59.1</b> 隨機截距模型的定義</a></li>
<li class="chapter" data-level="59.2" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#section-59.2"><i class="fa fa-check"></i><b>59.2</b> 隨機截距模型的參數估計</a></li>
<li class="chapter" data-level="59.3" data-path="-association.html"><a href="-association.html#-r-"><i class="fa fa-check"></i><b>59.3</b> 如何在 R 中進行隨機截距模型的擬合</a></li>
<li class="chapter" data-level="59.4" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#section-59.4"><i class="fa fa-check"></i><b>59.4</b> 隨機截距模型中的統計推斷</a><ul>
<li class="chapter" data-level="59.4.1" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#fixed-inference"><i class="fa fa-check"></i><b>59.4.1</b> 固定效應部分的推斷</a></li>
<li class="chapter" data-level="59.4.2" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#section-59.4.2"><i class="fa fa-check"></i><b>59.4.2</b> 隨機效應部分的推斷</a></li>
</ul></li>
<li class="chapter" data-level="59.5" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-8"><i class="fa fa-check"></i><b>59.5</b> 練習題</a><ul>
<li class="chapter" data-level="59.5.1" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>59.5.1</b> 數據</a></li>
<li class="chapter" data-level="59.5.2" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-ghq--balanced"><i class="fa fa-check"></i><b>59.5.2</b> 讀入 GHQ 數據，探索其內容，該數據是否是平衡數據 (balanced)？計算每名學生的兩次問卷成績平均分。</a></li>
<li class="chapter" data-level="59.5.3" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-wide--long-"><i class="fa fa-check"></i><b>59.5.3</b> 把數據從寬 (wide) 改變成長 (long) 的形式</a></li>
<li class="chapter" data-level="59.5.4" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-id--anova"><i class="fa fa-check"></i><b>59.5.4</b> 對數據按照 <code>id</code> 分層進行 ANOVA</a></li>
<li class="chapter" data-level="59.5.5" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-r--nlme--restricted-maximum-likelihood-reml--anova-"><i class="fa fa-check"></i><b>59.5.5</b> 用 R 裏的 <code>nlme</code> 包，使用限制性極大似然法 (restricted maximum likelihood, REML) 擬合截距混合效應模型，比較其結果和前文中隨機效應 ANOVA 的結果</a></li>
<li class="chapter" data-level="59.5.6" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-maximum-likelihood-ml-method-ml-"><i class="fa fa-check"></i><b>59.5.6</b> 用極大似然法 (maximum likelihood, ML) <code>method = &quot;ML&quot;</code> 重新擬合前面的混合效應模型，比較結果有什麼不同。</a></li>
<li class="chapter" data-level="59.5.7" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#section-59.5.7"><i class="fa fa-check"></i><b>59.5.7</b> 用簡單線性迴歸擬合一個固定效應模型</a></li>
<li class="chapter" data-level="59.5.8" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#section-59.5.8"><i class="fa fa-check"></i><b>59.5.8</b> 計算這些隨機截距的均值和標準差</a></li>
<li class="chapter" data-level="59.5.9" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-ghq-"><i class="fa fa-check"></i><b>59.5.9</b> 忽略掉所有的分層和解釋變量擬合 <code>GHQ</code> 的簡單線性迴歸</a></li>
<li class="chapter" data-level="59.5.10" data-path="Hierarchical.html"><a href="Hierarchical.html#--"><i class="fa fa-check"></i><b>59.5.10</b> 用分層的穩健法 (三明治標準誤法) 計算簡單線性迴歸時，截距的標準誤差，和簡單線性迴歸時的結果作比較</a></li>
<li class="chapter" data-level="59.5.11" data-path="-random-intercept-model.html"><a href="-random-intercept-model.html#-siblings--ml-reml"><i class="fa fa-check"></i><b>59.5.11</b> 讀入 <code>siblings</code> 數據。先總結嬰兒的出生體重，思考這個數據中嬰兒出生體重之間是否可能存在關聯性？它的來源是哪裏。用這個數據擬合兩個混合效應模型 (ML, REML)，不加入任何解釋變量。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="60" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html"><i class="fa fa-check"></i><b>60</b> 隨機截距模型中加入共變量 random intercept model with covariates</a><ul>
<li class="chapter" data-level="60.1" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.1"><i class="fa fa-check"></i><b>60.1</b> 多元線性回歸模型的延伸</a></li>
<li class="chapter" data-level="60.2" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#siblings-"><i class="fa fa-check"></i><b>60.2</b> <code>siblings</code> 數據中新生兒體重的實例</a></li>
<li class="chapter" data-level="60.3" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.3"><i class="fa fa-check"></i><b>60.3</b> 賦值予隨機效應成分</a><ul>
<li class="chapter" data-level="60.3.1" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-simple-prediction"><i class="fa fa-check"></i><b>60.3.1</b> 簡單預測 simple prediction</a></li>
<li class="chapter" data-level="60.3.2" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#eb-"><i class="fa fa-check"></i><b>60.3.2</b> EB 預測值</a></li>
</ul></li>
<li class="chapter" data-level="60.4" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.4"><i class="fa fa-check"></i><b>60.4</b> 混合效應模型的診斷</a></li>
<li class="chapter" data-level="60.5" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-cluster-levellevel-2-"><i class="fa fa-check"></i><b>60.5</b> 第二層級 (cluster level/level 2) 的協方差</a></li>
<li class="chapter" data-level="60.6" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.6"><i class="fa fa-check"></i><b>60.6</b> 層內層間效應估計</a></li>
<li class="chapter" data-level="60.7" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.7"><i class="fa fa-check"></i><b>60.7</b> 到底選擇固定還是混合模型？</a></li>
<li class="chapter" data-level="60.8" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.8"><i class="fa fa-check"></i><b>60.8</b> 練習題目</a><ul>
<li class="chapter" data-level="60.8.1" data-path="Hierarchical.html"><a href="Hierarchical.html#-high-school-and-beyond--r-"><i class="fa fa-check"></i><b>60.8.1</b> 把 High-school-and-Beyond 數據讀入 R 中。</a></li>
<li class="chapter" data-level="60.8.2" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-ml-reml-mathach-ses"><i class="fa fa-check"></i><b>60.8.2</b> 擬合兩個隨機截距模型 (ML, REML)，結果變量用 <code>mathach</code>，解釋變量用 <code>ses</code>。觀察結果是否不同。</a></li>
<li class="chapter" data-level="60.8.3" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-sector--hatsigma_u-hatsigma_e-mlreml-"><i class="fa fa-check"></i><b>60.8.3</b> 觀察學校類型是否爲天主教學校 <code>sector</code> 的分佈，把它加入剛擬合的兩個隨機截距模型，它們估計的隨機效應標準差 <span class="math inline">\(\hat\sigma_u\)</span>，和隨機誤差標準差 <span class="math inline">\(\hat\sigma_e\)</span>，和之前有什麼不同？ “ML，REML” 的選用對結果有影響嗎？</a></li>
<li class="chapter" data-level="60.8.4" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-size--100-100"><i class="fa fa-check"></i><b>60.8.4</b> 現在把學校規模 <code>size</code> 這一變量加入混合效應模型的固定效應部分，記得先把該變量中心化，並除以 100，會有助於對結果的解釋 (比平均值每增加100名學生)。仔細觀察模型結果中隨機效應標準差和隨機誤差標準殘差的變化。</a></li>
<li class="chapter" data-level="60.8.5" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-sizesector-"><i class="fa fa-check"></i><b>60.8.5</b> 在模型的固定效應部分增加 <code>size*sector</code> 的交互作用項。觀察輸出結果中該交互作用項是否有意義。用什麼檢驗方法判斷這個交互作用項能否幫助模型更加擬合數據？</a></li>
<li class="chapter" data-level="60.8.6" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.8.6"><i class="fa fa-check"></i><b>60.8.6</b> 把上面八個模型估計的隨機效應標準差，和隨機誤差標準差總結成表格，它們之間有什麼規律嗎？</a></li>
<li class="chapter" data-level="60.8.7" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-female-minority--hatsigma_u-hatsigma_e-"><i class="fa fa-check"></i><b>60.8.7</b> 在混合效應模型的固定效應部分增加學生性別 <code>female</code>，和學生是否是少數族裔 <code>minority</code> 兩個變量。再觀察 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span> 是否發生變化？</a></li>
<li class="chapter" data-level="60.8.8" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-sector--hatsigma_u-hatsigma_e"><i class="fa fa-check"></i><b>60.8.8</b> 檢查學生性別和族裔是否和學校是否是天主教會學校有關係，先作分類型數據的分佈表格，然後把它們各自與 <code>sector</code> 的交互作用項加入混合效應模型中的固定效應部分，記錄下此時的 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span></a></li>
<li class="chapter" data-level="60.8.9" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.8.9"><i class="fa fa-check"></i><b>60.8.9</b> 對上面最後一個模型進行殘差分析和模型的診斷。</a></li>
<li class="chapter" data-level="60.8.10" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#section-60.8.10"><i class="fa fa-check"></i><b>60.8.10</b> 通過剛剛所求的隨機效應方差的殘差，確認哪個學校存在相對極端的值。</a></li>
<li class="chapter" data-level="60.8.11" data-path="-random-intercept-model-with-covariates.html"><a href="-random-intercept-model-with-covariates.html#-ses--ses"><i class="fa fa-check"></i><b>60.8.11</b> 計算學校水平的 SES 平均值，以及每個學生自己和所在學校均值之間的差值大小。分別擬合兩個不同的混合效應模型，一個只用 <code>SES</code>，另一個換做使用新計算的組均值和組內均差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="61" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html"><i class="fa fa-check"></i><b>61</b> 隨機回歸系數模型 random coefficient model</a><ul>
<li class="chapter" data-level="61.1" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#gcse-scores-"><i class="fa fa-check"></i><b>61.1</b> GCSE scores 實例</a></li>
<li class="chapter" data-level="61.2" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#section-61.2"><i class="fa fa-check"></i><b>61.2</b> 隨機回歸系數的實質</a></li>
<li class="chapter" data-level="61.3" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-gcse-scores-"><i class="fa fa-check"></i><b>61.3</b> 繼續 GCSE scores 實例</a></li>
<li class="chapter" data-level="61.4" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#section-61.4"><i class="fa fa-check"></i><b>61.4</b> 使用模型結果推斷</a></li>
<li class="chapter" data-level="61.5" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#random-var"><i class="fa fa-check"></i><b>61.5</b> 隨機效應的方差</a></li>
<li class="chapter" data-level="61.6" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#section-61.6"><i class="fa fa-check"></i><b>61.6</b> 模型效果評估</a></li>
<li class="chapter" data-level="61.7" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-9"><i class="fa fa-check"></i><b>61.7</b> 練習題</a><ul>
<li class="chapter" data-level="61.7.1" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#section-61.7.1"><i class="fa fa-check"></i><b>61.7.1</b> 　將數據導入軟件裏，</a></li>
<li class="chapter" data-level="61.7.2" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-48---gcse-lrt-"><i class="fa fa-check"></i><b>61.7.2</b> 先忽略學校編號爲 48 的學校，擬合一個只有固定效應 (簡單線性回歸模型)，結果變量是 GCSE，解釋變量是 LRT 和學校。</a></li>
<li class="chapter" data-level="61.7.3" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#--lrt-"><i class="fa fa-check"></i><b>61.7.3</b> 僅有固定效應模型的學校變量變更爲學校類型 (男校女校或混合校)，從這個新模型的結果來看，你是否認爲學校類型，和學校編號本身相比能夠解釋相同的學校層面的方差？ <code>lrt</code> 的估計回歸參數發生了怎樣的變化？</a></li>
<li class="chapter" data-level="61.7.4" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-log-likelihood-lmertestrand-"><i class="fa fa-check"></i><b>61.7.4</b> 使用限制性極大似然法擬合一個隨機截距模型。記錄此時的限制性對數似然的大小 (log-likelihood)。用 <code>lmerTest::rand</code> 命令對隨機效應部分的方差是否爲零做檢驗，指明該檢驗的零假設是什麼，並解釋其結果的含義。</a></li>
<li class="chapter" data-level="61.7.5" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-schgend-"><i class="fa fa-check"></i><b>61.7.5</b> 在前一題的隨機截距模型中加入 <code>schgend</code> 變量，作爲解釋隨機截距的一個自變量，觀察輸出結果，解釋其是否有意義。記錄這個模型的限制性似然。</a></li>
<li class="chapter" data-level="61.7.6" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-lrt-"><i class="fa fa-check"></i><b>61.7.6</b> 擬合隨機截距隨機斜率模型，固定效應部分的 <code>lrt</code> 也加入進隨機效應部分。</a></li>
<li class="chapter" data-level="61.7.7" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#section-61.7.7"><i class="fa fa-check"></i><b>61.7.7</b> 通過上面幾個模型計算獲得的似然，嘗試檢驗隨機斜率標準差，以及該標準差和隨機截距標準差的協相關是否有意義。</a></li>
<li class="chapter" data-level="61.7.8" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-schgend--mean_girl-"><i class="fa fa-check"></i><b>61.7.8</b> 模型中的 <code>schgend</code> 改成 <code>mean_girl</code> 會給出怎樣的結果呢？</a></li>
<li class="chapter" data-level="61.7.9" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-48--gcse-lrt"><i class="fa fa-check"></i><b>61.7.9</b> 現在我們把注意力改爲關心學校編號爲 48 的學校的情況。用且禁用它一所學校的數據，擬合一個簡單線性回歸，結果變量是 <code>gcse</code>，解釋變量是 <code>lrt</code>。</a></li>
<li class="chapter" data-level="61.7.10" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#-48--fixed_reml2-"><i class="fa fa-check"></i><b>61.7.10</b> 這次不排除 48 號學校，擬合所有學校的數據進入 <code>Fixed_reml2</code> 模型中去，結果有發生顯著的變化嗎？</a></li>
<li class="chapter" data-level="61.7.11" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#level-2-school-level"><i class="fa fa-check"></i><b>61.7.11</b> 計算這個模型的第二階級(level 2, <code>school</code> level)的殘差。</a></li>
<li class="chapter" data-level="61.7.12" data-path="-random-coefficient-model.html"><a href="-random-coefficient-model.html#level-1-student48"><i class="fa fa-check"></i><b>61.7.12</b> 計算這個模型的第一階級(level 1, student)殘差，分析其分布，查看第48所學校的殘差表現如何。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="62" data-path="-longitudinal-data-1.html"><a href="-longitudinal-data-1.html"><i class="fa fa-check"></i><b>62</b> 縱向研究數據 longitudinal data 1</a><ul>
<li class="chapter" data-level="62.1" data-path="-longitudinal-data-1.html"><a href="-longitudinal-data-1.html#-fixed-occasions"><i class="fa fa-check"></i><b>62.1</b> 固定測量時刻 fixed occasions</a><ul>
<li class="chapter" data-level="62.1.1" data-path="-longitudinal-data-1.html"><a href="-longitudinal-data-1.html#-missing-data"><i class="fa fa-check"></i><b>62.1.1</b> 缺失值 Missing data</a></li>
</ul></li>
<li class="chapter" data-level="62.2" data-path="-longitudinal-data-1.html"><a href="-longitudinal-data-1.html#-variable-occasions"><i class="fa fa-check"></i><b>62.2</b> 不固定測量時刻 variable occasions</a></li>
<li class="chapter" data-level="62.3" data-path="-longitudinal-data-1.html"><a href="-longitudinal-data-1.html#-predicting-trajectories"><i class="fa fa-check"></i><b>62.3</b> 預測軌跡 predicting trajectories</a></li>
<li class="chapter" data-level="62.4" data-path="-longitudinal-data-1.html"><a href="-longitudinal-data-1.html#practical-05-hier"><i class="fa fa-check"></i><b>62.4</b> Practical 05-Hier</a></li>
</ul></li>
<li class="chapter" data-level="63" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html"><i class="fa fa-check"></i><b>63</b> 縱向研究數據 longitudinal data 2</a><ul>
<li class="chapter" data-level="63.1" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#-marginal-structures"><i class="fa fa-check"></i><b>63.1</b> 邊際結構 marginal structures</a><ul>
<li class="chapter" data-level="63.1.1" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.1.1"><i class="fa fa-check"></i><b>63.1.1</b> 隨機截距模型</a></li>
<li class="chapter" data-level="63.1.2" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.1.2"><i class="fa fa-check"></i><b>63.1.2</b> 隨機系數模型</a></li>
</ul></li>
<li class="chapter" data-level="63.2" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.2"><i class="fa fa-check"></i><b>63.2</b> 矩陣記法</a></li>
<li class="chapter" data-level="63.3" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.3"><i class="fa fa-check"></i><b>63.3</b> 混合效應模型的一般化公式</a></li>
<li class="chapter" data-level="63.4" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.4"><i class="fa fa-check"></i><b>63.4</b> 其他可選擇的方差協方差矩陣特徵</a></li>
<li class="chapter" data-level="63.5" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.5"><i class="fa fa-check"></i><b>63.5</b> 其他要點評論</a></li>
<li class="chapter" data-level="63.6" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#section-63.6"><i class="fa fa-check"></i><b>63.6</b> 不平衡數據</a></li>
<li class="chapter" data-level="63.7" data-path="-longitudinal-data-2.html"><a href="-longitudinal-data-2.html#practical-06-hier"><i class="fa fa-check"></i><b>63.7</b> Practical 06-Hier</a></li>
</ul></li>
<li class="chapter" data-level="64" data-path="-longitudinal-data-3.html"><a href="-longitudinal-data-3.html"><i class="fa fa-check"></i><b>64</b> 縱向研究數據 longitudinal data 3</a><ul>
<li class="chapter" data-level="64.1" data-path="-longitudinal-data-3.html"><a href="-longitudinal-data-3.html#-level-1-heterogeneity"><i class="fa fa-check"></i><b>64.1</b> 第一層級的異質性 level 1 heterogeneity</a></li>
<li class="chapter" data-level="64.2" data-path="-longitudinal-data-3.html"><a href="-longitudinal-data-3.html#-level-2-heterogeneity"><i class="fa fa-check"></i><b>64.2</b> 第二層級異質性 level 2 heterogeneity</a></li>
<li class="chapter" data-level="64.3" data-path="section-7.html"><a href="section-7.html#-1"><i class="fa fa-check"></i><b>64.3</b> 分析策略</a><ul>
<li class="chapter" data-level="64.3.1" data-path="-longitudinal-data-3.html"><a href="-longitudinal-data-3.html#section-64.3.1"><i class="fa fa-check"></i><b>64.3.1</b> 模型選擇和建模步驟</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="65" data-path="generalized-estimating-equation.html"><a href="generalized-estimating-equation.html"><i class="fa fa-check"></i><b>65</b> Generalized Estimating Equation</a></li>
<li class="chapter" data-level="66" data-path="cluster-analysis.html"><a href="cluster-analysis.html"><i class="fa fa-check"></i><b>66</b> Cluster analysis</a></li>
<li class="chapter" data-level="67" data-path="missing-data-1.html"><a href="missing-data-1.html"><i class="fa fa-check"></i><b>67</b> Missing data 1</a></li>
<li class="chapter" data-level="68" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>68</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="69" data-path="missing-data-2.html"><a href="missing-data-2.html"><i class="fa fa-check"></i><b>69</b> Missing data 2</a></li>
<li class="chapter" data-level="70" data-path="further-issues.html"><a href="further-issues.html"><i class="fa fa-check"></i><b>70</b> Further issues</a></li>
<li class="part"><span><b>X 生存分析 survival analysis</b></span></li>
<li class="chapter" data-level="71" data-path="section-71.html"><a href="section-71.html"><i class="fa fa-check"></i><b>71</b> 入門</a><ul>
<li class="chapter" data-level="71.1" data-path="section-71.html"><a href="section-71.html#section-71.1"><i class="fa fa-check"></i><b>71.1</b> 什麼是生存分析</a></li>
<li class="chapter" data-level="71.2" data-path="section-71.html"><a href="section-71.html#section-71.2"><i class="fa fa-check"></i><b>71.2</b> 生存數據在哪裏</a></li>
<li class="chapter" data-level="71.3" data-path="section-71.html"><a href="section-71.html#section-71.3"><i class="fa fa-check"></i><b>71.3</b> 生存數據分析之前要理清楚的問題</a></li>
<li class="chapter" data-level="71.4" data-path="section-71.html"><a href="section-71.html#section-71.4"><i class="fa fa-check"></i><b>71.4</b> 生存數據的左右截尾</a><ul>
<li class="chapter" data-level="71.4.1" data-path="section-71.html"><a href="section-71.html#-left-truncation"><i class="fa fa-check"></i><b>71.4.1</b> 左側截尾數據 left-truncation</a></li>
</ul></li>
<li class="chapter" data-level="71.5" data-path="section-71.html"><a href="section-71.html#section-71.5"><i class="fa fa-check"></i><b>71.5</b> 初步分析生存數據</a></li>
<li class="chapter" data-level="71.6" data-path="section-71.html"><a href="section-71.html#section-71.6"><i class="fa fa-check"></i><b>71.6</b> 初步描述生存數據</a><ul>
<li class="chapter" data-level="71.6.1" data-path="section-71.html"><a href="section-71.html#section-71.6.1"><i class="fa fa-check"></i><b>71.6.1</b> 生存方程</a></li>
<li class="chapter" data-level="71.6.2" data-path="section-71.html"><a href="section-71.html#section-71.6.2"><i class="fa fa-check"></i><b>71.6.2</b> 危險度方程</a></li>
<li class="chapter" data-level="71.6.3" data-path="section-71.html"><a href="section-71.html#section-71.6.3"><i class="fa fa-check"></i><b>71.6.3</b> 概率密度方程</a></li>
<li class="chapter" data-level="71.6.4" data-path="section-71.html"><a href="section-71.html#section-71.6.4"><i class="fa fa-check"></i><b>71.6.4</b> 各方程之間的關系</a></li>
</ul></li>
<li class="chapter" data-level="71.7" data-path="section-71.html"><a href="section-71.html#section-71.7"><i class="fa fa-check"></i><b>71.7</b> 生存時間的參數分布</a><ul>
<li class="chapter" data-level="71.7.1" data-path="section-71.html"><a href="section-71.html#section-71.7.1"><i class="fa fa-check"></i><b>71.7.1</b> 指數分布</a></li>
<li class="chapter" data-level="71.7.2" data-path="section-71.html"><a href="section-71.html#weibull-"><i class="fa fa-check"></i><b>71.7.2</b> Weibull 分布</a></li>
</ul></li>
<li class="chapter" data-level="71.8" data-path="section-71.html"><a href="section-71.html#section-71.8"><i class="fa fa-check"></i><b>71.8</b> 極大似然法估計</a></li>
<li class="chapter" data-level="71.9" data-path="section-71.html"><a href="section-71.html#practical-survival-01"><i class="fa fa-check"></i><b>71.9</b> Practical Survival 01</a><ul>
<li class="chapter" data-level="71.9.1" data-path="section-71.html"><a href="section-71.html#section-71.9.1"><i class="fa fa-check"></i><b>71.9.1</b> 生存分析的時間尺度</a></li>
<li class="chapter" data-level="71.9.2" data-path="section-71.html"><a href="section-71.html#section-71.9.2"><i class="fa fa-check"></i><b>71.9.2</b> 擬合最簡單的指數分布生存數據</a></li>
<li class="chapter" data-level="71.9.3" data-path="section-71.html"><a href="section-71.html#-weibull-"><i class="fa fa-check"></i><b>71.9.3</b> 探索服從 Weibull 分布時危險度方程的曲線</a></li>
<li class="chapter" data-level="71.9.4" data-path="section-71.html"><a href="section-71.html#--log-logistic-"><i class="fa fa-check"></i><b>71.9.4</b> 探索 對數邏輯 (log-logistic) 分布時，危險度方程曲線會有哪些特性？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="72" data-path="section-72.html"><a href="section-72.html"><i class="fa fa-check"></i><b>72</b> 非參數法分析生存數據</a><ul>
<li class="chapter" data-level="72.1" data-path="section-72.html"><a href="section-72.html#section-72.1"><i class="fa fa-check"></i><b>72.1</b> 生存分析中的非參數分析法</a></li>
<li class="chapter" data-level="72.2" data-path="section-72.html"><a href="section-72.html#kaplan-meier-"><i class="fa fa-check"></i><b>72.2</b> Kaplan-Meier 法分析生存方程</a><ul>
<li class="chapter" data-level="72.2.1" data-path="section-72.html"><a href="section-72.html#section-72.2.1"><i class="fa fa-check"></i><b>72.2.1</b> 當數據中沒有刪失值</a></li>
<li class="chapter" data-level="72.2.2" data-path="section-72.html"><a href="section-72.html#section-72.2.2"><i class="fa fa-check"></i><b>72.2.2</b> 當數據中有刪失值</a></li>
</ul></li>
<li class="chapter" data-level="72.3" data-path="section-72.html"><a href="section-72.html#kaplan-meier-"><i class="fa fa-check"></i><b>72.3</b> Kaplan-Meier 數據的不確定性</a></li>
<li class="chapter" data-level="72.4" data-path="CLT.html"><a href="CLT.html#-"><i class="fa fa-check"></i><b>72.4</b> 另一種非參數法分析 – 生命表格估計</a><ul>
<li class="chapter" data-level="72.4.1" data-path="section-72.html"><a href="section-72.html#example-survival-2.3"><i class="fa fa-check"></i><b>72.4.1</b> Example-Survival-2.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="73" data-path="section-73.html"><a href="section-73.html"><i class="fa fa-check"></i><b>73</b> 生存數據中的回歸模型</a></li>
<li class="chapter" data-level="74" data-path="cox-.html"><a href="cox-.html"><i class="fa fa-check"></i><b>74</b> Cox 比例風險模型</a></li>
<li class="chapter" data-level="75" data-path="section-75.html"><a href="section-75.html"><i class="fa fa-check"></i><b>75</b> 模型檢查</a></li>
<li class="chapter" data-level="76" data-path="-competing-risk.html"><a href="-competing-risk.html"><i class="fa fa-check"></i><b>76</b> 競爭危險度 competing risk</a></li>
<li class="chapter" data-level="77" data-path="section-77.html"><a href="section-77.html"><i class="fa fa-check"></i><b>77</b> 其他手段</a></li>
<li class="chapter" data-level="78" data-path="section-78.html"><a href="section-78.html"><i class="fa fa-check"></i><b>78</b> 時間依賴變量</a></li>
<li class="chapter" data-level="79" data-path="section-79.html"><a href="section-79.html"><i class="fa fa-check"></i><b>79</b> 時間事件數據的高級分析法</a></li>
<li class="part"><span><b>XI 貝葉斯統計學 Bayesian Statistics</b></span></li>
<li class="chapter" data-level="80" data-path="-mente-carlo-estimation-and-prediction.html"><a href="-mente-carlo-estimation-and-prediction.html"><i class="fa fa-check"></i><b>80</b> 蒙特卡羅估計和預測 Mente Carlo estimation and prediction</a></li>
<li class="chapter" data-level="81" data-path="section-81.html"><a href="section-81.html"><i class="fa fa-check"></i><b>81</b> 共軛先驗概率</a></li>
<li class="chapter" data-level="82" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>82</b> MCMC</a></li>
<li class="chapter" data-level="83" data-path="section-83.html"><a href="section-83.html"><i class="fa fa-check"></i><b>83</b> 建模和模型的檢查</a></li>
<li class="chapter" data-level="84" data-path="section-84.html"><a href="section-84.html"><i class="fa fa-check"></i><b>84</b> 貝葉斯統計學框架下的實驗設計</a></li>
<li class="chapter" data-level="85" data-path="section-85.html"><a href="section-85.html"><i class="fa fa-check"></i><b>85</b> 貝葉斯廣義線性回歸</a></li>
<li class="chapter" data-level="86" data-path="section-86.html"><a href="section-86.html"><i class="fa fa-check"></i><b>86</b> 貝葉斯等級回歸模型</a></li>
<li class="chapter" data-level="87" data-path="-mcmc.html"><a href="-mcmc.html"><i class="fa fa-check"></i><b>87</b> 再訪 MCMC</a></li>
<li class="chapter" data-level="88" data-path="section-88.html"><a href="section-88.html"><i class="fa fa-check"></i><b>88</b> 貝葉斯和概率論的比較</a></li>
<li class="part"><span><b>XII Statistical Methods in Epidemiology</b></span></li>
<li class="chapter" data-level="89" data-path="crude-and-stratified-rate-ratios.html"><a href="crude-and-stratified-rate-ratios.html"><i class="fa fa-check"></i><b>89</b> Crude and stratified rate ratios</a></li>
<li class="part"><span><b>XIII 因果推斷 Causal Inference</b></span></li>
<li class="chapter" data-level="90" data-path="causal-languages-.html"><a href="causal-languages-.html"><i class="fa fa-check"></i><b>90</b> Causal Languages 因果推斷的語法</a><ul>
<li class="chapter" data-level="90.1" data-path="causal-languages-.html"><a href="causal-languages-.html#section-90.1"><i class="fa fa-check"></i><b>90.1</b> 當我們在談論因果推斷的時候，我們在談論什麼？</a></li>
<li class="chapter" data-level="90.2" data-path="causal-languages-.html"><a href="causal-languages-.html#section-90.2"><i class="fa fa-check"></i><b>90.2</b> 傳統的統計學方法</a><ul>
<li class="chapter" data-level="90.2.1" data-path="causal-languages-.html"><a href="causal-languages-.html#section-90.2.1"><i class="fa fa-check"></i><b>90.2.1</b> 初步分析</a></li>
<li class="chapter" data-level="90.2.2" data-path="causal-languages-.html"><a href="causal-languages-.html#section-90.2.2"><i class="fa fa-check"></i><b>90.2.2</b> 混雜</a></li>
<li class="chapter" data-level="90.2.3" data-path="causal-languages-.html"><a href="causal-languages-.html#-conditioning-on-covariates"><i class="fa fa-check"></i><b>90.2.3</b> 以共變量爲條件 conditioning on covariates</a></li>
</ul></li>
<li class="chapter" data-level="90.3" data-path="causal-languages-.html"><a href="causal-languages-.html#section-90.3"><i class="fa fa-check"></i><b>90.3</b> 更加正規的方法</a><ul>
<li class="chapter" data-level="90.3.1" data-path="causal-languages-.html"><a href="causal-languages-.html#section-90.3.1"><i class="fa fa-check"></i><b>90.3.1</b> 因果推斷使用的語言</a></li>
<li class="chapter" data-level="90.3.2" data-path="causal-languages-.html"><a href="causal-languages-.html#-causal-estimands"><i class="fa fa-check"></i><b>90.3.2</b> 因果推斷的被估計量 causal estimands</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="91" data-path="graphical-models-.html"><a href="graphical-models-.html"><i class="fa fa-check"></i><b>91</b> Graphical Models 因果推斷的圖形模型</a></li>
<li class="chapter" data-level="92" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html"><i class="fa fa-check"></i><b>92</b> Regression Methods with continuous outcomes 結果變量爲連續型變量</a></li>
<li class="chapter" data-level="93" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html"><i class="fa fa-check"></i><b>93</b> Regression Methods with binary outcomes 結果變量爲二分類變量</a></li>
<li class="chapter" data-level="94" data-path="prospensity-score-.html"><a href="prospensity-score-.html"><i class="fa fa-check"></i><b>94</b> Prospensity Score 傾向性評分</a></li>
<li class="chapter" data-level="95" data-path="inverse-probability-weighted-estimation-and-doubly-robust-methods.html"><a href="inverse-probability-weighted-estimation-and-doubly-robust-methods.html"><i class="fa fa-check"></i><b>95</b> Inverse probability weighted estimation and doubly robust methods</a></li>
<li class="chapter" data-level="96" data-path="causal-mediation-analysis.html"><a href="causal-mediation-analysis.html"><i class="fa fa-check"></i><b>96</b> Causal mediation analysis</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">醫學統計學</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="-random-coefficient-model" class="section level1">
<h1><span class="header-section-number">第 61 章</span> 隨機回歸系數模型 random coefficient model</h1>
<p>這一章節我們把隨機截距模型進一步擴展，在隨機效應部分增加隨機斜率成分 (random slope)。這樣的模型又稱隨機系數模型 (random coefficient model) 或 隨機斜率模型 (random slope model)。</p>
<div id="gcse-scores-" class="section level2">
<h2><span class="header-section-number">61.1</span> GCSE scores 實例</h2>
<p>第一章介紹過的 65 所中學學生在入學前的閱讀水平成績和畢業時的考試成績的 GCSE 數據，用來作爲本章介紹概念的實例。我們先對其中學校編號爲 1 的學生做兩個成績的線性回歸:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcse_selected &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/gcse_selected.dta&quot;</span>)
M_sch1 &lt;-<span class="st"> </span><span class="kw">lm</span>(gcse <span class="op">~</span><span class="st"> </span>lrt, <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ])

<span class="kw">summary</span>(M_sch1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = gcse ~ lrt, data = gcse_selected[gcse_selected$school == 
##     1, ])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -22.4876  -5.4427  -1.0177   6.1932  15.4687 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept) 3.833302   0.982238  3.9026 0.0002141 ***
## lrt         0.709341   0.092006  7.7097 5.771e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.29 on 71 degrees of freedom
## Multiple R-squared:  0.45569,    Adjusted R-squared:  0.44802 
## F-statistic:  59.44 on 1 and 71 DF,  p-value: 5.7708e-11</code></pre>
<div class="figure" style="text-align: center"><span id="fig:hier04-fig1"></span>
<img src="bookdown_files/figure-html/hier04-fig1-1.png" alt="GCSE versus LRT in school 1" width="80%" />
<p class="caption">
圖 61.1: GCSE versus LRT in school 1
</p>
</div>
<p>當我們重復同樣的實驗，給 65 所學校 (48號學校除外，它只有兩個學生) 一一繪制回歸直線的時候，你得到的一簇直線是這樣紙的:</p>
<div class="figure" style="text-align: center"><span id="fig:hier04-fig2"></span>
<img src="bookdown_files/figure-html/hier04-fig2-1.png" alt="Predicted regression lines of GCSE versus LRT scores: separate estimates from each school" width="80%" />
<p class="caption">
圖 61.2: Predicted regression lines of GCSE versus LRT scores: separate estimates from each school
</p>
</div>
<p>實際上這麼多學校學生的成績前後回歸線，其截距和斜率各不相同 (圖<a href="-random-coefficient-model.html#fig:hier04-fig2">61.2</a>)。這些斜率和截距的總結歸納如下:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summ</span>(Coefs[<span class="op">-</span><span class="dv">48</span>,])</code></pre></div>
<pre><code>## 
## No. of observations = 64
## 
##   Var. name   obs. mean   median  s.d.   min.   max.  
## 1 (Intercept) 64   -0.18  -0.33   3.29   -8.52  6.84  
## 2 lrt         64   0.54   0.54    0.18   0.04   1.08</code></pre>
<div class="figure" style="text-align: center"><span id="fig:hier04-fig3"></span>
<img src="bookdown_files/figure-html/hier04-fig3-1.png" alt="School specific slopes and intercepts" width="80%" />
<p class="caption">
圖 61.3: School specific slopes and intercepts
</p>
</div>
<p>圖 <a href="-random-coefficient-model.html#fig:hier04-fig3">61.3</a> 展示的是這些回歸直線各自的截距 (x 軸) 和斜率 (y 軸) 的散點圖。縱橫添加的兩條直線分別是截距和斜率的均值的位置。很明顯，截距和斜率之間本身是呈現正相關的 (相關系數 0.36): <strong>如果一個學校學生入學時成績一般，但是畢業時 GCSE 成績較高，說明那所學校本身對學生成績的提升作用明顯</strong>。</p>
<p>經過擬合64個線性回歸模型，獲得 <span class="math inline">\(64\times3\)</span> 個不同的回歸線的參數 (截距，斜率，和殘差方差)。所以我們可以提出的關於 “學校” 這個個體，它們各自的入學前後成績作出的回歸線獲得的三個參數，在它的 <strong>“人羣 (可以是英國國內的中學，全歐洲的中學，或者是全世界的中學)”</strong> 中是隨機分布在一些 “均值” 附近的。</p>
</div>
<div id="section-61.2" class="section level2">
<h2><span class="header-section-number">61.2</span> 隨機回歸系數的實質</h2>
<p>在隨機截距模型中，截距可以隨機分布在某個均值周圍，但是每條回歸直線我們默認其解釋變量和結果變量之間的關系是一樣的 (相同斜率的一簇直線)。現在，我們來把這個模型擴展，放寬它對斜率的限制，允許不同的層與層之間不僅僅可以有不同的截距，還可以有不同的斜率:</p>
<p><span class="math display" id="eq:hier04-1">\[
\begin{equation}
Y_{ij} = (\beta_0 + u_{0j}) + (\beta_1 + u_{1j})X_{1ij} + e_{ij}
\end{equation}
\tag{61.1}
\]</span></p>
<p>其中:</p>
<ul>
<li><span class="math inline">\(u_{0j}:\)</span> 是隨機截距成分 (第 <span class="math inline">\(j\)</span> 層數據和總體均值 <span class="math inline">\(\beta_0\)</span> 之間的差異)</li>
<li><span class="math inline">\(u_{1j}:\)</span> 是隨機斜率成分 (第 <span class="math inline">\(j\)</span> 層數據和總體寫率 <span class="math inline">\(\beta_1\)</span> 之間的差異)</li>
<li><span class="math inline">\(\text{E}(u_{0j}|X_{1ij}) = 0\)</span></li>
<li><span class="math inline">\(\text{E}(u_{1j}|X_{1ij}) = 0\)</span></li>
<li><span class="math inline">\(\text{E}(e_{ij}|X_{1ij},u_{0j}, u_{1j}) = 0\)</span></li>
<li><span class="math inline">\(u_0, u_1 \perp X_{1ij}\)</span> (兩個隨機部分和解釋變量之間獨立不相關)</li>
<li><span class="math inline">\(u_0, u_1 \perp e_{ij}\)</span> (兩個隨機部分和總體的隨機誤差獨立不相關)</li>
</ul>
<p>另外，<span class="math inline">\(\mathbf{u}_j = \{u_0, u_1\}\)</span> 服從分布:</p>
<p><span class="math display">\[
\mathbf{u}_j | X_{1ij} \sim N(\mathbf{0}, \mathbf{\sum}_{\mathbf{u}})
\]</span></p>
<p>其中的 <span class="math inline">\(\mathbf{\sum}_{\mathbf{u}}\)</span> 是一個 <span class="math inline">\(2\times2\)</span> 的方差協方差矩陣:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Where } \mathbf{u}_j &amp; = (u_{0j}, u_{1j})^T \\ 
              \mathbf{0}   &amp; = (0, 0)^T \\ 
              \mathbf{\sum}_{\mathbf{u}} &amp; =\left( \begin{array}{cc}
              \sigma^2_{u_{00}} &amp; \sigma_{u_{01}} \\
              \sigma_{u_{01}}   &amp; \sigma^2_{u_{11}} \\
              \end{array} \right)
\end{aligned}
\]</span></p>
<p><span class="math inline">\(e_{ij}\)</span> 則服從下列分布:</p>
<p><span class="math display">\[
e_{ij} | X_{1ij}, u_{0j}, u_{1j} \sim N(0, \sigma^2_e)
\]</span></p>
</div>
<div id="-gcse-scores-" class="section level2">
<h2><span class="header-section-number">61.3</span> 繼續 GCSE scores 實例</h2>
<p>繼續用 GCSE 數據，去除掉 48 號學校以後，擬合一個固定效應模型 (相同斜率，但是不同的固定截距):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FIX_inter &lt;-<span class="st"> </span><span class="kw">lm</span>(gcse <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="st"> </span><span class="dv">48</span>, ])</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(FIX_inter)</code></pre></div>
<pre><code>Call:
lm(formula = gcse ~ 0 + lrt + factor(school), data = gcse_selected[gcse_selected$school != 
    48, ])

Residuals:
   Min     1Q Median     3Q    Max 
-28.32  -4.77   0.22   5.08  24.41 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
lrt                0.5595     0.0125   44.63  &lt; 2e-16 ***
factor(school)1    4.0823     0.8806    4.64  3.7e-06 ***
factor(school)2    5.6202     1.0154    5.53  3.3e-08 ***
   ...................                  ............
   ................... &lt;Output ommited&gt; ............
   ...................                  ............
factor(school)62  -0.5566     0.8929   -0.62  0.53306    
factor(school)63   6.4827     1.3734    4.72  2.4e-06 ***
factor(school)64   1.0089     0.9808    1.03  0.30368    
factor(school)65  -1.7701     0.8415   -2.10  0.03547 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.52 on 3992 degrees of freedom
Multiple R-squared:  0.442, Adjusted R-squared:  0.433 
F-statistic: 48.7 on 65 and 3992 DF,  p-value: &lt;2e-16</code></pre>
<p>該固定效應模型 (簡單線性回歸模型) 估計的共同斜率是 0.56 (se = 0.01)，和 64 個不同的固定斜率。這些固定斜率的範圍是 -9,63 到 7.91，均值是 0.03，標準差是 3.38。估計的殘差標準差是 <code>Residual standard error: 7.52</code>。</p>
<p>如果用相同的數據，我們允許截距發生隨機變動的話 (隨機截距模型):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MIX_inter &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="st"> </span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(MIX_inter)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + (1 | school)
##    Data: gcse_selected[gcse_selected$school != 48, ]
## 
## REML criterion at convergence: 28044.1
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.71619 -0.63094  0.02920  0.68478  3.26661 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept)  9.4273  3.0704  
##  Residual             56.6047  7.5236  
## Number of obs: 4057, groups:  school, 64
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)    0.031006    0.405263   59.900000  0.0765   0.9393    
## lrt            0.563268    0.012471 4048.000000 45.1676   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##     (Intr)
## lrt 0.007</code></pre>
<p>隨機截距模型估計的共同斜率還是不變 (0.56, se = 0.01)，總體平均截距是 0.03 (無統計學意義)。截距的 (正態) 分布的標準差是 3.07。殘差標準差，和剛才簡單現行回歸計算的殘差標準差是一樣的 (=7.52)。幾乎所有我們關心的參數估計，都接近簡單線性回歸的結果，但是隨機截距模型使用的參數個數只有 4 個，固定效應模型則用到了 66 個 (很顯然隨機截距模型更加高效)。</p>
<p>接下來，我們進一步擬合本章的重點模型 – 隨機參數模型:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MIX_coef &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>(lrt <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="st"> </span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(MIX_coef)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + (lrt | school)
##    Data: gcse_selected[gcse_selected$school != 48, ]
## 
## REML criterion at convergence: 28003
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.83180 -0.63196  0.03374  0.68332  3.45517 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  school   (Intercept)  9.250260 3.04142       
##           lrt          0.014962 0.12232  0.494
##  Residual             55.382480 7.44194       
## Number of obs: 4057, groups:  school, 64
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) -0.109206   0.402644 59.910000 -0.2712   0.7872    
## lrt          0.556600   0.020115 56.323000 27.6715   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##     (Intr)
## lrt 0.365</code></pre>
<p>這個模型，不僅允許了隨機的截距，還允許每個直線的斜率成爲隨機的斜率。此時的總體平均截距被估計爲 -0.11 (依然沒有統計學意義)，標準差略微變小 (3.07 變成了 3.04)。總體平均斜率是 0.56，現在也被允許有變動，其標準差是 0.12。此時這些許許多多的估計回歸方程中，斜率和截距的相關系數是 0.49，這十分接近我們在一開始的簡單回歸64次計算獲得的斜率和截距的相關系數 (0.36)。此隨機系數模型的殘差標準差變成了 7.44，略微小於之前的 7.52。這三個模型的結果總結如下表:</p>
<table class="table table-striped table-bordered" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
表 61.1: Comparison of fixed, random intercept, and random coefficient models: school data
</caption>
<thead>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="6">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Model
</div>
</th>
</tr>
<tr>
<th style="border-bottom:hidden" colspan="1">
</th>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Fixed effect
</div>
</th>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Random intercept
</div>
</th>
<th style="text-align:center; border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;" colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px;">
Random coeff.
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
est
</th>
<th style="text-align:left;">
se
</th>
<th style="text-align:left;">
est
</th>
<th style="text-align:left;">
se
</th>
<th style="text-align:left;">
est
</th>
<th style="text-align:left;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(Fixed\; part\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:left;">
-0.03
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
0.031
</td>
<td style="text-align:left;">
0.405
</td>
<td style="text-align:left;">
-0.109
</td>
<td style="text-align:left;">
0.403
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;">
0.56
</td>
<td style="text-align:left;">
0.013
</td>
<td style="text-align:left;">
0.563
</td>
<td style="text-align:left;">
0.013
</td>
<td style="text-align:left;">
0.557
</td>
<td style="text-align:left;">
0.020
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(Random\; part\)</span>
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma_{u_{00}}\)</span>
</td>
<td style="text-align:left;">
3.38
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
3.07
</td>
<td style="text-align:left;">
0.312
</td>
<td style="text-align:left;">
3.041
</td>
<td style="text-align:left;">
0.311
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma_{u_{11}}\)</span>
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
0.122
</td>
<td style="text-align:left;">
0.019
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\text{Corr}(0,1)\)</span>
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
0.494
</td>
<td style="text-align:left;">
0.149
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma_e\)</span>
</td>
<td style="text-align:left;">
7.522
</td>
<td style="text-align:left;">
<ul>
<li></td>
<td style="text-align:left;">
7.524
</td>
<td style="text-align:left;">
0.084
</td>
<td style="text-align:left;">
7.442
</td>
<td style="text-align:left;">
0.084
</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="section-61.4" class="section level2">
<h2><span class="header-section-number">61.4</span> 使用模型結果推斷</h2>
<p>接下來，我們討論如何比較隨機系數模型，隨機截距模型，也就是如何選擇一個更優的模型。如果只是比較相同數據下，隨機系數模型和隨機截距模型的優劣，那麼只需要同時檢驗 <span class="math inline">\(u_{1j} = 0; \text{Cov}(u_{0j}, u_{1j}) = 0\)</span>。</p>
<p>就用剛剛擬合好的 <code>MIX_inter</code> 和 <code>MIX_coef</code> 來比較:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MIX_coef &lt;-<span class="st"> </span><span class="kw">lme</span>(<span class="dt">fixed =</span> gcse <span class="op">~</span><span class="st"> </span>lrt, <span class="dt">random =</span>  <span class="op">~</span><span class="st"> </span>lrt <span class="op">|</span><span class="st"> </span>school, <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="st"> </span><span class="dv">48</span>, ], <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>)
MIX_inter &lt;-<span class="st"> </span><span class="kw">lme</span>(<span class="dt">fixed =</span> gcse <span class="op">~</span><span class="st"> </span>lrt, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school, <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="st"> </span><span class="dv">48</span>, ], <span class="dt">method =</span> <span class="st">&quot;REML&quot;</span>)

<span class="kw">anova</span>(MIX_inter, MIX_coef)</code></pre></div>
<pre><code>##           Model df       AIC       BIC     logLik   Test   L.Ratio p-value
## MIX_inter     1  4 28052.050 28077.281 -14022.025                         
## MIX_coef      2  6 28014.963 28052.809 -14001.482 1 vs 2 41.087068  &lt;.0001</code></pre>
<p>值得注意的是，這裏計算的 似然比的檢驗統計量服從的是一個 自由度爲 2 的卡方分布和一個 自由度爲 1 的卡方分布的混合分布。所以報告中給出的 p 值是一個保守估計，正確的 p 值可以這樣計算:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">likelihood &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(MIX_inter) <span class="op">-</span><span class="st"> </span><span class="kw">logLik</span>(MIX_coef)))
<span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="kw">as.numeric</span>(likelihood), <span class="dt">df =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="kw">as.numeric</span>(likelihood), <span class="dt">df =</span> <span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 6.7124634e-10</code></pre>
<p>另一個重要的問題是該如何去真正理解這裏隨機系數模型給出的結果呢？</p>
<p>該模型的結果說，“人羣”中的總體均值是 -0.11，總體斜率是 0.56 (se = 0.02, 95%CI: 0.52, 0.60)。這裏的“人羣”指的是全英國/或者全世界這樣的學校。學校水平的截距和斜率服從以這兩個數字爲均值，標準差分別是 3.04 和 0.12 的正態分布。且截距和斜率之間的相關系數接近 0.50。第一層級 (學生的) 個體隨機誤差的標準差爲 7.44。這些結果可以拿來估計“學校人羣”的 95% 截距/斜率: <span class="math inline">\(-0.11 \pm 1.96 \times3.04\)</span> 和 <span class="math inline">\(0.56 \pm 1.96\times0.12\)</span>，所以人羣的截距的 95% 信賴區間是: <span class="math inline">\(-6.07, 5.85\)</span>，斜率的 95% 信賴區間是: <span class="math inline">\(0.33, 0.80\)</span>。與此形成對比的是，我們開頭給 64 所學校建立的 64 個模型的 截距和斜率拿來估計的 95% 截距信賴區間是 <span class="math inline">\(-0.18 \pm 1.96\times3.29: -6.63, 6.27\)</span>，95% 斜率信賴區間是 <span class="math inline">\(0.54 \pm 1.96 \times 0.18: 0.19, 0.89\)</span>。所以，隨機系數模型對截距和斜率的人羣估計及推斷更加精準。</p>
</div>
<div id="random-var" class="section level2">
<h2><span class="header-section-number">61.5</span> 隨機效應的方差</h2>
<p>在解釋混合效應模型的隨機效應部分的時候，有幾點需要注意。首先，隨機截距的方差，和隨機斜率的方差，是具有不同單位的。<strong>隨機截距的方差的單位是結果變量 <span class="math inline">\(Y\)</span> 的單位的平方</strong>。<strong>隨機斜率的方差，是結果變量和解釋變量的單位的商的平方</strong>。</p>
<p>另一個要注意的點是，<span class="math inline">\(Y_{ij}\)</span> 在 <span class="math inline">\(X_{1ij}\)</span> 的條件下的殘差的標準差，不是恆定不變的 (隨着 <span class="math inline">\(X_1\)</span> 的變化而變化):</p>
<p><span class="math display">\[
\begin{aligned}
Y_{ij} &amp; = (\beta_0 + u_{0j}) + (\beta_1 + u_{1j}) X_{1ij} + e_{ij}  \\ 
       &amp; = (\beta_0 + \beta_1X_{1ij}) + (u_{0j} + u_{1j}X_{1ij} + e_{ij}) \\ 
       &amp; = (\beta_0 + \beta_1X_{1ij}) + \epsilon_{ij}
\end{aligned}
\]</span></p>
<p>所以從上面的式子可看出，隨機參數模型的<strong>總體殘差 (total residuals)</strong>，<span class="math inline">\(\epsilon_{ij} = u_{0j} + u_{1j}X_{1ij} + e_{ij}\)</span>，是隨着你想給斜率隨機性的那個解釋變量的變化而變化的。也正因爲如此，總體殘差的方差，也是隨着解釋變量變化而變化的 (和解釋變量成二次方程關系，如果繪制總體慘差的方差和解釋變量之間的關系會是一個拋物線):</p>
<p><span class="math display" id="eq:hier04-3">\[
\begin{aligned}
\text{Var}(Y_{ij} | X_{1ij}) &amp; = \text{Var}( u_{0j} + u_{1j}X_{1ij} + e_{ij}) \\ 
                             &amp; = \sigma^2_{u_{00}} + X_{1ij}^2\sigma^2_{u_{11}} + 2X_{1ij}\sigma_{u_{01}} + \sigma^2_e
\end{aligned}
\tag{61.2}
\]</span></p>
</div>
<div id="section-61.6" class="section level2">
<h2><span class="header-section-number">61.6</span> 模型效果評估</h2>
<p>擬合模型的評估中，另一個重要的事是分析第一階層殘差和第二階層殘差是不是符合其前提條件 (正態分布)。記得第二階層殘差獲取之後需要被標準化。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MIX_coef &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>(lrt <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="st"> </span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>)
School_res0 &lt;-<span class="st"> </span>HLMdiag<span class="op">::</span><span class="kw">HLMresid</span>(MIX_coef, <span class="dt">level =</span> <span class="st">&quot;school&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;EB&quot;</span>, <span class="dt">standardize =</span> <span class="ot">FALSE</span>)
<span class="kw">summ</span>(School_res0)</code></pre></div>
<pre><code>## 
## No. of observations = 64
## 
##   Var. name   obs. mean   median  s.d.   min.   max.  
## 1 (Intercept) 64   0      -0.11   2.87   -7.19  6.45  
## 2 lrt         64   0      0       0.1    -0.19  0.35</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">School_res1 &lt;-<span class="st"> </span>HLMdiag<span class="op">::</span><span class="kw">HLMresid</span>(MIX_coef, <span class="dt">level =</span> <span class="st">&quot;school&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;EB&quot;</span>, <span class="dt">standardize =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Warning in ranef.merMod(object, postVar = TRUE): &#39;postVar&#39; is deprecated: please use &#39;condVar&#39;
## instead</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summ</span>(School_res1)</code></pre></div>
<pre><code>## 
## No. of observations = 64
## 
##   Var. name   obs. mean   median  s.d.   min.   max.  
## 1 (Intercept) 64   0.04   -0.14   3      -6.74  7.53  
## 2 lrt         64   0.04   -0.03   1.31   -2.35  5.07</code></pre>
<div class="figure" style="text-align: center"><span id="fig:hier4-level2-residuals"></span>
<img src="bookdown_files/figure-html/hier4-level2-residuals-1.png" alt="Q-Q plots of school level intercept and slope residuals (unstandardized)" width="80%" />
<p class="caption">
圖 61.4: Q-Q plots of school level intercept and slope residuals (unstandardized)
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:4-level2sta-residuals"></span>
<img src="bookdown_files/figure-html/4-level2sta-residuals-1.png" alt="Q-Q plots of school level intercept and slope residuals (standardized)" width="80%" />
<p class="caption">
圖 61.5: Q-Q plots of school level intercept and slope residuals (standardized)
</p>
</div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  4057 0      0.034   0.989  -3.832 3.455</code></pre>
<div class="figure" style="text-align: center"><span id="fig:4-level1sta-residuals"></span>
<img src="bookdown_files/figure-html/4-level1sta-residuals-1.png" alt="Histogram and Q-Qf plots of elementary level (pupil) standardized residuals" width="80%" />
<p class="caption">
圖 61.6: Histogram and Q-Qf plots of elementary level (pupil) standardized residuals
</p>
</div>
</div>
<div id="-9" class="section level2">
<h2><span class="header-section-number">61.7</span> 練習題</h2>
<ol style="list-style-type: decimal">
<li>GCSE data: 數據來自65所中學的學生畢業成績 “the Graduate Certificate of Secondary Education (GCSE) score”，和這些學生在剛剛入學時接受閱讀能力水平測試 (LRT score) 的成績。其變量和各自含義爲：</li>
</ol>
<pre><code>school          school identifier
student         student identifier
gcse            GCSE score (multiplied by 10)
lrt             LRT score (multiplied by 10)
girl            Student female gender (1 = yes, 0 = no)
schgend         type of school (1: mixed gender; 2: boys only; 3: girls only)</code></pre>
<div id="section-61.7.1" class="section level3">
<h3><span class="header-section-number">61.7.1</span> 　將數據導入軟件裏，</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcse_selected &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/gcse_selected.dta&quot;</span>)

<span class="kw">length</span>(<span class="kw">unique</span>(gcse_selected<span class="op">$</span>school)) ## number of school = 65</code></pre></div>
<pre><code>## [1] 65</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcse_selected &lt;-<span class="st"> </span>gcse_selected <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">schgend =</span> <span class="kw">factor</span>(schgend, <span class="dt">labels  =</span> <span class="kw">c</span>(<span class="st">&quot;mixed geder&quot;</span>, <span class="st">&quot;boys only&quot;</span>, <span class="st">&quot;girls only&quot;</span>)))


## create a subset data with only the first observation of each school
gcse &lt;-<span class="st"> </span>gcse_selected[<span class="op">!</span><span class="kw">duplicated</span>(gcse_selected<span class="op">$</span>school), ]

<span class="co"># 一共有 65 所學校，54% 是混合校，15% 是男校，31% 是女校</span>
<span class="kw">with</span>(gcse, <span class="kw">tab1</span>(schgend, <span class="dt">graph =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>## schgend : 
##             Frequency Percent Cum. percent
## mixed geder        35    53.8         53.8
## boys only          10    15.4         69.2
## girls only         20    30.8        100.0
##   Total            65   100.0        100.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 計算每所學校兩種成績的平均分，計算一個包含每所學校的平均女生人數的變量</span>
Mean_gcse_lrt &lt;-<span class="st"> </span><span class="kw">ddply</span>(gcse_selected,<span class="op">~</span>school,summarise,<span class="dt">mean_gcse=</span><span class="kw">mean</span>(gcse),<span class="dt">mean_lrt=</span><span class="kw">mean</span>(lrt), <span class="dt">mean_girl=</span><span class="kw">mean</span>(girl)) 

<span class="co"># 整體來說，GCSE 分數的分布比起入學前 LRT 分數的分布更加寬泛，標準差更大。</span>
<span class="co"># 意味着入學時學生閱讀成績的差異，比起畢業時成績的差異要小。</span>
<span class="co"># 或者反過來說，畢業時成績差異，比起入學時閱讀成績的差異要大。</span>
<span class="kw">summ</span>(Mean_gcse_lrt[,<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>## 
## No. of observations = 65
## 
##   Var. name obs. mean   median  s.d.   min.   max.  
## 1 mean_gcse 65   -0.23  -0.34   4.39   -10.49 10.04 
## 2 mean_lrt  65   -0.31  -0.41   3.44   -7.56  6.38  
## 3 mean_girl 65   0.57   0.5     0.36   0      1</code></pre>
</div>
<div id="-48---gcse-lrt-" class="section level3">
<h3><span class="header-section-number">61.7.2</span> 先忽略學校編號爲 48 的學校，擬合一個只有固定效應 (簡單線性回歸模型)，結果變量是 GCSE，解釋變量是 LRT 和學校。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fix &lt;-<span class="st"> </span><span class="kw">lm</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span><span class="kw">factor</span>(school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="dv">48</span>, ])
<span class="kw">anova</span>(Fix)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: gcse
##                  Df   Sum Sq  Mean Sq  F value     Pr(&gt;F)    
## lrt               1 141723.2 141723.2 2505.000 &lt; 2.22e-16 ***
## factor(school)   63  37314.7    592.3   10.469 &lt; 2.22e-16 ***
## Residuals      3992 225851.9     56.6                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Fix) <span class="co"># 輸出結果太長，中間被省略掉</span></code></pre></div>
<p>LRT 的回歸系數 (直線斜率 = 0.56, se = 0.01)，殘差的標準差 <span class="math inline">\(\hat\sigma_e =\)</span> 7.52。</p>
<pre><code>Call:
lm(formula = gcse ~ lrt + factor(school), data = gcse_selected[gcse_selected$school != 
    48, ])

Residuals:
   Min     1Q Median     3Q    Max 
-28.32  -4.77   0.22   5.08  24.41 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        4.08232    0.88060    4.64  3.7e-06 ***
lrt                0.55948    0.01253   44.63  &lt; 2e-16 ***
factor(school)2    1.53785    1.34332    1.14  0.25235    
                         ...
                         ...&lt;OMITTED OUTPUT&gt;
                         ...
                         ...
factor(school)65  -5.85245    1.21850   -4.80  1.6e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 7.52 on 3992 degrees of freedom
Multiple R-squared:  0.442, Adjusted R-squared:  0.433 
F-statistic: 49.4 on 64 and 3992 DF,  p-value: &lt;2e-16</code></pre>
</div>
<div id="--lrt-" class="section level3">
<h3><span class="header-section-number">61.7.3</span> 僅有固定效應模型的學校變量變更爲學校類型 (男校女校或混合校)，從這個新模型的結果來看，你是否認爲學校類型，和學校編號本身相比能夠解釋相同的學校層面的方差？ <code>lrt</code> 的估計回歸參數發生了怎樣的變化？</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fix1 &lt;-<span class="st"> </span><span class="kw">lm</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>schgend, <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="dv">48</span>, ])
<span class="kw">anova</span>(Fix1)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: gcse
##             Df   Sum Sq  Mean Sq   F value     Pr(&gt;F)    
## lrt          1 141723.2 141723.2 2222.6017 &lt; 2.22e-16 ***
## schgend      2   4728.9   2364.4   37.0807 &lt; 2.22e-16 ***
## Residuals 4053 258437.7     63.8                         
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Fix1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = gcse ~ lrt + schgend, data = gcse_selected[gcse_selected$school != 
##     48, ])
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -26.17545  -5.12410   0.19171   5.35399  28.32233 
## 
## Coefficients:
##                    Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)       -0.960872   0.171460 -5.6041 2.233e-08 ***
## lrt                0.594272   0.012622 47.0836 &lt; 2.2e-16 ***
## schgendboys only   1.177713   0.392041  3.0041   0.00268 ** 
## schgendgirls only  2.362920   0.275274  8.5839 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.9853 on 4053 degrees of freedom
## Multiple R-squared:  0.36171,    Adjusted R-squared:  0.36124 
## F-statistic: 765.59 on 3 and 4053 DF,  p-value: &lt; 2.22e-16</code></pre>
<p>新的模型 <code>Fix1</code> 參數明顯減少很多，殘差標準差估計 <span class="math inline">\(\hat\sigma_u =\)</span> 7.99。LRT 的回歸系數估計僅發生了不太明顯的變化 0.59 (0.01)</p>
</div>
<div id="-log-likelihood-lmertestrand-" class="section level3">
<h3><span class="header-section-number">61.7.4</span> 使用限制性極大似然法擬合一個隨機截距模型。記錄此時的限制性對數似然的大小 (log-likelihood)。用 <code>lmerTest::rand</code> 命令對隨機效應部分的方差是否爲零做檢驗，指明該檢驗的零假設是什麼，並解釋其結果的含義。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lmerTest)
Fixed_reml &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st">  </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(Fixed_reml)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + (1 | school)
##    Data: gcse_selected[gcse_selected$school != 48, ]
## 
## REML criterion at convergence: 28044.1
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.71619 -0.63094  0.02920  0.68478  3.26661 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept)  9.4273  3.0704  
##  Residual             56.6047  7.5236  
## Number of obs: 4057, groups:  school, 64
## 
## Fixed effects:
##                Estimate  Std. Error          df t value Pr(&gt;|t|)    
## (Intercept)    0.031006    0.405263   59.900000  0.0765   0.9393    
## lrt            0.563268    0.012471 4048.000000 45.1676   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##     (Intr)
## lrt 0.007</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rand</span>(Fixed_reml) ## random effect test</code></pre></div>
<pre><code>## Analysis of Random effects Table:
##        Chi.sq Chi.DF p.value    
## school    406      1  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>隨機截距模型的輸出結果可以看出，這裏的混合模型估計的 LRT 的回歸系數跟僅有固定效應的簡單線性回歸模型估計的值完全一樣 (0.56, se=0.01)。隨機效應部分 <span class="math inline">\(\hat\sigma_e = 7.524, \hat\sigma_u = 3.07\)</span>，此時的限制性似然 (restricted log-likelihood) 是 -14022。最晚部分的隨機效應檢驗的零假設是 <span class="math inline">\(\sigma_u = 0\)</span>，且值得注意的是，由於方差本身不可能小於零，故本次檢驗只用到自由度爲 1 的卡方分布的右半側(單側)。也就是說，其替代假設有且只有 <span class="math inline">\(\sigma_u &gt; 0\)</span> 的單側假設。這裏的檢驗結果提示高度有意義 (highly significant)。</p>
</div>
<div id="-schgend-" class="section level3">
<h3><span class="header-section-number">61.7.5</span> 在前一題的隨機截距模型中加入 <code>schgend</code> 變量，作爲解釋隨機截距的一個自變量，觀察輸出結果，解釋其是否有意義。記錄這個模型的限制性似然。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fixed_reml1 &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>schgend <span class="op">+</span><span class="st">  </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>) 
<span class="co">#Fixed_reml1 &lt;- lme(fixed = gcse ~ lrt + schgend , random =  ~ 1 | school, data = gcse_selected[gcse_selected$school !=48, ], method = &quot;REML&quot;) </span>

<span class="kw">summary</span>(Fixed_reml1)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + schgend + (1 | school)
##    Data: gcse_selected[gcse_selected$school != 48, ]
## 
## REML criterion at convergence: 28032.6
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.71222 -0.63023  0.02647  0.68064  3.24445 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  school   (Intercept)  8.4961  2.9148  
##  Residual             56.6045  7.5236  
## Number of obs: 4057, groups:  school, 64
## 
## Fixed effects:
##                      Estimate  Std. Error          df t value  Pr(&gt;|t|)    
## (Intercept)         -0.872660    0.524979   58.500000 -1.6623  0.101807    
## lrt                  0.563512    0.012465 4049.300000 45.2087 &lt; 2.2e-16 ***
## schgendboys only     0.968683    1.118170   59.800000  0.8663  0.389785    
## schgendgirls only    2.497825    0.876614   56.700000  2.8494  0.006096 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) lrt    schgndbo
## lrt          0.006                
## schgndbyson -0.469  0.006         
## schgndgrlso -0.599 -0.004  0.281</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 檢驗新增的學校種類 schgend 是否對應該加入模型。

mod2&lt;-<span class="st"> </span><span class="kw">update</span>(Fixed_reml1, . <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>schgend)
<span class="kw">anova</span>(Fixed_reml1, mod2)</code></pre></div>
<pre><code>## Data: gcse_selected[gcse_selected$school != 48, ]
## Models:
## ..1: gcse ~ lrt + (1 | school)
## object: gcse ~ lrt + schgend + (1 | school)
##        Df     AIC     BIC   logLik deviance   Chisq Chi Df Pr(&gt;Chisq)  
## ..1     4 28045.1 28070.4 -14018.6  28037.1                            
## object  6 28041.1 28079.0 -14014.6  28029.1 8.01852      2   0.018147 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 求 Fixed_reml1 的似然

<span class="kw">logLik</span>(Fixed_reml1)</code></pre></div>
<pre><code>## &#39;log Lik.&#39; -14016.32 (df=6)</code></pre>
<p>增加了學校類型在固定效應部分時，隨機效應的標準差從錢一個模型的 3.07 降低到這裏的 2.92。這個變量本身，從最後的模型比較也能看出，對模型的貢獻是有意義的 (p=0.018)。當然從隨機截距模型的輸出結果可以看出，學校類型的這一變量中，可能只有“女校”這一細分部分提供了足夠的效應。這裏的隨機截距模型的REML似然是 (restricted log-likelihood = -14016)</p>
</div>
<div id="-lrt-" class="section level3">
<h3><span class="header-section-number">61.7.6</span> 擬合隨機截距隨機斜率模型，固定效應部分的 <code>lrt</code> 也加入進隨機效應部分。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fixed_reml2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>schgend <span class="op">+</span><span class="st">  </span>(lrt <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(Fixed_reml2)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + schgend + (lrt | school)
##    Data: gcse_selected[gcse_selected$school != 48, ]
## 
## REML criterion at convergence: 27988.8
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.83074 -0.63014  0.03252  0.68507  3.41664 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  school   (Intercept)  8.273453 2.87636       
##           lrt          0.014942 0.12224  0.582
##  Residual             55.394052 7.44272       
## Number of obs: 4057, groups:  school, 64
## 
## Fixed effects:
##                    Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)       -1.097849   0.497542 63.011000 -2.2065  0.03100 *  
## lrt                0.558198   0.020074 56.234000 27.8067  &lt; 2e-16 ***
## schgendboys only   1.041559   0.998822 57.086000  1.0428  0.30144    
## schgendgirls only  2.712077   0.783468 53.765000  3.4616  0.00106 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) lrt    schgndbo
## lrt          0.321                
## schgndbyson -0.443  0.011         
## schgndgrlso -0.566  0.011  0.284</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">logLik</span>(Fixed_reml2)</code></pre></div>
<pre><code>## &#39;log Lik.&#39; -13994.393 (df=8)</code></pre>
<p>當截距 (不同學校之間， gcse 的起點)，斜率 (不同學校之間 lrt 和 gcse 之間的關系的斜率) 均可以有隨機性以後，<code>lrt</code> 的斜率雖然仍然保持不變 <span class="math inline">\(=0.56\)</span>，但是它的隨機效應標準差變成了 <span class="math inline">\(=0.12\)</span>，隨機截距的標準差也保持不變 <span class="math inline">\(=2.88\)</span>，這二者之間的相關系數是 <span class="math inline">\(=0.58\)</span>。第一階層隨機殘差標準也有了微妙的變化 <span class="math inline">\(7.52 \rightarrow 7.44\)</span>，此模型的限制性對數似然 (restricted log-likelihood) 是 <code>-13994.393 (df=8)</code>。</p>
</div>
<div id="section-61.7.7" class="section level3">
<h3><span class="header-section-number">61.7.7</span> 通過上面幾個模型計算獲得的似然，嘗試檢驗隨機斜率標準差，以及該標準差和隨機截距標準差的協相關是否有意義。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rand</span>(Fixed_reml2)</code></pre></div>
<pre><code>## Analysis of Random effects Table:
##            Chi.sq Chi.DF p.value    
## lrt:school   43.9      2   3e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 手算的方法是這樣的</span>
likelihood &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(<span class="kw">logLik</span>(Fixed_reml1) <span class="op">-</span><span class="st"> </span><span class="kw">logLik</span>(Fixed_reml2)))
<span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="kw">as.numeric</span>(likelihood), <span class="dt">df =</span> <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pchisq</span>(<span class="kw">as.numeric</span>(likelihood), <span class="dt">df =</span> <span class="dv">2</span>))</code></pre></div>
<pre><code>## [1] 1.67652e-10</code></pre>
<p>似然比檢驗的統計量是 43.8，不用檢驗也知道肯定是有意義的。手算也是可以達到相同的效果。值得注意的是，R計算給出的基於自由度爲 2 的卡方分布，其實是偏保守的。注意看手算部分，其實用到了自由度爲 1 自由度爲 2 兩個卡方分布換算獲得的 p 值。</p>
</div>
<div id="-schgend--mean_girl-" class="section level3">
<h3><span class="header-section-number">61.7.8</span> 模型中的 <code>schgend</code> 改成 <code>mean_girl</code> 會給出怎樣的結果呢？</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 把女生平均值放回整體數據中去
Mean_girl &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">65</span>) {
  Mean_girl &lt;-<span class="st"> </span><span class="kw">c</span>(Mean_girl, <span class="kw">rep</span>(Mean_gcse_lrt<span class="op">$</span>mean_girl[i], <span class="kw">with</span>(gcse_selected, <span class="kw">table</span>(school))[i]))
  }
gcse_selected<span class="op">$</span>mean_girl &lt;-<span class="st"> </span>Mean_girl
  <span class="kw">rm</span>(Mean_girl)


Fixed_reml3 &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>mean_girl <span class="op">+</span><span class="st">  </span>(lrt <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">!=</span><span class="dv">48</span>, ], <span class="dt">REML =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(Fixed_reml3)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + mean_girl + (lrt | school)
##    Data: gcse_selected[gcse_selected$school != 48, ]
## 
## REML criterion at convergence: 27997.1
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.81959 -0.63170  0.02996  0.68439  3.43505 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  school   (Intercept)  8.915642 2.98591       
##           lrt          0.014907 0.12209  0.523
##  Residual             55.388117 7.44232       
## Number of obs: 4057, groups:  school, 64
## 
## Fixed effects:
##              Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept) -1.279921   0.705712 63.060000 -1.8137  0.07449 .  
## lrt          0.556709   0.020082 56.157000 27.7219  &lt; 2e-16 ***
## mean_girl    2.066076   1.031947 56.642000  2.0021  0.05007 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##           (Intr) lrt   
## lrt        0.220       
## mean_girl -0.828 -0.004</code></pre>
<p>由於 <code>mean_girl</code> 其實是和 <code>schgend</code> 非常相似的表示學校層面的男女生性別比例的變量，所以這個模型的結果其實和前一個給出的隨機效應標準差的估計都很接近。</p>
</div>
<div id="-48--gcse-lrt" class="section level3">
<h3><span class="header-section-number">61.7.9</span> 現在我們把注意力改爲關心學校編號爲 48 的學校的情況。用且禁用它一所學校的數據，擬合一個簡單線性回歸，結果變量是 <code>gcse</code>，解釋變量是 <code>lrt</code>。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">==</span><span class="dv">48</span>, ]</code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   school student  gcse   lrt  girl schgend    mean_girl
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;
## 1   48.0    1.00 -7.00 -3.73  1.00 girls only      1.00
## 2   48.0    2.00 -1.29 -4.55  1.00 girls only      1.00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">school48lm &lt;-<span class="st"> </span><span class="kw">lm</span>(gcse <span class="op">~</span><span class="st"> </span>lrt, <span class="dt">data =</span> gcse_selected[gcse_selected<span class="op">$</span>school <span class="op">==</span><span class="dv">48</span>, ])
<span class="kw">summary</span>(school48lm)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = gcse ~ lrt, data = gcse_selected[gcse_selected$school == 
##     48, ])
## 
## Residuals:
## ALL 2 residuals are 0: no residual degrees of freedom!
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -32.7221         NA      NA       NA
## lrt          -6.9018         NA      NA       NA
## 
## Residual standard error: NaN on 0 degrees of freedom
## Multiple R-squared:       1, Adjusted R-squared:     NaN 
## F-statistic:    NaN on 1 and 0 DF,  p-value: NA</code></pre>
<p>由於 48 號學校只有兩個數據點，所以強行進行簡單線性回歸的結果，就是擬合了一條通過這兩個點的直線，截距是-32.7，斜率是 -6.9，且沒有任何估計的誤差。</p>
</div>
<div id="-48--fixed_reml2-" class="section level3">
<h3><span class="header-section-number">61.7.10</span> 這次不排除 48 號學校，擬合所有學校的數據進入 <code>Fixed_reml2</code> 模型中去，結果有發生顯著的變化嗎？</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fixed_reml2 &lt;-<span class="st"> </span><span class="kw">lmer</span>(gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>schgend <span class="op">+</span><span class="st">  </span>(lrt <span class="op">|</span><span class="st"> </span>school), <span class="dt">data =</span> gcse_selected, <span class="dt">REML =</span> <span class="ot">TRUE</span>)
<span class="kw">summary</span>(Fixed_reml2)</code></pre></div>
<pre><code>## Linear mixed model fit by REML t-tests use Satterthwaite approximations to degrees of freedom [
## lmerMod]
## Formula: gcse ~ lrt + schgend + (lrt | school)
##    Data: gcse_selected
## 
## REML criterion at convergence: 28001.4
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -3.83116 -0.63097  0.03274  0.68535  3.41847 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  school   (Intercept)  8.245345 2.87147       
##           lrt          0.014949 0.12227  0.582
##  Residual             55.377764 7.44162       
## Number of obs: 4059, groups:  school, 65
## 
## Fixed effects:
##                    Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)       -1.099119   0.496805 63.337000 -2.2124  0.03055 *  
## lrt                0.558021   0.020074 56.266000 27.7984  &lt; 2e-16 ***
## schgendboys only   1.041128   0.997441 57.360000  1.0438  0.30096    
## schgendgirls only  2.672895   0.779542 54.644000  3.4288  0.00116 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) lrt    schgndbo
## lrt          0.321                
## schgndbyson -0.443  0.011         
## schgndgrlso -0.569  0.010  0.285</code></pre>
<p>可以看到，即使我們加入這個數據量極少的一個學校的數據，對結果也沒有太大的影響。</p>
</div>
<div id="level-2-school-level" class="section level3">
<h3><span class="header-section-number">61.7.11</span> 計算這個模型的第二階級(level 2, <code>school</code> level)的殘差。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">School_res &lt;-<span class="st"> </span>HLMdiag<span class="op">::</span><span class="kw">HLMresid</span>(Fixed_reml2, <span class="dt">level =</span> <span class="st">&quot;school&quot;</span>)
<span class="kw">summ</span>(School_res)</code></pre></div>
<pre><code>## 
## No. of observations = 65
## 
##   Var. name   obs. mean   median  s.d.   min.   max.  
## 1 (Intercept) 65   0      0.11    2.65   -6.25  5.83  
## 2 lrt         65   0      0       0.1    -0.19  0.33</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">School_res[<span class="dv">48</span>, ] </code></pre></div>
<pre><code>##    (Intercept)          lrt
## 48 -0.73853833 -0.014707986</code></pre>
<p>隨機截距的殘差估計範圍在 -6.25 和 5.83 之間，隨機斜率殘差估計範圍在 -0.19 和 0.33 之間。其中 48 號學校的擬合後截距和斜率分別是 -0.74 和 -0.02。48 號學校在這個模型中估計的截距和斜率，與我們單獨對它一所學校擬合模型時的結果大相徑庭。這是因爲在總體的混合效應模型中，該學校的數據被拉近與總體的平均水平。</p>
<div class="figure" style="text-align: center"><span id="fig:4-level2-residuals"></span>
<img src="bookdown_files/figure-html/4-level2-residuals-1.png" alt="Q-Q plots of school level intercept and slope (unstandardized) residuals" width="80%" />
<p class="caption">
圖 61.7: Q-Q plots of school level intercept and slope (unstandardized) residuals
</p>
</div>
<p>圖 <a href="-random-coefficient-model.html#fig:4-level2-residuals">61.7</a> 顯示標準化前的隨機效應部分的殘差表現尚可接受。</p>
</div>
<div id="level-1-student48" class="section level3">
<h3><span class="header-section-number">61.7.12</span> 計算這個模型的第一階級(level 1, student)殘差，分析其分布，查看第48所學校的殘差表現如何。</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Fixed_reml2 &lt;-<span class="st"> </span><span class="kw">lme</span>(<span class="dt">fixed =</span> gcse <span class="op">~</span><span class="st"> </span>lrt <span class="op">+</span><span class="st"> </span>schgend, <span class="dt">random =</span> <span class="op">~</span><span class="st">  </span>lrt <span class="op">|</span><span class="st"> </span>school, <span class="dt">data =</span> gcse_selected, <span class="dt">method=</span><span class="st">&quot;REML&quot;</span>) <span class="co"># for extracting standardized level 2 error</span>

gcse_selected<span class="op">$</span>ehat &lt;-<span class="st"> </span><span class="kw">residuals</span>(Fixed_reml2, <span class="dt">level =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;normalized&quot;</span>)
<span class="kw">with</span>(gcse_selected, <span class="kw">summ</span>(ehat, <span class="dt">graph =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  4059 0      0.033   0.989  -3.831 3.419</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  48 號學校的標準化殘差並不顯得異常</span>
gcse_selected<span class="op">$</span>ehat[gcse_selected<span class="op">$</span>school <span class="op">==</span><span class="st"> </span><span class="dv">48</span>]</code></pre></div>
<pre><code>## [1] -0.780061331  0.046827706</code></pre>
<div class="figure" style="text-align: center"><span id="fig:4-level1-residuals"></span>
<img src="bookdown_files/figure-html/4-level1-residuals-1.png" alt="Histogram and Q-Q plots of elementary level (pupil) standardized residuals" width="80%" />
<p class="caption">
圖 61.8: Histogram and Q-Q plots of elementary level (pupil) standardized residuals
</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="-random-intercept-model-with-covariates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="-longitudinal-data-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/winterwang/LSHTMlearningnote/edit/master/10-Hierarchical-models.Rmd",
"text": "編輯"
},
"download": ["bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
