<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>第 94 章 Prospensity Score 傾向性評分 | 醫學統計學</title>
  <meta name="description" content="在LSHTM的學習筆記">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="第 94 章 Prospensity Score 傾向性評分 | 醫學統計學" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="img/cover.jpg" />
  <meta property="og:description" content="在LSHTM的學習筆記" />
  <meta name="github-repo" content="winterwang/LSHTMlearningnote" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 94 章 Prospensity Score 傾向性評分 | 醫學統計學" />
  
  <meta name="twitter:description" content="在LSHTM的學習筆記" />
  <meta name="twitter:image" content="img/cover.jpg" />

<meta name="author" content="王 超辰 Chaochen Wang">


<meta name="date" content="2019-02-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="regression-methods-with-binary-outcomes-.html">
<link rel="next" href="inverse-probability-weighted-estimation-and-doubly-robust-methods.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">在LSHTM的學習筆記</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>我是誰</a></li>
<li class="part"><span><b>I 概率論 Probability</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> 概率論入門：定義與公理</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#section-1"><i class="fa fa-check"></i><b>1.1</b> 三個概率公理：</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#conditonalProb"><i class="fa fa-check"></i><b>1.2</b> 條件概率 Conditional probability</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#independence-"><i class="fa fa-check"></i><b>1.3</b> 獨立 (independence) 的定義</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#section-2"><i class="fa fa-check"></i><b>1.4</b> 賭博問題</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#section-3"><i class="fa fa-check"></i><b>1.5</b> 賭博問題的答案</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Bayes-Definition.html"><a href="Bayes-Definition.html"><i class="fa fa-check"></i><b>2</b> Bayes 貝葉斯理論的概念</a></li>
<li class="chapter" data-level="3" data-path="expectation-or-mean-variance.html"><a href="expectation-or-mean-variance.html"><i class="fa fa-check"></i><b>3</b> 期望 Expectation (或均值 or mean) 和 方差 Variance</a><ul>
<li class="chapter" data-level="3.1" data-path="expectation-or-mean-variance.html"><a href="expectation-or-mean-variance.html#section-4"><i class="fa fa-check"></i><b>3.1</b> 方差的性質：</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bernoulli.html"><a href="bernoulli.html"><i class="fa fa-check"></i><b>4</b> 伯努利分佈 Bernoulli distribution</a></li>
<li class="chapter" data-level="5" data-path="binomial.html"><a href="binomial.html"><i class="fa fa-check"></i><b>5</b> 二項分佈的概念 Binomial distribution</a><ul>
<li class="chapter" data-level="5.1" data-path="binomial.html"><a href="binomial.html#section-5"><i class="fa fa-check"></i><b>5.1</b> 二項分佈的期望和方差</a></li>
<li class="chapter" data-level="5.2" data-path="binomial.html"><a href="binomial.html#hyperdist"><i class="fa fa-check"></i><b>5.2</b> 超幾何分佈 hypergeometric distribution</a></li>
<li class="chapter" data-level="5.3" data-path="binomial.html"><a href="binomial.html#section-6"><i class="fa fa-check"></i><b>5.3</b> 樂透中獎概率問題：</a><ul>
<li class="chapter" data-level="5.3.1" data-path="binomial.html"><a href="binomial.html#section-7"><i class="fa fa-check"></i><b>5.3.1</b> 如果我只想中其中的 <span class="math inline">\(3\)</span> 個號碼，概率有多大？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>6</b> 泊松分佈 Poisson Distribution</a></li>
<li class="chapter" data-level="7" data-path="section-8.html"><a href="section-8.html"><i class="fa fa-check"></i><b>7</b> 正態分佈</a><ul>
<li class="chapter" data-level="7.1" data-path="section-8.html"><a href="section-8.html#probability-density-function-pdf"><i class="fa fa-check"></i><b>7.1</b> 概率密度曲線 probability density function， PDF</a></li>
<li class="chapter" data-level="7.2" data-path="section-8.html"><a href="section-8.html#section-9"><i class="fa fa-check"></i><b>7.2</b> 正態分佈</a></li>
<li class="chapter" data-level="7.3" data-path="section-8.html"><a href="section-8.html#standardNormal"><i class="fa fa-check"></i><b>7.3</b> 標準正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="CLT.html"><a href="CLT.html"><i class="fa fa-check"></i><b>8</b> 中心極限定理 the Central Limit Theorem</a><ul>
<li class="chapter" data-level="8.1" data-path="CLT.html"><a href="CLT.html#covariance"><i class="fa fa-check"></i><b>8.1</b> 協方差 Covariance</a></li>
<li class="chapter" data-level="8.2" data-path="CLT.html"><a href="CLT.html#correlation"><i class="fa fa-check"></i><b>8.2</b> 相關 Correlation</a></li>
<li class="chapter" data-level="8.3" data-path="CLT.html"><a href="CLT.html#the-central-limit-theorem"><i class="fa fa-check"></i><b>8.3</b> 中心極限定理 the Central Limit Theorem</a></li>
<li class="chapter" data-level="8.4" data-path="CLT.html"><a href="CLT.html#binomial-normal-approx"><i class="fa fa-check"></i><b>8.4</b> 二項分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.5" data-path="CLT.html"><a href="CLT.html#section-10"><i class="fa fa-check"></i><b>8.5</b> 泊松分佈的正態分佈近似</a></li>
<li class="chapter" data-level="8.6" data-path="CLT.html"><a href="CLT.html#continuity-correction"><i class="fa fa-check"></i><b>8.6</b> 正態分佈模擬的校正：continuity corrections</a><ul>
<li class="chapter" data-level="8.6.1" data-path="CLT.html"><a href="CLT.html#section-11"><i class="fa fa-check"></i><b>8.6.1</b> 例題</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="CLT.html"><a href="CLT.html#section-12"><i class="fa fa-check"></i><b>8.7</b> 兩個連續隨機變量</a></li>
<li class="chapter" data-level="8.8" data-path="CLT.html"><a href="CLT.html#section-13"><i class="fa fa-check"></i><b>8.8</b> 兩個連續隨機變量 例子：</a></li>
<li class="chapter" data-level="8.9" data-path="CLT.html"><a href="CLT.html#section-14"><i class="fa fa-check"></i><b>8.9</b> 條件分佈和邊緣分佈的概念</a></li>
<li class="chapter" data-level="8.10" data-path="CLT.html"><a href="CLT.html#section-15"><i class="fa fa-check"></i><b>8.10</b> 條件分佈和邊緣分佈的例子</a><ul>
<li class="chapter" data-level="8.10.1" data-path="CLT.html"><a href="CLT.html#section-16"><i class="fa fa-check"></i><b>8.10.1</b> 例題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II 統計推斷 Inference</b></span></li>
<li class="chapter" data-level="9" data-path="section-17.html"><a href="section-17.html"><i class="fa fa-check"></i><b>9</b> 統計推斷的概念</a><ul>
<li class="chapter" data-level="9.1" data-path="section-17.html"><a href="section-17.html#population-and-sample"><i class="fa fa-check"></i><b>9.1</b> 人羣與樣本 (population and sample)</a></li>
<li class="chapter" data-level="9.2" data-path="section-17.html"><a href="section-17.html#sample-and-statistic"><i class="fa fa-check"></i><b>9.2</b> 樣本和統計量 (sample and statistic)</a></li>
<li class="chapter" data-level="9.3" data-path="section-17.html"><a href="section-17.html#estimation"><i class="fa fa-check"></i><b>9.3</b> 估計 Estimation</a></li>
<li class="chapter" data-level="9.4" data-path="section-17.html"><a href="section-17.html#confidence-intervals"><i class="fa fa-check"></i><b>9.4</b> 信賴區間 confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html"><i class="fa fa-check"></i><b>10</b> 估計和精確度 Estimation and Precision</a><ul>
<li class="chapter" data-level="10.1" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#CI-for-sample-mean"><i class="fa fa-check"></i><b>10.1</b> 估計量和他們的樣本分佈</a></li>
<li class="chapter" data-level="10.2" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#section-18"><i class="fa fa-check"></i><b>10.2</b> 估計量的特質</a><ul>
<li class="chapter" data-level="10.2.1" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#bias"><i class="fa fa-check"></i><b>10.2.1</b> 偏倚</a></li>
<li class="chapter" data-level="10.2.2" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#efficiency"><i class="fa fa-check"></i><b>10.2.2</b> 估計量的效能 Efficiency</a></li>
<li class="chapter" data-level="10.2.3" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#section-19"><i class="fa fa-check"></i><b>10.2.3</b> 均值和中位數的相對效能</a></li>
<li class="chapter" data-level="10.2.4" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#mean-square-error-mse"><i class="fa fa-check"></i><b>10.2.4</b> 均方差 mean square error (MSE)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#samplevarbias"><i class="fa fa-check"></i><b>10.3</b> 總體方差的估計，自由度</a></li>
<li class="chapter" data-level="10.4" data-path="estimation-and-precision.html"><a href="estimation-and-precision.html#samplevar"><i class="fa fa-check"></i><b>10.4</b> 樣本方差的樣本分佈</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html"><i class="fa fa-check"></i><b>11</b> 卡方分佈 Chi-square distribution</a><ul>
<li class="chapter" data-level="11.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-20"><i class="fa fa-check"></i><b>11.1</b> 卡方分佈的期望和方差的證明</a></li>
<li class="chapter" data-level="11.2" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-21"><i class="fa fa-check"></i><b>11.2</b> 卡方分佈的期望</a></li>
<li class="chapter" data-level="11.3" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-22"><i class="fa fa-check"></i><b>11.3</b> 卡方分佈的方差</a><ul>
<li class="chapter" data-level="11.3.1" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#ex_14"><i class="fa fa-check"></i><b>11.3.1</b> 下面來求 <span class="math inline">\(E(X_1^4)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chi-square-distribution.html"><a href="chi-square-distribution.html#section-23"><i class="fa fa-check"></i><b>11.4</b> 把上面的推導擴展</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="likelihood-definition.html"><a href="likelihood-definition.html"><i class="fa fa-check"></i><b>12</b> 似然 Likelihood</a><ul>
<li class="chapter" data-level="12.1" data-path="likelihood-definition.html"><a href="likelihood-definition.html#vs.--probability-vs.-inference"><i class="fa fa-check"></i><b>12.1</b> 概率 vs. 推斷 Probability vs. Inference</a></li>
<li class="chapter" data-level="12.2" data-path="likelihood-definition.html"><a href="likelihood-definition.html#likelihood-and-maximum-likelihood-estimators"><i class="fa fa-check"></i><b>12.2</b> 似然和極大似然估計 Likelihood and maximum likelihood estimators</a></li>
<li class="chapter" data-level="12.3" data-path="likelihood-definition.html"><a href="likelihood-definition.html#section-24"><i class="fa fa-check"></i><b>12.3</b> 似然方程的一般化定義</a></li>
<li class="chapter" data-level="12.4" data-path="likelihood-definition.html"><a href="likelihood-definition.html#log-likelihood"><i class="fa fa-check"></i><b>12.4</b> 對數似然方程 log-likelihood</a></li>
<li class="chapter" data-level="12.5" data-path="likelihood-definition.html"><a href="likelihood-definition.html#maximum-likelihood-estimator-mle-"><i class="fa fa-check"></i><b>12.5</b> 極大似然估計 (maximum likelihood estimator, MLE) 的性質：</a></li>
<li class="chapter" data-level="12.6" data-path="likelihood-definition.html"><a href="likelihood-definition.html#likelihood-poi"><i class="fa fa-check"></i><b>12.6</b> 率的似然估計 Likelihood for a rate</a></li>
<li class="chapter" data-level="12.7" data-path="likelihood-definition.html"><a href="likelihood-definition.html#n-"><i class="fa fa-check"></i><b>12.7</b> 有 <span class="math inline">\(n\)</span> 個獨立觀察時的似然方程和對數似然方程</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="llr.html"><a href="llr.html"><i class="fa fa-check"></i><b>13</b> 對數似然比 Log-likelihood ratio</a><ul>
<li class="chapter" data-level="13.1" data-path="llr.html"><a href="llr.html#section-25"><i class="fa fa-check"></i><b>13.1</b> 正態分佈數據的極大似然和對數似然比</a></li>
<li class="chapter" data-level="13.2" data-path="llr.html"><a href="llr.html#llr-chi1"><i class="fa fa-check"></i><b>13.2</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比</a></li>
<li class="chapter" data-level="13.3" data-path="llr.html"><a href="llr.html#llr-chi"><i class="fa fa-check"></i><b>13.3</b> <span class="math inline">\(n\)</span> 個獨立正態分佈樣本的對數似然比的分佈</a></li>
<li class="chapter" data-level="13.4" data-path="llr.html"><a href="llr.html#section-26"><i class="fa fa-check"></i><b>13.4</b> 似然比信賴區間</a><ul>
<li class="chapter" data-level="13.4.1" data-path="llr.html"><a href="llr.html#binomial-ex"><i class="fa fa-check"></i><b>13.4.1</b> 以二項分佈數據爲例</a></li>
<li class="chapter" data-level="13.4.2" data-path="llr.html"><a href="llr.html#normal-ex"><i class="fa fa-check"></i><b>13.4.2</b> 以正態分佈數據爲例</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="llr.html"><a href="llr.html#section-27"><i class="fa fa-check"></i><b>13.5</b> 練習題</a><ul>
<li class="chapter" data-level="13.5.1" data-path="llr.html"><a href="llr.html#q1"><i class="fa fa-check"></i><b>13.5.1</b> Q1</a></li>
<li class="chapter" data-level="13.5.2" data-path="llr.html"><a href="llr.html#q2"><i class="fa fa-check"></i><b>13.5.2</b> Q2</a></li>
<li class="chapter" data-level="13.5.3" data-path="llr.html"><a href="llr.html#q3"><i class="fa fa-check"></i><b>13.5.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="quadratic-llr.html"><a href="quadratic-llr.html"><i class="fa fa-check"></i><b>14</b> 二次方程近似法求對數似然比 approximate log-likelihood ratios</a><ul>
<li class="chapter" data-level="14.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#quadratic-llr2"><i class="fa fa-check"></i><b>14.1</b> 正態近似法求對數似然 Normal approximation to the log-likelihood</a><ul>
<li class="chapter" data-level="14.1.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-28"><i class="fa fa-check"></i><b>14.1.1</b> 近似法估算對數似然比的信賴區間</a></li>
<li class="chapter" data-level="14.1.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-29"><i class="fa fa-check"></i><b>14.1.2</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.1.3" data-path="quadratic-llr.html"><a href="quadratic-llr.html#quadratic-binomial-approx"><i class="fa fa-check"></i><b>14.1.3</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#para-trans"><i class="fa fa-check"></i><b>14.2</b> 參數转换 parameter transformations</a><ul>
<li class="chapter" data-level="14.2.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#Possion-log-transform"><i class="fa fa-check"></i><b>14.2.1</b> 以泊松分佈爲例</a></li>
<li class="chapter" data-level="14.2.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-30"><i class="fa fa-check"></i><b>14.2.2</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="quadratic-llr.html"><a href="quadratic-llr.html#section-31"><i class="fa fa-check"></i><b>14.3</b> 練習題</a><ul>
<li class="chapter" data-level="14.3.1" data-path="quadratic-llr.html"><a href="quadratic-llr.html#q1-1"><i class="fa fa-check"></i><b>14.3.1</b> Q1</a></li>
<li class="chapter" data-level="14.3.2" data-path="quadratic-llr.html"><a href="quadratic-llr.html#q2-1"><i class="fa fa-check"></i><b>14.3.2</b> Q2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html"><i class="fa fa-check"></i><b>15</b> 假設檢驗的構建 Construction of a hypothesis test</a><ul>
<li class="chapter" data-level="15.1" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#null-and-alter"><i class="fa fa-check"></i><b>15.1</b> 什麼是假設檢驗 Hypothesis testing</a></li>
<li class="chapter" data-level="15.2" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#error-probabilities-and-the-power-function"><i class="fa fa-check"></i><b>15.2</b> 錯誤概率和效能方程 error probabilities and the power function</a><ul>
<li class="chapter" data-level="15.2.1" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#section-32"><i class="fa fa-check"></i><b>15.2.1</b> 以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#Neyman-Pearson"><i class="fa fa-check"></i><b>15.3</b> 如何選擇要檢驗的統計量</a><ul>
<li class="chapter" data-level="15.3.1" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#section-33"><i class="fa fa-check"></i><b>15.3.1</b> 以已知方差的正態分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#composite-hypotheses"><i class="fa fa-check"></i><b>15.4</b> 複合假設 composite hypotheses</a><ul>
<li class="chapter" data-level="15.4.1" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#section-34"><i class="fa fa-check"></i><b>15.4.1</b> 單側替代假設</a></li>
<li class="chapter" data-level="15.4.2" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#section-35"><i class="fa fa-check"></i><b>15.4.2</b> 雙側替代假設</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#h_0-"><i class="fa fa-check"></i><b>15.5</b> 爲反對零假設 <span class="math inline">\(H_0\)</span> 的證據定量</a><ul>
<li class="chapter" data-level="15.5.1" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#normal-mean-compare"><i class="fa fa-check"></i><b>15.5.1</b> 回到正態分佈的均值比較問題上來(單側替代假設)</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#p-"><i class="fa fa-check"></i><b>15.6</b> 雙側替代假設情況下，雙側 <span class="math inline">\(p\)</span> 值的定量方法</a></li>
<li class="chapter" data-level="15.7" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#test-summary"><i class="fa fa-check"></i><b>15.7</b> 假設檢驗構建之總結</a></li>
<li class="chapter" data-level="15.8" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#section-36"><i class="fa fa-check"></i><b>15.8</b> 練習題</a><ul>
<li class="chapter" data-level="15.8.1" data-path="construction-of-a-hypothesis-test.html"><a href="construction-of-a-hypothesis-test.html#q1-2"><i class="fa fa-check"></i><b>15.8.1</b> Q1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="section-37.html"><a href="section-37.html"><i class="fa fa-check"></i><b>16</b> 假設檢驗的近似方法</a><ul>
<li class="chapter" data-level="16.1" data-path="section-37.html"><a href="section-37.html#approximate-and-exact-tests"><i class="fa fa-check"></i><b>16.1</b> 近似和精確檢驗 approximate and exact tests</a></li>
<li class="chapter" data-level="16.2" data-path="section-37.html"><a href="section-37.html#LRT"><i class="fa fa-check"></i><b>16.2</b> 精確檢驗法之 – 似然比檢驗法 Likelihood ratio test</a></li>
<li class="chapter" data-level="16.3" data-path="section-37.html"><a href="section-37.html#section-38"><i class="fa fa-check"></i><b>16.3</b> 練習題</a></li>
<li class="chapter" data-level="16.4" data-path="section-37.html"><a href="section-37.html#Wald"><i class="fa fa-check"></i><b>16.4</b> 近似檢驗法之 – Wald 檢驗</a><ul>
<li class="chapter" data-level="16.4.1" data-path="section-37.html"><a href="section-37.html#section-39"><i class="fa fa-check"></i><b>16.4.1</b> 再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="section-37.html"><a href="section-37.html#Score"><i class="fa fa-check"></i><b>16.5</b> 近似檢驗法之 – Score 检验</a><ul>
<li class="chapter" data-level="16.5.1" data-path="section-37.html"><a href="section-37.html#section-40"><i class="fa fa-check"></i><b>16.5.1</b> 再再以二項分佈爲例</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="section-37.html"><a href="section-37.html#LRTwaldScore-Compare"><i class="fa fa-check"></i><b>16.6</b> LRT, Wald, Score 檢驗三者的比較</a></li>
<li class="chapter" data-level="16.7" data-path="section-37.html"><a href="section-37.html#section-41"><i class="fa fa-check"></i><b>16.7</b> 練習題</a><ul>
<li class="chapter" data-level="16.7.1" data-path="section-37.html"><a href="section-37.html#q1-3"><i class="fa fa-check"></i><b>16.7.1</b> Q1</a></li>
<li class="chapter" data-level="16.7.2" data-path="section-37.html"><a href="section-37.html#q2-2"><i class="fa fa-check"></i><b>16.7.2</b> Q2</a></li>
<li class="chapter" data-level="16.7.3" data-path="section-37.html"><a href="section-37.html#q3-1"><i class="fa fa-check"></i><b>16.7.3</b> Q3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="normal-error-models.html"><a href="normal-error-models.html"><i class="fa fa-check"></i><b>17</b> 正態誤差模型 Normal error models</a><ul>
<li class="chapter" data-level="17.1" data-path="normal-error-models.html"><a href="normal-error-models.html#section-42"><i class="fa fa-check"></i><b>17.1</b> 服從正態分佈的隨機變量</a></li>
<li class="chapter" data-level="17.2" data-path="normal-error-models.html"><a href="normal-error-models.html#Fandtdistr"><i class="fa fa-check"></i><b>17.2</b> <span class="math inline">\(F\)</span> 分佈和 <span class="math inline">\(t\)</span> 分佈的概念</a></li>
<li class="chapter" data-level="17.3" data-path="normal-error-models.html"><a href="normal-error-models.html#section-43"><i class="fa fa-check"></i><b>17.3</b> 兩個參數的模型</a><ul>
<li class="chapter" data-level="17.3.1" data-path="normal-error-models.html"><a href="normal-error-models.html#section-44"><i class="fa fa-check"></i><b>17.3.1</b> 一組數據兩個參數</a></li>
<li class="chapter" data-level="17.3.2" data-path="normal-error-models.html"><a href="normal-error-models.html#section-45"><i class="fa fa-check"></i><b>17.3.2</b> 兩組數據各一個參數</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="normal-error-models.html"><a href="normal-error-models.html#t--one-sample-t-test-"><i class="fa fa-check"></i><b>17.4</b> 正態分佈概率密度方程中總體均值和方差都未知 (單樣本 <span class="math inline">\(t\)</span> 檢驗 one sample <span class="math inline">\(t\)</span> test 的統計學推導)</a></li>
<li class="chapter" data-level="17.5" data-path="normal-error-models.html"><a href="normal-error-models.html#two-sample-t-test-with-equal-unknown-sigma2"><i class="fa fa-check"></i><b>17.5</b> 比較兩組獨立數據的均值 two sample <span class="math inline">\(t\)</span> test with equal unknown <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="17.6" data-path="normal-error-models.html"><a href="normal-error-models.html#section-46"><i class="fa fa-check"></i><b>17.6</b> 各個統計分佈之間的關係</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html"><i class="fa fa-check"></i><b>18</b> 多個參數時的統計推斷 Inference with multiple parameters I</a><ul>
<li class="chapter" data-level="18.1" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#multiple-parameters---lrt"><i class="fa fa-check"></i><b>18.1</b> 多參數 multiple parameters - LRT</a><ul>
<li class="chapter" data-level="18.1.1" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#likelihood"><i class="fa fa-check"></i><b>18.1.1</b> 似然 likelihood</a></li>
<li class="chapter" data-level="18.1.2" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#section-47"><i class="fa fa-check"></i><b>18.1.2</b> 對數似然比檢驗</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#wald----wald-test"><i class="fa fa-check"></i><b>18.2</b> 多參數 Wald 檢驗 - Wald test</a></li>
<li class="chapter" data-level="18.3" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#score----score-test"><i class="fa fa-check"></i><b>18.3</b> 多參數 Score 檢驗 - Score test</a></li>
<li class="chapter" data-level="18.4" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#condilikeli"><i class="fa fa-check"></i><b>18.4</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="18.5" data-path="inference-with-multiple-parameters-i.html"><a href="inference-with-multiple-parameters-i.html#section-48"><i class="fa fa-check"></i><b>18.5</b> 練習</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html"><i class="fa fa-check"></i><b>19</b> 多個參數時的統計推斷 – 子集似然函數 profile log-likelihoods</a><ul>
<li class="chapter" data-level="19.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-49"><i class="fa fa-check"></i><b>19.1</b> 子集似然法推導的過程總結</a><ul>
<li class="chapter" data-level="19.1.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-50"><i class="fa fa-check"></i><b>19.1.1</b> 子集對數似然方程的分佈</a></li>
<li class="chapter" data-level="19.1.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-51"><i class="fa fa-check"></i><b>19.1.2</b> 假設檢驗過程舉例</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-52"><i class="fa fa-check"></i><b>19.2</b> 子集對數似然比的近似</a><ul>
<li class="chapter" data-level="19.2.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-53"><i class="fa fa-check"></i><b>19.2.1</b> 子集對數似然比近似的一般化</a></li>
<li class="chapter" data-level="19.2.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#wald-"><i class="fa fa-check"></i><b>19.2.2</b> 事件發生率之比的 Wald 檢驗統計量</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#practical"><i class="fa fa-check"></i><b>19.3</b> 練習 Practical</a></li>
<li class="chapter" data-level="19.4" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-54"><i class="fa fa-check"></i><b>19.4</b> 總結</a><ul>
<li class="chapter" data-level="19.4.1" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-55"><i class="fa fa-check"></i><b>19.4.1</b> 快速複習</a></li>
<li class="chapter" data-level="19.4.2" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-56"><i class="fa fa-check"></i><b>19.4.2</b> 試爲下面的醫學研究問題提出合適的統計學模型</a></li>
<li class="chapter" data-level="19.4.3" data-path="profile-log-likelihood.html"><a href="profile-log-likelihood.html#section-57"><i class="fa fa-check"></i><b>19.4.3</b> 醫生來找統計學家問問題</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III 統計分析方法 Analytical Techniques</b></span></li>
<li class="chapter" data-level="20" data-path="section-58.html"><a href="section-58.html"><i class="fa fa-check"></i><b>20</b> 探索數據和簡單描述</a><ul>
<li class="chapter" data-level="20.1" data-path="section-58.html"><a href="section-58.html#section-59"><i class="fa fa-check"></i><b>20.1</b> 數據分析的流程</a><ul>
<li class="chapter" data-level="20.1.1" data-path="section-58.html"><a href="section-58.html#section-60"><i class="fa fa-check"></i><b>20.1.1</b> 研究設計和實施</a></li>
<li class="chapter" data-level="20.1.2" data-path="section-58.html"><a href="section-58.html#section-61"><i class="fa fa-check"></i><b>20.1.2</b> 數據分析</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="section-58.html"><a href="section-58.html#section-62"><i class="fa fa-check"></i><b>20.2</b> 數據類型</a></li>
<li class="chapter" data-level="20.3" data-path="section-58.html"><a href="section-58.html#section-63"><i class="fa fa-check"></i><b>20.3</b> 如何總結並展示數據</a><ul>
<li class="chapter" data-level="20.3.1" data-path="section-58.html"><a href="section-58.html#frequency-table"><i class="fa fa-check"></i><b>20.3.1</b> 離散型分類型數據的描述 - 頻數分佈表 frequency table</a></li>
<li class="chapter" data-level="20.3.2" data-path="section-58.html"><a href="section-58.html#section-64"><i class="fa fa-check"></i><b>20.3.2</b> 連續型變量</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="section-58.html"><a href="section-58.html#section-65"><i class="fa fa-check"></i><b>20.4</b> 數據總結方案：位置，分散，偏度，和峰度</a><ul>
<li class="chapter" data-level="20.4.1" data-path="section-58.html"><a href="section-58.html#section-66"><i class="fa fa-check"></i><b>20.4.1</b> 位置</a></li>
<li class="chapter" data-level="20.4.2" data-path="section-58.html"><a href="section-58.html#section-67"><i class="fa fa-check"></i><b>20.4.2</b> 分散</a></li>
<li class="chapter" data-level="20.4.3" data-path="section-58.html"><a href="section-58.html#skewness"><i class="fa fa-check"></i><b>20.4.3</b> 偏度 skewness</a></li>
<li class="chapter" data-level="20.4.4" data-path="section-58.html"><a href="section-58.html#kurtosis"><i class="fa fa-check"></i><b>20.4.4</b> 峯度 kurtosis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html"><i class="fa fa-check"></i><b>21</b> 信賴區間 confidence intervals</a><ul>
<li class="chapter" data-level="21.1" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-68"><i class="fa fa-check"></i><b>21.1</b> 定義</a></li>
<li class="chapter" data-level="21.2" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-69"><i class="fa fa-check"></i><b>21.2</b> 利用總體參數的樣本分佈求信賴區間</a></li>
<li class="chapter" data-level="21.3" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-70"><i class="fa fa-check"></i><b>21.3</b> 情況1：已知方差的正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="21.4" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#CImean"><i class="fa fa-check"></i><b>21.4</b> 信賴區間的意義</a></li>
<li class="chapter" data-level="21.5" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#AT2-5"><i class="fa fa-check"></i><b>21.5</b> 情況2：未知方差，但是已知服從正態分佈數據均值的信賴區間</a></li>
<li class="chapter" data-level="21.6" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#varCI"><i class="fa fa-check"></i><b>21.6</b> 情況3：服從正態分佈的隨機變量方差的信賴區間</a></li>
<li class="chapter" data-level="21.7" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-71"><i class="fa fa-check"></i><b>21.7</b> 當樣本量足夠大時</a></li>
<li class="chapter" data-level="21.8" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-72"><i class="fa fa-check"></i><b>21.8</b> 情況4：求人羣百分比的信賴區間</a><ul>
<li class="chapter" data-level="21.8.1" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-73"><i class="fa fa-check"></i><b>21.8.1</b> 一般原則</a></li>
<li class="chapter" data-level="21.8.2" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#exactprop"><i class="fa fa-check"></i><b>21.8.2</b> 二項分佈的“精確法”計算信賴區間</a></li>
<li class="chapter" data-level="21.8.3" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-74"><i class="fa fa-check"></i><b>21.8.3</b> 二項分佈的近似法計算信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#CIrate"><i class="fa fa-check"></i><b>21.9</b> 率的信賴區間</a><ul>
<li class="chapter" data-level="21.9.1" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-75"><i class="fa fa-check"></i><b>21.9.1</b> 利用泊松分佈精確計算</a></li>
<li class="chapter" data-level="21.9.2" data-path="confidence-intervals-1.html"><a href="confidence-intervals-1.html#section-76"><i class="fa fa-check"></i><b>21.9.2</b> 利用正態近似法計算</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="section-77.html"><a href="section-77.html"><i class="fa fa-check"></i><b>22</b> 假設檢驗</a><ul>
<li class="chapter" data-level="22.1" data-path="section-77.html"><a href="section-77.html#section-78"><i class="fa fa-check"></i><b>22.1</b> 拋硬幣的例子</a><ul>
<li class="chapter" data-level="22.1.1" data-path="section-77.html"><a href="section-77.html#section-79"><i class="fa fa-check"></i><b>22.1.1</b> 單側和雙側檢驗</a></li>
<li class="chapter" data-level="22.1.2" data-path="section-77.html"><a href="section-77.html#p--1"><i class="fa fa-check"></i><b>22.1.2</b> <span class="math inline">\(p\)</span> 值的意義</a></li>
<li class="chapter" data-level="22.1.3" data-path="section-77.html"><a href="section-77.html#p--2"><i class="fa fa-check"></i><b>22.1.3</b> <span class="math inline">\(p\)</span> 值和信賴區間的關係</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="section-77.html"><a href="section-77.html#section-80"><i class="fa fa-check"></i><b>22.2</b> 二項分佈的精確假設檢驗</a></li>
<li class="chapter" data-level="22.3" data-path="section-77.html"><a href="section-77.html#section-81"><i class="fa fa-check"></i><b>22.3</b> 當樣本量較大</a></li>
<li class="chapter" data-level="22.4" data-path="section-77.html"><a href="section-77.html#section-82"><i class="fa fa-check"></i><b>22.4</b> 二項分佈的正態近似法假設檢驗</a><ul>
<li class="chapter" data-level="22.4.1" data-path="section-77.html"><a href="section-77.html#continuity-correction-1"><i class="fa fa-check"></i><b>22.4.1</b> 連續性校正 continuity correction</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="section-77.html"><a href="section-77.html#AT3-5"><i class="fa fa-check"></i><b>22.5</b> 情況1：對均值進行假設檢驗 (方差已知)</a></li>
<li class="chapter" data-level="22.6" data-path="section-77.html"><a href="section-77.html#OneSampleT"><i class="fa fa-check"></i><b>22.6</b> 情況2：對均值進行假設檢驗 (方差未知) the one-sample t-test</a></li>
<li class="chapter" data-level="22.7" data-path="section-77.html"><a href="section-77.html#the-paired-t-test"><i class="fa fa-check"></i><b>22.7</b> 情況3：對配對實驗數據的均值差進行假設檢驗 the paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="association.html"><a href="association.html"><i class="fa fa-check"></i><b>23</b> 相關 association</a><ul>
<li class="chapter" data-level="23.1" data-path="association.html"><a href="association.html#section-83"><i class="fa fa-check"></i><b>23.1</b> 背景介紹</a></li>
<li class="chapter" data-level="23.2" data-path="association.html"><a href="association.html#section-84"><i class="fa fa-check"></i><b>23.2</b> 兩個連續型變量的相關分析</a><ul>
<li class="chapter" data-level="23.2.1" data-path="association.html"><a href="association.html#section-85"><i class="fa fa-check"></i><b>23.2.1</b> 相關係數的定義</a></li>
<li class="chapter" data-level="23.2.2" data-path="association.html"><a href="association.html#section-86"><i class="fa fa-check"></i><b>23.2.2</b> 相關係數的性質</a></li>
<li class="chapter" data-level="23.2.3" data-path="association.html"><a href="association.html#section-87"><i class="fa fa-check"></i><b>23.2.3</b> 對相關係數是否爲零進行假設檢驗</a></li>
<li class="chapter" data-level="23.2.4" data-path="association.html"><a href="association.html#section-88"><i class="fa fa-check"></i><b>23.2.4</b> 相關係數的 <span class="math inline">\(95\%\)</span> 信賴區間</a></li>
<li class="chapter" data-level="23.2.5" data-path="association.html"><a href="association.html#section-89"><i class="fa fa-check"></i><b>23.2.5</b> 比較兩個相關係數是否相等</a></li>
<li class="chapter" data-level="23.2.6" data-path="association.html"><a href="association.html#section-90"><i class="fa fa-check"></i><b>23.2.6</b> 相關係數那些事兒</a></li>
<li class="chapter" data-level="23.2.7" data-path="association.html"><a href="association.html#r-"><i class="fa fa-check"></i><b>23.2.7</b> 在 R 裏面計算相關係數</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="association.html"><a href="association.html#association-between-pairs-of-binary-variables"><i class="fa fa-check"></i><b>23.3</b> 二元變量之間的相關性 association between pairs of binary variables</a><ul>
<li class="chapter" data-level="23.3.1" data-path="association.html"><a href="association.html#or-"><i class="fa fa-check"></i><b>23.3.1</b> OR 的信賴區間</a></li>
<li class="chapter" data-level="23.3.2" data-path="association.html"><a href="association.html#section-91"><i class="fa fa-check"></i><b>23.3.2</b> 比值比的假設檢驗</a></li>
<li class="chapter" data-level="23.3.3" data-path="association.html"><a href="association.html#chisquaretest"><i class="fa fa-check"></i><b>23.3.3</b> 兩個百分比的卡方檢驗</a></li>
<li class="chapter" data-level="23.3.4" data-path="association.html"><a href="association.html#fishers-exact-test"><i class="fa fa-check"></i><b>23.3.4</b> 確切檢驗法 Fisher’s “exact” test</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="association.html"><a href="association.html#mtimes-n-"><i class="fa fa-check"></i><b>23.4</b> 多分類 (無排序) 的情況 <span class="math inline">\(M\times N\)</span> 表格</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="comparisons.html"><a href="comparisons.html"><i class="fa fa-check"></i><b>24</b> 比較 Comparisons</a><ul>
<li class="chapter" data-level="24.1" data-path="comparisons.html"><a href="comparisons.html#comparing-two-population-means"><i class="fa fa-check"></i><b>24.1</b> 比較兩個均值 comparing two population means</a><ul>
<li class="chapter" data-level="24.1.1" data-path="comparisons.html"><a href="comparisons.html#z-test"><i class="fa fa-check"></i><b>24.1.1</b> 當方差已知，且數據服從正態分佈 Z-test</a></li>
<li class="chapter" data-level="24.1.2" data-path="comparisons.html"><a href="comparisons.html#two-sample-t-test"><i class="fa fa-check"></i><b>24.1.2</b> 當方差未知，但是方差可以被認爲相等，且數據服從正態分佈 two sample <span class="math inline">\(t\)</span> test</a></li>
<li class="chapter" data-level="24.1.3" data-path="comparisons.html"><a href="comparisons.html#section-92"><i class="fa fa-check"></i><b>24.1.3</b> 練習</a></li>
<li class="chapter" data-level="24.1.4" data-path="comparisons.html"><a href="comparisons.html#section-93"><i class="fa fa-check"></i><b>24.1.4</b> 當方差未知，但是方差<strong>不可以</strong>被認爲相等，且數據服從正態分佈</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="comparisons.html"><a href="comparisons.html#section-94"><i class="fa fa-check"></i><b>24.2</b> 兩個人羣的方差比較</a><ul>
<li class="chapter" data-level="24.2.1" data-path="comparisons.html"><a href="comparisons.html#Ftest"><i class="fa fa-check"></i><b>24.2.1</b> 方差比值檢驗 variance ratio test</a></li>
<li class="chapter" data-level="24.2.2" data-path="comparisons.html"><a href="comparisons.html#section-95"><i class="fa fa-check"></i><b>24.2.2</b> 信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="comparisons.html"><a href="comparisons.html#section-96"><i class="fa fa-check"></i><b>24.3</b> 比較兩個百分比</a><ul>
<li class="chapter" data-level="24.3.1" data-path="comparisons.html"><a href="comparisons.html#proportiontest"><i class="fa fa-check"></i><b>24.3.1</b> 兩個百分比差是否爲零的推斷 Risk difference</a></li>
<li class="chapter" data-level="24.3.2" data-path="comparisons.html"><a href="comparisons.html#relative-riskrisk-ratio"><i class="fa fa-check"></i><b>24.3.2</b> 兩個百分比商是否爲 1 的推斷 relative risk/risk ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html"><i class="fa fa-check"></i><b>25</b> 前提和數據轉換 Assumptions and transformations</a><ul>
<li class="chapter" data-level="25.1" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#section-97"><i class="fa fa-check"></i><b>25.1</b> 穩健性</a></li>
<li class="chapter" data-level="25.2" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#section-98"><i class="fa fa-check"></i><b>25.2</b> 正態性</a><ul>
<li class="chapter" data-level="25.2.1" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#normalplot"><i class="fa fa-check"></i><b>25.2.1</b> 正態分佈圖 normal plot</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#section-99"><i class="fa fa-check"></i><b>25.3</b> 總結連續型變量不服從正態分佈時的處理方案</a></li>
<li class="chapter" data-level="25.4" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#power-transformations"><i class="fa fa-check"></i><b>25.4</b> 數學冪轉換 power transformations</a><ul>
<li class="chapter" data-level="25.4.1" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#logarithmic-transformation"><i class="fa fa-check"></i><b>25.4.1</b> 對數轉換 logarithmic Transformation</a></li>
<li class="chapter" data-level="25.4.2" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#back-transformation-of-cis"><i class="fa fa-check"></i><b>25.4.2</b> 逆轉換信賴區間 back-transformation of CIs</a></li>
<li class="chapter" data-level="25.4.3" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#log-normal-distribution"><i class="fa fa-check"></i><b>25.4.3</b> 對數正態分佈 log-normal distribution</a></li>
<li class="chapter" data-level="25.4.4" data-path="assumptions-and-transformations.html"><a href="assumptions-and-transformations.html#section-100"><i class="fa fa-check"></i><b>25.4.4</b> 百分比的轉換</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 線性迴歸 Linear Regression</b></span></li>
<li class="chapter" data-level="26" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>26</b> 簡單線性迴歸 Simple Linear Regression</a><ul>
<li class="chapter" data-level="26.1" data-path="lm.html"><a href="lm.html#section-101"><i class="fa fa-check"></i><b>26.1</b> 一些背景和術語</a></li>
<li class="chapter" data-level="26.2" data-path="lm.html"><a href="lm.html#simple-linear-regression-model"><i class="fa fa-check"></i><b>26.2</b> 簡單線性迴歸模型 simple linear regression model</a><ul>
<li class="chapter" data-level="26.2.1" data-path="lm.html"><a href="lm.html#a"><i class="fa fa-check"></i><b>26.2.1</b> 數據 A</a></li>
<li class="chapter" data-level="26.2.2" data-path="lm.html"><a href="lm.html#b"><i class="fa fa-check"></i><b>26.2.2</b> 數據 B</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="lm.html"><a href="lm.html#section-102"><i class="fa fa-check"></i><b>26.3</b> 區分因變量和預測變量</a><ul>
<li class="chapter" data-level="26.3.1" data-path="lm.html"><a href="lm.html#meanfunction"><i class="fa fa-check"></i><b>26.3.1</b> 均值 (期待值) 公式</a></li>
<li class="chapter" data-level="26.3.2" data-path="lm.html"><a href="lm.html#the-conditional-distribution-and-the-variance-function"><i class="fa fa-check"></i><b>26.3.2</b> 條件分佈和方差 the conditional distribution and the variance function</a></li>
<li class="chapter" data-level="26.3.3" data-path="lm.html"><a href="lm.html#defLM"><i class="fa fa-check"></i><b>26.3.3</b> 定義簡單線性迴歸模型</a></li>
<li class="chapter" data-level="26.3.4" data-path="lm.html"><a href="lm.html#residuals"><i class="fa fa-check"></i><b>26.3.4</b> 殘差 residuals</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="lm.html"><a href="lm.html#estimation-of-parameters"><i class="fa fa-check"></i><b>26.4</b> 參數的估計 estimation of parameters</a><ul>
<li class="chapter" data-level="26.4.1" data-path="lm.html"><a href="lm.html#MLEalphabeta"><i class="fa fa-check"></i><b>26.4.1</b> 普通最小二乘法估計 <span class="math inline">\(\alpha, \beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="26.5" data-path="lm.html"><a href="lm.html#ResidualVar"><i class="fa fa-check"></i><b>26.5</b> 殘差方差的估計 Estimation of the residual variance <span class="math inline">\((\sigma^2)\)</span></a></li>
<li class="chapter" data-level="26.6" data-path="lm.html"><a href="lm.html#growgam"><i class="fa fa-check"></i><b>26.6</b> R 演示 例 1： 圖 @ref(fig:age-wt) 數據</a></li>
<li class="chapter" data-level="26.7" data-path="lm.html"><a href="lm.html#binarylms"><i class="fa fa-check"></i><b>26.7</b> R 演示 例 2： 表@ref(tab:walk) 數據</a></li>
<li class="chapter" data-level="26.8" data-path="lm.html"><a href="lm.html#exeChol"><i class="fa fa-check"></i><b>26.8</b> 練習</a><ul>
<li class="chapter" data-level="26.8.1" data-path="lm.html"><a href="lm.html#c_1-c_2-c_2alphabeta-c_2-varepsilon"><i class="fa fa-check"></i><b>26.8.1</b> 兩次測量的膽固醇水平分別用 <span class="math inline">\(C_1, C_2\)</span> 來標記的話，考慮這樣的簡單線性迴歸模型：<span class="math inline">\(C_2=\alpha+\beta C_2 + \varepsilon\)</span>。我們進行這樣迴歸的前提假設有哪些？</a></li>
<li class="chapter" data-level="26.8.2" data-path="lm.html"><a href="lm.html#ols--hatalpha-hatbeta"><i class="fa fa-check"></i><b>26.8.2</b> 計算普通最小二乘法 (OLS) 下，截距和斜率的估計值 <span class="math inline">\(\hat\alpha, \hat\beta\)</span></a></li>
<li class="chapter" data-level="26.8.3" data-path="lm.html"><a href="lm.html#section-103"><i class="fa fa-check"></i><b>26.8.3</b> 和迴歸模型計算的結果作比較，解釋這些估計值的含義</a></li>
<li class="chapter" data-level="26.8.4" data-path="lm.html"><a href="lm.html#section-104"><i class="fa fa-check"></i><b>26.8.4</b> 加上計算的估計值直線 (即迴歸直線)</a></li>
<li class="chapter" data-level="26.8.5" data-path="lm.html"><a href="lm.html#diagnosis"><i class="fa fa-check"></i><b>26.8.5</b> 下面的代碼用於模型的假設診斷</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html"><i class="fa fa-check"></i><b>27</b> 最小二乘估計的性質和推斷 Ordinary Least Squares Estimators and Inference</a><ul>
<li class="chapter" data-level="27.1" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#ols-"><i class="fa fa-check"></i><b>27.1</b> OLS 估計量的性質</a></li>
<li class="chapter" data-level="27.2" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#hatbeta-"><i class="fa fa-check"></i><b>27.2</b> <span class="math inline">\(\hat\beta\)</span> 的性質</a><ul>
<li class="chapter" data-level="27.2.1" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#randbeta"><i class="fa fa-check"></i><b>27.2.1</b> <span class="math inline">\(Y\)</span> 對 <span class="math inline">\(X\)</span> 迴歸， 和 <span class="math inline">\(X\)</span> 對 <span class="math inline">\(Y\)</span> 迴歸</a></li>
<li class="chapter" data-level="27.2.2" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#reffigage-wt-"><i class="fa fa-check"></i><b>27.2.2</b> 例 1： 還是圖 @ref(fig:age-wt) 數據</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#section-105"><i class="fa fa-check"></i><b>27.3</b> 截距和迴歸係數的方差，協方差</a><ul>
<li class="chapter" data-level="27.3.1" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#centring"><i class="fa fa-check"></i><b>27.3.1</b> 中心化 centring</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#alpha-beta-"><i class="fa fa-check"></i><b>27.4</b> <span class="math inline">\(\alpha, \beta\)</span> 的推斷</a><ul>
<li class="chapter" data-level="27.4.1" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#section-106"><i class="fa fa-check"></i><b>27.4.1</b> 對迴歸係數進行假設檢驗</a></li>
<li class="chapter" data-level="27.4.2" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#section-107"><i class="fa fa-check"></i><b>27.4.2</b> 迴歸係數，截距的信賴區間</a></li>
<li class="chapter" data-level="27.4.3" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#section-108"><i class="fa fa-check"></i><b>27.4.3</b> 預測值的信賴區間 (置信帶) - 測量迴歸曲線本身的不確定性</a></li>
<li class="chapter" data-level="27.4.4" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#reference-range----95-"><i class="fa fa-check"></i><b>27.4.4</b> 預測帶 Reference range - 包含了 95% 觀察值的區間</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#rsquare"><i class="fa fa-check"></i><b>27.5</b> 線性迴歸模型和 Pearson 相關係數</a><ul>
<li class="chapter" data-level="27.5.1" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#r2-"><i class="fa fa-check"></i><b>27.5.1</b> <span class="math inline">\(r^2\)</span> 可以理解爲因變量平方和被模型解釋的比例</a></li>
</ul></li>
<li class="chapter" data-level="27.6" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#t-r2-F"><i class="fa fa-check"></i><b>27.6</b> Pearson 相關係數和模型迴歸係數的檢驗統計量 <span class="math inline">\(t\)</span> 之間的關係</a></li>
<li class="chapter" data-level="27.7" data-path="ordinary-least-squares-estimators-and-inference.html"><a href="ordinary-least-squares-estimators-and-inference.html#section-109"><i class="fa fa-check"></i><b>27.7</b> 練習</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ANOVA.html"><a href="ANOVA.html"><i class="fa fa-check"></i><b>28</b> 方差分析 Introduction to Analysis of Variance</a><ul>
<li class="chapter" data-level="28.1" data-path="ANOVA.html"><a href="ANOVA.html#section-110"><i class="fa fa-check"></i><b>28.1</b> 背景</a></li>
<li class="chapter" data-level="28.2" data-path="ANOVA.html"><a href="ANOVA.html#section-111"><i class="fa fa-check"></i><b>28.2</b> 簡單線性迴歸模型的方差分析</a><ul>
<li class="chapter" data-level="28.2.1" data-path="ANOVA.html"><a href="ANOVA.html#section-112"><i class="fa fa-check"></i><b>28.2.1</b> 兩個模型的參數估計</a></li>
<li class="chapter" data-level="28.2.2" data-path="ANOVA.html"><a href="ANOVA.html#section-113"><i class="fa fa-check"></i><b>28.2.2</b> 分割零假設模型的殘差平方和</a></li>
<li class="chapter" data-level="28.2.3" data-path="ANOVA.html"><a href="ANOVA.html#Rsquare"><i class="fa fa-check"></i><b>28.2.3</b> <span class="math inline">\(R^2\)</span> – 我的名字叫<strong>決定係數</strong> coefficient of determination</a></li>
<li class="chapter" data-level="28.2.4" data-path="ANOVA.html"><a href="ANOVA.html#the-anova-table"><i class="fa fa-check"></i><b>28.2.4</b> 方差分析表格 the ANOVA table</a></li>
<li class="chapter" data-level="28.2.5" data-path="ANOVA.html"><a href="ANOVA.html#anova-"><i class="fa fa-check"></i><b>28.2.5</b> 用 ANOVA 進行假設檢驗</a></li>
<li class="chapter" data-level="28.2.6" data-path="ANOVA.html"><a href="ANOVA.html#lm-Ftest"><i class="fa fa-check"></i><b>28.2.6</b> 簡單線性迴歸時的 <span class="math inline">\(F\)</span> 檢驗</a></li>
<li class="chapter" data-level="28.2.7" data-path="ANOVA.html"><a href="ANOVA.html#F-t-same"><i class="fa fa-check"></i><b>28.2.7</b> 簡單線性迴歸時 <span class="math inline">\(F\)</span> 檢驗和 <span class="math inline">\(t\)</span> 檢驗的一致性</a></li>
</ul></li>
<li class="chapter" data-level="28.3" data-path="ANOVA.html"><a href="ANOVA.html#anova"><i class="fa fa-check"></i><b>28.3</b> 分類變量用作預測變量時的 ANOVA</a><ul>
<li class="chapter" data-level="28.3.1" data-path="ANOVA.html"><a href="ANOVA.html#section-114"><i class="fa fa-check"></i><b>28.3.1</b> 一個二分類預測變量</a></li>
<li class="chapter" data-level="28.3.2" data-path="ANOVA.html"><a href="ANOVA.html#section-115"><i class="fa fa-check"></i><b>28.3.2</b> 一個模型，兩種表述</a></li>
<li class="chapter" data-level="28.3.3" data-path="ANOVA.html"><a href="ANOVA.html#section-116"><i class="fa fa-check"></i><b>28.3.3</b> 分組變量的平方和</a></li>
<li class="chapter" data-level="28.3.4" data-path="ANOVA.html"><a href="ANOVA.html#section-117"><i class="fa fa-check"></i><b>28.3.4</b> 簡單模型的分組變量大於兩組的情況</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="multivariable-models.html"><a href="multivariable-models.html"><i class="fa fa-check"></i><b>29</b> 多元模型分析 Multivariable Models</a><ul>
<li class="chapter" data-level="29.1" data-path="multivariable-models.html"><a href="multivariable-models.html#section-118"><i class="fa fa-check"></i><b>29.1</b> 兩個預測變量的線性迴歸模型</a><ul>
<li class="chapter" data-level="29.1.1" data-path="multivariable-models.html"><a href="multivariable-models.html#section-119"><i class="fa fa-check"></i><b>29.1.1</b> 數學標記法和解釋</a></li>
<li class="chapter" data-level="29.1.2" data-path="multivariable-models.html"><a href="multivariable-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>29.1.2</b> 最小平方和估計 Least Squares Estimation</a></li>
</ul></li>
<li class="chapter" data-level="29.2" data-path="multivariable-models.html"><a href="multivariable-models.html#section-120"><i class="fa fa-check"></i><b>29.2</b> 線性回歸模型中使用分組變量</a></li>
<li class="chapter" data-level="29.3" data-path="multivariable-models.html"><a href="multivariable-models.html#the-analysis-of-covariance-ancova-model"><i class="fa fa-check"></i><b>29.3</b> 協方差分析模型 the Analysis of Covariance (ANCOVA) Model</a></li>
<li class="chapter" data-level="29.4" data-path="multivariable-models.html"><a href="multivariable-models.html#section-121"><i class="fa fa-check"></i><b>29.4</b> 偏回歸係數的變化</a><ul>
<li class="chapter" data-level="29.4.1" data-path="multivariable-models.html"><a href="multivariable-models.html#beta_1-beta_1"><i class="fa fa-check"></i><b>29.4.1</b> 情況1： <span class="math inline">\(\beta_1 &gt; \beta_1^*\)</span></a></li>
<li class="chapter" data-level="29.4.2" data-path="multivariable-models.html"><a href="multivariable-models.html#beta_1beta_1"><i class="fa fa-check"></i><b>29.4.2</b> 情況2：<span class="math inline">\(\beta_1&lt;\beta_1^*\)</span></a></li>
<li class="chapter" data-level="29.4.3" data-path="multivariable-models.html"><a href="multivariable-models.html#beta_1-beta_1-1"><i class="fa fa-check"></i><b>29.4.3</b> 情況3： <span class="math inline">\(\beta_1 = \beta_1^*\)</span></a></li>
</ul></li>
<li class="chapter" data-level="29.5" data-path="multivariable-models.html"><a href="multivariable-models.html#confounding"><i class="fa fa-check"></i><b>29.5</b> 混雜 confounding</a><ul>
<li class="chapter" data-level="29.5.1" data-path="multivariable-models.html"><a href="multivariable-models.html#mediation-effect"><i class="fa fa-check"></i><b>29.5.1</b> 作為媒介 mediation effect</a></li>
<li class="chapter" data-level="29.5.2" data-path="multivariable-models.html"><a href="multivariable-models.html#section-122"><i class="fa fa-check"></i><b>29.5.2</b> 兩個預測變量之間的關係</a></li>
<li class="chapter" data-level="29.5.3" data-path="multivariable-models.html"><a href="multivariable-models.html#rct"><i class="fa fa-check"></i><b>29.5.3</b> RCT臨床實驗是個特例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="section-123.html"><a href="section-123.html"><i class="fa fa-check"></i><b>30</b> 多元模型分析：矩陣標記與其意義</a><ul>
<li class="chapter" data-level="30.1" data-path="section-123.html"><a href="section-123.html#section-124"><i class="fa fa-check"></i><b>30.1</b> 線性回歸模型的矩陣/非矩陣標記法</a><ul>
<li class="chapter" data-level="30.1.1" data-path="section-123.html"><a href="section-123.html#section-125"><i class="fa fa-check"></i><b>30.1.1</b> 模型標記：</a></li>
</ul></li>
<li class="chapter" data-level="30.2" data-path="section-123.html"><a href="section-123.html#section-126"><i class="fa fa-check"></i><b>30.2</b> 解讀參數</a><ul>
<li class="chapter" data-level="30.2.1" data-path="section-123.html"><a href="section-123.html#section-127"><i class="fa fa-check"></i><b>30.2.1</b> 最小二乘估計</a></li>
<li class="chapter" data-level="30.2.2" data-path="section-123.html"><a href="section-123.html#mathbfhat-y"><i class="fa fa-check"></i><b>30.2.2</b> 因變量的期待值 <span class="math inline">\(\mathbf{\hat Y}\)</span></a></li>
<li class="chapter" data-level="30.2.3" data-path="section-123.html"><a href="section-123.html#section-128"><i class="fa fa-check"></i><b>30.2.3</b> 殘差</a></li>
</ul></li>
<li class="chapter" data-level="30.3" data-path="section-123.html"><a href="section-123.html#f-"><i class="fa fa-check"></i><b>30.3</b> 方差分析一般化和 <span class="math inline">\(F\)</span> 檢驗</a><ul>
<li class="chapter" data-level="30.3.1" data-path="section-123.html"><a href="section-123.html#section-129"><i class="fa fa-check"></i><b>30.3.1</b> 多元線性迴歸時的決定係數和殘差方差</a></li>
<li class="chapter" data-level="30.3.2" data-path="section-123.html"><a href="section-123.html#section-130"><i class="fa fa-check"></i><b>30.3.2</b> 方差分析表格</a></li>
<li class="chapter" data-level="30.3.3" data-path="section-123.html"><a href="section-123.html#globalsig"><i class="fa fa-check"></i><b>30.3.3</b> 迴歸方程的顯著性檢驗</a></li>
<li class="chapter" data-level="30.3.4" data-path="section-123.html"><a href="section-123.html#partialF"><i class="fa fa-check"></i><b>30.3.4</b> <span class="math inline">\(\text{partial }F\)</span> 檢驗</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="section-123.html"><a href="section-123.html#section-131"><i class="fa fa-check"></i><b>30.4</b> 添加新變量對迴歸模型的影響</a><ul>
<li class="chapter" data-level="30.4.1" data-path="section-123.html"><a href="section-123.html#section-132"><i class="fa fa-check"></i><b>30.4.1</b> 偏迴歸係數方差的改變</a></li>
<li class="chapter" data-level="30.4.2" data-path="section-123.html"><a href="section-123.html#section-133"><i class="fa fa-check"></i><b>30.4.2</b> 偏迴歸係數檢驗結果的改變</a></li>
<li class="chapter" data-level="30.4.3" data-path="section-123.html"><a href="section-123.html#section-134"><i class="fa fa-check"></i><b>30.4.3</b> 擬合值的改變</a></li>
<li class="chapter" data-level="30.4.4" data-path="section-123.html"><a href="section-123.html#section-135"><i class="fa fa-check"></i><b>30.4.4</b> 決定係數的改變</a></li>
<li class="chapter" data-level="30.4.5" data-path="section-123.html"><a href="section-123.html#collinearity"><i class="fa fa-check"></i><b>30.4.5</b> 共線性 collinearity</a></li>
</ul></li>
<li class="chapter" data-level="30.5" data-path="section-123.html"><a href="section-123.html#section-136"><i class="fa fa-check"></i><b>30.5</b> 實戰演習</a><ul>
<li class="chapter" data-level="30.5.1" data-path="section-123.html"><a href="section-123.html#c-"><i class="fa fa-check"></i><b>30.5.1</b> 血清維生素 C 濃度的預測變量</a></li>
<li class="chapter" data-level="30.5.2" data-path="section-123.html"><a href="section-123.html#section-137"><i class="fa fa-check"></i><b>30.5.2</b> 紅細胞容積與血紅蛋白</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="31" data-path="section-138.html"><a href="section-138.html"><i class="fa fa-check"></i><b>31</b> 線性迴歸的模型診斷</a><ul>
<li class="chapter" data-level="31.1" data-path="section-138.html"><a href="section-138.html#section-139"><i class="fa fa-check"></i><b>31.1</b> 線性迴歸模型的前提條件</a></li>
<li class="chapter" data-level="31.2" data-path="section-138.html"><a href="section-138.html#section-140"><i class="fa fa-check"></i><b>31.2</b> 用圖形來視覺診斷</a></li>
<li class="chapter" data-level="31.3" data-path="section-138.html"><a href="section-138.html#section-141"><i class="fa fa-check"></i><b>31.3</b> 殘差圖</a></li>
<li class="chapter" data-level="31.4" data-path="section-138.html"><a href="section-138.html#normal-plot-of-residuals"><i class="fa fa-check"></i><b>31.4</b> 殘差正態圖 normal plot of residuals</a><ul>
<li class="chapter" data-level="31.4.1" data-path="section-138.html"><a href="section-138.html#section-142"><i class="fa fa-check"></i><b>31.4.1</b> 模型診斷實例</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="section-138.html"><a href="section-138.html#section-143"><i class="fa fa-check"></i><b>31.5</b> 前提條件的統計學檢驗</a><ul>
<li class="chapter" data-level="31.5.1" data-path="section-138.html"><a href="section-138.html#section-144"><i class="fa fa-check"></i><b>31.5.1</b> 二次方程迴歸法檢驗非線性</a></li>
<li class="chapter" data-level="31.5.2" data-path="section-138.html"><a href="section-138.html#section-145"><i class="fa fa-check"></i><b>31.5.2</b> 非線性關係模型</a></li>
</ul></li>
<li class="chapter" data-level="31.6" data-path="section-138.html"><a href="section-138.html#section-146"><i class="fa fa-check"></i><b>31.6</b> 異常值，槓桿值，和庫克距離</a><ul>
<li class="chapter" data-level="31.6.1" data-path="section-138.html"><a href="section-138.html#standardres"><i class="fa fa-check"></i><b>31.6.1</b> 異常值和標準化殘差</a></li>
<li class="chapter" data-level="31.6.2" data-path="section-138.html"><a href="section-138.html#leverage"><i class="fa fa-check"></i><b>31.6.2</b> 槓桿值 Leverage</a></li>
<li class="chapter" data-level="31.6.3" data-path="section-138.html"><a href="section-138.html#cooks-distance"><i class="fa fa-check"></i><b>31.6.3</b> 庫克距離 Cook’s Distance</a></li>
</ul></li>
<li class="chapter" data-level="31.7" data-path="section-138.html"><a href="section-138.html#section-147"><i class="fa fa-check"></i><b>31.7</b> 在統計忍者包裏面對模型診斷作圖</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>32</b> 交互作用 Interactions</a><ul>
<li class="chapter" data-level="32.1" data-path="interaction.html"><a href="interaction.html#section-148"><i class="fa fa-check"></i><b>32.1</b> 兩個預測變量之間的線性模型交互作用</a><ul>
<li class="chapter" data-level="32.1.1" data-path="interaction.html"><a href="interaction.html#section-149"><i class="fa fa-check"></i><b>32.1.1</b> 交互作用線性模型的一般表達式</a></li>
<li class="chapter" data-level="32.1.2" data-path="interaction.html"><a href="interaction.html#interaction-cont-bin"><i class="fa fa-check"></i><b>32.1.2</b> 連續型變量和二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="32.1.3" data-path="interaction.html"><a href="interaction.html#section-150"><i class="fa fa-check"></i><b>32.1.3</b> 兩個二分類變量之間的交互作用</a></li>
<li class="chapter" data-level="32.1.4" data-path="interaction.html"><a href="interaction.html#section-151"><i class="fa fa-check"></i><b>32.1.4</b> 兩個連續變量之間的交互作用</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V 臨床實驗 Clinical Trials</b></span></li>
<li class="chapter" data-level="33" data-path="sample-size.html"><a href="sample-size.html"><i class="fa fa-check"></i><b>33</b> 樣本量計算問題</a><ul>
<li class="chapter" data-level="33.1" data-path="sample-size.html"><a href="sample-size.html#section-152"><i class="fa fa-check"></i><b>33.1</b> 背景</a></li>
<li class="chapter" data-level="33.2" data-path="sample-size.html"><a href="sample-size.html#section-153"><i class="fa fa-check"></i><b>33.2</b> 決定所需樣本量大小的統計學因素</a></li>
<li class="chapter" data-level="33.3" data-path="sample-size.html"><a href="sample-size.html#type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>33.3</b> 第一類和第二類錯誤 Type I and type II errors</a></li>
<li class="chapter" data-level="33.4" data-path="sample-size.html"><a href="sample-size.html#percentages-or-proportions"><i class="fa fa-check"></i><b>33.4</b> 比較兩組之間的百分比 (percentages or proportions)</a><ul>
<li class="chapter" data-level="33.4.1" data-path="sample-size.html"><a href="sample-size.html#section-154"><i class="fa fa-check"></i><b>33.4.1</b> 樣本量計算公式 (使用顯著水平 5%, 和檢驗效能 90%)</a></li>
<li class="chapter" data-level="33.4.2" data-path="sample-size.html"><a href="sample-size.html#section-155"><i class="fa fa-check"></i><b>33.4.2</b> 樣本量計算公式的一般化 (不同的顯著水平和檢驗效能條件下)</a></li>
</ul></li>
<li class="chapter" data-level="33.5" data-path="sample-size.html"><a href="sample-size.html#section-156"><i class="fa fa-check"></i><b>33.5</b> 比較兩組之間的均值</a><ul>
<li class="chapter" data-level="33.5.1" data-path="sample-size.html"><a href="sample-size.html#section-157"><i class="fa fa-check"></i><b>33.5.1</b> 樣本量計算公式</a></li>
</ul></li>
<li class="chapter" data-level="33.6" data-path="sample-size.html"><a href="sample-size.html#section-158"><i class="fa fa-check"></i><b>33.6</b> 樣本量計算的調整</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="baseline-adjustment-using-ancova.html"><a href="baseline-adjustment-using-ancova.html"><i class="fa fa-check"></i><b>34</b> Baseline Adjustment using ANCOVA</a></li>
<li class="part"><span><b>VI 穩健統計方法 Robust Statistic Methods</b></span></li>
<li class="chapter" data-level="35" data-path="section-159.html"><a href="section-159.html"><i class="fa fa-check"></i><b>35</b> 穩健統計方法入門</a></li>
<li class="chapter" data-level="36" data-path="section-160.html"><a href="section-160.html"><i class="fa fa-check"></i><b>36</b> 基於秩次的非參數檢驗</a><ul>
<li class="chapter" data-level="36.1" data-path="section-160.html"><a href="section-160.html#sign-test"><i class="fa fa-check"></i><b>36.1</b> 符號檢驗 the Sign test</a><ul>
<li class="chapter" data-level="36.1.1" data-path="section-160.html"><a href="section-160.html#section-161"><i class="fa fa-check"></i><b>36.1.1</b> 符號檢驗的特點</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="section-160.html"><a href="section-160.html#Wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>36.2</b> Wilcoxon 符號秩和檢驗，the Wilcoxon signed-rank test</a></li>
<li class="chapter" data-level="36.3" data-path="section-160.html"><a href="section-160.html#wilcoxon-mann-whitney-wmw-"><i class="fa fa-check"></i><b>36.3</b> Wilcoxon-Mann-Whitney (WMW) 檢驗</a></li>
<li class="chapter" data-level="36.4" data-path="section-160.html"><a href="section-160.html#spearmans-rank-correlation-coefficient"><i class="fa fa-check"></i><b>36.4</b> 秩相關，Spearman’s Rank Correlation Coefficient</a></li>
<li class="chapter" data-level="36.5" data-path="section-160.html"><a href="section-160.html#section-162"><i class="fa fa-check"></i><b>36.5</b> 基於秩次的非參數檢驗的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="permutation-procedures.html"><a href="permutation-procedures.html"><i class="fa fa-check"></i><b>37</b> 排列置換法 Permutation procedures</a><ul>
<li class="chapter" data-level="37.1" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-163"><i class="fa fa-check"></i><b>37.1</b> 背景介紹</a></li>
<li class="chapter" data-level="37.2" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-164"><i class="fa fa-check"></i><b>37.2</b> 直接上實例</a></li>
<li class="chapter" data-level="37.3" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-165"><i class="fa fa-check"></i><b>37.3</b> 排列置換法三板斧</a><ul>
<li class="chapter" data-level="37.3.1" data-path="permutation-procedures.html"><a href="permutation-procedures.html#t"><i class="fa fa-check"></i><b>37.3.1</b> 該如何選用合適的檢驗統計量 <span class="math inline">\(T\)</span>？</a></li>
<li class="chapter" data-level="37.3.2" data-path="permutation-procedures.html"><a href="permutation-procedures.html#adjustment-"><i class="fa fa-check"></i><b>37.3.2</b> 可以在排列置換法中對其他變量進行統計學調整 (adjustment) 嗎？</a></li>
<li class="chapter" data-level="37.3.3" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-166"><i class="fa fa-check"></i><b>37.3.3</b> 排列置換法，基於秩次的非參數檢驗之間的關係</a></li>
<li class="chapter" data-level="37.3.4" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-167"><i class="fa fa-check"></i><b>37.3.4</b> 排列置換檢驗法，是一種精確檢驗</a></li>
</ul></li>
<li class="chapter" data-level="37.4" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-168"><i class="fa fa-check"></i><b>37.4</b> 基於排序置換檢驗法計算信賴區間</a></li>
<li class="chapter" data-level="37.5" data-path="permutation-procedures.html"><a href="permutation-procedures.html#section-169"><i class="fa fa-check"></i><b>37.5</b> 排序置換法的優缺點</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="the-bootstrap.html"><a href="the-bootstrap.html"><i class="fa fa-check"></i><b>38</b> 自助重抽法 The bootstrap</a><ul>
<li class="chapter" data-level="38.1" data-path="the-bootstrap.html"><a href="the-bootstrap.html#section-170"><i class="fa fa-check"></i><b>38.1</b> 定義</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="the-sandwich-estimator.html"><a href="the-sandwich-estimator.html"><i class="fa fa-check"></i><b>39</b> The sandwich estimator</a></li>
<li class="part"><span><b>VII 貝葉斯統計</b></span></li>
<li class="chapter" data-level="40" data-path="intro-Bayes.html"><a href="intro-Bayes.html"><i class="fa fa-check"></i><b>40</b> 貝葉斯統計入門</a><ul>
<li class="chapter" data-level="40.1" data-path="intro-Bayes.html"><a href="intro-Bayes.html#section-171"><i class="fa fa-check"></i><b>40.1</b> 概率論推斷的複習</a></li>
<li class="chapter" data-level="40.2" data-path="intro-Bayes.html"><a href="intro-Bayes.html#bayesian-reasoninginverse-probability"><i class="fa fa-check"></i><b>40.2</b> 貝葉斯概率推理/逆概率 Bayesian reasoning/inverse probability</a><ul>
<li class="chapter" data-level="40.2.1" data-path="intro-Bayes.html"><a href="intro-Bayes.html#deductive-reasoning---weak-syllogisms"><i class="fa fa-check"></i><b>40.2.1</b> 演繹推理 deductive reasoning 和 三段論 weak syllogisms</a></li>
<li class="chapter" data-level="40.2.2" data-path="intro-Bayes.html"><a href="intro-Bayes.html#quantifying-plausibility"><i class="fa fa-check"></i><b>40.2.2</b> 如何給可能性定量 Quantifying plausibility</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="intro-Bayes.html"><a href="intro-Bayes.html#section-172"><i class="fa fa-check"></i><b>40.3</b> 貝葉斯推理的統計學實現</a><ul>
<li class="chapter" data-level="40.3.1" data-path="intro-Bayes.html"><a href="intro-Bayes.html#diagnostic-testing"><i class="fa fa-check"></i><b>40.3.1</b> 醫學診斷測試 diagnostic testing</a></li>
<li class="chapter" data-level="40.3.2" data-path="intro-Bayes.html"><a href="intro-Bayes.html#hiv-"><i class="fa fa-check"></i><b>40.3.2</b> HIV 檢查時的應用</a></li>
<li class="chapter" data-level="40.3.3" data-path="intro-Bayes.html"><a href="intro-Bayes.html#section-173"><i class="fa fa-check"></i><b>40.3.3</b> 說點小歷史</a></li>
</ul></li>
<li class="chapter" data-level="40.4" data-path="intro-Bayes.html"><a href="intro-Bayes.html#section-174"><i class="fa fa-check"></i><b>40.4</b> 練習題</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="section-175.html"><a href="section-175.html"><i class="fa fa-check"></i><b>41</b> 貝葉斯定理的應用：單一參數模型</a><ul>
<li class="chapter" data-level="41.1" data-path="section-175.html"><a href="section-175.html#notation-for-probability-density-functions"><i class="fa fa-check"></i><b>41.1</b> 貝葉斯理論下的事後二項分佈概率密度方程 notation for probability density functions</a></li>
<li class="chapter" data-level="41.2" data-path="section-175.html"><a href="section-175.html#theta-"><i class="fa fa-check"></i><b>41.2</b> <span class="math inline">\(\theta\)</span> 的先驗概率</a><ul>
<li class="chapter" data-level="41.2.1" data-path="section-175.html"><a href="section-175.html#beta-distribution-intro"><i class="fa fa-check"></i><b>41.2.1</b> beta 分佈 the beta distribution</a></li>
<li class="chapter" data-level="41.2.2" data-path="section-175.html"><a href="section-175.html#conjugate"><i class="fa fa-check"></i><b>41.2.2</b> 二項分佈數據事後概率分佈的一般化：共軛性</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="section-175.html"><a href="section-175.html#section-176"><i class="fa fa-check"></i><b>41.3</b> 附贈–加量不加價</a></li>
<li class="chapter" data-level="41.4" data-path="section-175.html"><a href="section-175.html#section-177"><i class="fa fa-check"></i><b>41.4</b> 練習題</a><ul>
<li class="chapter" data-level="41.4.1" data-path="section-175.html"><a href="section-175.html#q1-4"><i class="fa fa-check"></i><b>41.4.1</b> Q1</a></li>
<li class="chapter" data-level="41.4.2" data-path="section-175.html"><a href="section-175.html#q2-3"><i class="fa fa-check"></i><b>41.4.2</b> Q2</a></li>
<li class="chapter" data-level="41.4.3" data-path="section-175.html"><a href="section-175.html#q3-2"><i class="fa fa-check"></i><b>41.4.3</b> Q3</a></li>
<li class="chapter" data-level="41.4.4" data-path="section-175.html"><a href="section-175.html#q4"><i class="fa fa-check"></i><b>41.4.4</b> Q4</a></li>
<li class="chapter" data-level="41.4.5" data-path="section-175.html"><a href="section-175.html#q5"><i class="fa fa-check"></i><b>41.4.5</b> Q5</a></li>
<li class="chapter" data-level="41.4.6" data-path="section-175.html"><a href="section-175.html#q6"><i class="fa fa-check"></i><b>41.4.6</b> Q6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="42" data-path="normal-distribution-applying-bayes-theorem.html"><a href="normal-distribution-applying-bayes-theorem.html"><i class="fa fa-check"></i><b>42</b> 貝葉斯理論在正態分布數據中的應用 Normal distribution applying Bayes’ Theorem</a><ul>
<li class="chapter" data-level="42.1" data-path="normal-distribution-applying-bayes-theorem.html"><a href="normal-distribution-applying-bayes-theorem.html#section-178"><i class="fa fa-check"></i><b>42.1</b> 事後概率的總結方法</a></li>
<li class="chapter" data-level="42.2" data-path="normal-distribution-applying-bayes-theorem.html"><a href="normal-distribution-applying-bayes-theorem.html#section-179"><i class="fa fa-check"></i><b>42.2</b> 貝葉斯統計推斷中的正態分布</a><ul>
<li class="chapter" data-level="42.2.1" data-path="normal-distribution-applying-bayes-theorem.html"><a href="normal-distribution-applying-bayes-theorem.html#n-independent-identically-distributed-observations"><i class="fa fa-check"></i><b>42.2.1</b> <span class="math inline">\(n\)</span> independent identically distributed observations</a></li>
</ul></li>
<li class="chapter" data-level="42.3" data-path="normal-distribution-applying-bayes-theorem.html"><a href="normal-distribution-applying-bayes-theorem.html#section-180"><i class="fa fa-check"></i><b>42.3</b> 貝葉斯預測分布</a></li>
</ul></li>
<li class="part"><span><b>VIII 廣義線性迴歸模型</b></span></li>
<li class="chapter" data-level="43" data-path="section-181.html"><a href="section-181.html"><i class="fa fa-check"></i><b>43</b> 重要概念複習</a><ul>
<li class="chapter" data-level="43.1" data-path="section-181.html"><a href="section-181.html#section-182"><i class="fa fa-check"></i><b>43.1</b> 概率論學派統計推斷要點複習</a></li>
<li class="chapter" data-level="43.2" data-path="section-181.html"><a href="section-181.html#section-183"><i class="fa fa-check"></i><b>43.2</b> 似然</a></li>
<li class="chapter" data-level="43.3" data-path="section-181.html"><a href="section-181.html#section-184"><i class="fa fa-check"></i><b>43.3</b> 極大似然估計</a></li>
<li class="chapter" data-level="43.4" data-path="section-181.html"><a href="section-181.html#section-185"><i class="fa fa-check"></i><b>43.4</b> 關於假設檢驗的複習</a><ul>
<li class="chapter" data-level="43.4.1" data-path="section-181.html"><a href="section-181.html#section-186"><i class="fa fa-check"></i><b>43.4.1</b> 子集似然函數</a></li>
</ul></li>
<li class="chapter" data-level="43.5" data-path="section-181.html"><a href="section-181.html#section-187"><i class="fa fa-check"></i><b>43.5</b> 線性迴歸複習</a><ul>
<li class="chapter" data-level="43.5.1" data-path="section-181.html"><a href="section-181.html#section-188"><i class="fa fa-check"></i><b>43.5.1</b> 簡單線性迴歸</a></li>
<li class="chapter" data-level="43.5.2" data-path="section-181.html"><a href="section-181.html#section-189"><i class="fa fa-check"></i><b>43.5.2</b> 多元線性迴歸</a></li>
<li class="chapter" data-level="43.5.3" data-path="section-181.html"><a href="section-181.html#score-equations"><i class="fa fa-check"></i><b>43.5.3</b> 簡單線性迴歸的統計推斷</a></li>
</ul></li>
<li class="chapter" data-level="43.6" data-path="section-181.html"><a href="section-181.html#glm-practical-01"><i class="fa fa-check"></i><b>43.6</b> GLM-Practical 01</a><ul>
<li class="chapter" data-level="43.6.1" data-path="section-181.html"><a href="section-181.html#section-190"><i class="fa fa-check"></i><b>43.6.1</b> 建立似然方程</a></li>
<li class="chapter" data-level="43.6.2" data-path="section-181.html"><a href="section-181.html#section-191"><i class="fa fa-check"></i><b>43.6.2</b> 建立對數似然方程</a></li>
<li class="chapter" data-level="43.6.3" data-path="section-181.html"><a href="section-181.html#section-193"><i class="fa fa-check"></i><b>43.6.3</b> 線性回歸模型</a></li>
<li class="chapter" data-level="43.6.4" data-path="section-181.html"><a href="section-181.html#wald-score-"><i class="fa fa-check"></i><b>43.6.4</b> 似然比檢驗，Wald 檢驗，Score 檢驗</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="44" data-path="section-194.html"><a href="section-194.html"><i class="fa fa-check"></i><b>44</b> 廣義線性迴歸入門</a><ul>
<li class="chapter" data-level="44.1" data-path="section-194.html"><a href="section-194.html#section-195"><i class="fa fa-check"></i><b>44.1</b> 指數分佈家族</a><ul>
<li class="chapter" data-level="44.1.1" data-path="section-194.html"><a href="section-194.html#section-196"><i class="fa fa-check"></i><b>44.1.1</b> 泊松分佈和二項分佈的指數分佈家族屬性</a></li>
<li class="chapter" data-level="44.1.2" data-path="section-194.html"><a href="section-194.html#exercise.-exponential-distribution"><i class="fa fa-check"></i><b>44.1.2</b> Exercise. Exponential distribution</a></li>
</ul></li>
<li class="chapter" data-level="44.2" data-path="section-194.html"><a href="section-194.html#defineaGLM"><i class="fa fa-check"></i><b>44.2</b> 廣義線性迴歸模型之定義</a></li>
<li class="chapter" data-level="44.3" data-path="section-194.html"><a href="section-194.html#section-197"><i class="fa fa-check"></i><b>44.3</b> 注意</a></li>
<li class="chapter" data-level="44.4" data-path="section-194.html"><a href="section-194.html#r--glm"><i class="fa fa-check"></i><b>44.4</b> 如何在 R 裏擬合 “GLM”</a><ul>
<li class="chapter" data-level="44.4.1" data-path="section-194.html"><a href="section-194.html#margins-"><i class="fa fa-check"></i><b>44.4.1</b> <code>margins</code> 命令</a></li>
<li class="chapter" data-level="44.4.2" data-path="section-194.html"><a href="section-194.html#ggplot2geom_smoothmethod-loess-"><i class="fa fa-check"></i><b>44.4.2</b> <code>ggplot2::geom_smooth(method = "loess")</code> 命令</a></li>
</ul></li>
<li class="chapter" data-level="44.5" data-path="section-194.html"><a href="section-194.html#glm-practical-02"><i class="fa fa-check"></i><b>44.5</b> GLM-Practical 02</a><ul>
<li class="chapter" data-level="44.5.1" data-path="section-194.html"><a href="section-194.html#y-"><i class="fa fa-check"></i><b>44.5.1</b> 思考本章中指數分布家族的參數設置。假如，有一個觀測值 <span class="math inline">\(y\)</span> 來自指數家族。試求證:</a></li>
<li class="chapter" data-level="44.5.2" data-path="section-194.html"><a href="section-194.html#r--1"><i class="fa fa-check"></i><b>44.5.2</b> R 練習</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="45" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html"><i class="fa fa-check"></i><b>45</b> 二項分佈數據的廣義線性迴歸模型 logistic regression model</a><ul>
<li class="chapter" data-level="45.1" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#grouped-individual-"><i class="fa fa-check"></i><b>45.1</b> 彙總後/個人 (grouped / individual) 的二項分佈數據</a></li>
<li class="chapter" data-level="45.2" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#section-200"><i class="fa fa-check"></i><b>45.2</b> 二項分佈數據的廣義線性迴歸模型</a></li>
<li class="chapter" data-level="45.3" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#logit-or-log"><i class="fa fa-check"></i><b>45.3</b> 注</a><ul>
<li class="chapter" data-level="45.3.1" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#exercise.-link-functions."><i class="fa fa-check"></i><b>45.3.1</b> Exercise. Link functions.</a></li>
</ul></li>
<li class="chapter" data-level="45.4" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#section-201"><i class="fa fa-check"></i><b>45.4</b> 邏輯迴歸模型迴歸係數的實際意義</a></li>
<li class="chapter" data-level="45.5" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#BSEinfection"><i class="fa fa-check"></i><b>45.5</b> 邏輯迴歸實際案例</a><ul>
<li class="chapter" data-level="45.5.1" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#section-202"><i class="fa fa-check"></i><b>45.5.1</b> 分析目的</a></li>
<li class="chapter" data-level="45.5.2" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#section-203"><i class="fa fa-check"></i><b>45.5.2</b> 模型 1 飼料 + 羣</a></li>
<li class="chapter" data-level="45.5.3" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#times-"><i class="fa fa-check"></i><b>45.5.3</b> 模型 2 增加交互作用項 飼料 <span class="math inline">\(\times\)</span> 羣</a></li>
</ul></li>
<li class="chapter" data-level="45.6" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#glm-practical-03"><i class="fa fa-check"></i><b>45.6</b> GLM-Practical 03</a><ul>
<li class="chapter" data-level="45.6.1" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#section-204"><i class="fa fa-check"></i><b>45.6.1</b> 昆蟲的死亡率</a></li>
<li class="chapter" data-level="45.6.2" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html#section-205"><i class="fa fa-check"></i><b>45.6.2</b> 哮喘門診數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="46" data-path="section-206.html"><a href="section-206.html"><i class="fa fa-check"></i><b>46</b> 模型比較和擬合優度</a><ul>
<li class="chapter" data-level="46.1" data-path="section-206.html"><a href="section-206.html#nested-models"><i class="fa fa-check"></i><b>46.1</b> 嵌套式模型的比較 nested models</a></li>
<li class="chapter" data-level="46.2" data-path="section-206.html"><a href="section-206.html#section-207"><i class="fa fa-check"></i><b>46.2</b> 嵌套式模型比較實例</a></li>
<li class="chapter" data-level="46.3" data-path="section-206.html"><a href="section-206.html#section-208"><i class="fa fa-check"></i><b>46.3</b> 飽和模型，模型的偏差，擬合優度</a><ul>
<li class="chapter" data-level="46.3.1" data-path="section-206.html"><a href="section-206.html#saturated-model"><i class="fa fa-check"></i><b>46.3.1</b> 飽和模型 saturated model</a></li>
<li class="chapter" data-level="46.3.2" data-path="section-206.html"><a href="section-206.html#deviance"><i class="fa fa-check"></i><b>46.3.2</b> 模型偏差 deviance</a></li>
<li class="chapter" data-level="46.3.3" data-path="section-206.html"><a href="section-206.html#aggregatedgrouped-binary-data"><i class="fa fa-check"></i><b>46.3.3</b> 彙總型二項分佈數據 aggregated/grouped binary data</a></li>
</ul></li>
<li class="chapter" data-level="46.4" data-path="section-206.html"><a href="section-206.html#gof"><i class="fa fa-check"></i><b>46.4</b> 個人數據擬合模型的優度檢驗</a></li>
<li class="chapter" data-level="46.5" data-path="section-206.html"><a href="section-206.html#glm-practical-04"><i class="fa fa-check"></i><b>46.5</b> GLM Practical 04</a><ul>
<li class="chapter" data-level="46.5.1" data-path="section-206.html"><a href="section-206.html#section-209"><i class="fa fa-check"></i><b>46.5.1</b> 回到之前的昆蟲數據，嘗試評價該模型的擬合優度。</a></li>
<li class="chapter" data-level="46.5.2" data-path="section-206.html"><a href="section-206.html#section-210"><i class="fa fa-check"></i><b>46.5.2</b> 低出生體重數據</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="47" data-path="poisson-regression.html"><a href="poisson-regression.html"><i class="fa fa-check"></i><b>47</b> 計數型因變量 Poisson regression</a><ul>
<li class="chapter" data-level="47.1" data-path="poisson-regression.html"><a href="poisson-regression.html#glm"><i class="fa fa-check"></i><b>47.1</b> 泊松 GLM</a></li>
<li class="chapter" data-level="47.2" data-path="poisson-regression.html"><a href="poisson-regression.html#section-211"><i class="fa fa-check"></i><b>47.2</b> 泊松迴歸實例</a></li>
<li class="chapter" data-level="47.3" data-path="poisson-regression.html"><a href="poisson-regression.html#overdispersion"><i class="fa fa-check"></i><b>47.3</b> 過度離散 overdispersion</a><ul>
<li class="chapter" data-level="47.3.1" data-path="poisson-regression.html"><a href="poisson-regression.html#section-212"><i class="fa fa-check"></i><b>47.3.1</b> 過度離散怎麼查？</a></li>
<li class="chapter" data-level="47.3.2" data-path="poisson-regression.html"><a href="poisson-regression.html#negative-binomial-model"><i class="fa fa-check"></i><b>47.3.2</b> 負二項式分佈模型 negative binomial model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="48" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html"><i class="fa fa-check"></i><b>48</b> 率的廣義線性迴歸 Poisson GLM for rates</a><ul>
<li class="chapter" data-level="48.1" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-213"><i class="fa fa-check"></i><b>48.1</b> 醫學中的率</a></li>
<li class="chapter" data-level="48.2" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-214"><i class="fa fa-check"></i><b>48.2</b> 泊松過程</a></li>
<li class="chapter" data-level="48.3" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-215"><i class="fa fa-check"></i><b>48.3</b> 率的模型</a></li>
<li class="chapter" data-level="48.4" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#glm-1"><i class="fa fa-check"></i><b>48.4</b> 率的 GLM</a></li>
<li class="chapter" data-level="48.5" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-216"><i class="fa fa-check"></i><b>48.5</b> 實戰演練</a><ul>
<li class="chapter" data-level="48.5.1" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-217"><i class="fa fa-check"></i><b>48.5.1</b> 模型 1</a></li>
<li class="chapter" data-level="48.5.2" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-218"><i class="fa fa-check"></i><b>48.5.2</b> 模型 2</a></li>
<li class="chapter" data-level="48.5.3" data-path="poisson-glm-for-rates.html"><a href="poisson-glm-for-rates.html#section-219"><i class="fa fa-check"></i><b>48.5.3</b> 模型 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="49" data-path="section-220.html"><a href="section-220.html"><i class="fa fa-check"></i><b>49</b> 混雜的調整，交互作用，和模型的可壓縮性</a><ul>
<li class="chapter" data-level="49.1" data-path="section-220.html"><a href="section-220.html#section-221"><i class="fa fa-check"></i><b>49.1</b> 混雜因素的調整</a><ul>
<li class="chapter" data-level="49.1.1" data-path="section-220.html"><a href="section-220.html#woolf-"><i class="fa fa-check"></i><b>49.1.1</b> Woolf 法估算合併比值比</a></li>
</ul></li>
<li class="chapter" data-level="49.2" data-path="section-220.html"><a href="section-220.html#section-222"><i class="fa fa-check"></i><b>49.2</b> 交互作用</a></li>
<li class="chapter" data-level="49.3" data-path="section-220.html"><a href="section-220.html#collapsibility"><i class="fa fa-check"></i><b>49.3</b> 可壓縮性 collapsibility</a><ul>
<li class="chapter" data-level="49.3.1" data-path="section-220.html"><a href="section-220.html#section-223"><i class="fa fa-check"></i><b>49.3.1</b> 線性迴歸的可壓縮性</a></li>
<li class="chapter" data-level="49.3.2" data-path="section-220.html"><a href="section-220.html#collapsibility"><i class="fa fa-check"></i><b>49.3.2</b> 邏輯鏈接方程時的不可壓縮性</a></li>
</ul></li>
<li class="chapter" data-level="49.4" data-path="section-220.html"><a href="section-220.html#interaction-depend-scale"><i class="fa fa-check"></i><b>49.4</b> 交互作用對尺度的依賴性</a></li>
</ul></li>
<li class="chapter" data-level="50" data-path="section-224.html"><a href="section-224.html"><i class="fa fa-check"></i><b>50</b> 流行病學中的邏輯迴歸</a><ul>
<li class="chapter" data-level="50.1" data-path="section-224.html"><a href="section-224.html#section-225"><i class="fa fa-check"></i><b>50.1</b> 流行病學研究最常用的實驗設計</a></li>
<li class="chapter" data-level="50.2" data-path="section-224.html"><a href="section-224.html#GLM8-3"><i class="fa fa-check"></i><b>50.2</b> 以簡單二分類暴露變量爲例</a><ul>
<li class="chapter" data-level="50.2.1" data-path="section-224.html"><a href="section-224.html#section-226"><i class="fa fa-check"></i><b>50.2.1</b> 先決條件</a></li>
<li class="chapter" data-level="50.2.2" data-path="section-224.html"><a href="section-224.html#odds-ratios"><i class="fa fa-check"></i><b>50.2.2</b> 比值比 Odds ratios</a></li>
<li class="chapter" data-level="50.2.3" data-path="section-224.html"><a href="section-224.html#GLM8-3-4"><i class="fa fa-check"></i><b>50.2.3</b> 邏輯迴歸應用於病例對照研究的合理性</a></li>
</ul></li>
<li class="chapter" data-level="50.3" data-path="section-224.html"><a href="section-224.html#section-227"><i class="fa fa-check"></i><b>50.3</b> 拓展到多個暴露變量的邏輯迴歸模型</a><ul>
<li class="chapter" data-level="50.3.1" data-path="section-224.html"><a href="section-224.html#mantel-haenszel-"><i class="fa fa-check"></i><b>50.3.1</b> Mantel Haenszel 法</a></li>
<li class="chapter" data-level="50.3.2" data-path="section-224.html"><a href="section-224.html#section-228"><i class="fa fa-check"></i><b>50.3.2</b> 隊列研究和病例對照研究的似然</a></li>
<li class="chapter" data-level="50.3.3" data-path="section-224.html"><a href="section-224.html#section-229"><i class="fa fa-check"></i><b>50.3.3</b> 病例對照研究中的邏輯迴歸</a></li>
</ul></li>
<li class="chapter" data-level="50.4" data-path="section-224.html"><a href="section-224.html#section-230"><i class="fa fa-check"></i><b>50.4</b> 流行病學研究中變量的調整策略</a></li>
</ul></li>
<li class="chapter" data-level="51" data-path="section-231.html"><a href="section-231.html"><i class="fa fa-check"></i><b>51</b> 分析策略</a><ul>
<li class="chapter" data-level="51.1" data-path="section-231.html"><a href="section-231.html#section-232"><i class="fa fa-check"></i><b>51.1</b> 明確分析目的</a></li>
<li class="chapter" data-level="51.2" data-path="section-231.html"><a href="section-231.html#rct--treatment-effect"><i class="fa fa-check"></i><b>51.2</b> 分析目的 1.1 – 估計 RCT 中治療效果 (treatment effect)</a><ul>
<li class="chapter" data-level="51.2.1" data-path="section-231.html"><a href="section-231.html#rct-"><i class="fa fa-check"></i><b>51.2.1</b> RCT 數據分析的一些不成熟的小建議</a></li>
</ul></li>
<li class="chapter" data-level="51.3" data-path="section-231.html"><a href="section-231.html#exposure-effect"><i class="fa fa-check"></i><b>51.3</b> 分析目的 1.2 – 估計流行病學研究中暴露變量和結果變量的關係 (exposure effect)</a><ul>
<li class="chapter" data-level="51.3.1" data-path="section-231.html"><a href="section-231.html#section-233"><i class="fa fa-check"></i><b>51.3.1</b> 不成熟的小策略</a></li>
<li class="chapter" data-level="51.3.2" data-path="section-231.html"><a href="section-231.html#section-234"><i class="fa fa-check"></i><b>51.3.2</b> 補充</a></li>
</ul></li>
<li class="chapter" data-level="51.4" data-path="section-231.html"><a href="section-231.html#predictive-models"><i class="fa fa-check"></i><b>51.4</b> 分析目的 2 和 3 – 建立預測模型 (predictive models)</a></li>
</ul></li>
<li class="chapter" data-level="52" data-path="model-checking-glm.html"><a href="model-checking-glm.html"><i class="fa fa-check"></i><b>52</b> 檢查你的模型 Model Checking - GLM</a><ul>
<li class="chapter" data-level="52.1" data-path="model-checking-glm.html"><a href="model-checking-glm.html#section-235"><i class="fa fa-check"></i><b>52.1</b> 線性預測方程的定義</a><ul>
<li class="chapter" data-level="52.1.1" data-path="model-checking-glm.html"><a href="model-checking-glm.html#section-236"><i class="fa fa-check"></i><b>52.1.1</b> 殘差</a></li>
<li class="chapter" data-level="52.1.2" data-path="model-checking-glm.html"><a href="model-checking-glm.html#glm--r-"><i class="fa fa-check"></i><b>52.1.2</b> GLM 在 R 裏獲取殘差</a></li>
<li class="chapter" data-level="52.1.3" data-path="model-checking-glm.html"><a href="model-checking-glm.html#section-237"><i class="fa fa-check"></i><b>52.1.3</b> 如何利用獲得的殘差</a></li>
</ul></li>
<li class="chapter" data-level="52.2" data-path="model-checking-glm.html"><a href="model-checking-glm.html#covariate-pattern-residuals"><i class="fa fa-check"></i><b>52.2</b> 共變量模式殘差 covariate pattern residuals</a></li>
<li class="chapter" data-level="52.3" data-path="model-checking-glm.html"><a href="model-checking-glm.html#section-238"><i class="fa fa-check"></i><b>52.3</b> 鏈接方程</a></li>
<li class="chapter" data-level="52.4" data-path="model-checking-glm.html"><a href="model-checking-glm.html#NHANESdrinker"><i class="fa fa-check"></i><b>52.4</b> NHANES 飲酒量數據實例</a></li>
<li class="chapter" data-level="52.5" data-path="model-checking-glm.html"><a href="model-checking-glm.html#practical-10"><i class="fa fa-check"></i><b>52.5</b> Practical 10</a></li>
</ul></li>
<li class="chapter" data-level="53" data-path="assessing-model-performance.html"><a href="assessing-model-performance.html"><i class="fa fa-check"></i><b>53</b> 評價模型的表現 Assessing model performance</a><ul>
<li class="chapter" data-level="53.1" data-path="assessing-model-performance.html"><a href="assessing-model-performance.html#calibration"><i class="fa fa-check"></i><b>53.1</b> 精準度 calibration</a></li>
<li class="chapter" data-level="53.2" data-path="assessing-model-performance.html"><a href="assessing-model-performance.html#r2--1"><i class="fa fa-check"></i><b>53.2</b> 可解釋因變量的變異度及 <span class="math inline">\(R^2\)</span> 決定係數</a></li>
<li class="chapter" data-level="53.3" data-path="assessing-model-performance.html"><a href="assessing-model-performance.html#descrimination"><i class="fa fa-check"></i><b>53.3</b> 分辨能力 descrimination</a><ul>
<li class="chapter" data-level="53.3.1" data-path="assessing-model-performance.html"><a href="assessing-model-performance.html#section-239"><i class="fa fa-check"></i><b>53.3.1</b> 敏感度和特異度</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="54" data-path="section-240.html"><a href="section-240.html"><i class="fa fa-check"></i><b>54</b> 配對實驗數據的分析法</a><ul>
<li class="chapter" data-level="54.1" data-path="section-240.html"><a href="section-240.html#section-241"><i class="fa fa-check"></i><b>54.1</b> 配對的原理</a><ul>
<li class="chapter" data-level="54.1.1" data-path="section-240.html"><a href="section-240.html#section-242"><i class="fa fa-check"></i><b>54.1.1</b> 爲了提升估計的精確度</a></li>
<li class="chapter" data-level="54.1.2" data-path="section-240.html"><a href="section-240.html#section-243"><i class="fa fa-check"></i><b>54.1.2</b> 控制混雜因素</a></li>
</ul></li>
<li class="chapter" data-level="54.2" data-path="section-240.html"><a href="section-240.html#section-244"><i class="fa fa-check"></i><b>54.2</b> 結果變量爲連續型變量的配對實驗</a><ul>
<li class="chapter" data-level="54.2.1" data-path="section-240.html"><a href="section-240.html#section-245"><i class="fa fa-check"></i><b>54.2.1</b> 一般檢驗方法</a></li>
<li class="chapter" data-level="54.2.2" data-path="section-240.html"><a href="section-240.html#section-246"><i class="fa fa-check"></i><b>54.2.2</b> 用迴歸法分析</a></li>
</ul></li>
<li class="chapter" data-level="54.3" data-path="section-240.html"><a href="section-240.html#section-247"><i class="fa fa-check"></i><b>54.3</b> 結果變量是二分類變量的配對實驗</a><ul>
<li class="chapter" data-level="54.3.1" data-path="section-240.html"><a href="section-240.html#section-248"><i class="fa fa-check"></i><b>54.3.1</b> 第一步 對數據作表格</a></li>
<li class="chapter" data-level="54.3.2" data-path="section-240.html"><a href="section-240.html#mcnemars-test"><i class="fa fa-check"></i><b>54.3.2</b> McNemar’s test</a></li>
<li class="chapter" data-level="54.3.3" data-path="section-240.html"><a href="section-240.html#section-249"><i class="fa fa-check"></i><b>54.3.3</b> 二分類型結果變量配對實驗的比值比</a></li>
<li class="chapter" data-level="54.3.4" data-path="section-240.html"><a href="section-240.html#section-250"><i class="fa fa-check"></i><b>54.3.4</b> 配對實驗比值比的信賴區間</a></li>
</ul></li>
<li class="chapter" data-level="54.4" data-path="section-240.html"><a href="section-240.html#conditional--marginal-"><i class="fa fa-check"></i><b>54.4</b> 條件 (conditional) 比值比和邊際 (marginal) 比值比</a></li>
</ul></li>
<li class="chapter" data-level="55" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html"><i class="fa fa-check"></i><b>55</b> 條件邏輯迴歸 Conditional logistic regression</a><ul>
<li class="chapter" data-level="55.1" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-251"><i class="fa fa-check"></i><b>55.1</b> 配對實驗的邏輯迴歸模型</a><ul>
<li class="chapter" data-level="55.1.1" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-252"><i class="fa fa-check"></i><b>55.1.1</b> 配對病例對照研究</a></li>
<li class="chapter" data-level="55.1.2" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-253"><i class="fa fa-check"></i><b>55.1.2</b> 配對隊列研究</a></li>
</ul></li>
<li class="chapter" data-level="55.2" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-254"><i class="fa fa-check"></i><b>55.2</b> 條件邏輯回歸 – 二分類暴露變量</a><ul>
<li class="chapter" data-level="55.2.1" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#sufficient-statistics"><i class="fa fa-check"></i><b>55.2.1</b> 充分統計量 sufficient statistics</a></li>
<li class="chapter" data-level="55.2.2" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-255"><i class="fa fa-check"></i><b>55.2.2</b> 條件邏輯回歸的推導</a></li>
<li class="chapter" data-level="55.2.3" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#conditional-likelihood"><i class="fa fa-check"></i><b>55.2.3</b> 條件似然 conditional likelihood</a></li>
<li class="chapter" data-level="55.2.4" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-256"><i class="fa fa-check"></i><b>55.2.4</b> 進一步擴展</a></li>
</ul></li>
<li class="chapter" data-level="55.3" data-path="conditional-logistic-regression.html"><a href="conditional-logistic-regression.html#section-257"><i class="fa fa-check"></i><b>55.3</b> 條件邏輯回歸模型的一般化</a></li>
</ul></li>
<li class="chapter" data-level="56" data-path="multinomial-logistic-regression.html"><a href="multinomial-logistic-regression.html"><i class="fa fa-check"></i><b>56</b> Multinomial Logistic Regression</a></li>
<li class="chapter" data-level="57" data-path="ordinal-logistic-regression.html"><a href="ordinal-logistic-regression.html"><i class="fa fa-check"></i><b>57</b> Ordinal Logistic Regression</a></li>
<li class="part"><span><b>IX 等級線性迴歸模型 analysis of hierarchical and other dependent data</b></span></li>
<li class="chapter" data-level="58" data-path="Hierarchical.html"><a href="Hierarchical.html"><i class="fa fa-check"></i><b>58</b> 相互依賴數據及簡單的應對方案</a><ul>
<li class="chapter" data-level="58.1" data-path="Hierarchical.html"><a href="Hierarchical.html#section-258"><i class="fa fa-check"></i><b>58.1</b> 相互依賴的數據</a></li>
<li class="chapter" data-level="58.2" data-path="Hierarchical.html"><a href="Hierarchical.html#section-259"><i class="fa fa-check"></i><b>58.2</b> 依賴性的來源在哪裏</a></li>
<li class="chapter" data-level="58.3" data-path="Hierarchical.html"><a href="Hierarchical.html#section-260"><i class="fa fa-check"></i><b>58.3</b> 數據有依賴性導致的結果</a></li>
<li class="chapter" data-level="58.4" data-path="Hierarchical.html"><a href="Hierarchical.html#marginal-and-conditional-models"><i class="fa fa-check"></i><b>58.4</b> 邊際模型和條件模型 marginal and conditional models</a><ul>
<li class="chapter" data-level="58.4.1" data-path="Hierarchical.html"><a href="Hierarchical.html#notation"><i class="fa fa-check"></i><b>58.4.1</b> 標記法 notation</a></li>
<li class="chapter" data-level="58.4.2" data-path="Hierarchical.html"><a href="Hierarchical.html#section-261"><i class="fa fa-check"></i><b>58.4.2</b> 合並每個階層</a></li>
<li class="chapter" data-level="58.4.3" data-path="Hierarchical.html"><a href="Hierarchical.html#ecological-fallacy"><i class="fa fa-check"></i><b>58.4.3</b> 生物學悖論 ecological fallacy</a></li>
<li class="chapter" data-level="58.4.4" data-path="Hierarchical.html"><a href="Hierarchical.html#section-262"><i class="fa fa-check"></i><b>58.4.4</b> 分解層級數據</a></li>
<li class="chapter" data-level="58.4.5" data-path="Hierarchical.html"><a href="Hierarchical.html#fixed-effect-model"><i class="fa fa-check"></i><b>58.4.5</b> 固定效應模型 fixed effect model</a></li>
</ul></li>
<li class="chapter" data-level="58.5" data-path="Hierarchical.html"><a href="Hierarchical.html#section-263"><i class="fa fa-check"></i><b>58.5</b> 簡單線性迴歸複習</a></li>
<li class="chapter" data-level="58.6" data-path="Hierarchical.html"><a href="Hierarchical.html#section-264"><i class="fa fa-check"></i><b>58.6</b> 練習題</a><ul>
<li class="chapter" data-level="58.6.1" data-path="Hierarchical.html"><a href="Hierarchical.html#section-265"><i class="fa fa-check"></i><b>58.6.1</b> 數據</a></li>
<li class="chapter" data-level="58.6.2" data-path="Hierarchical.html"><a href="Hierarchical.html#section-266"><i class="fa fa-check"></i><b>58.6.2</b> 問題</a></li>
<li class="chapter" data-level="58.6.3" data-path="Hierarchical.html"><a href="Hierarchical.html#high-school-and-beyond--r-"><i class="fa fa-check"></i><b>58.6.3</b> 將 High-School-and-Beyond 數據導入 R 中，熟悉數據結構及內容，特別要注意觀察每個學校的學生特徵。</a></li>
<li class="chapter" data-level="58.6.4" data-path="Hierarchical.html"><a href="Hierarchical.html#ses-ses-"><i class="fa fa-check"></i><b>58.6.4</b> 爲了簡便起見，接下來的分析只節選數據中前五所學校 188 名學生的數學成績，和 SES。分別計算每所學校的數學成績,及 SES 的平均值。</a></li>
<li class="chapter" data-level="58.6.5" data-path="Hierarchical.html"><a href="Hierarchical.html#ses--total-regression-model"><i class="fa fa-check"></i><b>58.6.5</b> 先無視掉學校這一分層變量，把所有學生看作是相互獨立的，擬合總體的 SES 和數學成績的線性迴歸 <strong>(Total regression model)</strong>。把該總體模型的預測值提取並存儲在數據庫中。</a></li>
<li class="chapter" data-level="58.6.6" data-path="Hierarchical.html"><a href="Hierarchical.html#ses--between-regression-model"><i class="fa fa-check"></i><b>58.6.6</b> 用各個學校 SES 和數學成績的均值擬合一個學校間的線性迴歸模型 <strong>(between regression model)</strong>。</a></li>
<li class="chapter" data-level="58.6.7" data-path="Hierarchical.html"><a href="Hierarchical.html#ses-"><i class="fa fa-check"></i><b>58.6.7</b> 分別對每個學校內的學生進行 SES 和數學成績擬合線性迴歸模型。</a></li>
<li class="chapter" data-level="58.6.8" data-path="Hierarchical.html"><a href="Hierarchical.html#section-267"><i class="fa fa-check"></i><b>58.6.8</b> 比較三種模型計算的數學成績的擬合值，他們一致？還是有所不同？爲什麼會有不同？</a></li>
<li class="chapter" data-level="58.6.9" data-path="Hierarchical.html"><a href="Hierarchical.html#section-268"><i class="fa fa-check"></i><b>58.6.9</b> 把三種模型的數學成績擬合值散點圖繪製在同一張圖內。</a></li>
<li class="chapter" data-level="58.6.10" data-path="Hierarchical.html"><a href="Hierarchical.html#section-269"><i class="fa fa-check"></i><b>58.6.10</b> 用這 5 個學校的數據擬合一個固定效應線性迴歸模型</a></li>
<li class="chapter" data-level="58.6.11" data-path="Hierarchical.html"><a href="Hierarchical.html#pefr-"><i class="fa fa-check"></i><b>58.6.11</b> 讀入 PEFR 數據。</a></li>
<li class="chapter" data-level="58.6.12" data-path="Hierarchical.html"><a href="Hierarchical.html#wp-"><i class="fa fa-check"></i><b>58.6.12</b> 求每個患者的 <code>wp</code> 兩次測量平均值</a></li>
<li class="chapter" data-level="58.6.13" data-path="Hierarchical.html"><a href="Hierarchical.html#r--anova--wp--lme4lmer--id--std.dev-for-id-effect--anova--sqrtfractextmms-msen-n-"><i class="fa fa-check"></i><b>58.6.13</b> 在 R 裏先用 ANOVA 分析個人的 <code>wp</code> 變異。再用 <code>lme4::lmer</code> 擬合用 <code>id</code> 作隨機效應的混合效應模型。確認後者報告的 <code>Std.Dev for id effect</code> 其實可以用 ANOVA 結果的 <span class="math inline">\(\sqrt{\frac{\text{MMS-MSE}}{n}}\)</span> (n 是每個個體重複測量值的個數)。</a></li>
<li class="chapter" data-level="58.6.14" data-path="Hierarchical.html"><a href="Hierarchical.html#wp-id-"><i class="fa fa-check"></i><b>58.6.14</b> 擬合結果變量爲 <code>wp</code>，解釋變量爲 <code>id</code> 的簡單線性迴歸模型。用數學表達式描述這個模型。</a></li>
<li class="chapter" data-level="58.6.15" data-path="Hierarchical.html"><a href="Hierarchical.html#wp--1"><i class="fa fa-check"></i><b>58.6.15</b> 將 <code>wp</code> 中心化之後，重新擬合相同的模型，把截距去除掉。寫下這個模型的數學表達式。</a></li>
<li class="chapter" data-level="58.6.16" data-path="Hierarchical.html"><a href="Hierarchical.html#section-270"><i class="fa fa-check"></i><b>58.6.16</b> 計算這些迴歸係數 (其實是不同羣之間的隨機截距) 的均值和標準差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="59" data-path="random-intercept-model.html"><a href="random-intercept-model.html"><i class="fa fa-check"></i><b>59</b> 隨機截距模型 random intercept model</a><ul>
<li class="chapter" data-level="59.1" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-271"><i class="fa fa-check"></i><b>59.1</b> 隨機截距模型的定義</a></li>
<li class="chapter" data-level="59.2" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-272"><i class="fa fa-check"></i><b>59.2</b> 隨機截距模型的參數估計</a></li>
<li class="chapter" data-level="59.3" data-path="random-intercept-model.html"><a href="random-intercept-model.html#r--2"><i class="fa fa-check"></i><b>59.3</b> 如何在 R 中進行隨機截距模型的擬合</a></li>
<li class="chapter" data-level="59.4" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-273"><i class="fa fa-check"></i><b>59.4</b> 隨機截距模型中的統計推斷</a><ul>
<li class="chapter" data-level="59.4.1" data-path="random-intercept-model.html"><a href="random-intercept-model.html#fixed-inference"><i class="fa fa-check"></i><b>59.4.1</b> 固定效應部分的推斷</a></li>
<li class="chapter" data-level="59.4.2" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-274"><i class="fa fa-check"></i><b>59.4.2</b> 隨機效應部分的推斷</a></li>
</ul></li>
<li class="chapter" data-level="59.5" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-275"><i class="fa fa-check"></i><b>59.5</b> 練習題</a><ul>
<li class="chapter" data-level="59.5.1" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-276"><i class="fa fa-check"></i><b>59.5.1</b> 數據</a></li>
<li class="chapter" data-level="59.5.2" data-path="random-intercept-model.html"><a href="random-intercept-model.html#ghq--balanced"><i class="fa fa-check"></i><b>59.5.2</b> 讀入 GHQ 數據，探索其內容，該數據是否是平衡數據 (balanced)？計算每名學生的兩次問卷成績平均分。</a></li>
<li class="chapter" data-level="59.5.3" data-path="random-intercept-model.html"><a href="random-intercept-model.html#wide--long-"><i class="fa fa-check"></i><b>59.5.3</b> 把數據從寬 (wide) 改變成長 (long) 的形式</a></li>
<li class="chapter" data-level="59.5.4" data-path="random-intercept-model.html"><a href="random-intercept-model.html#id--anova"><i class="fa fa-check"></i><b>59.5.4</b> 對數據按照 <code>id</code> 分層進行 ANOVA</a></li>
<li class="chapter" data-level="59.5.5" data-path="random-intercept-model.html"><a href="random-intercept-model.html#r--nlme--restricted-maximum-likelihood-reml--anova-"><i class="fa fa-check"></i><b>59.5.5</b> 用 R 裏的 <code>nlme</code> 包，使用限制性極大似然法 (restricted maximum likelihood, REML) 擬合截距混合效應模型，比較其結果和前文中隨機效應 ANOVA 的結果</a></li>
<li class="chapter" data-level="59.5.6" data-path="random-intercept-model.html"><a href="random-intercept-model.html#maximum-likelihood-ml-method-ml-"><i class="fa fa-check"></i><b>59.5.6</b> 用極大似然法 (maximum likelihood, ML) <code>method = "ML"</code> 重新擬合前面的混合效應模型，比較結果有什麼不同。</a></li>
<li class="chapter" data-level="59.5.7" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-277"><i class="fa fa-check"></i><b>59.5.7</b> 用簡單線性迴歸擬合一個固定效應模型</a></li>
<li class="chapter" data-level="59.5.8" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-278"><i class="fa fa-check"></i><b>59.5.8</b> 計算這些隨機截距的均值和標準差</a></li>
<li class="chapter" data-level="59.5.9" data-path="random-intercept-model.html"><a href="random-intercept-model.html#ghq-"><i class="fa fa-check"></i><b>59.5.9</b> 忽略掉所有的分層和解釋變量擬合 <code>GHQ</code> 的簡單線性迴歸</a></li>
<li class="chapter" data-level="59.5.10" data-path="random-intercept-model.html"><a href="random-intercept-model.html#section-279"><i class="fa fa-check"></i><b>59.5.10</b> 用分層的穩健法 (三明治標準誤法) 計算簡單線性迴歸時，截距的標準誤差，和簡單線性迴歸時的結果作比較</a></li>
<li class="chapter" data-level="59.5.11" data-path="random-intercept-model.html"><a href="random-intercept-model.html#siblings--ml-reml"><i class="fa fa-check"></i><b>59.5.11</b> 讀入 <code>siblings</code> 數據。先總結嬰兒的出生體重，思考這個數據中嬰兒出生體重之間是否可能存在關聯性？它的來源是哪裏。用這個數據擬合兩個混合效應模型 (ML, REML)，不加入任何解釋變量。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="60" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html"><i class="fa fa-check"></i><b>60</b> 隨機截距模型中加入共變量 random intercept model with covariates</a><ul>
<li class="chapter" data-level="60.1" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-280"><i class="fa fa-check"></i><b>60.1</b> 多元線性回歸模型的延伸</a></li>
<li class="chapter" data-level="60.2" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#siblings-"><i class="fa fa-check"></i><b>60.2</b> <code>siblings</code> 數據中新生兒體重的實例</a></li>
<li class="chapter" data-level="60.3" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-281"><i class="fa fa-check"></i><b>60.3</b> 賦值予隨機效應成分</a><ul>
<li class="chapter" data-level="60.3.1" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#simple-prediction"><i class="fa fa-check"></i><b>60.3.1</b> 簡單預測 simple prediction</a></li>
<li class="chapter" data-level="60.3.2" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#eb-"><i class="fa fa-check"></i><b>60.3.2</b> EB 預測值</a></li>
</ul></li>
<li class="chapter" data-level="60.4" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-282"><i class="fa fa-check"></i><b>60.4</b> 混合效應模型的診斷</a></li>
<li class="chapter" data-level="60.5" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#cluster-levellevel-2-"><i class="fa fa-check"></i><b>60.5</b> 第二層級 (cluster level/level 2) 的協方差</a></li>
<li class="chapter" data-level="60.6" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-283"><i class="fa fa-check"></i><b>60.6</b> 層內層間效應估計</a></li>
<li class="chapter" data-level="60.7" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-284"><i class="fa fa-check"></i><b>60.7</b> 到底選擇固定還是混合模型？</a></li>
<li class="chapter" data-level="60.8" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-285"><i class="fa fa-check"></i><b>60.8</b> 練習題目</a><ul>
<li class="chapter" data-level="60.8.1" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#high-school-and-beyond--r--1"><i class="fa fa-check"></i><b>60.8.1</b> 把 High-school-and-Beyond 數據讀入 R 中。</a></li>
<li class="chapter" data-level="60.8.2" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#ml-reml-mathach-ses"><i class="fa fa-check"></i><b>60.8.2</b> 擬合兩個隨機截距模型 (ML, REML)，結果變量用 <code>mathach</code>，解釋變量用 <code>ses</code>。觀察結果是否不同。</a></li>
<li class="chapter" data-level="60.8.3" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#sector--hatsigma_u-hatsigma_e-mlreml-"><i class="fa fa-check"></i><b>60.8.3</b> 觀察學校類型是否爲天主教學校 <code>sector</code> 的分佈，把它加入剛擬合的兩個隨機截距模型，它們估計的隨機效應標準差 <span class="math inline">\(\hat\sigma_u\)</span>，和隨機誤差標準差 <span class="math inline">\(\hat\sigma_e\)</span>，和之前有什麼不同？ “ML，REML” 的選用對結果有影響嗎？</a></li>
<li class="chapter" data-level="60.8.4" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#size--100-100"><i class="fa fa-check"></i><b>60.8.4</b> 現在把學校規模 <code>size</code> 這一變量加入混合效應模型的固定效應部分，記得先把該變量中心化，並除以 100，會有助於對結果的解釋 (比平均值每增加100名學生)。仔細觀察模型結果中隨機效應標準差和隨機誤差標準殘差的變化。</a></li>
<li class="chapter" data-level="60.8.5" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#sizesector-"><i class="fa fa-check"></i><b>60.8.5</b> 在模型的固定效應部分增加 <code>size*sector</code> 的交互作用項。觀察輸出結果中該交互作用項是否有意義。用什麼檢驗方法判斷這個交互作用項能否幫助模型更加擬合數據？</a></li>
<li class="chapter" data-level="60.8.6" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-286"><i class="fa fa-check"></i><b>60.8.6</b> 把上面八個模型估計的隨機效應標準差，和隨機誤差標準差總結成表格，它們之間有什麼規律嗎？</a></li>
<li class="chapter" data-level="60.8.7" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#female-minority--hatsigma_u-hatsigma_e-"><i class="fa fa-check"></i><b>60.8.7</b> 在混合效應模型的固定效應部分增加學生性別 <code>female</code>，和學生是否是少數族裔 <code>minority</code> 兩個變量。再觀察 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span> 是否發生變化？</a></li>
<li class="chapter" data-level="60.8.8" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#sector--hatsigma_u-hatsigma_e"><i class="fa fa-check"></i><b>60.8.8</b> 檢查學生性別和族裔是否和學校是否是天主教會學校有關係，先作分類型數據的分佈表格，然後把它們各自與 <code>sector</code> 的交互作用項加入混合效應模型中的固定效應部分，記錄下此時的 <span class="math inline">\(\hat\sigma_u, \hat\sigma_e\)</span></a></li>
<li class="chapter" data-level="60.8.9" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-287"><i class="fa fa-check"></i><b>60.8.9</b> 對上面最後一個模型進行殘差分析和模型的診斷。</a></li>
<li class="chapter" data-level="60.8.10" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#section-288"><i class="fa fa-check"></i><b>60.8.10</b> 通過剛剛所求的隨機效應方差的殘差，確認哪個學校存在相對極端的值。</a></li>
<li class="chapter" data-level="60.8.11" data-path="random-intercept-model-with-covariates.html"><a href="random-intercept-model-with-covariates.html#ses--ses"><i class="fa fa-check"></i><b>60.8.11</b> 計算學校水平的 SES 平均值，以及每個學生自己和所在學校均值之間的差值大小。分別擬合兩個不同的混合效應模型，一個只用 <code>SES</code>，另一個換做使用新計算的組均值和組內均差。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="61" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html"><i class="fa fa-check"></i><b>61</b> 隨機回歸系數模型 random coefficient model</a><ul>
<li class="chapter" data-level="61.1" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#gcse-scores-"><i class="fa fa-check"></i><b>61.1</b> GCSE scores 實例</a></li>
<li class="chapter" data-level="61.2" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#section-289"><i class="fa fa-check"></i><b>61.2</b> 隨機回歸系數的實質</a></li>
<li class="chapter" data-level="61.3" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#gcse-scores--1"><i class="fa fa-check"></i><b>61.3</b> 繼續 GCSE scores 實例</a></li>
<li class="chapter" data-level="61.4" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#section-290"><i class="fa fa-check"></i><b>61.4</b> 使用模型結果推斷</a></li>
<li class="chapter" data-level="61.5" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#random-var"><i class="fa fa-check"></i><b>61.5</b> 隨機效應的方差</a></li>
<li class="chapter" data-level="61.6" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#section-291"><i class="fa fa-check"></i><b>61.6</b> 模型效果評估</a></li>
<li class="chapter" data-level="61.7" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#section-292"><i class="fa fa-check"></i><b>61.7</b> 練習題</a><ul>
<li class="chapter" data-level="61.7.1" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#gcse-lrt-"><i class="fa fa-check"></i><b>61.7.1</b> 先忽略學校編號爲 48 的學校，擬合一個只有固定效應 (簡單線性回歸模型)，結果變量是 GCSE，解釋變量是 LRT 和學校。</a></li>
<li class="chapter" data-level="61.7.2" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#lrt-"><i class="fa fa-check"></i><b>61.7.2</b> 僅有固定效應模型的學校變量變更爲學校類型 (男校女校或混合校)，從這個新模型的結果來看，你是否認爲學校類型，和學校編號本身相比能夠解釋相同的學校層面的方差？ <code>lrt</code> 的估計回歸參數發生了怎樣的變化？</a></li>
<li class="chapter" data-level="61.7.3" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#log-likelihood-lmertestrand-"><i class="fa fa-check"></i><b>61.7.3</b> 使用限制性極大似然法擬合一個隨機截距模型。記錄此時的限制性對數似然的大小 (log-likelihood)。用 <code>lmerTest::rand</code> 命令對隨機效應部分的方差是否爲零做檢驗，指明該檢驗的零假設是什麼，並解釋其結果的含義。</a></li>
<li class="chapter" data-level="61.7.4" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#schgend-"><i class="fa fa-check"></i><b>61.7.4</b> 在前一題的隨機截距模型中加入 <code>schgend</code> 變量，作爲解釋隨機截距的一個自變量，觀察輸出結果，解釋其是否有意義。記錄這個模型的限制性似然。</a></li>
<li class="chapter" data-level="61.7.5" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#lrt--1"><i class="fa fa-check"></i><b>61.7.5</b> 擬合隨機截距隨機斜率模型，固定效應部分的 <code>lrt</code> 也加入進隨機效應部分。</a></li>
<li class="chapter" data-level="61.7.6" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#section-293"><i class="fa fa-check"></i><b>61.7.6</b> 通過上面幾個模型計算獲得的似然，嘗試檢驗隨機斜率標準差，以及該標準差和隨機截距標準差的協相關是否有意義。</a></li>
<li class="chapter" data-level="61.7.7" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#schgend--mean_girl-"><i class="fa fa-check"></i><b>61.7.7</b> 模型中的 <code>schgend</code> 改成 <code>mean_girl</code> 會給出怎樣的結果呢？</a></li>
<li class="chapter" data-level="61.7.8" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#gcse-lrt"><i class="fa fa-check"></i><b>61.7.8</b> 現在我們把注意力改爲關心學校編號爲 48 的學校的情況。用且禁用它一所學校的數據，擬合一個簡單線性回歸，結果變量是 <code>gcse</code>，解釋變量是 <code>lrt</code>。</a></li>
<li class="chapter" data-level="61.7.9" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#fixed_reml2-"><i class="fa fa-check"></i><b>61.7.9</b> 這次不排除 48 號學校，擬合所有學校的數據進入 <code>Fixed_reml2</code> 模型中去，結果有發生顯著的變化嗎？</a></li>
<li class="chapter" data-level="61.7.10" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#level-2-school-level"><i class="fa fa-check"></i><b>61.7.10</b> 計算這個模型的第二階級(level 2, <code>school</code> level)的殘差。</a></li>
<li class="chapter" data-level="61.7.11" data-path="random-coefficient-model.html"><a href="random-coefficient-model.html#level-1-student48"><i class="fa fa-check"></i><b>61.7.11</b> 計算這個模型的第一階級(level 1, student)殘差，分析其分布，查看第48所學校的殘差表現如何。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="62" data-path="longitudinal-data-1.html"><a href="longitudinal-data-1.html"><i class="fa fa-check"></i><b>62</b> 縱向研究數據 longitudinal data 1</a><ul>
<li class="chapter" data-level="62.1" data-path="longitudinal-data-1.html"><a href="longitudinal-data-1.html#fixed-occasions"><i class="fa fa-check"></i><b>62.1</b> 固定測量時刻 fixed occasions</a><ul>
<li class="chapter" data-level="62.1.1" data-path="longitudinal-data-1.html"><a href="longitudinal-data-1.html#missing-data"><i class="fa fa-check"></i><b>62.1.1</b> 缺失值 Missing data</a></li>
</ul></li>
<li class="chapter" data-level="62.2" data-path="longitudinal-data-1.html"><a href="longitudinal-data-1.html#variable-occasions"><i class="fa fa-check"></i><b>62.2</b> 不固定測量時刻 variable occasions</a></li>
<li class="chapter" data-level="62.3" data-path="longitudinal-data-1.html"><a href="longitudinal-data-1.html#predicting-trajectories"><i class="fa fa-check"></i><b>62.3</b> 預測軌跡 predicting trajectories</a></li>
<li class="chapter" data-level="62.4" data-path="longitudinal-data-1.html"><a href="longitudinal-data-1.html#practical-05-hier"><i class="fa fa-check"></i><b>62.4</b> Practical 05-Hier</a></li>
</ul></li>
<li class="chapter" data-level="63" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html"><i class="fa fa-check"></i><b>63</b> 縱向研究數據 longitudinal data 2</a><ul>
<li class="chapter" data-level="63.1" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#marginal-structures"><i class="fa fa-check"></i><b>63.1</b> 邊際結構 marginal structures</a><ul>
<li class="chapter" data-level="63.1.1" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-294"><i class="fa fa-check"></i><b>63.1.1</b> 隨機截距模型</a></li>
<li class="chapter" data-level="63.1.2" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-295"><i class="fa fa-check"></i><b>63.1.2</b> 隨機系數模型</a></li>
</ul></li>
<li class="chapter" data-level="63.2" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-296"><i class="fa fa-check"></i><b>63.2</b> 矩陣記法</a></li>
<li class="chapter" data-level="63.3" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-297"><i class="fa fa-check"></i><b>63.3</b> 混合效應模型的一般化公式</a></li>
<li class="chapter" data-level="63.4" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-298"><i class="fa fa-check"></i><b>63.4</b> 其他可選擇的方差協方差矩陣特徵</a></li>
<li class="chapter" data-level="63.5" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-299"><i class="fa fa-check"></i><b>63.5</b> 其他要點評論</a></li>
<li class="chapter" data-level="63.6" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#section-300"><i class="fa fa-check"></i><b>63.6</b> 不平衡數據</a></li>
<li class="chapter" data-level="63.7" data-path="longitudinal-data-2.html"><a href="longitudinal-data-2.html#practical-06-hier"><i class="fa fa-check"></i><b>63.7</b> Practical 06-Hier</a></li>
</ul></li>
<li class="chapter" data-level="64" data-path="longitudinal-data-3.html"><a href="longitudinal-data-3.html"><i class="fa fa-check"></i><b>64</b> 縱向研究數據 longitudinal data 3</a><ul>
<li class="chapter" data-level="64.1" data-path="longitudinal-data-3.html"><a href="longitudinal-data-3.html#level-1-heterogeneity"><i class="fa fa-check"></i><b>64.1</b> 第一層級的異質性 level 1 heterogeneity</a></li>
<li class="chapter" data-level="64.2" data-path="longitudinal-data-3.html"><a href="longitudinal-data-3.html#level-2-heterogeneity"><i class="fa fa-check"></i><b>64.2</b> 第二層級異質性 level 2 heterogeneity</a></li>
<li class="chapter" data-level="64.3" data-path="longitudinal-data-3.html"><a href="longitudinal-data-3.html#section-301"><i class="fa fa-check"></i><b>64.3</b> 分析策略</a><ul>
<li class="chapter" data-level="64.3.1" data-path="longitudinal-data-3.html"><a href="longitudinal-data-3.html#section-302"><i class="fa fa-check"></i><b>64.3.1</b> 模型選擇和建模步驟</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="65" data-path="generalized-estimating-equation.html"><a href="generalized-estimating-equation.html"><i class="fa fa-check"></i><b>65</b> Generalized Estimating Equation</a></li>
<li class="chapter" data-level="66" data-path="cluster-analysisunsupervised-learning-.html"><a href="cluster-analysisunsupervised-learning-.html"><i class="fa fa-check"></i><b>66</b> Cluster analysis/unsupervised learning 聚類分析</a></li>
<li class="chapter" data-level="67" data-path="missing-data-1.html"><a href="missing-data-1.html"><i class="fa fa-check"></i><b>67</b> Missing data 1</a></li>
<li class="chapter" data-level="68" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>68</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="69" data-path="missing-data-2.html"><a href="missing-data-2.html"><i class="fa fa-check"></i><b>69</b> Missing data 2</a></li>
<li class="chapter" data-level="70" data-path="further-issues.html"><a href="further-issues.html"><i class="fa fa-check"></i><b>70</b> Further issues</a></li>
<li class="part"><span><b>X 生存分析 survival analysis</b></span></li>
<li class="chapter" data-level="71" data-path="section-303.html"><a href="section-303.html"><i class="fa fa-check"></i><b>71</b> 生存分析入門</a><ul>
<li class="chapter" data-level="71.1" data-path="section-303.html"><a href="section-303.html#section-304"><i class="fa fa-check"></i><b>71.1</b> 什麼是生存分析</a></li>
<li class="chapter" data-level="71.2" data-path="section-303.html"><a href="section-303.html#section-305"><i class="fa fa-check"></i><b>71.2</b> 生存數據在哪裏</a></li>
<li class="chapter" data-level="71.3" data-path="section-303.html"><a href="section-303.html#section-306"><i class="fa fa-check"></i><b>71.3</b> 生存數據分析之前要理清楚的問題</a></li>
<li class="chapter" data-level="71.4" data-path="section-303.html"><a href="section-303.html#section-307"><i class="fa fa-check"></i><b>71.4</b> 生存數據的左右截尾</a><ul>
<li class="chapter" data-level="71.4.1" data-path="section-303.html"><a href="section-303.html#left-truncation"><i class="fa fa-check"></i><b>71.4.1</b> 左側截尾數據 left-truncation</a></li>
</ul></li>
<li class="chapter" data-level="71.5" data-path="section-303.html"><a href="section-303.html#section-308"><i class="fa fa-check"></i><b>71.5</b> 初步分析生存數據</a></li>
<li class="chapter" data-level="71.6" data-path="section-303.html"><a href="section-303.html#section-309"><i class="fa fa-check"></i><b>71.6</b> 初步描述生存數據</a><ul>
<li class="chapter" data-level="71.6.1" data-path="section-303.html"><a href="section-303.html#section-310"><i class="fa fa-check"></i><b>71.6.1</b> 生存方程</a></li>
<li class="chapter" data-level="71.6.2" data-path="section-303.html"><a href="section-303.html#section-311"><i class="fa fa-check"></i><b>71.6.2</b> 風險度方程</a></li>
<li class="chapter" data-level="71.6.3" data-path="section-303.html"><a href="section-303.html#section-312"><i class="fa fa-check"></i><b>71.6.3</b> 概率密度方程</a></li>
<li class="chapter" data-level="71.6.4" data-path="section-303.html"><a href="section-303.html#section-313"><i class="fa fa-check"></i><b>71.6.4</b> 各方程之間的關系</a></li>
</ul></li>
<li class="chapter" data-level="71.7" data-path="section-303.html"><a href="section-303.html#section-314"><i class="fa fa-check"></i><b>71.7</b> 生存時間的參數分布</a><ul>
<li class="chapter" data-level="71.7.1" data-path="section-303.html"><a href="section-303.html#section-315"><i class="fa fa-check"></i><b>71.7.1</b> 指數分布</a></li>
<li class="chapter" data-level="71.7.2" data-path="section-303.html"><a href="section-303.html#weibull-"><i class="fa fa-check"></i><b>71.7.2</b> Weibull 分布</a></li>
</ul></li>
<li class="chapter" data-level="71.8" data-path="section-303.html"><a href="section-303.html#section-316"><i class="fa fa-check"></i><b>71.8</b> 極大似然法估計</a></li>
<li class="chapter" data-level="71.9" data-path="section-303.html"><a href="section-303.html#practical-survival-01"><i class="fa fa-check"></i><b>71.9</b> Practical Survival 01</a><ul>
<li class="chapter" data-level="71.9.1" data-path="section-303.html"><a href="section-303.html#section-317"><i class="fa fa-check"></i><b>71.9.1</b> 生存分析的時間尺度</a></li>
<li class="chapter" data-level="71.9.2" data-path="section-303.html"><a href="section-303.html#section-321"><i class="fa fa-check"></i><b>71.9.2</b> 擬合最簡單的指數分布生存數據</a></li>
<li class="chapter" data-level="71.9.3" data-path="section-303.html"><a href="section-303.html#weibull--1"><i class="fa fa-check"></i><b>71.9.3</b> 探索服從 Weibull 分布時風險度方程的曲線</a></li>
<li class="chapter" data-level="71.9.4" data-path="section-303.html"><a href="section-303.html#log-logistic-"><i class="fa fa-check"></i><b>71.9.4</b> 探索 對數邏輯 (log-logistic) 分布時，風險度方程曲線會有哪些特性？</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="72" data-path="nonparametric.html"><a href="nonparametric.html"><i class="fa fa-check"></i><b>72</b> 非參數法分析生存數據</a><ul>
<li class="chapter" data-level="72.1" data-path="nonparametric.html"><a href="nonparametric.html#section-322"><i class="fa fa-check"></i><b>72.1</b> 生存分析中的非參數分析法</a></li>
<li class="chapter" data-level="72.2" data-path="nonparametric.html"><a href="nonparametric.html#kaplan-meier-"><i class="fa fa-check"></i><b>72.2</b> Kaplan-Meier 法分析生存方程</a><ul>
<li class="chapter" data-level="72.2.1" data-path="nonparametric.html"><a href="nonparametric.html#section-323"><i class="fa fa-check"></i><b>72.2.1</b> 當數據中沒有刪失值</a></li>
<li class="chapter" data-level="72.2.2" data-path="nonparametric.html"><a href="nonparametric.html#section-324"><i class="fa fa-check"></i><b>72.2.2</b> 當數據中有刪失值</a></li>
</ul></li>
<li class="chapter" data-level="72.3" data-path="nonparametric.html"><a href="nonparametric.html#kaplan-meier--1"><i class="fa fa-check"></i><b>72.3</b> Kaplan-Meier 數據的不確定性</a></li>
<li class="chapter" data-level="72.4" data-path="nonparametric.html"><a href="nonparametric.html#section-325"><i class="fa fa-check"></i><b>72.4</b> 另一種非參數法分析 – 生命表格估計</a></li>
<li class="chapter" data-level="72.5" data-path="nonparametric.html"><a href="nonparametric.html#section-326"><i class="fa fa-check"></i><b>72.5</b> 兩組之間生存概率的比較</a><ul>
<li class="chapter" data-level="72.5.1" data-path="nonparametric.html"><a href="nonparametric.html#the-log-rank-test"><i class="fa fa-check"></i><b>72.5.1</b> The log rank test</a></li>
</ul></li>
<li class="chapter" data-level="72.6" data-path="nonparametric.html"><a href="nonparametric.html#cumulative-hazard"><i class="fa fa-check"></i><b>72.6</b> 計算累積風險度 cumulative hazard</a></li>
<li class="chapter" data-level="72.7" data-path="nonparametric.html"><a href="nonparametric.html#practical-02---survival-analysis"><i class="fa fa-check"></i><b>72.7</b> Practical 02 - survival analysis</a></li>
</ul></li>
<li class="chapter" data-level="73" data-path="section-327.html"><a href="section-327.html"><i class="fa fa-check"></i><b>73</b> 生存數據中的回歸模型</a><ul>
<li class="chapter" data-level="73.1" data-path="section-327.html"><a href="section-327.html#section-328"><i class="fa fa-check"></i><b>73.1</b> 生存數據的似然方程</a></li>
<li class="chapter" data-level="73.2" data-path="section-327.html"><a href="section-327.html#section-329"><i class="fa fa-check"></i><b>73.2</b> 如何加入解釋變量</a></li>
<li class="chapter" data-level="73.3" data-path="section-327.html"><a href="section-327.html#exponential-model"><i class="fa fa-check"></i><b>73.3</b> 指數模型 exponential model</a></li>
<li class="chapter" data-level="73.4" data-path="section-327.html"><a href="section-327.html#weibull--2"><i class="fa fa-check"></i><b>73.4</b> Weibull 分布</a></li>
<li class="chapter" data-level="73.5" data-path="section-327.html"><a href="section-327.html#weibull--"><i class="fa fa-check"></i><b>73.5</b> Weibull 和 指數模型的比較</a><ul>
<li class="chapter" data-level="73.5.1" data-path="section-327.html"><a href="section-327.html#section-330"><i class="fa fa-check"></i><b>73.5.1</b> 繪圖法</a></li>
<li class="chapter" data-level="73.5.2" data-path="section-327.html"><a href="section-327.html#section-331"><i class="fa fa-check"></i><b>73.5.2</b> 統計檢驗法</a></li>
</ul></li>
<li class="chapter" data-level="73.6" data-path="section-327.html"><a href="section-327.html#section-332"><i class="fa fa-check"></i><b>73.6</b> 多於 1 個解釋變量的參數模型</a></li>
<li class="chapter" data-level="73.7" data-path="section-327.html"><a href="section-327.html#practical-survival-03"><i class="fa fa-check"></i><b>73.7</b> Practical Survival 03</a></li>
</ul></li>
<li class="chapter" data-level="74" data-path="cox-.html"><a href="cox-.html"><i class="fa fa-check"></i><b>74</b> Cox 比例風險模型</a><ul>
<li class="chapter" data-level="74.1" data-path="cox-.html"><a href="cox-.html#section-333"><i class="fa fa-check"></i><b>74.1</b> 該用半參數模型還是用全參數模型</a></li>
</ul></li>
<li class="chapter" data-level="75" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html"><i class="fa fa-check"></i><b>75</b> 分析策略和模型檢查 Model checking-survival analysis</a><ul>
<li class="chapter" data-level="75.1" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#section-334"><i class="fa fa-check"></i><b>75.1</b> 生存分析策略</a></li>
<li class="chapter" data-level="75.2" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#section-335"><i class="fa fa-check"></i><b>75.2</b> 針對臨床實驗</a></li>
<li class="chapter" data-level="75.3" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#section-336"><i class="fa fa-check"></i><b>75.3</b> 針對觀察性研究</a></li>
<li class="chapter" data-level="75.4" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#section-337"><i class="fa fa-check"></i><b>75.4</b> 模型檢查的要點</a></li>
<li class="chapter" data-level="75.5" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#check-the-proportional-hazard-assumtion"><i class="fa fa-check"></i><b>75.5</b> 比例風險假設的檢查 check the proportional hazard assumtion</a><ul>
<li class="chapter" data-level="75.5.1" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#section-338"><i class="fa fa-check"></i><b>75.5.1</b> 比例風險檢查的統計檢驗法</a></li>
<li class="chapter" data-level="75.5.2" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#schoenfeld-"><i class="fa fa-check"></i><b>75.5.2</b> 用 Schoenfeld 殘差繪圖</a></li>
</ul></li>
<li class="chapter" data-level="75.6" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#section-339"><i class="fa fa-check"></i><b>75.6</b> 評價模型擬合的其他有趣方法</a><ul>
<li class="chapter" data-level="75.6.1" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#martingale--assessing-the-functional-form-of-continuous-variables"><i class="fa fa-check"></i><b>75.6.1</b> Martingale 殘差-assessing the functional form of continuous variables</a></li>
<li class="chapter" data-level="75.6.2" data-path="model-checking-survival-analysis.html"><a href="model-checking-survival-analysis.html#deviance--identifying-individuals-for-whom-the-model-does-not-provide-a-good-fit"><i class="fa fa-check"></i><b>75.6.2</b> Deviance 偏差殘差 – identifying individuals for whom the model does not provide a good fit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="76" data-path="competing-risk.html"><a href="competing-risk.html"><i class="fa fa-check"></i><b>76</b> 競爭風險模型 competing risk</a><ul>
<li class="chapter" data-level="76.1" data-path="competing-risk.html"><a href="competing-risk.html#cause-specific-hazard"><i class="fa fa-check"></i><b>76.1</b> Cause-specific hazard</a><ul>
<li class="chapter" data-level="76.1.1" data-path="competing-risk.html"><a href="competing-risk.html#cause-specific-hazards-models"><i class="fa fa-check"></i><b>76.1.1</b> Cause-specific hazards models</a></li>
</ul></li>
<li class="chapter" data-level="76.2" data-path="competing-risk.html"><a href="competing-risk.html#cumulative-incidence-function"><i class="fa fa-check"></i><b>76.2</b> Cumulative incidence function</a></li>
<li class="chapter" data-level="76.3" data-path="competing-risk.html"><a href="competing-risk.html#subdistribution-hazard---fine-and-gray-model"><i class="fa fa-check"></i><b>76.3</b> Subdistribution hazard - Fine and Gray model</a><ul>
<li class="chapter" data-level="76.3.1" data-path="competing-risk.html"><a href="competing-risk.html#subdistribution-hazard-model"><i class="fa fa-check"></i><b>76.3.1</b> Subdistribution hazard model</a></li>
</ul></li>
<li class="chapter" data-level="76.4" data-path="competing-risk.html"><a href="competing-risk.html#multi-state-models"><i class="fa fa-check"></i><b>76.4</b> Multi-state models</a><ul>
<li class="chapter" data-level="76.4.1" data-path="competing-risk.html"><a href="competing-risk.html#the-markov-model"><i class="fa fa-check"></i><b>76.4.1</b> The Markov model</a></li>
<li class="chapter" data-level="76.4.2" data-path="competing-risk.html"><a href="competing-risk.html#cox-proportional-hazards-model-for-transition-intensities"><i class="fa fa-check"></i><b>76.4.2</b> Cox proportional hazards model for transition intensities</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="77" data-path="section-340.html"><a href="section-340.html"><i class="fa fa-check"></i><b>77</b> 生存分析的其他手段</a><ul>
<li class="chapter" data-level="77.1" data-path="section-340.html"><a href="section-340.html#cox-stratified-cox-proportional-hazards-model"><i class="fa fa-check"></i><b>77.1</b> 分層Cox生存分析 stratified Cox proportional hazards model</a></li>
<li class="chapter" data-level="77.2" data-path="section-340.html"><a href="section-340.html#accelerated-failure-time-aft-model"><i class="fa fa-check"></i><b>77.2</b> 加速失效模型 Accelerated failure time (AFT) model</a><ul>
<li class="chapter" data-level="77.2.1" data-path="section-340.html"><a href="section-340.html#weibull--aft-"><i class="fa fa-check"></i><b>77.2.1</b> Weibull 模型也是一種 AFT 模型</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="78" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html"><i class="fa fa-check"></i><b>78</b> 時間依存變量 Time-dependent variables 和脆弱模型 frailty model</a><ul>
<li class="chapter" data-level="78.1" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#section-341"><i class="fa fa-check"></i><b>78.1</b> 時間依存變量指的是什麼</a></li>
<li class="chapter" data-level="78.2" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#extended-cox-model-cox"><i class="fa fa-check"></i><b>78.2</b> Extended Cox model 把Cox模型擴展開去</a><ul>
<li class="chapter" data-level="78.2.1" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#exercise-8.1"><i class="fa fa-check"></i><b>78.2.1</b> 練習題 exercise 8.1</a></li>
<li class="chapter" data-level="78.2.2" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#section-342"><i class="fa fa-check"></i><b>78.2.2</b> 解答</a></li>
</ul></li>
<li class="chapter" data-level="78.3" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#section-343"><i class="fa fa-check"></i><b>78.3</b> 時間依存變量數據的結構</a><ul>
<li class="chapter" data-level="78.3.1" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#section-344"><i class="fa fa-check"></i><b>78.3.1</b> 值得注意的點</a></li>
</ul></li>
<li class="chapter" data-level="78.4" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#frailty-models-"><i class="fa fa-check"></i><b>78.4</b> Frailty Models (脆弱模型?)</a><ul>
<li class="chapter" data-level="78.4.1" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#individual-frailty-model"><i class="fa fa-check"></i><b>78.4.1</b> Individual frailty model</a></li>
<li class="chapter" data-level="78.4.2" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#application-to-a-weibull-model"><i class="fa fa-check"></i><b>78.4.2</b> Application to a Weibull model</a></li>
<li class="chapter" data-level="78.4.3" data-path="time-dependent-variables-frailty-model.html"><a href="time-dependent-variables-frailty-model.html#shared-frailty-model"><i class="fa fa-check"></i><b>78.4.3</b> Shared frailty model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="79" data-path="section-345.html"><a href="section-345.html"><i class="fa fa-check"></i><b>79</b> 時間事件數據的高級分析法</a></li>
<li class="part"><span><b>XI 貝葉斯統計學 Bayesian Statistics</b></span></li>
<li class="chapter" data-level="80" data-path="section-346.html"><a href="section-346.html"><i class="fa fa-check"></i><b>80</b> 爲什麼我們要用貝葉斯統計學方法？</a><ul>
<li class="chapter" data-level="80.1" data-path="section-346.html"><a href="section-346.html#methotrexate--systematic-sclerosis-ssc-"><i class="fa fa-check"></i><b>80.1</b> 氨甲喋呤 (methotrexate) 在系統性硬皮病 (systematic sclerosis, SSc) 中的療效</a><ul>
<li class="chapter" data-level="80.1.1" data-path="section-346.html"><a href="section-346.html#ssc-trial"><i class="fa fa-check"></i><b>80.1.1</b> 背景資料-SSc trial</a></li>
<li class="chapter" data-level="80.1.2" data-path="section-346.html"><a href="section-346.html#section-347"><i class="fa fa-check"></i><b>80.1.2</b> 概率論者分析結果</a></li>
<li class="chapter" data-level="80.1.3" data-path="section-346.html"><a href="section-346.html#section-348"><i class="fa fa-check"></i><b>80.1.3</b> 貝葉斯統計分析結果</a></li>
</ul></li>
<li class="chapter" data-level="80.2" data-path="section-346.html"><a href="section-346.html#example-the-great-trial"><i class="fa fa-check"></i><b>80.2</b> Example: The GREAT trial</a><ul>
<li class="chapter" data-level="80.2.1" data-path="section-346.html"><a href="section-346.html#background-great-trial"><i class="fa fa-check"></i><b>80.2.1</b> Background (GREAT trial)</a></li>
<li class="chapter" data-level="80.2.2" data-path="section-346.html"><a href="section-346.html#section-349"><i class="fa fa-check"></i><b>80.2.2</b> 試驗結果</a></li>
<li class="chapter" data-level="80.2.3" data-path="section-346.html"><a href="section-346.html#section-350"><i class="fa fa-check"></i><b>80.2.3</b> 經典統計學分析方法</a></li>
<li class="chapter" data-level="80.2.4" data-path="section-346.html"><a href="section-346.html#section-351"><i class="fa fa-check"></i><b>80.2.4</b> 貝葉斯統計學分析方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="81" data-path="MC-estimation.html"><a href="MC-estimation.html"><i class="fa fa-check"></i><b>81</b> 蒙特卡羅估計和預測 Mente Carlo estimation and prediction</a><ul>
<li class="chapter" data-level="81.1" data-path="MC-estimation.html"><a href="MC-estimation.html#section-352"><i class="fa fa-check"></i><b>81.1</b> 起源</a><ul>
<li class="chapter" data-level="81.1.1" data-path="MC-estimation.html"><a href="MC-estimation.html#section-353"><i class="fa fa-check"></i><b>81.1.1</b> 作出預測</a></li>
<li class="chapter" data-level="81.1.2" data-path="MC-estimation.html"><a href="MC-estimation.html#example-"><i class="fa fa-check"></i><b>81.1.2</b> Example: 新藥表現預測</a></li>
</ul></li>
<li class="chapter" data-level="81.2" data-path="MC-estimation.html"><a href="MC-estimation.html#section-354"><i class="fa fa-check"></i><b>81.2</b> 蒙特卡羅估計</a><ul>
<li class="chapter" data-level="81.2.1" data-path="MC-estimation.html"><a href="MC-estimation.html#section-355"><i class="fa fa-check"></i><b>81.2.1</b> 用蒙特卡羅法估計概率分佈尾側累積概率(面積)</a></li>
<li class="chapter" data-level="81.2.2" data-path="MC-estimation.html"><a href="MC-estimation.html#section-356"><i class="fa fa-check"></i><b>81.2.2</b> 用蒙特卡羅法計算預測概率分佈</a></li>
</ul></li>
<li class="chapter" data-level="81.3" data-path="MC-estimation.html"><a href="MC-estimation.html#openbugs"><i class="fa fa-check"></i><b>81.3</b> 蒙特卡羅法分析軟件 OpenBUGS</a><ul>
<li class="chapter" data-level="81.3.1" data-path="MC-estimation.html"><a href="MC-estimation.html#openbugs-"><i class="fa fa-check"></i><b>81.3.1</b> 用 OpenBUGS 分析投擲硬幣數據</a></li>
<li class="chapter" data-level="81.3.2" data-path="MC-estimation.html"><a href="MC-estimation.html#openbugs--1"><i class="fa fa-check"></i><b>81.3.2</b> 用 OpenBUGS 對藥物臨牀試驗的結果做預測</a></li>
<li class="chapter" data-level="81.3.3" data-path="MC-estimation.html"><a href="MC-estimation.html#allow-uncertainty-in-power-calculation"><i class="fa fa-check"></i><b>81.3.3</b> 用蒙特卡羅法計算一個臨牀試驗的統計效能 allow uncertainty in power calculation</a></li>
</ul></li>
<li class="chapter" data-level="81.4" data-path="MC-estimation.html"><a href="MC-estimation.html#practical-bayesian-statistics-02"><i class="fa fa-check"></i><b>81.4</b> Practical Bayesian Statistics 02</a></li>
</ul></li>
<li class="chapter" data-level="82" data-path="conjugate-priors.html"><a href="conjugate-priors.html"><i class="fa fa-check"></i><b>82</b> 共軛先驗概率 Conjugate priors</a><ul>
<li class="chapter" data-level="82.1" data-path="conjugate-priors.html"><a href="conjugate-priors.html#section-357"><i class="fa fa-check"></i><b>82.1</b> 貝葉斯推斷的基礎</a></li>
<li class="chapter" data-level="82.2" data-path="conjugate-priors.html"><a href="conjugate-priors.html#section-358"><i class="fa fa-check"></i><b>82.2</b> 二項分布(似然)數據的共軛先驗概率</a><ul>
<li class="chapter" data-level="82.2.1" data-path="conjugate-priors.html"><a href="conjugate-priors.html#section-359"><i class="fa fa-check"></i><b>82.2.1</b> 事後概率分布預測</a></li>
</ul></li>
<li class="chapter" data-level="82.3" data-path="conjugate-priors.html"><a href="conjugate-priors.html#section-360"><i class="fa fa-check"></i><b>82.3</b> 正態分布(似然)數據的共軛先驗概率</a></li>
<li class="chapter" data-level="82.4" data-path="conjugate-priors.html"><a href="conjugate-priors.html#section-361"><i class="fa fa-check"></i><b>82.4</b> 泊淞分布(似然)數據的共軛先驗概率</a></li>
<li class="chapter" data-level="82.5" data-path="conjugate-priors.html"><a href="conjugate-priors.html#section-362"><i class="fa fa-check"></i><b>82.5</b> 共軛先驗概率分布的總結</a></li>
<li class="chapter" data-level="82.6" data-path="conjugate-priors.html"><a href="conjugate-priors.html#BayesPrac03"><i class="fa fa-check"></i><b>82.6</b> Practical Bayesian Statistics 03</a></li>
</ul></li>
<li class="chapter" data-level="83" data-path="MCMC-methods.html"><a href="MCMC-methods.html"><i class="fa fa-check"></i><b>83</b> 馬爾可夫鏈蒙特卡羅MCMC，圖形模型，BUGS語言</a><ul>
<li class="chapter" data-level="83.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#markov-chain-monte-carlo-"><i class="fa fa-check"></i><b>83.1</b> Markov Chain Monte Carlo 馬爾可夫鏈蒙特卡羅算法</a><ul>
<li class="chapter" data-level="83.1.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#simulation-methods"><i class="fa fa-check"></i><b>83.1.1</b> 爲什麼我們需要用計算機模擬算法(simulation methods)來進行貝葉斯統計推斷？</a></li>
<li class="chapter" data-level="83.1.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#Gibbs-sampling"><i class="fa fa-check"></i><b>83.1.2</b> 吉布斯採樣</a></li>
<li class="chapter" data-level="83.1.3" data-path="MCMC-methods.html"><a href="MCMC-methods.html#initial-values"><i class="fa fa-check"></i><b>83.1.3</b> 初始值 initial values</a></li>
</ul></li>
<li class="chapter" data-level="83.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#mcmc-"><i class="fa fa-check"></i><b>83.2</b> 使用 MCMC 時需要考慮的一些問題</a><ul>
<li class="chapter" data-level="83.2.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#section-363"><i class="fa fa-check"></i><b>83.2.1</b> 收斂時間</a></li>
<li class="chapter" data-level="83.2.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#efficiency-of-mcmc"><i class="fa fa-check"></i><b>83.2.2</b> 模型效率 efficiency of MCMC</a></li>
</ul></li>
<li class="chapter" data-level="83.3" data-path="MCMC-methods.html"><a href="MCMC-methods.html#bugs-"><i class="fa fa-check"></i><b>83.3</b> BUGS 軟件</a></li>
<li class="chapter" data-level="83.4" data-path="MCMC-methods.html"><a href="MCMC-methods.html#statistical-graphical-models---directed-acyclic-graphs-dags"><i class="fa fa-check"></i><b>83.4</b> 圖形模型 statistical graphical models - Directed Acyclic Graphs (DAGs)</a><ul>
<li class="chapter" data-level="83.4.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#conditional-independence-concept"><i class="fa fa-check"></i><b>83.4.1</b> 條件獨立的概念 conditional independence concept</a></li>
</ul></li>
<li class="chapter" data-level="83.5" data-path="MCMC-methods.html"><a href="MCMC-methods.html#bugs-language"><i class="fa fa-check"></i><b>83.5</b> BUGS language</a><ul>
<li class="chapter" data-level="83.5.1" data-path="MCMC-methods.html"><a href="MCMC-methods.html#types-of-nodes"><i class="fa fa-check"></i><b>83.5.1</b> 節點的種類 types of nodes</a></li>
<li class="chapter" data-level="83.5.2" data-path="MCMC-methods.html"><a href="MCMC-methods.html#section-365"><i class="fa fa-check"></i><b>83.5.2</b> 分布的標記法</a></li>
<li class="chapter" data-level="83.5.3" data-path="MCMC-methods.html"><a href="MCMC-methods.html#arrays-and-loops"><i class="fa fa-check"></i><b>83.5.3</b> Arrays and loops</a></li>
<li class="chapter" data-level="83.5.4" data-path="MCMC-methods.html"><a href="MCMC-methods.html#section-366"><i class="fa fa-check"></i><b>83.5.4</b> 常用的方程</a></li>
</ul></li>
<li class="chapter" data-level="83.6" data-path="MCMC-methods.html"><a href="MCMC-methods.html#bugs-model"><i class="fa fa-check"></i><b>83.6</b> 爲BUGS model模型準備格式正確的數據</a></li>
<li class="chapter" data-level="83.7" data-path="MCMC-methods.html"><a href="MCMC-methods.html#practical-bayesian-statistics-04"><i class="fa fa-check"></i><b>83.7</b> Practical Bayesian Statistics 04</a></li>
</ul></li>
<li class="chapter" data-level="84" data-path="section-367.html"><a href="section-367.html"><i class="fa fa-check"></i><b>84</b> 建模和模型的檢查</a><ul>
<li class="chapter" data-level="84.1" data-path="section-367.html"><a href="section-367.html#BayesianLM"><i class="fa fa-check"></i><b>84.1</b> 簡單線性回歸模型</a></li>
<li class="chapter" data-level="84.2" data-path="section-367.html"><a href="section-367.html#children-in-the-gambia"><i class="fa fa-check"></i><b>84.2</b> Children in the Gambia</a><ul>
<li class="chapter" data-level="84.2.1" data-path="section-367.html"><a href="section-367.html#section-368"><i class="fa fa-check"></i><b>84.2.1</b> 岡比亞兒童數據模型</a></li>
<li class="chapter" data-level="84.2.2" data-path="section-367.html"><a href="section-367.html#bugs-model-for-gambia-example"><i class="fa fa-check"></i><b>84.2.2</b> BUGS model for Gambia example</a></li>
<li class="chapter" data-level="84.2.3" data-path="section-367.html"><a href="section-367.html#data-file-for-the-gambia-example"><i class="fa fa-check"></i><b>84.2.3</b> Data file for the Gambia example</a></li>
<li class="chapter" data-level="84.2.4" data-path="section-367.html"><a href="section-367.html#initial-value-files"><i class="fa fa-check"></i><b>84.2.4</b> 初始值文件 initial value files</a></li>
<li class="chapter" data-level="84.2.5" data-path="section-367.html"><a href="section-367.html#mcmc-check-1"><i class="fa fa-check"></i><b>84.2.5</b> 給岡比亞兒童體重數據的貝葉斯模型檢查收斂 (MCMC check 1)</a></li>
<li class="chapter" data-level="84.2.6" data-path="section-367.html"><a href="section-367.html#section-369"><i class="fa fa-check"></i><b>84.2.6</b> 岡比亞兒童體重數據的貝葉斯統計學推斷結果</a></li>
<li class="chapter" data-level="84.2.7" data-path="section-367.html"><a href="section-367.html#effective-sample-size-mcmc-check-2"><i class="fa fa-check"></i><b>84.2.7</b> 檢查岡比亞兒童體重數據貝葉斯模型的有效樣本量 effective sample size (MCMC check 2)</a></li>
<li class="chapter" data-level="84.2.8" data-path="section-367.html"><a href="section-367.html#checking-model-fit-for-the-gambia-example"><i class="fa fa-check"></i><b>84.2.8</b> 檢查模型擬合程度 checking model fit for the Gambia example</a></li>
<li class="chapter" data-level="84.2.9" data-path="section-367.html"><a href="section-367.html#tdreplacegaussian"><i class="fa fa-check"></i><b>84.2.9</b> 其他的替代模型 alternative model with t-errors</a></li>
</ul></li>
<li class="chapter" data-level="84.3" data-path="section-367.html"><a href="section-367.html#bayesian-model-comparison"><i class="fa fa-check"></i><b>84.3</b> 貝葉斯統計模型的比較 Bayesian model comparison</a><ul>
<li class="chapter" data-level="84.3.1" data-path="section-367.html"><a href="section-367.html#deviance-information-criterion-dic"><i class="fa fa-check"></i><b>84.3.1</b> Deviance Information Criterion (DIC)</a></li>
<li class="chapter" data-level="84.3.2" data-path="section-367.html"><a href="section-367.html#section-370"><i class="fa fa-check"></i><b>84.3.2</b> 岡比亞兒童體重數據模型比較</a></li>
</ul></li>
<li class="chapter" data-level="84.4" data-path="section-367.html"><a href="section-367.html#practical-bayesian-statistics-05"><i class="fa fa-check"></i><b>84.4</b> Practical Bayesian Statistics 05</a><ul>
<li class="chapter" data-level="84.4.1" data-path="section-367.html"><a href="section-367.html#adding-age-squared"><i class="fa fa-check"></i><b>84.4.1</b> 增加年齡二次方項 adding age squared</a></li>
<li class="chapter" data-level="84.4.2" data-path="section-367.html"><a href="section-367.html#adding-an-interaction-term"><i class="fa fa-check"></i><b>84.4.2</b> 增加年齡和性別的交互作用項 adding an interaction term</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="85" data-path="section-371.html"><a href="section-371.html"><i class="fa fa-check"></i><b>85</b> 不同實驗/研究設計時適用的貝葉斯模型</a><ul>
<li class="chapter" data-level="85.1" data-path="section-371.html"><a href="section-371.html#section-372"><i class="fa fa-check"></i><b>85.1</b> 隊列研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="85.2" data-path="section-371.html"><a href="section-371.html#section-373"><i class="fa fa-check"></i><b>85.2</b> 病例對照研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="85.3" data-path="section-371.html"><a href="section-371.html#section-374"><i class="fa fa-check"></i><b>85.3</b> 橫斷面研究設計時的貝葉斯模型</a></li>
<li class="chapter" data-level="85.4" data-path="section-371.html"><a href="section-371.html#section-375"><i class="fa fa-check"></i><b>85.4</b> 把不同實驗設計的數據用貝葉斯模型連接起來</a><ul>
<li class="chapter" data-level="85.4.1" data-path="section-371.html"><a href="section-371.html#linking-sub-models-throug-common-parameters"><i class="fa fa-check"></i><b>85.4.1</b> Linking sub-models throug common parameters</a></li>
</ul></li>
<li class="chapter" data-level="85.5" data-path="section-371.html"><a href="section-371.html#practical-bayesian-statistics-06"><i class="fa fa-check"></i><b>85.5</b> Practical Bayesian Statistics 06</a><ul>
<li class="chapter" data-level="85.5.1" data-path="section-371.html"><a href="section-371.html#the-great-trial"><i class="fa fa-check"></i><b>85.5.1</b> The GREAT Trial</a></li>
<li class="chapter" data-level="85.5.2" data-path="section-371.html"><a href="section-371.html#section-376"><i class="fa fa-check"></i><b>85.5.2</b> 吸煙與癌症</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="86" data-path="section-380.html"><a href="section-380.html"><i class="fa fa-check"></i><b>86</b> 貝葉斯廣義線性回歸</a><ul>
<li class="chapter" data-level="86.1" data-path="section-380.html"><a href="section-380.html#bugs"><i class="fa fa-check"></i><b>86.1</b> 如何在BUGS語言中描述分類型變量</a><ul>
<li class="chapter" data-level="86.1.1" data-path="section-380.html"><a href="section-380.html#section-381"><i class="fa fa-check"></i><b>86.1.1</b> 啞變量的數據矩陣</a></li>
<li class="chapter" data-level="86.1.2" data-path="section-380.html"><a href="section-380.html#bugs-1"><i class="fa fa-check"></i><b>86.1.2</b> 雙重索引BUGS語言標記法</a></li>
</ul></li>
<li class="chapter" data-level="86.2" data-path="section-380.html"><a href="section-380.html#bayesian-logistic-regression"><i class="fa fa-check"></i><b>86.2</b> 邏輯回歸 Bayesian Logistic Regression</a><ul>
<li class="chapter" data-level="86.2.1" data-path="section-380.html"><a href="section-380.html#section-382"><i class="fa fa-check"></i><b>86.2.1</b> 低出生體重數據</a></li>
</ul></li>
<li class="chapter" data-level="86.3" data-path="section-380.html"><a href="section-380.html#bayesian-poisson-regression"><i class="fa fa-check"></i><b>86.3</b> 貝葉斯泊鬆回歸 Bayesian Poisson Regression</a></li>
<li class="chapter" data-level="86.4" data-path="section-380.html"><a href="section-380.html#glm-in-a-bayesian-way"><i class="fa fa-check"></i><b>86.4</b> GLM in a Bayesian way</a></li>
<li class="chapter" data-level="86.5" data-path="section-380.html"><a href="section-380.html#Bayesian-practical07"><i class="fa fa-check"></i><b>86.5</b> Practical Bayesian Statistics 07</a></li>
</ul></li>
<li class="chapter" data-level="87" data-path="section-383.html"><a href="section-383.html"><i class="fa fa-check"></i><b>87</b> 貝葉斯等級回歸模型</a><ul>
<li class="chapter" data-level="87.1" data-path="section-383.html"><a href="section-383.html#section-384"><i class="fa fa-check"></i><b>87.1</b> 關於等級迴歸模型</a></li>
<li class="chapter" data-level="87.2" data-path="section-383.html"><a href="section-383.html#section-385"><i class="fa fa-check"></i><b>87.2</b> 多層數據在模型中可能要用到的前提條件</a><ul>
<li class="chapter" data-level="87.2.1" data-path="section-383.html"><a href="section-383.html#identical-parameters"><i class="fa fa-check"></i><b>87.2.1</b> 參數是相同的 (identical parameters)</a></li>
<li class="chapter" data-level="87.2.2" data-path="section-383.html"><a href="section-383.html#independent-parameters"><i class="fa fa-check"></i><b>87.2.2</b> 參數是獨立的 (independent parameters)</a></li>
<li class="chapter" data-level="87.2.3" data-path="section-383.html"><a href="section-383.html#exchangeable-parameters"><i class="fa fa-check"></i><b>87.2.3</b> 參數是可交換的 (exchangeable parameters)</a></li>
</ul></li>
<li class="chapter" data-level="87.3" data-path="section-383.html"><a href="section-383.html#section-386"><i class="fa fa-check"></i><b>87.3</b> 抗抑鬱臨牀試驗實例</a><ul>
<li class="chapter" data-level="87.3.1" data-path="section-383.html"><a href="section-383.html#section-387"><i class="fa fa-check"></i><b>87.3.1</b> 縱向數據</a></li>
<li class="chapter" data-level="87.3.2" data-path="section-383.html"><a href="section-383.html#hamd-example"><i class="fa fa-check"></i><b>87.3.2</b> HAMD example</a></li>
<li class="chapter" data-level="87.3.3" data-path="section-383.html"><a href="section-383.html#section-388"><i class="fa fa-check"></i><b>87.3.3</b> 貝葉斯簡單線性迴歸模型</a></li>
<li class="chapter" data-level="87.3.4" data-path="section-383.html"><a href="section-383.html#section-389"><i class="fa fa-check"></i><b>87.3.4</b> 貝葉斯等級線性回歸–隨機截距模型</a></li>
<li class="chapter" data-level="87.3.5" data-path="section-383.html"><a href="section-383.html#section-390"><i class="fa fa-check"></i><b>87.3.5</b> 貝葉斯等級線性回歸模型–隨機截距和隨機斜率模型</a></li>
<li class="chapter" data-level="87.3.6" data-path="section-383.html"><a href="section-383.html#hamd-"><i class="fa fa-check"></i><b>87.3.6</b> HAMD 數據不同模型結果的比較</a></li>
<li class="chapter" data-level="87.3.7" data-path="section-383.html"><a href="section-383.html#hamd--1"><i class="fa fa-check"></i><b>87.3.7</b> HAMD 數據實例結果的解釋</a></li>
</ul></li>
<li class="chapter" data-level="87.4" data-path="section-383.html"><a href="section-383.html#practical-bayesian-statistics-08"><i class="fa fa-check"></i><b>87.4</b> Practical Bayesian Statistics 08</a></li>
</ul></li>
<li class="chapter" data-level="88" data-path="mcmc.html"><a href="mcmc.html"><i class="fa fa-check"></i><b>88</b> 再訪 MCMC</a><ul>
<li class="chapter" data-level="88.1" data-path="mcmc.html"><a href="mcmc.html#metropolis-hastings-algorithm"><i class="fa fa-check"></i><b>88.1</b> Metropolis-Hastings algorithm</a></li>
<li class="chapter" data-level="88.2" data-path="mcmc.html"><a href="mcmc.html#adaptive-phase"><i class="fa fa-check"></i><b>88.2</b> 適應階段 adaptive phase</a></li>
</ul></li>
<li class="chapter" data-level="89" data-path="section-391.html"><a href="section-391.html"><i class="fa fa-check"></i><b>89</b> 貝葉斯和概率論的比較</a><ul>
<li class="chapter" data-level="89.1" data-path="section-391.html"><a href="section-391.html#section-392"><i class="fa fa-check"></i><b>89.1</b> 兩種方法的不同點總覽</a></li>
<li class="chapter" data-level="89.2" data-path="section-391.html"><a href="section-391.html#subgroup-analysis"><i class="fa fa-check"></i><b>89.2</b> 亞組分析 subgroup analysis</a></li>
<li class="chapter" data-level="89.3" data-path="section-391.html"><a href="section-391.html#multiple-comparisons"><i class="fa fa-check"></i><b>89.3</b> 多重比較問題 multiple comparisons</a></li>
</ul></li>
<li class="part"><span><b>XII 因果推斷 Causal Inference</b></span></li>
<li class="chapter" data-level="90" data-path="causal-languages-.html"><a href="causal-languages-.html"><i class="fa fa-check"></i><b>90</b> Causal Languages 因果推斷的語法</a><ul>
<li class="chapter" data-level="90.1" data-path="causal-languages-.html"><a href="causal-languages-.html#section-393"><i class="fa fa-check"></i><b>90.1</b> 當我們在談論因果推斷的時候，我們在談論什麼？</a></li>
<li class="chapter" data-level="90.2" data-path="causal-languages-.html"><a href="causal-languages-.html#section-394"><i class="fa fa-check"></i><b>90.2</b> 傳統的統計學方法</a><ul>
<li class="chapter" data-level="90.2.1" data-path="causal-languages-.html"><a href="causal-languages-.html#section-395"><i class="fa fa-check"></i><b>90.2.1</b> 初步分析</a></li>
<li class="chapter" data-level="90.2.2" data-path="causal-languages-.html"><a href="causal-languages-.html#section-396"><i class="fa fa-check"></i><b>90.2.2</b> 混雜</a></li>
<li class="chapter" data-level="90.2.3" data-path="causal-languages-.html"><a href="causal-languages-.html#conditioning-on-covariates"><i class="fa fa-check"></i><b>90.2.3</b> 以共變量爲條件 conditioning on covariates</a></li>
</ul></li>
<li class="chapter" data-level="90.3" data-path="causal-languages-.html"><a href="causal-languages-.html#section-397"><i class="fa fa-check"></i><b>90.3</b> 更加正規的方法</a><ul>
<li class="chapter" data-level="90.3.1" data-path="causal-languages-.html"><a href="causal-languages-.html#section-398"><i class="fa fa-check"></i><b>90.3.1</b> 因果推斷使用的語言</a></li>
<li class="chapter" data-level="90.3.2" data-path="causal-languages-.html"><a href="causal-languages-.html#causal-estimands"><i class="fa fa-check"></i><b>90.3.2</b> 因果推斷的被估計量 causal estimands</a></li>
<li class="chapter" data-level="90.3.3" data-path="causal-languages-.html"><a href="causal-languages-.html#assumptions-for-identification"><i class="fa fa-check"></i><b>90.3.3</b> 鑑定因果推斷時的前提假設 assumptions for identification</a></li>
<li class="chapter" data-level="90.3.4" data-path="causal-languages-.html"><a href="causal-languages-.html#identification"><i class="fa fa-check"></i><b>90.3.4</b> 鑑定 identification</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="91" data-path="graphical-models-.html"><a href="graphical-models-.html"><i class="fa fa-check"></i><b>91</b> Graphical Models 因果推斷的圖形模型</a><ul>
<li class="chapter" data-level="91.1" data-path="graphical-models-.html"><a href="graphical-models-.html#section-399"><i class="fa fa-check"></i><b>91.1</b> 統計學中的有向無環圖</a><ul>
<li class="chapter" data-level="91.1.1" data-path="graphical-models-.html"><a href="graphical-models-.html#dag--conditional-independence"><i class="fa fa-check"></i><b>91.1.1</b> DAG 和條件獨立性 conditional independence</a></li>
<li class="chapter" data-level="91.1.2" data-path="graphical-models-.html"><a href="graphical-models-.html#dag-"><i class="fa fa-check"></i><b>91.1.2</b> DAG 圖的術語</a></li>
<li class="chapter" data-level="91.1.3" data-path="graphical-models-.html"><a href="graphical-models-.html#blocking-paths"><i class="fa fa-check"></i><b>91.1.3</b> 阻斷通路 blocking paths</a></li>
<li class="chapter" data-level="91.1.4" data-path="graphical-models-.html"><a href="graphical-models-.html#conditioning-on-a-collider"><i class="fa fa-check"></i><b>91.1.4</b> 以對撞因子爲條件 conditioning on a collider</a></li>
</ul></li>
<li class="chapter" data-level="91.2" data-path="graphical-models-.html"><a href="graphical-models-.html#conditioning-on-a-non-collider"><i class="fa fa-check"></i><b>91.2</b> 以非對撞銀子爲條件 conditioning on a non-collider</a><ul>
<li class="chapter" data-level="91.2.1" data-path="graphical-models-.html"><a href="graphical-models-.html#section-400"><i class="fa fa-check"></i><b>91.2.1</b> 條件的總結</a></li>
<li class="chapter" data-level="91.2.2" data-path="graphical-models-.html"><a href="graphical-models-.html#d--d-separation"><i class="fa fa-check"></i><b>91.2.2</b> D 分離 d-separation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="92" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html"><i class="fa fa-check"></i><b>92</b> Regression Methods with continuous outcomes 結果變量爲連續型變量</a><ul>
<li class="chapter" data-level="92.1" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#section-401"><i class="fa fa-check"></i><b>92.1</b> 用於對連續型結果變量做因果推斷的被估計量</a></li>
<li class="chapter" data-level="92.2" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#identification---revision"><i class="fa fa-check"></i><b>92.2</b> 鑑定 identification - revision</a><ul>
<li class="chapter" data-level="92.2.1" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#conditional-causal-mean-difference"><i class="fa fa-check"></i><b>92.2.1</b> 條件因果均差 conditional causal mean difference</a></li>
<li class="chapter" data-level="92.2.2" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#c--ace"><i class="fa fa-check"></i><b>92.2.2</b> 簡單分類型條件變量 <span class="math inline">\(C\)</span> 的 ACE</a></li>
<li class="chapter" data-level="92.2.3" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#c-ace"><i class="fa fa-check"></i><b>92.2.3</b> 簡單連續型條件變量 <span class="math inline">\(C\)</span> 的ACE</a></li>
</ul></li>
<li class="chapter" data-level="92.3" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#ace"><i class="fa fa-check"></i><b>92.3</b> 通過線性回歸模型來估計 ACE</a><ul>
<li class="chapter" data-level="92.3.1" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#section-402"><i class="fa fa-check"></i><b>92.3.1</b> 條件因果均值差</a></li>
<li class="chapter" data-level="92.3.2" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#effect-modification---interaction"><i class="fa fa-check"></i><b>92.3.2</b> 效應修正 effect modification 和 交互作用 interaction</a></li>
<li class="chapter" data-level="92.3.3" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#ace-1"><i class="fa fa-check"></i><b>92.3.3</b> 分類型條件變量的平均因果效應 (ACE)</a></li>
<li class="chapter" data-level="92.3.4" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#positivity-"><i class="fa fa-check"></i><b>92.3.4</b> Positivity 非零性</a></li>
<li class="chapter" data-level="92.3.5" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#section-403"><i class="fa fa-check"></i><b>92.3.5</b> 連續型變量的平均因果效應</a></li>
</ul></li>
<li class="chapter" data-level="92.4" data-path="regression-methods-with-continuous-outcomes-.html"><a href="regression-methods-with-continuous-outcomes-.html#practical03---causal-inference"><i class="fa fa-check"></i><b>92.4</b> Practical03 - causal inference</a></li>
</ul></li>
<li class="chapter" data-level="93" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html"><i class="fa fa-check"></i><b>93</b> Regression Methods with binary outcomes 結果變量爲二分類變量</a><ul>
<li class="chapter" data-level="93.1" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#causal-estimand"><i class="fa fa-check"></i><b>93.1</b> 二分類結果變量的因果被估計量 (causal estimand):</a><ul>
<li class="chapter" data-level="93.1.1" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#non-collapsibility-of-the-odds-ratio"><i class="fa fa-check"></i><b>93.1.1</b> 比值比的不可壓縮性 non-collapsibility of the odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="93.2" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#identification---conditional-effects"><i class="fa fa-check"></i><b>93.2</b> 鑑定 identification - conditional effects</a></li>
<li class="chapter" data-level="93.3" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#identification---marginal-effects"><i class="fa fa-check"></i><b>93.3</b> 鑑定 identification - marginal effects</a><ul>
<li class="chapter" data-level="93.3.1" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#marginal-causal-risk-difference-ace"><i class="fa fa-check"></i><b>93.3.1</b> Marginal causal risk difference (ACE)</a></li>
<li class="chapter" data-level="93.3.2" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#marginal-causal-log-risk-ratio"><i class="fa fa-check"></i><b>93.3.2</b> Marginal causal log risk ratio</a></li>
</ul></li>
<li class="chapter" data-level="93.4" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#section-404"><i class="fa fa-check"></i><b>93.4</b> 通過邏輯回歸估計這些被估計量</a></li>
<li class="chapter" data-level="93.5" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#average-causaltreatment-effect-in-the-exposedtreated-atet"><i class="fa fa-check"></i><b>93.5</b> Average causal/treatment effect in the exposed/treated (ATET)</a></li>
<li class="chapter" data-level="93.6" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#practical04---causal-inference"><i class="fa fa-check"></i><b>93.6</b> Practical04 - causal inference</a><ul>
<li class="chapter" data-level="93.6.1" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#stata"><i class="fa fa-check"></i><b>93.6.1</b> 在STATA裡打開數據，初步分析和熟悉數據</a></li>
<li class="chapter" data-level="93.6.2" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#rfa---dodp--"><i class="fa fa-check"></i><b>93.6.2</b> 用標準邏輯回歸模型分析 <code>rfa</code> (暴露) 和 <code>dodp</code> (結果) 之間的關係</a></li>
<li class="chapter" data-level="93.6.3" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#ab"><i class="fa fa-check"></i><b>93.6.3</b> 比較上面(a)和(b)兩個邏輯回歸模型的結果，你認為混雜因素對暴露和結果的關係的影響是怎樣的？</a></li>
<li class="chapter" data-level="93.6.4" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#b-"><i class="fa fa-check"></i><b>93.6.4</b> 在怎樣的前提假設條件下，上面模型 (b) 可以被賦予因果關係的解釋？</a></li>
<li class="chapter" data-level="93.6.5" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#b--1"><i class="fa fa-check"></i><b>93.6.5</b> 在前面提出的所有前提假設都滿足的情況下，請給模型 (b) 的回歸係數賦予一個因果效應的解釋。</a></li>
<li class="chapter" data-level="93.6.6" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#stata--teffects-ra-"><i class="fa fa-check"></i><b>93.6.6</b> 用 STATA 的 <code>teffects ra</code> 擬合上面兩個模型</a></li>
<li class="chapter" data-level="93.6.7" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#b--ate-"><i class="fa fa-check"></i><b>93.6.7</b> 在怎樣的假設前提條件下，前一步擬合的模型 (b) 結果中的 ATE 可以被賦予因果關係的解釋？</a></li>
<li class="chapter" data-level="93.6.8" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#section-405"><i class="fa fa-check"></i><b>93.6.8</b> 前一問和你擬合完簡單的邏輯回歸之後做的模型假設的回答，有什麼不同？</a></li>
<li class="chapter" data-level="93.6.9" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#teffects-ra--b-"><i class="fa fa-check"></i><b>93.6.9</b> 用因果關係語言解釋 <code>teffects ra</code> 擬合的模型 (b) 的結果</a></li>
<li class="chapter" data-level="93.6.10" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#age-gender-smoke-nodules-mets-duration-primary-"><i class="fa fa-check"></i><b>93.6.10</b> 如果模型中加入 <code>age, gender, smoke, nodules, mets, duration, primary</code> 等和預後相關但是和決定療法並不太有關係的變量，結果會有什麼不同呢？</a></li>
<li class="chapter" data-level="93.6.11" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#coag"><i class="fa fa-check"></i><b>93.6.11</b> 如果再向模型中加入和暴露變量相關，和預後沒什麼關係的變量 <code>coag</code>，結果該怎麼解讀？</a></li>
<li class="chapter" data-level="93.6.12" data-path="regression-methods-with-binary-outcomes-.html"><a href="regression-methods-with-binary-outcomes-.html#atet-"><i class="fa fa-check"></i><b>93.6.12</b> 使用 <code>atet</code> 的選項重新擬合上面的因果效應模型，解釋結果發生的變化，並作出相應的結論。</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="94" data-path="prospensity-score-.html"><a href="prospensity-score-.html"><i class="fa fa-check"></i><b>94</b> Prospensity Score 傾向性評分</a><ul>
<li class="chapter" data-level="94.0.1" data-path="prospensity-score-.html"><a href="prospensity-score-.html#section-406"><i class="fa fa-check"></i><b>94.0.1</b> 關於條件可置換性</a></li>
<li class="chapter" data-level="94.1" data-path="prospensity-score-.html"><a href="prospensity-score-.html#section-407"><i class="fa fa-check"></i><b>94.1</b> 怎樣使用傾向性評分</a><ul>
<li class="chapter" data-level="94.1.1" data-path="prospensity-score-.html"><a href="prospensity-score-.html#stratification"><i class="fa fa-check"></i><b>94.1.1</b> 分層法 stratification</a></li>
<li class="chapter" data-level="94.1.2" data-path="prospensity-score-.html"><a href="prospensity-score-.html#matching"><i class="fa fa-check"></i><b>94.1.2</b> 配對法 matching</a></li>
<li class="chapter" data-level="94.1.3" data-path="prospensity-score-.html"><a href="prospensity-score-.html#adjustment"><i class="fa fa-check"></i><b>94.1.3</b> 回歸模型校正法 adjustment</a></li>
</ul></li>
<li class="chapter" data-level="94.2" data-path="prospensity-score-.html"><a href="prospensity-score-.html#practical05---causal-inference"><i class="fa fa-check"></i><b>94.2</b> Practical05 - causal inference</a><ul>
<li class="chapter" data-level="94.2.1" data-path="prospensity-score-.html"><a href="prospensity-score-.html#section-408"><i class="fa fa-check"></i><b>94.2.1</b> 初步熟悉數據內容</a></li>
<li class="chapter" data-level="94.2.2" data-path="prospensity-score-.html"><a href="prospensity-score-.html#section-409"><i class="fa fa-check"></i><b>94.2.2</b> 把連續型變量以分類型數據的形式放入模型中:</a></li>
<li class="chapter" data-level="94.2.3" data-path="prospensity-score-.html"><a href="prospensity-score-.html#section-410"><i class="fa fa-check"></i><b>94.2.3</b> 用相同的模型結構估計每個人的傾向性評分</a></li>
<li class="chapter" data-level="94.2.4" data-path="prospensity-score-.html"><a href="prospensity-score-.html#ps--stratification"><i class="fa fa-check"></i><b>94.2.4</b> 用 PS 評分來把對象分層 stratification</a></li>
<li class="chapter" data-level="94.2.5" data-path="prospensity-score-.html"><a href="prospensity-score-.html#ace-3"><i class="fa fa-check"></i><b>94.2.5</b> 用配對法計算 ACE</a></li>
<li class="chapter" data-level="94.2.6" data-path="prospensity-score-.html"><a href="prospensity-score-.html#ps"><i class="fa fa-check"></i><b>94.2.6</b> 模型校正 PS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="95" data-path="inverse-probability-weighted-estimation-and-doubly-robust-methods.html"><a href="inverse-probability-weighted-estimation-and-doubly-robust-methods.html"><i class="fa fa-check"></i><b>95</b> Inverse probability weighted estimation and doubly robust methods</a></li>
<li class="chapter" data-level="96" data-path="causal-mediation-analysis.html"><a href="causal-mediation-analysis.html"><i class="fa fa-check"></i><b>96</b> Causal mediation analysis</a></li>
<li class="part"><span><b>XIII Statistical Methods in Epidemiology</b></span></li>
<li class="chapter" data-level="97" data-path="crude-and-stratified-rate-ratios.html"><a href="crude-and-stratified-rate-ratios.html"><i class="fa fa-check"></i><b>97</b> Crude and stratified rate ratios</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">醫學統計學</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prospensity-score-" class="section level1">
<h1><span class="header-section-number">第 94 章</span> Prospensity Score 傾向性評分</h1>

<div class="definition">
<p><span id="def:16-ASM-Causal-infer-20" class="definition"><strong>Definition 94.1  </strong></span><strong>傾向性評分 propensity score:</strong> 如果研究中結果變量為 <span class="math inline">\(Y\)</span>，二分類的暴露變量 <span class="math inline">\(X\)</span>，以及條件變量 <span class="math inline">\(\mathbf{C}\)</span>，那麼每個觀察對象的傾向性評分 <span class="math inline">\(p\mathbf{C}\)</span> 可以被定義為，一個觀察對象真實被觀察到暴露變量 <span class="math inline">\(X=1\)</span> 的條件概率(<span class="math inline">\(p\mathbf{C}\)</span> is defined as the conditional probability of being exposed given covariates)：</p>
<span class="math display">\[
p(\mathbf{C}) = \text{Pr}(X=1 | \mathbf{C})
\]</span>
</div>

<p>注意，傾向性評分 propensity score，本質上僅僅只是一個標量 scalar，而不是條件變量那樣的多維變量。</p>
<p>而且，條件可置換性這一重要的前提假設，被 <span class="citation">(Rosenbaum and Rubin <a href="#ref-Rosenbaum1983">1983</a>)</span> 證明是可以拓展到這個標量的:</p>

<div class="theorem">
<p><span id="thm:16-ASM-Causal-infer-21" class="theorem"><strong>Theorem 94.1  </strong></span><strong>傾向性評分的最重要性質:</strong></p>
<p><span class="math display">\[
Y(x) \perp\perp X|\mathbf{C}, x=0,1 \Rightarrow Y(x) \perp\perp X|p(\mathbf{C}, x=0, 1)
\]</span></p>
<span class="citation">(Rosenbaum and Rubin <a href="#ref-Rosenbaum1983">1983</a>)</span>
</div>

<p>這一重要的性質告訴我們，其實在考慮調整混雜因素的時候，我們可以專注考慮這一個標量作爲混雜因素。實際操作中，這個標量通常需要通過一個邏輯回歸模型來擬合計算。這個計算傾向性評分的邏輯回歸模型，用的是對象是否被暴露作爲結果變量，用其他的和這個暴露相關的混雜因素作爲預測變量 <span class="math inline">\(X|\mathbf{C}\)</span>。</p>
<div id="section-406" class="section level3">
<h3><span class="header-section-number">94.0.1</span> 關於條件可置換性</h3>
<p>如果兩個觀察對象，經過計算，他們二人的傾向性評分相同，那麼從這些條件變量來看，這兩個對象是否被暴露，就是<strong>完全隨機的</strong>，他們有相同的概率屬於被暴露或非暴露人羣。這一點和RCT有些相似，如果，一個完美的隨機化試驗，那麼一個患者被分進治療組或者對照組的概率是完全相同的，他們是完全可以置換的 (exchangeable)。所以，在一個觀察性研究中，如果傾向性評分相同，在給定的觀察到的所有混雜因素的條件下，這兩個對象是否暴露的概率是相同的 (可以條件置換的 conditional exchangeability given the propensity score)。</p>
<p>當然和RCT相比，這兩個概念的本質區別在於，隨機化臨牀實驗是通過實驗設計手段，保證了研究對象的完全可置換。觀察性研究，則沒有這個優點，因爲他們的可置換性質是由觀察到的混雜因子決定的，許多觀察性研究的混雜因子都無法保證全部觀察得到。條件可置換性是<strong>一個非常強的假設</strong>，因爲它假定我們真的把所有的混雜都觀察到了。</p>

<div class="example">
<span id="exm:16-ASM-Causal-infer-22" class="example"><strong>Example 94.1  </strong></span>前一章的練習題中的例子是，3351 名肺癌患者，其中 1848 名患者接受了標準手術摘除腫塊療法，另外 1703 名患者接受了高頻消蝕法 (RFA) 治療。表面上看，這兩個療法的3年存活率是 RFA 較高 (79.2% vs. 67.9%)，但是潛在的混雜因素很明顯: 因爲 RFA 無法治療尺寸較大的腫塊，所以腫塊大的病人醫生就傾向於給予標準手術摘除法，所以，腫塊大小本身造成了療效差異的混雜。因爲那些接受 RFA 治療的癌症患者腫塊多較小，那麼他們的預後本身也就會比較好。
</div>

<p>這個例子中的混雜因子包括: 年齡，性別，醫院 (1/2/3/4)，吸煙 (non, ex, current)，腫塊數量，其他腫瘤轉移部位，患者已患癌症的時間，腫塊的大小，主要癌症的部位 (膀胱，乳腺，大腸，食道，腎，皮膚，胃，睾丸等)，還有一個腫塊是否容易被摘除的難易程度 (容易，中等，困難)。那麼，我們可以給患者擬合下面的模型做傾向性評分:</p>
<p><span class="math display">\[
\begin{aligned}
\text{logit}\{ \text{Pr(RFA}|\mathbf{C} \}  = &amp; \beta_0 + \beta_1\text{age} + \beta_2 \text{gender}+ \beta_3I(\text{hospital = 2}) \\
&amp; +\beta_4I(\text{hospital =3}) + \beta_5I(\text{hospital = 4}) + \beta_6I(\text{smoke = 2} )\\
&amp; + \beta_7I(\text{smoke = 3}) + \beta_8\text{nodules} + \beta_9\text{mets} + \beta_{10}\text{duration} \\
&amp; + \cdots + \beta_{20}I(\text{primary = 9}) + \beta_{21}I(\text{position = 2}) + \beta_{22}I(\text{position = 3})
\end{aligned}
\]</span></p>
<p>擬合了這個模型，計算每個參數 <span class="math inline">\(\beta_0 sim \beta_22\)</span> 的極大似然估計之後，就可以計算每個患者的傾向性評分:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{p}(\mathbf{C}_i) = &amp; \text{expit}\{ \hat\beta_0 + \hat\beta_1\text{age} + \hat\beta_2 \text{gender}+ \hat\beta_3I(\text{hospital = 2}) \\
&amp; +\hat\beta_4I(\text{hospital =3}) + \hat\beta_5I(\text{hospital = 4}) + \hat\beta_6I(\text{smoke = 2} )\\
&amp; + \hat\beta_7I(\text{smoke = 3}) + \hat\beta_8\text{nodules} + \hat\beta_9\text{mets} + \hat\beta_{10}\text{duration} \\
&amp; + \cdots + \hat\beta_{20}I(\text{primary = 9}) + \hat\beta_{21}I(\text{position = 2}) + \hat\beta_{22}I(\text{position = 3}) \}
\end{aligned}
\]</span></p>
<p>其中</p>
<p><span class="math display">\[
\text{expit}(a) = \frac{\exp(a)}{1+\exp(a)}
\]</span></p>
<p>下面就是傾向性評分模型的輸出結果:</p>
<pre><code>## 
## Call:
## glm(formula = rfa ~ age + gender + smoke + hospital + nodules + 
##     mets + duration + maxdia + primary + position, family = binomial(link = logit), 
##     data = RFAcat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.53460  -0.86875  -0.30119   0.89717   2.64611  
## 
## Coefficients:
##                Estimate  Std. Error  z value  Pr(&gt;|z|)    
## (Intercept)  2.95798757  0.61770661   4.7887 1.679e-06 ***
## age         -0.00044027  0.00992941  -0.0443   0.96463    
## gender1      0.10435375  0.15103436   0.6909   0.48961    
## smoke1       0.11861648  0.15106839   0.7852   0.43235    
## smoke2       0.09342271  0.10380671   0.9000   0.36814    
## hospital2   -0.23564078  0.14243617  -1.6544   0.09805 .  
## hospital3    0.30045787  0.13850888   2.1692   0.03007 *  
## hospital4   -0.11174925  0.19236619  -0.5809   0.56129    
## nodules     -0.02987712  0.01820608  -1.6411   0.10079    
## mets         0.06514394  0.04672394   1.3942   0.16325    
## duration     0.00260668  0.00488559   0.5335   0.59366    
## maxdia      -2.26045488  0.08773789 -25.7637 &lt; 2.2e-16 ***
## primary2     0.09927913  0.29102032   0.3411   0.73300    
## primary3     0.14593436  0.29460236   0.4954   0.62035    
## primary4    -0.00212669  0.38021005  -0.0056   0.99554    
## primary5    -0.22135219  0.37933124  -0.5835   0.55953    
## primary6     0.04504894  0.34609342   0.1302   0.89644    
## primary7     1.57439087  0.64792618   2.4299   0.01510 *  
## primary8     0.21261200  0.38272919   0.5555   0.57854    
## primary9     0.33223472  0.40566455   0.8190   0.41279    
## position2    0.94096446  0.10080061   9.3349 &lt; 2.2e-16 ***
## position3    1.22134526  0.11678128  10.4584 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 4916.81  on 3550  degrees of freedom
## Residual deviance: 3834.74  on 3529  degrees of freedom
## AIC: 3878.74
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>正如我們預料的那樣，醫院，腫塊尺寸，和腫塊的位置是患者接受 RFA 治療與否的重要預測指標。</p>
<div class="figure" style="text-align: center"><span id="fig:propscore00"></span>
<img src="bookdown_files/figure-html/propscore00-1.png" alt="Density and histogram of the estimated propensity score in the two exposure groups." width="80%" />
<p class="caption">
圖 94.1: Density and histogram of the estimated propensity score in the two exposure groups.
</p>
</div>
<p>從圖 <a href="prospensity-score-.html#fig:propscore00">94.1</a> 可以看出評分在兩個暴露組中的分布交叉十分令人滿意。</p>
</div>
<div id="section-407" class="section level2">
<h2><span class="header-section-number">94.1</span> 怎樣使用傾向性評分</h2>
<p>傾向性評分在實際操作中的運用:</p>
<ol style="list-style-type: decimal">
<li><strong>分層 stratification</strong>: 把觀察對象按照傾向性評分的高低分層成爲幾個組，進行組內的療效比較;</li>
<li><strong>配對 matching</strong>: 在真實的暴露組中的對象，爲他們每個人找一個非暴露的人，一兩個對象的傾向性評分盡可能接近爲配對的方法;</li>
<li><strong>在模型中調整 adjustment</strong>: 在回歸模型中調整這個傾向性評分，而不是調整那些計算評分時的那些條件變量;</li>
<li>給每個研究對象按照其評分得分，使用<strong>逆向加權法 (inverse weighting)</strong>。</li>
</ol>
<div id="stratification" class="section level3">
<h3><span class="header-section-number">94.1.1</span> 分層法 stratification</h3>
<p><img src="img/Selection_133.png" width="90%" style="display: block; margin: auto;" /></p>
<p><span class="math display">\[
\widehat{\text{ACE}}  = \frac{13.1 + 6.0 - 4.8 - 13.4}{4} = 0.2%
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{ATT}} &amp; = \frac{13.1\times100 + 6.0\times341 - 4.8\times544 - 13.4\times718}{100 + 341 + 544 + 718} \\
&amp; = -5.2%\\
\end{aligned}
\]</span></p>
<p>再次印證了之前一章練習中的計算結果，也就是 RFA 如果施加給整體患者，那麼甚至可能還稍微提高三年內死亡/病情加重的概率。但是如果只給適合 RFA 療法的人，那麼 RFA 能明顯地降低死亡/病情加重的概率。</p>
</div>
<div id="matching" class="section level3">
<h3><span class="header-section-number">94.1.2</span> 配對法 matching</h3>
<p>用肺癌數據的例子來解釋，就是</p>
<p>從選擇了 RFA 療法的患者出發，在標準療法的患者中尋找一名或者多名和 RFA 療法患者的評分接近的患者作對照，這樣計算的是 ATT (average treatment effect in the treated)。</p>
<p>從選擇了標準手術療法的患者出發，在 RFA 療法的患者中尋找一名或者多名和 RFA 療法患者的評分接近的患者作對照，這樣計算的是 非暴露組中的平均療效 (average treatment effect in the untreated/unexposed)。</p>
<p>此時，配對患者選用是可以重復出現的 (replacement is allowed)，所以，有的對照可能同時給好幾個病例做對照也有可能。所以當你的樣本可能不平衡，那麼從樣本量大的那一部分出發的時候，就會出現這種情況。</p>
<p>選擇配對的方法也有很多:</p>
<ul>
<li>nearest neighbour matching (wthin calipers defined by the PS)</li>
<li>Kernel matching (nearest neighbour matching chooses one match)</li>
<li>etc.</li>
</ul>
<p>如果數據不適合使用傾向性評分法，那麼只要一做配對，就能立刻發現數據的問題，因爲如果違反了 positivity，那麼樣本中的某一組患者可能就大量地找不到相同相似PS評分的配對。另外配對法，可以配合調整變量共同使用，以增加估計的效能和穩健性。從經驗上來看 1:1 配對常常造成的效果是統計效能較低，而且即使使用配對法，觀察性研究還是觀察性研究，殘差混雜 (residual confounding) 依然存在。而且配對法導致估計量的標準誤難以估計，即使用自助重抽 (bootstrapping) 也常常是沒有效果。還好牛人 <span class="citation">(Abadie and Imbens <a href="#ref-Abadie2016">2016</a>)</span> 發現並發表了配對評分時的有效方差估計法，這個方法也已經加入了 STATA。</p>
<p>在 STATA 裏使用 <code>teffects psmatch</code> 命令執行傾向性評分的配對法</p>
<pre><code>## 
## . use &quot;backupfiles/RFA.dta&quot; 
## 
## . teffects psmatch (dodp) (rfa age gender i.smoke i.hospital nodules mets durat
## &gt; ion maxdia i.primary i.position, logit)
## 
## Treatment-effects estimation                   Number of obs      =      3,551
## Estimator      : propensity-score matching     Matches: requested =          1
## Outcome model  : matching                                     min =          1
## Treatment model: logit                                        max =          1
## ------------------------------------------------------------------------------
##              |              AI Robust
##         dodp |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
## ATE          |
##          rfa |
## (radiofre..  |
##          vs  |
## standard..)  |   .0154886   .0204308     0.76   0.448     -.024555    .0555322
## ------------------------------------------------------------------------------
## 
## . 
## . teffects psmatch (dodp) (rfa age gender i.smoke i.hospital nodules mets durat
## &gt; ion maxdia i.primary i.position, logit), atet
## 
## Treatment-effects estimation                   Number of obs      =      3,551
## Estimator      : propensity-score matching     Matches: requested =          1
## Outcome model  : matching                                     min =          1
## Treatment model: logit                                        max =          1
## ------------------------------------------------------------------------------
##              |              AI Robust
##         dodp |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
## ATET         |
##          rfa |
## (radiofre..  |
##          vs  |
## standard..)  |  -.0387551   .0199095    -1.95   0.052    -.0777771    .0002668
## ------------------------------------------------------------------------------</code></pre>
<p>可見，結果和目前爲止計算的結果是吻合的。值得注意的是，配對法在文獻中被發現是最常(濫)用的方法，這裏提評分的配對法，不是因爲我贊成使用這種方法，而是因爲它常見，所以你需要知道這種配對的背後到底在幹啥。顯而易見的是，傾向性評分有它更好的使用方法 (逆向權重)。</p>
</div>
<div id="adjustment" class="section level3">
<h3><span class="header-section-number">94.1.3</span> 回歸模型校正法 adjustment</h3>
<p><span class="math display">\[
E\{Y|X,p(\mathbf{C}) \} = \alpha + \beta X + \gamma p(\mathbf{C})
\]</span></p>
<p>校正傾向性評分，可以一定程度上克服<strong>有限樣本造成的偏倚 (finite sample bias)</strong>。</p>
</div>
</div>
<div id="practical05---causal-inference" class="section level2">
<h2><span class="header-section-number">94.2</span> Practical05 - causal inference</h2>
<p>數據還是和前一章節一樣的數據。傾向性評分的 R 包有很多，下面用 R 來進行大多數的計算。</p>
<div id="section-408" class="section level3">
<h3><span class="header-section-number">94.2.1</span> 初步熟悉數據內容</h3>
<pre><code>## 
## . use &quot;backupfiles/RFAcat.dta&quot; 
## 
## . describe
## 
## Contains data from backupfiles/RFAcat.dta
##   obs:         3,551                          
##  vars:            18                          5 Nov 2013 15:05
##  size:       255,672                          
## -------------------------------------------------------------------------------
##               storage   display    value
## variable name   type    format     label      variable label
## -------------------------------------------------------------------------------
## id              float   %9.0g                 Patient ID
## age             float   %9.0g                 
## gender          float   %9.0g      gender     
## smoke           float   %9.0g      smoke      Smoking status
## hospital        float   %9.0g                 Hospital ID
## nodules         float   %9.0g                 Number of nodules
## mets            float   %9.0g                 Number of other metastatic sites
## duration        float   %9.0g                 Duration of disease (in months)
## maxdia          float   %9.0g                 Diameter of largest nodule (in
##                                                 cm)
## primary         float   %22.0g     primary    Location of primary cancer
## position        float   %9.0g      position   Ease with which nodules can be
##                                                 reached
## coag            float   %9.0g      coag       Coagulopathy
## rfa             float   %23.0g     rfa        Treatment variable: RFA or
##                                                 standard surgery
## dodp            float   %9.0g      dodp       Outcome variable: death or
##                                                 disease progression within 36
##                                                 months
## agecat          float   %9.0g      agecat     Age in categories
## nodcat          float   %9.0g      nodcat     Number of nodules in categories
## durcat          float   %12.0g     durcat     Duration of disease in categories
## diacat          float   %9.0g      diacat     Diameter of largest nodule in
##                                                 categories
## -------------------------------------------------------------------------------
## Sorted by: id
## 
## . 
## . **********************
## . *  Explore the data  *
## . **********************
## . 
## . /*  Question 1  */
## . * Exposure and outcome
## . tab rfa
## 
## Treatment variable: RFA |
##     or standard surgery |      Freq.     Percent        Cum.
## ------------------------+-----------------------------------
##        standard surgery |      1,848       52.04       52.04
## radiofrequency ablation |      1,703       47.96      100.00
## ------------------------+-----------------------------------
##                   Total |      3,551      100.00
## 
## . tab dodp rfa, col
## 
## +-------------------+
## | Key               |
## |-------------------|
## |     frequency     |
## | column percentage |
## +-------------------+
## 
##    Outcome |
##  variable: |
##   death or |
##    disease |  Treatment variable:
## progressio |    RFA or standard
##   n within |        surgery
##  36 months | standard   radiofreq |     Total
## -----------+----------------------+----------
##         no |     1,255      1,349 |     2,604 
##            |     67.91      79.21 |     73.33 
## -----------+----------------------+----------
##        yes |       593        354 |       947 
##            |     32.09      20.79 |     26.67 
## -----------+----------------------+----------
##      Total |     1,848      1,703 |     3,551 
##            |    100.00     100.00 |    100.00 
## 
## . 
## . * New (categorised) variables: 
## . tab1 agecat nodcat durcat diacat, m
## 
## -&gt; tabulation of agecat  
## 
##      Age in |
##  categories |      Freq.     Percent        Cum.
## ------------+-----------------------------------
##         &lt;45 |         96        2.70        2.70
##       45-49 |        860       24.22       26.92
##       50-54 |      1,755       49.42       76.34
##       55-59 |        662       18.64       94.99
##       60-64 |        135        3.80       98.79
##         65+ |         43        1.21      100.00
## ------------+-----------------------------------
##       Total |      3,551      100.00
## 
## -&gt; tabulation of nodcat  
## 
##   Number of |
##  nodules in |
##  categories |      Freq.     Percent        Cum.
## ------------+-----------------------------------
##           1 |        997       28.08       28.08
##           2 |      1,350       38.02       66.09
##           3 |        635       17.88       83.98
##           4 |        204        5.74       89.72
##         5-9 |        304        8.56       98.28
##         10+ |         61        1.72      100.00
## ------------+-----------------------------------
##       Total |      3,551      100.00
## 
## -&gt; tabulation of durcat  
## 
##  Duration of |
##   disease in |
##   categories |      Freq.     Percent        Cum.
## -------------+-----------------------------------
##   &lt;10 months |         53        1.49        1.49
## 10-19 months |      1,437       40.47       41.96
## 20-29 months |      1,528       43.03       84.99
## 30-39 months |        397       11.18       96.17
##   40+ months |        136        3.83      100.00
## -------------+-----------------------------------
##        Total |      3,551      100.00
## 
## -&gt; tabulation of diacat  
## 
## Diameter of |
##     largest |
##   nodule in |
##  categories |      Freq.     Percent        Cum.
## ------------+-----------------------------------
##     &lt;1.5 cm |        967       27.23       27.23
##   1.5-1.9cm |      1,147       32.30       59.53
##     2-2.4cm |        940       26.47       86.00
##   2.5-2.9cm |        403       11.35       97.35
##        3cm+ |         94        2.65      100.00
## ------------+-----------------------------------
##       Total |      3,551      100.00
## 
## .</code></pre>
</div>
<div id="section-409" class="section level3">
<h3><span class="header-section-number">94.2.2</span> 把連續型變量以分類型數據的形式放入模型中:</h3>
<pre><code>***************************
*  Regression adjustment  *
***************************

/*  Question 2  */
// teffects ra (dodp   i.agecat gender i.smoke i.hospital i.nodcat ///
// i.mets i.durcat i.diacat i.primary i.position,   ///
// logit) (rfa)</code></pre>
<p>你會發現 STATA 停不下來，計算永遠都不會收斂。這是因爲我們在這個模型中結果部分加入了太多的分類型變量，但數據又沒辦法進行足夠的計算。</p>
</div>
<div id="section-410" class="section level3">
<h3><span class="header-section-number">94.2.3</span> 用相同的模型結構估計每個人的傾向性評分</h3>
<pre class="sourceCode r"><code class="sourceCode r">RFAcat &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;backupfiles/RFAcat.dta&quot;</span>)
RFAcat &lt;-<span class="st"> </span>RFAcat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">gender =</span> <span class="kw">factor</span>(gender, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;men&quot;</span>, <span class="st">&quot;women&quot;</span>)), 
         <span class="dt">smoke =</span> <span class="kw">factor</span>(smoke, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;never&quot;</span>, <span class="st">&quot;ex&quot;</span>, <span class="st">&quot;current&quot;</span>)),
         <span class="dt">hospital =</span> <span class="kw">as.factor</span>(hospital),
         <span class="dt">primary =</span> <span class="kw">factor</span>(primary, <span class="dt">labels =</span>  <span class="kw">c</span>(<span class="st">&quot;bladder&quot;</span>, 
                                     <span class="st">&quot;breast&quot;</span>, 
                                     <span class="st">&quot;colorectal&quot;</span>,
                                     <span class="st">&quot;gullet&quot;</span>, 
                                     <span class="st">&quot;kidney&quot;</span>,
                                     <span class="st">&quot;prostate&quot;</span>,
                                     <span class="st">&quot;skin&quot;</span>,
                                     <span class="st">&quot;stomach&quot;</span>, 
                                     <span class="st">&quot;testicular&quot;</span>)),
         <span class="dt">position =</span> <span class="kw">factor</span>(position, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;easy&quot;</span>, <span class="st">&quot;moderate&quot;</span>, <span class="st">&quot;difficult&quot;</span>)),
         <span class="dt">nodcat =</span> <span class="kw">factor</span>(nodcat, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5-9&quot;</span>,<span class="st">&quot;10+&quot;</span>)),
         <span class="dt">mets =</span> <span class="kw">as.factor</span>(mets), 
         <span class="dt">agecat =</span> <span class="kw">factor</span>(agecat, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt; 45&quot;</span>, <span class="st">&quot;45-49&quot;</span>, <span class="st">&quot;50-54&quot;</span>, <span class="st">&quot;55-59&quot;</span>, <span class="st">&quot;60-64&quot;</span>,<span class="st">&quot;65+&quot;</span>)), 
         <span class="dt">durcat =</span> <span class="kw">factor</span>(durcat, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt; 10m&quot;</span>, <span class="st">&quot;10-19m&quot;</span>, <span class="st">&quot;20-29m&quot;</span>, <span class="st">&quot;30-39m&quot;</span>, <span class="st">&quot;40+m&quot;</span>)), 
         <span class="dt">diacat =</span> <span class="kw">factor</span>(diacat, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt;1.5cm&quot;</span>, <span class="st">&quot;1.5-1.9cm&quot;</span>, <span class="st">&quot;2-2.4cm&quot;</span>, <span class="st">&quot;2.5-2.9cm&quot;</span>, 
                                            <span class="st">&quot;3cm+&quot;</span>)))
Pros_Score &lt;-<span class="st"> </span><span class="kw">glm</span>(rfa <span class="op">~</span><span class="st"> </span>agecat <span class="op">+</span><span class="st"> </span>gender <span class="op">+</span><span class="st"> </span>smoke <span class="op">+</span><span class="st"> </span>hospital <span class="op">+</span><span class="st"> </span>nodcat <span class="op">+</span><span class="st"> </span>mets <span class="op">+</span><span class="st"> </span>
<span class="st">                    </span>durcat <span class="op">+</span><span class="st"> </span>diacat <span class="op">+</span><span class="st"> </span>primary <span class="op">+</span><span class="st"> </span>position, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> logit), 
                  <span class="dt">data =</span> RFAcat)
<span class="kw">summary</span>(Pros_Score)</code></pre>
<pre><code>## 
## Call:
## glm(formula = rfa ~ agecat + gender + smoke + hospital + nodcat + 
##     mets + durcat + diacat + primary + position, family = binomial(link = logit), 
##     data = RFAcat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.45628  -0.90333  -0.26702   0.90927   2.67426  
## 
## Coefficients:
##                    Estimate Std. Error  z value  Pr(&gt;|z|)    
## (Intercept)        0.243514   0.505730   0.4815  0.630154    
## agecat45-49        0.090044   0.261908   0.3438  0.730996    
## agecat50-54        0.107064   0.255438   0.4191  0.675115    
## agecat55-59       -0.040906   0.269042  -0.1520  0.879154    
## agecat60-64        0.074712   0.327138   0.2284  0.819351    
## agecat65+          0.398326   0.431966   0.9221  0.356464    
## genderwomen        0.083521   0.151596   0.5509  0.581673    
## smokeex            0.117319   0.150316   0.7805  0.435105    
## smokecurrent       0.144515   0.104757   1.3795  0.167732    
## hospital2         -0.190892   0.140877  -1.3550  0.175407    
## hospital3          0.345035   0.138004   2.5002  0.012413 *  
## hospital4         -0.094451   0.191935  -0.4921  0.622648    
## nodcat2           -0.085830   0.097834  -0.8773  0.380324    
## nodcat3           -0.012021   0.118491  -0.1014  0.919195    
## nodcat4            0.143596   0.182086   0.7886  0.430336    
## nodcat5-9         -0.482427   0.156551  -3.0816  0.002059 ** 
## nodcat10+          0.043502   0.299620   0.1452  0.884561    
## mets1              0.100543   0.099312   1.0124  0.311349    
## mets2              0.139866   0.105583   1.3247  0.185272    
## mets3             -0.091375   0.296308  -0.3084  0.757795    
## durcat10-19m       0.038115   0.342352   0.1113  0.911352    
## durcat20-29m      -0.009245   0.341993  -0.0270  0.978434    
## durcat30-39m       0.127019   0.356684   0.3561  0.721758    
## durcat40+m         0.159252   0.394089   0.4041  0.686138    
## diacat1.5-1.9cm   -1.053938   0.100734 -10.4626 &lt; 2.2e-16 ***
## diacat2-2.4cm     -2.223150   0.109874 -20.2337 &lt; 2.2e-16 ***
## diacat2.5-2.9cm   -3.781319   0.199920 -18.9142 &lt; 2.2e-16 ***
## diacat3cm+        -4.216794   0.470139  -8.9693 &lt; 2.2e-16 ***
## primarybreast      0.070017   0.288955   0.2423  0.808540    
## primarycolorectal  0.087730   0.292264   0.3002  0.764044    
## primarygullet     -0.091053   0.378701  -0.2404  0.809993    
## primarykidney     -0.269296   0.377865  -0.7127  0.476046    
## primaryprostate   -0.027718   0.344383  -0.0805  0.935850    
## primaryskin        1.557764   0.670168   2.3244  0.020102 *  
## primarystomach     0.134603   0.380885   0.3534  0.723792    
## primarytesticular  0.304981   0.403875   0.7551  0.450167    
## positionmoderate   0.891048   0.099587   8.9474 &lt; 2.2e-16 ***
## positiondifficult  1.178730   0.116364  10.1296 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 4916.81  on 3550  degrees of freedom
## Residual deviance: 3852.35  on 3513  degrees of freedom
## AIC: 3928.35
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">RFAcat<span class="op">$</span>Score &lt;-<span class="st"> </span>Pros_Score<span class="op">$</span>fitted.values <span class="co"># extract the fitted scores</span>
<span class="kw">ggthemr</span>(<span class="st">&#39;fresh&#39;</span>, <span class="dt">layout =</span> <span class="st">&#39;scientific&#39;</span>)
RFAcat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Score, <span class="dt">y=</span> ..density.., <span class="dt">fill =</span> <span class="kw">as.factor</span>(rfa))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">17</span>), <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">14</span>),
        <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>),
    <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),
    <span class="dt">panel.background =</span> <span class="kw">element_blank</span>()) <span class="op">+</span>
<span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">19</span>), 
  <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">19</span>),
  <span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Treatment Methods&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Standard surgery&quot;</span>, <span class="st">&quot;RFA&quot;</span>)); <span class="kw">ggthemr_reset</span>()</code></pre>
<div class="figure" style="text-align: center"><span id="fig:CI-05-exe01"></span>
<img src="bookdown_files/figure-html/CI-05-exe01-1.png" alt="Density and histogram of the estimated propensity score in the two exposure groups, **with confounders and predictors of outcome included in the PS model.**" width="80%" />
<p class="caption">
圖 94.2: Density and histogram of the estimated propensity score in the two exposure groups, <strong>with confounders and predictors of outcome included in the PS model.</strong>
</p>
</div>
<p>概率密度分布圖和直方圖的內容告訴我們兩個暴露組患者的評分分布的交叉部分十分令人滿意，positivity 的前提假設可認爲得到滿足 (每個患者都有非零的概率接受 RFA 或者標準手術療法)。</p>
<p>一種比較組與組之間不同量的指標: standardized (mean) difference <span class="citation">(Austin <a href="#ref-Austin2011">2011</a>)</span>，可以用下面的方法來計算，使用 <code>tableone</code> 這個方便的 R 包:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># covariates</span>
Cov &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;agecat&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;smoke&quot;</span>, <span class="st">&quot;hospital&quot;</span>, <span class="st">&quot;nodcat&quot;</span>, <span class="st">&quot;mets&quot;</span>, <span class="st">&quot;durcat&quot;</span>, <span class="st">&quot;diacat&quot;</span>, 
         <span class="st">&quot;primary&quot;</span>, <span class="st">&quot;position&quot;</span>)
<span class="co">## Construct a table</span>
tabUnmatched &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(<span class="dt">vars =</span> Cov, <span class="dt">strata =</span> <span class="st">&quot;rfa&quot;</span>, <span class="dt">data =</span> RFAcat, <span class="dt">test =</span> <span class="ot">FALSE</span>)
<span class="co">## Show table with SMD</span>
<span class="kw">print</span>(tabUnmatched, <span class="dt">smd =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##                     Stratified by rfa
##                      0            1            SMD   
##   n                  1848         1703               
##   agecat (%)                                    0.065
##      &lt; 45              51 ( 2.8)    45 ( 2.6)        
##      45-49            463 (25.1)   397 (23.3)        
##      50-54            891 (48.2)   864 (50.7)        
##      55-59            352 (19.0)   310 (18.2)        
##      60-64             72 ( 3.9)    63 ( 3.7)        
##      65+               19 ( 1.0)    24 ( 1.4)        
##   gender = women (%)  726 (39.3)   701 (41.2)   0.038
##   smoke (%)                                     0.031
##      never           1279 (69.2)  1157 (67.9)        
##      ex               135 ( 7.3)   136 ( 8.0)        
##      current          434 (23.5)   410 (24.1)        
##   hospital (%)                                  0.115
##      1                308 (16.7)   262 (15.4)        
##      2                349 (18.9)   282 (16.6)        
##      3                677 (36.6)   718 (42.2)        
##      4                514 (27.8)   441 (25.9)        
##   nodcat (%)                                    0.096
##      1                505 (27.3)   492 (28.9)        
##      2                703 (38.0)   647 (38.0)        
##      3                325 (17.6)   310 (18.2)        
##      4                104 ( 5.6)   100 ( 5.9)        
##      5-9              181 ( 9.8)   123 ( 7.2)        
##      10+               30 ( 1.6)    31 ( 1.8)        
##   mets (%)                                      0.061
##      0               1089 (58.9)   969 (56.9)        
##      1                393 (21.3)   375 (22.0)        
##      2                327 (17.7)   331 (19.4)        
##      3                 39 ( 2.1)    28 ( 1.6)        
##   durcat (%)                                    0.070
##      &lt; 10m             31 ( 1.7)    22 ( 1.3)        
##      10-19m           731 (39.6)   706 (41.5)        
##      20-29m           820 (44.4)   708 (41.6)        
##      30-39m           197 (10.7)   200 (11.7)        
##      40+m              69 ( 3.7)    67 ( 3.9)        
##   diacat (%)                                    1.086
##      &lt;1.5cm           222 (12.0)   745 (43.7)        
##      1.5-1.9cm        507 (27.4)   640 (37.6)        
##      2-2.4cm          661 (35.8)   279 (16.4)        
##      2.5-2.9cm        369 (20.0)    34 ( 2.0)        
##      3cm+              89 ( 4.8)     5 ( 0.3)        
##   primary (%)                                   0.126
##      bladder           46 ( 2.5)    35 ( 2.1)        
##      breast           423 (22.9)   401 (23.5)        
##      colorectal       694 (37.6)   671 (39.4)        
##      gullet            75 ( 4.1)    55 ( 3.2)        
##      kidney            66 ( 3.6)    47 ( 2.8)        
##      prostate         365 (19.8)   324 (19.0)        
##      skin               5 ( 0.3)    17 ( 1.0)        
##      stomach           86 ( 4.7)    67 ( 3.9)        
##      testicular        88 ( 4.8)    86 ( 5.0)        
##   position (%)                                  0.332
##      easy             565 (30.6)   292 (17.1)        
##      moderate         899 (48.6)   921 (54.1)        
##      difficult        384 (20.8)   490 (28.8)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Count covariates with important imbalance</span>
<span class="kw">addmargins</span>(<span class="kw">table</span>(<span class="kw">ExtractSmd</span>(tabUnmatched) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.08</span>))</code></pre>
<pre><code>## 
## FALSE  TRUE   Sum 
##     5     5    10</code></pre>
<p>嚴重不平衡的變量有 5 個: <code>hospital, nodcat, diaact, primary, position</code>。</p>
</div>
<div id="ps--stratification" class="section level3">
<h3><span class="header-section-number">94.2.4</span> 用 PS 評分來把對象分層 stratification</h3>
<pre class="sourceCode r"><code class="sourceCode r">RFAcat &lt;-<span class="st"> </span>RFAcat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">psblock =</span> <span class="kw">ntile</span>(Score, <span class="dv">4</span>))

RFAcat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(psblock) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="kw">n</span>(), <span class="kw">min</span>(Score), <span class="kw">max</span>(Score))</code></pre>
<pre><code>## # A tibble: 4 x 4
##   psblock `n()` `min(Score)` `max(Score)`
##     &lt;int&gt; &lt;int&gt;        &lt;dbl&gt;        &lt;dbl&gt;
## 1       1   888       0.0167        0.280
## 2       2   888       0.281         0.508
## 3       3   888       0.508         0.695
## 4       4   887       0.696         0.951</code></pre>
<p>但是你看每層的傾向性評分其實範圍有點寬，提示使用分層的方法可能殘餘的混雜有點多。</p>
<p>看每層內數據的平衡:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cov &lt;- c(&quot;diacat&quot;, &quot;position&quot;)</span>
<span class="co">#---------------------------------------------#</span>
<span class="co">#  in strata == 1                             #</span>
<span class="co">#                                             #</span>
<span class="co">#---------------------------------------------#</span>
<span class="co">## Construct a table</span>
tabUnmatched &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(<span class="dt">vars =</span> Cov, <span class="dt">strata =</span> <span class="st">&quot;rfa&quot;</span>, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,], <span class="dt">test =</span> <span class="ot">FALSE</span>)
<span class="co">## Show table with SMD</span>
<span class="kw">print</span>(tabUnmatched, <span class="dt">smd =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##                     Stratified by rfa
##                      0           1           SMD   
##   n                  777         111               
##   agecat (%)                                  0.321
##      &lt; 45             27 ( 3.5)    3 ( 2.7)        
##      45-49           211 (27.2)   25 (22.5)        
##      50-54           334 (43.0)   59 (53.2)        
##      55-59           162 (20.8)   23 (20.7)        
##      60-64            37 ( 4.8)    1 ( 0.9)        
##      65+               6 ( 0.8)    0 ( 0.0)        
##   gender = women (%) 304 (39.1)   45 (40.5)   0.029
##   smoke (%)                                   0.248
##      never           533 (68.6)   88 (79.3)        
##      ex               56 ( 7.2)    6 ( 5.4)        
##      current         188 (24.2)   17 (15.3)        
##   hospital (%)                                0.265
##      1               135 (17.4)   10 ( 9.0)        
##      2               152 (19.6)   27 (24.3)        
##      3               270 (34.7)   38 (34.2)        
##      4               220 (28.3)   36 (32.4)        
##   nodcat (%)                                  0.209
##      1               201 (25.9)   24 (21.6)        
##      2               293 (37.7)   47 (42.3)        
##      3               119 (15.3)   17 (15.3)        
##      4                41 ( 5.3)    7 ( 6.3)        
##      5-9             112 (14.4)   16 (14.4)        
##      10+              11 ( 1.4)    0 ( 0.0)        
##   mets (%)                                    0.141
##      0               463 (59.6)   70 (63.1)        
##      1               154 (19.8)   24 (21.6)        
##      2               138 (17.8)   15 (13.5)        
##      3                22 ( 2.8)    2 ( 1.8)        
##   durcat (%)                                  0.209
##      &lt; 10m            17 ( 2.2)    3 ( 2.7)        
##      10-19m          297 (38.2)   41 (36.9)        
##      20-29m          356 (45.8)   54 (48.6)        
##      30-39m           76 ( 9.8)   12 (10.8)        
##      40+m             31 ( 4.0)    1 ( 0.9)        
##   diacat (%)                                  0.515
##      &lt;1.5cm            0 ( 0.0)    0 ( 0.0)        
##      1.5-1.9cm         9 ( 1.2)    4 ( 3.6)        
##      2-2.4cm         310 (39.9)   68 (61.3)        
##      2.5-2.9cm       369 (47.5)   34 (30.6)        
##      3cm+             89 (11.5)    5 ( 4.5)        
##   primary (%)                                 0.279
##      bladder          23 ( 3.0)    1 ( 0.9)        
##      breast          180 (23.2)   25 (22.5)        
##      colorectal      273 (35.1)   43 (38.7)        
##      gullet           40 ( 5.1)    3 ( 2.7)        
##      kidney           34 ( 4.4)    7 ( 6.3)        
##      prostate        159 (20.5)   25 (22.5)        
##      skin              1 ( 0.1)    1 ( 0.9)        
##      stomach          32 ( 4.1)    3 ( 2.7)        
##      testicular       35 ( 4.5)    3 ( 2.7)        
##   position (%)                                0.181
##      easy            319 (41.1)   36 (32.4)        
##      moderate        342 (44.0)   55 (49.5)        
##      difficult       116 (14.9)   20 (18.0)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Count covariates with important imbalance</span>
<span class="kw">addmargins</span>(<span class="kw">table</span>(<span class="kw">ExtractSmd</span>(tabUnmatched) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.08</span>))</code></pre>
<pre><code>## 
## FALSE  TRUE   Sum 
##     1     9    10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#---------------------------------------------#</span>
<span class="co">#  in strata == 2                             #</span>
<span class="co">#                                             #</span>
<span class="co">#---------------------------------------------#</span>
<span class="co">## Construct a table</span>
tabUnmatched &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(<span class="dt">vars =</span> Cov, <span class="dt">strata =</span> <span class="st">&quot;rfa&quot;</span>, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">2</span>,], <span class="dt">test =</span> <span class="ot">FALSE</span>)
<span class="co">## Show table with SMD</span>
<span class="kw">print</span>(tabUnmatched, <span class="dt">smd =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##                     Stratified by rfa
##                      0           1           SMD   
##   n                  550         338               
##   agecat (%)                                  0.114
##      &lt; 45             12 ( 2.2)    5 ( 1.5)        
##      45-49           129 (23.5)   82 (24.3)        
##      50-54           294 (53.5)  173 (51.2)        
##      55-59            87 (15.8)   61 (18.0)        
##      60-64            21 ( 3.8)   10 ( 3.0)        
##      65+               7 ( 1.3)    7 ( 2.1)        
##   gender = women (%) 217 (39.5)  132 (39.1)   0.008
##   smoke (%)                                   0.091
##      never           384 (69.8)  222 (65.7)        
##      ex               39 ( 7.1)   29 ( 8.6)        
##      current         127 (23.1)   87 (25.7)        
##   hospital (%)                                0.101
##      1                91 (16.5)   48 (14.2)        
##      2                89 (16.2)   49 (14.5)        
##      3               226 (41.1)  154 (45.6)        
##      4               144 (26.2)   87 (25.7)        
##   nodcat (%)                                  0.139
##      1               150 (27.3)  102 (30.2)        
##      2               205 (37.3)  124 (36.7)        
##      3               117 (21.3)   61 (18.0)        
##      4                37 ( 6.7)   18 ( 5.3)        
##      5-9              30 ( 5.5)   26 ( 7.7)        
##      10+              11 ( 2.0)    7 ( 2.1)        
##   mets (%)                                    0.145
##      0               322 (58.5)  191 (56.5)        
##      1               127 (23.1)   72 (21.3)        
##      2                93 (16.9)   73 (21.6)        
##      3                 8 ( 1.5)    2 ( 0.6)        
##   durcat (%)                                  0.162
##      &lt; 10m             8 ( 1.5)    4 ( 1.2)        
##      10-19m          210 (38.2)  138 (40.8)        
##      20-29m          251 (45.6)  133 (39.3)        
##      30-39m           63 (11.5)   44 (13.0)        
##      40+m             18 ( 3.3)   19 ( 5.6)        
##   diacat (%)                                  0.057
##      &lt;1.5cm            4 ( 0.7)    4 ( 1.2)        
##      1.5-1.9cm       199 (36.2)  127 (37.6)        
##      2-2.4cm         347 (63.1)  207 (61.2)        
##      2.5-2.9cm         0 ( 0.0)    0 ( 0.0)        
##      3cm+              0 ( 0.0)    0 ( 0.0)        
##   primary (%)                                 0.099
##      bladder           9 ( 1.6)    8 ( 2.4)        
##      breast          124 (22.5)   79 (23.4)        
##      colorectal      221 (40.2)  126 (37.3)        
##      gullet           19 ( 3.5)   13 ( 3.8)        
##      kidney           14 ( 2.5)   12 ( 3.6)        
##      prostate        104 (18.9)   63 (18.6)        
##      skin              0 ( 0.0)    0 ( 0.0)        
##      stomach          33 ( 6.0)   19 ( 5.6)        
##      testicular       26 ( 4.7)   18 ( 5.3)        
##   position (%)                                0.041
##      easy            172 (31.3)  100 (29.6)        
##      moderate        242 (44.0)  155 (45.9)        
##      difficult       136 (24.7)   83 (24.6)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Count covariates with important imbalance</span>
<span class="kw">addmargins</span>(<span class="kw">table</span>(<span class="kw">ExtractSmd</span>(tabUnmatched) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.08</span>))</code></pre>
<pre><code>## 
## FALSE  TRUE   Sum 
##     3     7    10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#---------------------------------------------#</span>
<span class="co">#  in strata == 3                             #</span>
<span class="co">#                                             #</span>
<span class="co">#---------------------------------------------#</span>
<span class="co">## Construct a table</span>
tabUnmatched &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(<span class="dt">vars =</span> Cov, <span class="dt">strata =</span> <span class="st">&quot;rfa&quot;</span>, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">3</span>,], <span class="dt">test =</span> <span class="ot">FALSE</span>)
<span class="co">## Show table with SMD</span>
<span class="kw">print</span>(tabUnmatched, <span class="dt">smd =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##                     Stratified by rfa
##                      0           1           SMD   
##   n                  347         541               
##   agecat (%)                                  0.163
##      &lt; 45              6 ( 1.7)   13 ( 2.4)        
##      45-49            90 (25.9)  135 (25.0)        
##      50-54           171 (49.3)  261 (48.2)        
##      55-59            71 (20.5)  102 (18.9)        
##      60-64             8 ( 2.3)   25 ( 4.6)        
##      65+               1 ( 0.3)    5 ( 0.9)        
##   gender = women (%) 132 (38.0)  205 (37.9)   0.003
##   smoke (%)                                   0.049
##      never           245 (70.6)  372 (68.8)        
##      ex               22 ( 6.3)   40 ( 7.4)        
##      current          80 (23.1)  129 (23.8)        
##   hospital (%)                                0.125
##      1                59 (17.0)  107 (19.8)        
##      2                78 (22.5)  109 (20.1)        
##      3               101 (29.1)  176 (32.5)        
##      4               109 (31.4)  149 (27.5)        
##   nodcat (%)                                  0.087
##      1               101 (29.1)  161 (29.8)        
##      2               143 (41.2)  205 (37.9)        
##      3                59 (17.0)  101 (18.7)        
##      4                14 ( 4.0)   24 ( 4.4)        
##      5-9              22 ( 6.3)   40 ( 7.4)        
##      10+               8 ( 2.3)   10 ( 1.8)        
##   mets (%)                                    0.061
##      0               205 (59.1)  314 (58.0)        
##      1                78 (22.5)  122 (22.6)        
##      2                57 (16.4)   89 (16.5)        
##      3                 7 ( 2.0)   16 ( 3.0)        
##   durcat (%)                                  0.088
##      &lt; 10m             3 ( 0.9)    6 ( 1.1)        
##      10-19m          150 (43.2)  227 (42.0)        
##      20-29m          142 (40.9)  239 (44.2)        
##      30-39m           40 (11.5)   51 ( 9.4)        
##      40+m             12 ( 3.5)   18 ( 3.3)        
##   diacat (%)                                  0.142
##      &lt;1.5cm           68 (19.6)  135 (25.0)        
##      1.5-1.9cm       275 (79.3)  403 (74.5)        
##      2-2.4cm           4 ( 1.2)    3 ( 0.6)        
##      2.5-2.9cm         0 ( 0.0)    0 ( 0.0)        
##      3cm+              0 ( 0.0)    0 ( 0.0)        
##   primary (%)                                 0.121
##      bladder          12 ( 3.5)   18 ( 3.3)        
##      breast           73 (21.0)  124 (22.9)        
##      colorectal      131 (37.8)  198 (36.6)        
##      gullet           10 ( 2.9)   19 ( 3.5)        
##      kidney           13 ( 3.7)   16 ( 3.0)        
##      prostate         68 (19.6)  106 (19.6)        
##      skin              3 ( 0.9)    1 ( 0.2)        
##      stomach          17 ( 4.9)   25 ( 4.6)        
##      testicular       20 ( 5.8)   34 ( 6.3)        
##   position (%)                                0.162
##      easy             65 (18.7)  127 (23.5)        
##      moderate        216 (62.2)  294 (54.3)        
##      difficult        66 (19.0)  120 (22.2)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Count covariates with important imbalance</span>
<span class="kw">addmargins</span>(<span class="kw">table</span>(<span class="kw">ExtractSmd</span>(tabUnmatched) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.08</span>))</code></pre>
<pre><code>## 
## FALSE  TRUE   Sum 
##     3     7    10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#---------------------------------------------#</span>
<span class="co">#  in strata == 4                             #</span>
<span class="co">#                                             #</span>
<span class="co">#---------------------------------------------#</span>
<span class="co">## Construct a table</span>
tabUnmatched &lt;-<span class="st"> </span><span class="kw">CreateTableOne</span>(<span class="dt">vars =</span> Cov, <span class="dt">strata =</span> <span class="st">&quot;rfa&quot;</span>, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">4</span>,], <span class="dt">test =</span> <span class="ot">FALSE</span>)
<span class="co">## Show table with SMD</span>
<span class="kw">print</span>(tabUnmatched, <span class="dt">smd =</span> <span class="ot">TRUE</span>)</code></pre>
<pre><code>##                     Stratified by rfa
##                      0           1           SMD   
##   n                  174         713               
##   agecat (%)                                  0.105
##      &lt; 45              6 ( 3.4)   24 ( 3.4)        
##      45-49            33 (19.0)  155 (21.7)        
##      50-54            92 (52.9)  371 (52.0)        
##      55-59            32 (18.4)  124 (17.4)        
##      60-64             6 ( 3.4)   27 ( 3.8)        
##      65+               5 ( 2.9)   12 ( 1.7)        
##   gender = women (%)  73 (42.0)  319 (44.7)   0.056
##   smoke (%)                                   0.077
##      never           117 (67.2)  475 (66.6)        
##      ex               18 (10.3)   61 ( 8.6)        
##      current          39 (22.4)  177 (24.8)        
##   hospital (%)                                0.104
##      1                23 (13.2)   97 (13.6)        
##      2                30 (17.2)   97 (13.6)        
##      3                80 (46.0)  350 (49.1)        
##      4                41 (23.6)  169 (23.7)        
##   nodcat (%)                                  0.254
##      1                53 (30.5)  205 (28.8)        
##      2                62 (35.6)  271 (38.0)        
##      3                30 (17.2)  131 (18.4)        
##      4                12 ( 6.9)   51 ( 7.2)        
##      5-9              17 ( 9.8)   41 ( 5.8)        
##      10+               0 ( 0.0)   14 ( 2.0)        
##   mets (%)                                    0.061
##      0                99 (56.9)  394 (55.3)        
##      1                34 (19.5)  157 (22.0)        
##      2                39 (22.4)  154 (21.6)        
##      3                 2 ( 1.1)    8 ( 1.1)        
##   durcat (%)                                  0.094
##      &lt; 10m             3 ( 1.7)    9 ( 1.3)        
##      10-19m           74 (42.5)  300 (42.1)        
##      20-29m           71 (40.8)  282 (39.6)        
##      30-39m           18 (10.3)   93 (13.0)        
##      40+m              8 ( 4.6)   29 ( 4.1)        
##   diacat (%)                                  0.062
##      &lt;1.5cm          150 (86.2)  606 (85.0)        
##      1.5-1.9cm        24 (13.8)  106 (14.9)        
##      2-2.4cm           0 ( 0.0)    1 ( 0.1)        
##      2.5-2.9cm         0 ( 0.0)    0 ( 0.0)        
##      3cm+              0 ( 0.0)    0 ( 0.0)        
##   primary (%)                                 0.177
##      bladder           2 ( 1.1)    8 ( 1.1)        
##      breast           46 (26.4)  173 (24.3)        
##      colorectal       69 (39.7)  304 (42.6)        
##      gullet            6 ( 3.4)   20 ( 2.8)        
##      kidney            5 ( 2.9)   12 ( 1.7)        
##      prostate         34 (19.5)  130 (18.2)        
##      skin              1 ( 0.6)   15 ( 2.1)        
##      stomach           4 ( 2.3)   20 ( 2.8)        
##      testicular        7 ( 4.0)   31 ( 4.3)        
##   position (%)                                0.056
##      easy              9 ( 5.2)   29 ( 4.1)        
##      moderate         99 (56.9)  417 (58.5)        
##      difficult        66 (37.9)  267 (37.4)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">## Count covariates with important imbalance</span>
<span class="kw">addmargins</span>(<span class="kw">table</span>(<span class="kw">ExtractSmd</span>(tabUnmatched) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.08</span>))</code></pre>
<pre><code>## 
## FALSE  TRUE   Sum 
##     5     5    10</code></pre>
<p>可以看出其實分層法中每層的數據依然還有很多的不平衡。分層法不是合理的利用傾向性評分的理想辦法。</p>
<div id="section-411" class="section level4">
<h4><span class="header-section-number">94.2.4.1</span> 計算每層評分組內，暴露和結果之間的關系</h4>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">lm</span>(dodp <span class="op">~</span><span class="st"> </span>rfa, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]))</code></pre>
<pre><code>## 
## Call:
## lm(formula = dodp ~ rfa, data = RFAcat[RFAcat$psblock == 1, ])
## 
## Coefficients:
## (Intercept)          rfa  
##     0.40927      0.11326</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">lm</span>(dodp <span class="op">~</span><span class="st"> </span>rfa, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]))</code></pre>
<pre><code>## 
## Call:
## lm(formula = dodp ~ rfa, data = RFAcat[RFAcat$psblock == 2, ])
## 
## Coefficients:
## (Intercept)          rfa  
##    0.285455     0.099161</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">lm</span>(dodp <span class="op">~</span><span class="st"> </span>rfa, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, ]))</code></pre>
<pre><code>## 
## Call:
## lm(formula = dodp ~ rfa, data = RFAcat[RFAcat$psblock == 3, ])
## 
## Coefficients:
## (Intercept)          rfa  
##    0.198847    -0.041731</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">lm</span>(dodp <span class="op">~</span><span class="st"> </span>rfa, <span class="dt">data =</span> RFAcat[RFAcat<span class="op">$</span>psblock <span class="op">==</span><span class="st"> </span><span class="dv">4</span>, ]))</code></pre>
<pre><code>## 
## Call:
## lm(formula = dodp ~ rfa, data = RFAcat[RFAcat$psblock == 4, ])
## 
## Coefficients:
## (Intercept)          rfa  
##     0.28161     -0.16800</code></pre>
</div>
<div id="ace-2" class="section level4">
<h4><span class="header-section-number">94.2.4.2</span> 計算 ACE</h4>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="dv">888</span><span class="op">*</span><span class="fl">0.1132561</span> <span class="op">+</span><span class="st"> </span><span class="dv">888</span><span class="op">*</span><span class="fl">0.0991608</span> <span class="op">+</span><span class="st"> </span><span class="dv">888</span><span class="op">*</span>(<span class="op">-</span><span class="fl">0.0417308</span>) <span class="op">+</span><span class="st"> </span><span class="dv">887</span><span class="op">*</span>(<span class="op">-</span><span class="fl">0.1680047</span>))<span class="op">/</span><span class="dv">3551</span></code></pre>
<pre><code>## [1] 0.00071785072</code></pre>
</div>
</div>
<div id="ace-3" class="section level3">
<h3><span class="header-section-number">94.2.5</span> 用配對法計算 ACE</h3>
<pre><code>## 
## . use &quot;backupfiles/RFAcat.dta&quot; 
## 
## . /*  Question 10  */
## . teffects psmatch (dodp) (rfa i.agecat gender i.smoke i.hospital ///
## &gt;                         i.nodcat i.mets i.durcat i.diacat i.primary i.positio
## &gt; n, logit)
## 
## Treatment-effects estimation                   Number of obs      =      3,551
## Estimator      : propensity-score matching     Matches: requested =          1
## Outcome model  : matching                                     min =          1
## Treatment model: logit                                        max =          3
## ------------------------------------------------------------------------------
##              |              AI Robust
##         dodp |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]
## -------------+----------------------------------------------------------------
## ATE          |
##          rfa |
## (radiofre..  |
##          vs  |
## standard..)  |   .0263775   .0187999     1.40   0.161    -.0104697    .0632248
## ------------------------------------------------------------------------------</code></pre>
</div>
<div id="ps" class="section level3">
<h3><span class="header-section-number">94.2.6</span> 模型校正 PS</h3>
<pre class="sourceCode r"><code class="sourceCode r">RFAcat<span class="op">$</span>rfanew &lt;-<span class="st"> </span>RFAcat<span class="op">$</span>rfa
Log_ps &lt;-<span class="st"> </span><span class="kw">glm</span>(dodp <span class="op">~</span><span class="st"> </span><span class="kw">as.factor</span>(rfanew)<span class="op">*</span>Score, <span class="dt">data =</span> RFAcat, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))
<span class="kw">summary</span>(Log_ps)</code></pre>
<pre><code>## 
## Call:
## glm(formula = dodp ~ as.factor(rfanew) * Score, family = binomial(link = &quot;logit&quot;), 
##     data = RFAcat)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.45859  -0.86831  -0.63218   1.29348   2.29729  
## 
## Coefficients:
##                          Estimate Std. Error z value  Pr(&gt;|z|)    
## (Intercept)              -0.28539    0.08742 -3.2646  0.001096 ** 
## as.factor(rfanew)1        1.04607    0.19586  5.3409 9.247e-08 ***
## Score                    -1.37952    0.22182 -6.2190 5.003e-10 ***
## as.factor(rfanew)1:Score -2.24706    0.37406 -6.0073 1.886e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 4118.69  on 3550  degrees of freedom
## Residual deviance: 3863.82  on 3547  degrees of freedom
## AIC: 3871.82
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">RFAcat &lt;-<span class="st"> </span>RFAcat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rfanew =</span> <span class="dv">1</span>)
newdata &lt;-<span class="st"> </span><span class="kw">subset</span>(RFAcat, <span class="dt">select =</span> <span class="kw">c</span>(rfanew, Score))

RFAcat<span class="op">$</span>Po1&lt;-<span class="st"> </span><span class="kw">predict</span>(Log_ps, newdata, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)


RFAcat &lt;-<span class="st"> </span>RFAcat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rfanew =</span> <span class="dv">0</span>)
newdata1 &lt;-<span class="st"> </span><span class="kw">subset</span>(RFAcat, <span class="dt">select =</span> <span class="kw">c</span>(rfanew, Score))

RFAcat<span class="op">$</span>Po0 &lt;-<span class="st"> </span><span class="kw">predict</span>(Log_ps, newdata1, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)


<span class="kw">with</span>(RFAcat, <span class="kw">summ</span>(Po1, <span class="dt">graph =</span> F))</code></pre>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  3551 0.306  0.253   0.182  0.064  0.668</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(RFAcat, <span class="kw">summ</span>(Po0, <span class="dt">graph =</span> F))</code></pre>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  3551 0.285  0.272   0.072  0.168  0.423</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">with</span>(RFAcat, <span class="kw">summ</span>(Po1 <span class="op">-</span><span class="st"> </span>Po0, <span class="dt">graph =</span> F))</code></pre>
<pre><code>##  obs. mean   median  s.d.   min.   max.  
##  3551 0.021  -0.018  0.11   -0.105 0.245</code></pre>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Rosenbaum1983">
<p>Rosenbaum, Paul R, and Donald B Rubin. 1983. “The Central Role of the Propensity Score in Observational Studies for Causal Effects.” <em>Biometrika</em> 70 (1): 41–55.</p>
</div>
<div id="ref-Abadie2016">
<p>Abadie, Alberto, and Guido W Imbens. 2016. “Matching on the Estimated Propensity Score.” <em>Econometrica</em> 84 (2): 781–807.</p>
</div>
<div id="ref-Austin2011">
<p>Austin, Peter C. 2011. “An Introduction to Propensity Score Methods for Reducing the Effects of Confounding in Observational Studies.” <em>Multivariate Behavioral Research</em> 46 (3): 399–424.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression-methods-with-binary-outcomes-.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inverse-probability-weighted-estimation-and-doubly-robust-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/winterwang/LSHTMlearningnote/edit/master/16-ASM-Causal-infer.Rmd",
"text": "編輯"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
